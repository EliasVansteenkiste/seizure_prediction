['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config6.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_0']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config6.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_0'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-23 20:20:47.123830
Hostname: kat
gpu2
Configuration 'config6.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net29
evaluation:
    online_training: False
    model: net29

end Configuration
['patient2_0']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [0]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.784662528
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 367.479559326 395.117904663
20 582.979382324 615.201062012
30 795.170080566 830.338665771
40 1032.00554199 1067.2041748
50 1317.6385498 1346.52661133
60 1685.20253906 1697.71447754
70 2197.84929199 2175.63908691
80 3011.64487305 2914.53989258
90 4710.7300293 4431.95449219
100 63321.7421875 58944.8007812
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net29
Model name for the evaluation phase:  net29
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m8.61314[0m     [32m2.23940[0m    3.84618      0.59007  41.82s
      2     [36m1.11197[0m     [32m1.18243[0m    0.94041      0.59969  47.64s
      3     [36m0.76833[0m     [32m1.11671[0m    0.68803      0.54829  50.28s
      4     [36m0.64518[0m     [32m0.96715[0m    0.66709      0.51678  50.21s
      5     [36m0.58635[0m     [32m0.83980[0m    0.69820      0.59059  50.42s
      6     [36m0.56229[0m     [32m0.83453[0m    0.67378      0.53481  50.77s
      7     [36m0.53724[0m     0.83465    0.64367      0.58430  50.43s
      8     0.53748     [32m0.70270[0m    0.76488      0.67731  51.70s
      9     [36m0.52444[0m     0.81060    0.64698      0.68923  50.69s
     10     [36m0.51996[0m     0.78273    0.66430      0.72066  50.00s
     11     [36m0.51336[0m     0.79105    0.64896      0.70272  50.52s
     12     [36m0.51128[0m     0.84789    0.60300      0.64726  50.12s
     13     [36m0.50994[0m     0.80374    0.63446      0.68690  49.79s
     14     [36m0.50599[0m     0.77139    0.65594      0.70001  56.43s
     15     0.55471     0.76771    0.72255      0.68346  55.33s
     16     [36m0.48724[0m     0.90386    0.53906      0.66274  57.58s
     17     0.48855     0.82339    0.59334      0.68065  55.68s
     18     [36m0.48182[0m     0.78475    0.61398      0.64549  56.05s
Early stopping.
Best valid loss was 0.702699 at epoch 8.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[ 0.51020646  0.8612898   0.89802098  0.99514455  0.88905495  0.949552
  0.42650113  0.79787886  0.59928292  0.71038944  0.8221032   0.90110075
  0.11616633  0.93773353  0.58594847  0.40745017  0.33140978  0.18040322
  0.45025045  0.22559051  0.01364343  0.48625994  0.14281687  0.21903913
  0.02095452  0.1326403   0.31252405  0.34388694  0.01982606  0.52324426]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.77238013207
Error rate (%):  22.761986793
[[36599  9571]
 [ 2321  3754]]
(52245,)
(52245,)
roc_auc: 0.725232191641
log_loss: 1.03791984942
roc_auc for the hours: 0.747368421053
log_loss for the hours: 0.709934633781
saving predictions to csv file
hourspatient2_0_net29_10-23-20-57-43.csv
Accuracy validation for the hours:  0.813953488372
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [0]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.07636736
saving predictions to csv file
patient2_0_net29_10-23-21-38-26.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config6.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_1']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config6.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_1'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-23 21:38:28.051260
Hostname: kat
gpu2
Configuration 'config6.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net29
evaluation:
    online_training: False
    model: net29

end Configuration
['patient2_1']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [1]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.783814656
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 263.661355591 284.954690552
20 416.892218018 440.678961182
30 568.269549561 590.942108154
40 738.6140625 756.022766113
50 948.0390625 954.364257812
60 1230.36213379 1214.27253418
70 1653.89840088 1589.50096436
80 2395.20083008 2220.65932617
90 4170.49838867 3672.37075195
100 56617.8046875 55581.1640625
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net29
Model name for the evaluation phase:  net29
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m7.36626[0m     [32m3.20830[0m    2.29600      0.49959  40.49s
      2     [36m1.03455[0m     [32m2.04735[0m    0.50531      0.49881  41.85s
      3     [36m0.72222[0m     [32m1.43602[0m    0.50293      0.49964  45.80s
      4     [36m0.63529[0m     [32m1.27316[0m    0.49898      0.49964  46.02s
      5     [36m0.58554[0m     [32m1.21828[0m    0.48063      0.50052  45.57s
      6     [36m0.56040[0m     [32m1.18142[0m    0.47435      0.49742  45.39s
      7     [36m0.54375[0m     [32m1.04484[0m    0.52041      0.50021  45.23s
      8     [36m0.53620[0m     [32m0.90241[0m    0.59418      0.52796  44.86s
      9     [36m0.52847[0m     [32m0.85893[0m    0.61527      0.55012  45.06s
     10     [36m0.51266[0m     0.86531    0.59246      0.56857  45.35s
     11     [36m0.51070[0m     [32m0.80923[0m    0.63109      0.60035  45.53s
     12     [36m0.50840[0m     [32m0.78265[0m    0.64959      0.61152  45.58s
     13     [36m0.49768[0m     0.80227    0.62033      0.53506  45.25s
     14     0.50441     0.80608    0.62576      0.60796  45.32s
     15     [36m0.48968[0m     0.83317    0.58774      0.53002  45.56s
     16     [36m0.48641[0m     0.83990    0.57913      0.57286  45.68s
     17     [36m0.46640[0m     [32m0.78128[0m    0.59697      0.54101  45.67s
     18     1.13021     0.97862    1.15490      0.58589  45.52s
     19     [36m0.46411[0m     0.92638    0.50099      0.60856  45.71s
     20     [36m0.43439[0m     1.10383    0.39353      0.58579  45.81s
     21     [36m0.41956[0m     1.14442    0.36661      0.55437  45.38s
     22     [36m0.41016[0m     1.18347    0.34657      0.59132  45.67s
     23     [36m0.40028[0m     1.25892    0.31796      0.53433  45.31s
     24     [36m0.39337[0m     1.19898    0.32809      0.57568  46.19s
     25     [36m0.37974[0m     1.22602    0.30973      0.56506  46.39s
     26     [36m0.37500[0m     1.18894    0.31541      0.59239  44.67s
     27     [36m0.35464[0m     1.53695    0.23074      0.60594  44.42s
Early stopping.
Best valid loss was 0.781277 at epoch 17.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[ 0.81085068  0.98646867  0.99991214  0.99999714  0.97472465  0.99952149
  0.97332597  0.99998426  0.97079223  0.99765503  0.97259033  0.99988294
  0.89866173  0.99848795  0.97298121  0.9999615   0.91729742  0.9930529
  0.9982906   0.99949265  0.59263343  0.93058401  0.84581017  0.97109038
  0.30517858  0.90043616  0.65865773  0.94785821  0.23383276  0.82068956]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.619676524069
Error rate (%):  38.0323475931
[[28942 17228]
 [ 2642  3433]]
(52245,)
(52245,)
roc_auc: 0.576701866692
log_loss: inf
roc_auc for the hours: 0.647368421053
log_loss for the hours: 0.799175016686
saving predictions to csv file
hourspatient2_1_net29_10-23-22-15-33.csv
Accuracy validation for the hours:  0.627906976744
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [1]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.075634176
saving predictions to csv file
patient2_1_net29_10-23-22-56-01.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config6.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_2']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config6.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_2'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-23 22:56:02.436252
Hostname: kat
gpu2
Configuration 'config6.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net29
evaluation:
    online_training: False
    model: net29

end Configuration
['patient2_2']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [2]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.78456832
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 209.986540222 225.906962585
20 329.095306396 346.162701416
30 444.230593872 460.11050415
40 570.524414062 582.58815918
50 722.16116333 726.961212158
60 921.348901367 911.623071289
70 1211.68074951 1175.55042725
80 1700.91003418 1611.25981445
90 2771.39865723 2552.46484375
100 58473.7617188 75930.625
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net29
Model name for the evaluation phase:  net29
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m5.67970[0m     [32m1.26386[0m    4.49395      0.64981  40.37s
      2     [36m0.84311[0m     [32m1.16073[0m    0.72636      0.66071  42.89s
      3     [36m0.64996[0m     1.20402    0.53982      0.58897  44.61s
      4     [36m0.57889[0m     1.28902    0.44910      0.65514  44.05s
      5     [36m0.53940[0m     1.36855    0.39414      0.64920  44.07s
      6     [36m0.51695[0m     1.40722    0.36736      0.64194  44.17s
      7     [36m0.50597[0m     1.59505    0.31721      0.61157  43.63s
      8     [36m0.49630[0m     1.69355    0.29305      0.64155  43.86s
      9     [36m0.48660[0m     1.75054    0.27797      0.60500  44.20s
     10     [36m0.48470[0m     2.11041    0.22967      0.62312  43.92s
     11     [36m0.48042[0m     2.21216    0.21717      0.60004  44.17s
     12     [36m0.47169[0m     2.30609    0.20454      0.58020  44.25s
Early stopping.
Best valid loss was 1.160731 at epoch 2.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[  2.74416685e-01   5.78292787e-01   7.71701038e-01   4.09425382e-04
   9.98817980e-01   9.24001336e-01   7.14322209e-01   1.60413664e-02
   5.99019766e-01   7.40292490e-01   9.38555062e-01   7.78323831e-03
   6.69439793e-01   9.67747092e-01   1.17049918e-01   4.14272491e-03
   1.59362443e-02   7.39115775e-01   1.84510216e-01   3.23023275e-02
   1.05121143e-01   9.75078940e-01   8.42579544e-01   5.94138494e-03
   6.22013271e-01   9.87457335e-01   9.64064002e-01   1.17227817e-02
   2.29066843e-03   9.82496798e-01]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.814489424825
Error rate (%):  18.5510575175
[[40188  5982]
 [ 3710  2365]]
(52245,)
(52245,)
roc_auc: 0.640002370912
log_loss: nan
roc_auc for the hours: 0.639473684211
log_loss for the hours: 1.23749549855
saving predictions to csv file
hourspatient2_2_net29_10-23-23-32-19.csv
Accuracy validation for the hours:  0.837209302326
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [2]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.076670464
saving predictions to csv file
patient2_2_net29_10-23-23-43-28.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config6.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_3']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config6.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_3'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-23 23:43:30.240458
Hostname: kat
gpu2
Configuration 'config6.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net29
evaluation:
    online_training: False
    model: net29

end Configuration
['patient2_3']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [3]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.783634432
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 232.146871948 248.098060608
20 362.633648682 379.823339844
30 488.15196228 505.159686279
40 627.292626953 642.350366211
50 799.678375244 809.175415039
60 1039.14638672 1037.57441406
70 1420.94019775 1395.75299072
80 2108.71582031 2036.62312012
90 3569.3847168 3399.96303711
100 147926.25 114985.820312
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net29
Model name for the evaluation phase:  net29
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m6.91970[0m     [32m1.40780[0m    4.91526      0.60070  41.08s
      2     [36m0.97485[0m     [32m1.20001[0m    0.81236      0.64491  42.07s
      3     [36m0.70823[0m     [32m1.17099[0m    0.60481      0.63803  43.70s
      4     [36m0.60963[0m     [32m1.12388[0m    0.54243      0.62499  43.45s
      5     [36m0.56315[0m     1.16758    0.48232      0.62381  43.10s
      6     [36m0.53980[0m     1.25045    0.43169      0.59494  43.45s
      7     [36m0.52445[0m     1.19025    0.44062      0.58833  43.40s
      8     [36m0.51179[0m     1.22627    0.41735      0.60775  43.66s
      9     [36m0.49875[0m     [32m1.12315[0m    0.44407      0.57875  44.19s
     10     [36m0.49786[0m     1.35422    0.36763      0.62745  45.03s
     11     0.50285     1.20389    0.41769      0.62455  44.72s
     12     [36m0.48555[0m     1.41601    0.34290      0.61440  44.53s
     13     0.49617     1.41684    0.35020      0.62589  43.78s
     14     0.48718     1.45163    0.33561      0.62030  44.03s
     15     0.48741     1.42003    0.34324      0.61130  44.29s
     16     0.49955     1.48587    0.33620      0.60544  45.14s
     17     [36m0.44989[0m     1.53086    0.29388      0.62376  45.62s
     18     [36m0.43504[0m     1.47515    0.29491      0.59851  45.61s
     19     0.45128     1.63721    0.27564      0.61818  45.65s
Early stopping.
Best valid loss was 1.123150 at epoch 9.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[  2.32823137e-02   2.69191973e-02   1.71794444e-02   7.87574425e-02
   7.26559712e-03   2.16157772e-02   4.03933600e-03   1.89853534e-02
   1.27830368e-03   1.03475498e-02   2.17795055e-02   4.57422901e-03
   1.08147424e-03   4.22910461e-03   6.47841627e-03   3.11454502e-03
   2.32252612e-04   1.98191381e-03   5.25767868e-03   2.69099465e-03
   1.95587214e-04   1.05025084e-03   1.48973300e-03   8.02440289e-03
   5.23296883e-04   1.75350904e-03   8.20609927e-03   4.23073582e-03
   9.68739987e-05   6.64839405e-04]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.584496124031
Error rate (%):  41.5503875969
[[26679 19491]
 [ 2217  3858]]
(52245,)
(52245,)
roc_auc: 0.663706301011
log_loss: 2.02705002764
roc_auc for the hours: 0.657894736842
log_loss for the hours: 1.56365567157
saving predictions to csv file
hourspatient2_3_net29_10-24-00-10-13.csv
Accuracy validation for the hours:  0.558139534884
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [3]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.075474432
saving predictions to csv file
patient2_3_net29_10-24-00-14-01.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config6.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_4']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config6.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_4'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-24 00:14:02.752252
Hostname: kat
gpu2
Configuration 'config6.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net29
evaluation:
    online_training: False
    model: net29

end Configuration
['patient2_4']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [4]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.783818752
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 165.436743164 175.107310486
20 259.898529053 270.363952637
30 352.872415161 363.763861084
40 459.585931396 469.051629639
50 596.801239014 602.84375
60 794.120068359 791.004992676
70 1106.86796875 1082.3704834
80 1648.70195313 1577.21459961
90 2803.05773926 2610.05686035
100 44210.6640625 39898.75
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net29
Model name for the evaluation phase:  net29
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m4.79030[0m     [32m1.08925[0m    4.39781      0.71461  40.53s
      2     [36m0.76241[0m     [32m0.78713[0m    0.96859      0.75157  42.78s
      3     [36m0.59029[0m     [32m0.72096[0m    0.81875      0.76110  43.37s
      4     [36m0.54572[0m     [32m0.66551[0m    0.82001      0.72421  43.52s
      5     [36m0.52163[0m     [32m0.65633[0m    0.79477      0.68262  43.42s
      6     [36m0.50594[0m     [32m0.64097[0m    0.78934      0.69948  43.71s
      7     [36m0.49586[0m     [32m0.63719[0m    0.77821      0.64917  45.26s
      8     [36m0.48909[0m     0.63985    0.76438      0.63183  44.81s
      9     0.49426     0.65866    0.75041      0.59777  44.39s
     10     [36m0.47652[0m     [32m0.63070[0m    0.75554      0.60497  45.22s
     11     [36m0.47566[0m     [32m0.61062[0m    0.77897      0.62889  45.40s
     12     [36m0.46850[0m     0.63111    0.74234      0.61399  44.77s
     13     [36m0.46017[0m     0.63255    0.72748      0.62268  44.53s
     14     [36m0.44952[0m     0.64739    0.69435      0.62247  44.34s
     15     [36m0.44053[0m     0.62479    0.70507      0.64044  43.33s
     16     0.44349     0.68475    0.64766      0.62375  43.74s
     17     [36m0.42304[0m     0.66481    0.63633      0.64097  44.11s
     18     [36m0.40188[0m     0.68057    0.59051      0.64352  45.13s
     19     [36m0.38709[0m     0.73478    0.52681      0.64185  44.01s
     20     0.66495     0.77297    0.86025      0.65538  44.59s
     21     [36m0.36276[0m     0.78363    0.46292      0.64508  44.84s
Early stopping.
Best valid loss was 0.610623 at epoch 11.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[ 0.99999547  0.99999678  0.99999845  0.99999774  0.99999571  0.99999845
  0.99995828  0.99999893  0.99999285  0.99999464  0.99999559  0.99999177
  0.99997735  0.99999833  0.99993372  0.99999487  0.99997473  0.99999142
  0.99997675  0.99987018  0.99975854  0.99992347  0.99874359  0.99899358
  0.99820721  0.99772137  0.99945134  0.99965525  0.99685103  0.99986708]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.796612115992
Error rate (%):  20.3387884008
[[37774  8396]
 [ 2230  3845]]
(52245,)
(52245,)
roc_auc: 0.747119295215
log_loss: nan
roc_auc for the hours: 0.752631578947
log_loss for the hours: 0.875633105366
saving predictions to csv file
hourspatient2_4_net29_10-24-00-39-57.csv
Accuracy validation for the hours:  0.813953488372
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [4]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.076015104
saving predictions to csv file
patient2_4_net29_10-24-00-43-45.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config6.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_5']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config6.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_5'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-24 00:43:47.151197
Hostname: kat
gpu2
Configuration 'config6.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net29
evaluation:
    online_training: False
    model: net29

end Configuration
['patient2_5']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [5]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.783876096
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 185.196789551 197.613002014
20 294.801989746 307.815057373
30 407.290542603 420.04319458
40 542.552478027 552.726599121
50 726.239715576 729.61151123
60 1003.9644165 990.04107666
70 1455.43812256 1400.85588379
80 2251.58901367 2106.12675781
90 4066.22578125 3684.91796875
100 67580.4921875 68869.3984375
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net29
Model name for the evaluation phase:  net29
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m7.03583[0m     [32m2.07616[0m    3.38887      0.53456  40.31s
      2     [36m0.98585[0m     [32m1.12038[0m    0.87993      0.56500  43.08s
      3     [36m0.71362[0m     [32m0.99640[0m    0.71620      0.56443  43.96s
      4     [36m0.62943[0m     [32m0.87711[0m    0.71762      0.58647  43.37s
      5     [36m0.57796[0m     [32m0.82581[0m    0.69987      0.58522  43.25s
      6     [36m0.55808[0m     0.85695    0.65124      0.57366  43.70s
      7     [36m0.53708[0m     0.87966    0.61055      0.57190  43.72s
      8     [36m0.52339[0m     0.99209    0.52756      0.57809  43.95s
      9     [36m0.51880[0m     0.91485    0.56709      0.58950  44.08s
     10     [36m0.50088[0m     0.90373    0.55423      0.59445  43.94s
     11     0.51519     0.98462    0.52324      0.58091  44.21s
     12     [36m0.47452[0m     0.92078    0.51534      0.57237  44.08s
     13     [36m0.47066[0m     1.00577    0.46796      0.58281  43.56s
     14     [36m0.46346[0m     1.07479    0.43121      0.58256  43.75s
     15     [36m0.45777[0m     1.21732    0.37604      0.58445  44.04s
Early stopping.
Best valid loss was 0.825810 at epoch 5.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[  5.55353836e-07   6.99360072e-08   5.13356690e-06   1.11710256e-06
   2.28800133e-07   6.19165121e-07   5.92267497e-07   8.01774434e-08
   8.94228975e-08   1.63768618e-07   3.12968587e-06   1.29831290e-09
   2.81355916e-08   9.96958747e-08   6.23485903e-08   1.72691212e-08
   9.62064095e-10   3.11126840e-08   3.17243298e-08   1.37468570e-09
   2.81711232e-09   1.14890291e-07   7.32002320e-07   1.54099100e-09
   4.48075399e-09   2.19060858e-08   4.04487764e-07   3.70978448e-08
   1.04635287e-08   9.20528365e-08]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.871241267107
Error rate (%):  12.8758732893
[[44449  1721]
 [ 5006  1069]]
(52245,)
(52245,)
roc_auc: 0.613203833391
log_loss: 1.19978407947
roc_auc for the hours: 0.652631578947
log_loss for the hours: 0.773977527093
saving predictions to csv file
hourspatient2_5_net29_10-24-01-05-21.csv
Accuracy validation for the hours:  0.883720930233
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [5]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.07579392
saving predictions to csv file
patient2_5_net29_10-24-01-09-16.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config6.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_6']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config6.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_6'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-24 01:09:18.016257
Hostname: kat
gpu2
Configuration 'config6.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net29
evaluation:
    online_training: False
    model: net29

end Configuration
['patient2_6']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [6]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.784912384
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 163.101298523 175.881399536
20 258.470428467 274.155731201
30 355.682626343 373.270678711
40 471.085089111 488.984100342
50 626.310150146 642.409729004
60 861.122949219 869.392102051
70 1253.91723633 1241.61234131
80 1956.83286133 1902.809375
90 3422.80100098 3262.08793945
100 47858.3515625 52179.953125
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net29
Model name for the evaluation phase:  net29
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m5.93958[0m     [32m1.49736[0m    3.96670      0.54643  41.84s
      2     [36m0.89978[0m     [32m0.98539[0m    0.91313      0.55416  44.51s
      3     [36m0.66524[0m     [32m0.84597[0m    0.78637      0.62488  45.10s
      4     [36m0.60214[0m     0.85460    0.70459      0.65369  43.93s
      5     [36m0.56287[0m     [32m0.83252[0m    0.67609      0.72648  43.40s
      6     [36m0.53997[0m     [32m0.81099[0m    0.66581      0.72386  43.31s
      7     [36m0.52631[0m     [32m0.79265[0m    0.66399      0.75000  44.13s
      8     [36m0.52125[0m     [32m0.79242[0m    0.65779      0.75876  43.72s
      9     [36m0.51091[0m     0.80271    0.63648      0.73532  43.22s
     10     [36m0.49869[0m     0.89035    0.56011      0.75057  43.42s
     11     [36m0.48740[0m     0.81687    0.59666      0.70024  43.04s
     12     [36m0.48054[0m     0.90911    0.52858      0.65252  43.13s
     13     [36m0.46951[0m     0.90988    0.51601      0.66028  43.11s
     14     [36m0.46882[0m     0.90124    0.52020      0.66166  43.64s
     15     [36m0.46061[0m     0.94213    0.48890      0.71094  43.50s
     16     [36m0.44170[0m     1.00323    0.44028      0.68942  44.28s
     17     [36m0.42663[0m     1.13643    0.37541      0.68518  44.24s
     18     [36m0.40222[0m     1.09088    0.36871      0.68978  43.86s
Early stopping.
Best valid loss was 0.792415 at epoch 8.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[ 0.11602173  0.07602683  0.11687953  0.58817232  0.24054663  0.32958722
  0.02486758  0.35589468  0.1799169   0.05380362  0.0715945   0.05445546
  0.04327237  0.06393426  0.00380523  0.19469357  0.01340019  0.05032826
  0.00981019  0.14656375  0.00807463  0.10387301  0.04134252  0.12393233
  0.04292344  0.08603778  0.2176037   0.65266442  0.10522562  0.29822826]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.897865824481
Error rate (%):  10.2134175519
[[45108  1062]
 [ 4274  1801]]
(52245,)
(52245,)
roc_auc: 0.775319952831
log_loss: 0.916053894152
roc_auc for the hours: 0.810526315789
log_loss for the hours: 0.407940556685
saving predictions to csv file
hourspatient2_6_net29_10-24-01-34-39.csv
Accuracy validation for the hours:  0.93023255814
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [6]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.07708416
saving predictions to csv file
patient2_6_net29_10-24-01-38-12.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config6.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_7']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config6.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_7'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-24 01:38:13.463183
Hostname: kat
gpu2
Configuration 'config6.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net29
evaluation:
    online_training: False
    model: net29

end Configuration
['patient2_7']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [7]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.784912384
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 177.49072113 198.887155151
20 286.226177979 314.740679932
30 400.515246582 436.170880127
40 540.098596191 582.037194824
50 725.995513916 773.688720703
60 988.882971191 1040.23283691
70 1379.6152832 1428.96156006
80 1995.99584961 2035.20236816
90 3121.08054199 3130.02658691
100 70629.9609375 92128.8515625
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net29
Model name for the evaluation phase:  net29
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m5.65228[0m     [32m2.23192[0m    2.53247      0.49959  41.96s
      2     [36m0.84943[0m     [32m1.48994[0m    0.57011      0.49881  44.38s
      3     [36m0.65339[0m     [32m1.41061[0m    0.46320      0.49964  44.41s
      4     [36m0.57960[0m     [32m1.33436[0m    0.43436      0.50098  43.32s
      5     [36m0.54028[0m     [32m1.30245[0m    0.41482      0.51816  43.64s
      6     [36m0.51660[0m     1.36255    0.37914      0.52603  43.69s
      7     [36m0.49982[0m     1.40963    0.35458      0.52820  42.97s
      8     0.49995     1.32450    0.37746      0.57767  43.03s
      9     [36m0.48570[0m     [32m1.20619[0m    0.40267      0.62360  43.17s
     10     [36m0.46852[0m     [32m1.13598[0m    0.41244      0.64962  43.38s
     11     0.48584     1.21725    0.39913      0.61410  43.39s
     12     0.48447     1.26234    0.38379      0.64304  43.36s
     13     [36m0.45278[0m     1.21581    0.37241      0.63231  43.90s
     14     [36m0.44941[0m     1.29369    0.34739      0.61760  43.44s
     15     [36m0.44512[0m     1.24137    0.35857      0.63318  43.16s
     16     [36m0.44010[0m     1.33770    0.32900      0.61516  42.91s
     17     0.44012     1.45918    0.30162      0.63397  43.13s
     18     0.46184     1.25155    0.36902      0.63555  43.66s
     19     [36m0.40273[0m     1.39399    0.28890      0.63782  43.18s
     20     [36m0.39120[0m     1.43880    0.27189      0.61168  43.80s
Early stopping.
Best valid loss was 1.135977 at epoch 10.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[ 0.97979271  0.87842792  0.88192075  0.92081052  0.87597406  0.49074849
  0.8709166   0.96325451  0.95482486  0.56993771  0.90528405  0.91058886
  0.95741379  0.52450508  0.80419695  0.86991721  0.90988201  0.5421409
  0.81971979  0.97030681  0.98157805  0.79696864  0.94427609  0.88958806
  0.93980426  0.25391304  0.86844635  0.9595263   0.9476915   0.25728148]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.819178868791
Error rate (%):  18.0821131209
[[40472  5698]
 [ 3749  2326]]
(52245,)
(52245,)
roc_auc: 0.67317011474
log_loss: 1.46596882716
roc_auc for the hours: 0.657894736842
log_loss for the hours: 1.15552809212
saving predictions to csv file
hourspatient2_7_net29_10-24-02-04-30.csv
Accuracy validation for the hours:  0.860465116279
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [7]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.07671552
saving predictions to csv file
patient2_7_net29_10-24-02-08-10.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config6.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_8']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config6.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_8'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-24 02:08:11.391181
Hostname: kat
gpu2
Configuration 'config6.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net29
evaluation:
    online_training: False
    model: net29

end Configuration
['patient2_8']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [8]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.784900096
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 304.582891846 331.561761475
20 484.435198975 519.064501953
30 665.606323242 707.089782715
40 874.991894531 920.50123291
50 1137.25024414 1183.24688721
60 1487.04992676 1528.72434082
70 1983.92612305 2011.19562988
80 2754.95263672 2754.76303711
90 4202.81694336 4159.4034668
100 105201.65625 53464.578125
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net29
Model name for the evaluation phase:  net29
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m8.87915[0m     [32m4.70126[0m    1.88868      0.49959  44.76s
      2     [36m1.00537[0m     [32m2.98360[0m    0.33696      0.49881  43.75s
      3     [36m0.69742[0m     [32m2.12791[0m    0.32775      0.49964  43.75s
      4     [36m0.59808[0m     [32m1.76041[0m    0.33974      0.49964  43.82s
      5     [36m0.54227[0m     [32m1.71190[0m    0.31677      0.50052  43.37s
      6     [36m0.50850[0m     [32m1.56484[0m    0.32496      0.49742  43.47s
      7     [36m0.48535[0m     [32m1.53634[0m    0.31591      0.51674  43.02s
      8     [36m0.47640[0m     [32m1.53498[0m    0.31036      0.51463  43.17s
      9     0.47723     [32m1.38894[0m    0.34359      0.61761  43.10s
     10     [36m0.46074[0m     [32m1.31079[0m    0.35150      0.61817  43.04s
     11     [36m0.45914[0m     1.41119    0.32536      0.60986  43.11s
     12     [36m0.44443[0m     1.57133    0.28284      0.62996  43.38s
     13     0.46573     1.32739    0.35086      0.60435  43.06s
     14     0.44705     1.43923    0.31062      0.61470  42.96s
     15     0.45446     1.44550    0.31439      0.62737  42.89s
     16     [36m0.43793[0m     1.35812    0.32245      0.64443  43.01s
     17     [36m0.42365[0m     1.44977    0.29222      0.61995  42.93s
     18     0.43088     1.32162    0.32602      0.62779  42.92s
     19     0.52664     1.61052    0.32700      0.62634  43.18s
     20     [36m0.39556[0m     1.66154    0.23807      0.62421  43.52s
Early stopping.
Best valid loss was 1.310788 at epoch 10.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[  6.07013390e-05   2.29995749e-05   1.08200904e-04   3.72240029e-04
   2.01109608e-04   4.75501292e-04   4.48076578e-04   3.32552241e-04
   3.35098273e-04   2.22198680e-04   7.82906311e-04   3.87033127e-04
   3.13893426e-04   3.12406657e-04   5.44306647e-04   5.94660174e-04
   1.29438515e-04   2.79773172e-04   4.59707808e-04   2.50438781e-04
   2.07269928e-04   8.85694972e-05   3.65122287e-05   5.94665180e-05
   3.73589486e-04   2.69759854e-04   4.36957227e-03   2.51363358e-03
   2.05972043e-04   1.62301716e-04]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.882840463202
Error rate (%):  11.7159536798
[[45819   351]
 [ 5770   305]]
(52245,)
(52245,)
roc_auc: 0.650415758188
log_loss: 1.80703963548
roc_auc for the hours: 0.676315789474
log_loss for the hours: 1.40609348885
saving predictions to csv file
hourspatient2_8_net29_10-24-02-39-31.csv
Accuracy validation for the hours:  0.883720930233
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [8]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.076723712
saving predictions to csv file
patient2_8_net29_10-24-02-43-17.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config6.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_9']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config6.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_9'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-24 02:43:19.175222
Hostname: kat
gpu2
Configuration 'config6.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net29
evaluation:
    online_training: False
    model: net29

end Configuration
['patient2_9']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [9]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.78497792
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 283.37227478 306.047775269
20 448.091705322 476.795318604
30 612.117547607 646.27376709
40 800.063977051 838.327783203
50 1035.82800293 1076.41149902
60 1355.32043457 1393.14555664
70 1821.88786621 1848.28326416
80 2583.80039063 2579.61362305
90 4184.19125977 4103.89086914
100 81443.234375 46753.0546875
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net29
Model name for the evaluation phase:  net29
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m8.44147[0m     [32m2.55732[0m    3.30090      0.55861  44.14s
      2     [36m1.02639[0m     [32m1.26385[0m    0.81212      0.64109  43.42s
      3     [36m0.72544[0m     [32m1.18755[0m    0.61087      0.61505  43.32s
      4     [36m0.62579[0m     [32m0.95980[0m    0.65200      0.66577  43.32s
      5     [36m0.56886[0m     0.98625    0.57679      0.66426  43.36s
      6     [36m0.54581[0m     [32m0.90949[0m    0.60013      0.66374  43.26s
      7     [36m0.52707[0m     [32m0.89294[0m    0.59026      0.63791  43.21s
      8     [36m0.51448[0m     [32m0.87352[0m    0.58897      0.63432  43.32s
      9     0.52757     [32m0.82207[0m    0.64176      0.62226  43.30s
     10     [36m0.49559[0m     0.83820    0.59126      0.64766  43.36s
     11     0.49786     [32m0.73494[0m    0.67742      0.53955  43.62s
     12     [36m0.49157[0m     0.76681    0.64106      0.53786  44.00s
     13     0.49185     0.80173    0.61349      0.60528  44.53s
     14     [36m0.48697[0m     0.74536    0.65333      0.58775  44.77s
     15     [36m0.48637[0m     0.78128    0.62254      0.55625  44.36s
     16     [36m0.46828[0m     1.15001    0.40719      0.65622  44.03s
     17     [36m0.45364[0m     0.96363    0.47075      0.53421  43.77s
     18     [36m0.43885[0m     1.14744    0.38246      0.58413  44.31s
     19     0.44245     0.97747    0.45265      0.52326  43.82s
     20     [36m0.40475[0m     1.22597    0.33015      0.61468  44.77s
     21     0.47515     1.07208    0.44320      0.59380  45.68s
Early stopping.
Best valid loss was 0.734942 at epoch 11.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[  9.41303006e-06   9.22758886e-07   4.57369168e-07   1.79830386e-05
   1.29497437e-06   5.31176829e-06   4.76623910e-07   2.01663734e-05
   4.65162248e-06   1.16628496e-06   2.98143573e-06   1.01964015e-05
   3.80289566e-06   7.77323567e-06   8.93471793e-07   8.82321910e-06
   2.94989513e-06   1.03418888e-05   2.11388215e-06   2.09790542e-05
   6.65485800e-07   2.57588135e-06   3.03643247e-07   2.88114961e-07
   2.19943990e-06   5.22820358e-07   2.48468746e-06   2.08754977e-06
   2.99391559e-06   2.38112943e-06]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.676504928701
Error rate (%):  32.3495071299
[[32402 13768]
 [ 3133  2942]]
(52245,)
(52245,)
roc_auc: 0.611354042272
log_loss: 1.46260512836
roc_auc for the hours: 0.610526315789
log_loss for the hours: 0.689784205785
saving predictions to csv file
hourspatient2_9_net29_10-24-03-17-55.csv
Accuracy validation for the hours:  0.767441860465
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [9]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.07718656
saving predictions to csv file
patient2_9_net29_10-24-03-21-46.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config6.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_10']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config6.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_10'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-24 03:21:47.380502
Hostname: kat
gpu2
Configuration 'config6.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net29
evaluation:
    online_training: False
    model: net29

end Configuration
['patient2_10']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [10]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.784306176
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 235.353125 259.209658813
20 373.425970459 404.270147705
30 511.624740601 548.895672607
40 670.266955566 710.672009277
50 867.946899414 908.465515137
60 1130.38996582 1165.67106934
70 1502.52767334 1525.50710449
80 2081.78022461 2081.2378418
90 3192.88137207 3135.13125
100 33467.8828125 31567.0722656
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net29
Model name for the evaluation phase:  net29
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m6.86217[0m     [32m1.43435[0m    4.78415      0.54591  43.99s
      2     [36m0.90424[0m     [32m0.92684[0m    0.97561      0.61559  43.94s
      3     [36m0.68997[0m     [32m0.87596[0m    0.78767      0.61277  43.85s
      4     [36m0.61400[0m     [32m0.80006[0m    0.76744      0.68663  43.48s
      5     [36m0.57582[0m     [32m0.79656[0m    0.72289      0.62619  43.73s
      6     [36m0.55472[0m     0.81286    0.68243      0.59432  43.41s
      7     [36m0.53946[0m     0.87432    0.61701      0.58471  43.70s
      8     0.54555     0.88806    0.61431      0.58057  43.44s
      9     [36m0.52363[0m     1.01798    0.51439      0.49649  44.12s
     10     0.53507     0.95004    0.56321      0.54248  43.64s
     11     0.52450     0.97207    0.53957      0.55785  44.00s
     12     [36m0.52277[0m     0.96209    0.54337      0.56485  45.33s
     13     [36m0.52246[0m     1.01586    0.51430      0.61046  45.09s
     14     [36m0.50615[0m     1.01913    0.49665      0.60641  45.25s
     15     [36m0.49717[0m     1.11018    0.44783      0.55448  45.48s
Early stopping.
Best valid loss was 0.796555 at epoch 5.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[ 0.96299034  0.95708829  0.96190822  0.97769976  0.96206021  0.98885381
  0.93970925  0.98488474  0.96734625  0.9838891   0.99024969  0.98214918
  0.95099932  0.99124885  0.90506583  0.98018473  0.94699484  0.99457753
  0.91378915  0.99140716  0.92702723  0.97144395  0.97796965  0.97995329
  0.9262774   0.99112892  0.98833138  0.9942615   0.83355707  0.97429442]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.731438415159
Error rate (%):  26.8561584841
[[34723 11447]
 [ 2584  3491]]
(52245,)
(52245,)
roc_auc: 0.682660832083
log_loss: 1.11672259471
roc_auc for the hours: 0.726315789474
log_loss for the hours: 0.708446139245
saving predictions to csv file
hourspatient2_10_net29_10-24-03-43-17.csv
Accuracy validation for the hours:  0.767441860465
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [10]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.076424704
saving predictions to csv file
patient2_10_net29_10-24-03-46-53.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config6.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_11']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config6.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_11'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-24 03:46:54.776247
Hostname: kat
gpu2
Configuration 'config6.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net29
evaluation:
    online_training: False
    model: net29

end Configuration
['patient2_11']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [11]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.784437248
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 185.314794922 208.111297607
20 299.770111084 330.638024902
30 420.835580444 458.932080078
40 567.582995605 611.673339844
50 760.888244629 809.9090271
60 1030.30930176 1080.86318359
70 1423.52952881 1473.30863037
80 2039.71828613 2086.87138672
90 3209.50048828 3264.72282715
100 47304.0664062 104914.585938
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net29
Model name for the evaluation phase:  net29
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m6.75483[0m     [32m2.58796[0m    2.61010      0.49690  44.30s
      2     [36m0.90307[0m     [32m1.52496[0m    0.59219      0.49871  43.50s
      3     [36m0.65794[0m     [32m1.31937[0m    0.49867      0.49964  43.48s
      4     [36m0.57920[0m     [32m1.28166[0m    0.45192      0.50191  43.48s
      5     [36m0.53335[0m     1.36010    0.39214      0.51300  43.28s
      6     [36m0.50079[0m     1.43588    0.34877      0.51188  43.56s
      7     [36m0.47659[0m     1.59427    0.29894      0.51860  43.91s
      8     [36m0.47333[0m     1.78217    0.26559      0.50005  43.55s
      9     [36m0.46691[0m     1.31159    0.35599      0.71817  43.72s
     10     0.46924     1.60032    0.29322      0.58352  43.99s
     11     [36m0.44360[0m     1.43548    0.30903      0.61669  43.35s
     12     0.44666     1.68775    0.26465      0.56804  43.73s
     13     [36m0.43686[0m     1.69904    0.25712      0.63045  43.65s
     14     [36m0.43327[0m     1.80402    0.24017      0.68156  43.98s
Early stopping.
Best valid loss was 1.281655 at epoch 4.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[  1.88254617e-05   4.69622355e-05   6.01829415e-05   9.42303541e-06
   4.31352737e-06   1.94110587e-04   3.69567488e-06   6.49375070e-05
   2.26359862e-06   7.65727134e-04   4.20360666e-05   2.22520357e-05
   9.09331732e-07   8.70851945e-05   6.15243607e-06   4.63085416e-05
   4.29008560e-06   1.35314316e-04   1.03645098e-05   3.05148278e-05
   2.87004641e-05   1.16998626e-05   2.98993036e-05   5.12610713e-05
   1.46655693e-05   2.99265739e-05   5.97559774e-05   8.09817648e-05
   8.07265224e-06   1.27328358e-05]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.883778351995
Error rate (%):  11.6221648005
[[46170     0]
 [ 6072     3]]
(52245,)
(52245,)
roc_auc: 0.696406233538
log_loss: 1.59139925901
roc_auc for the hours: 0.710526315789
log_loss for the hours: 1.31033556685
saving predictions to csv file
hourspatient2_11_net29_10-24-04-09-56.csv
Accuracy validation for the hours:  0.883720930233
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [11]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.07579392
saving predictions to csv file
patient2_11_net29_10-24-04-13-36.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config6.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_12']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config6.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_12'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-24 04:13:37.943189
Hostname: kat
gpu2
Configuration 'config6.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net29
evaluation:
    online_training: False
    model: net29

end Configuration
['patient2_12']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [12]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.784183296
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 246.400856018 260.383670044
20 388.318774414 405.029217529
30 528.878991699 548.355413818
40 689.669812012 711.362548828
50 892.074920654 915.121887207
60 1170.23933105 1190.96369629
70 1584.49351807 1593.89857178
80 2252.05878906 2238.45820313
90 3510.49829102 3446.85510254
100 68512.453125 43195.7773438
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net29
Model name for the evaluation phase:  net29
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m7.35086[0m     [32m2.26673[0m    3.24294      0.51279  44.98s
      2     [36m0.92517[0m     [32m1.45284[0m    0.63680      0.53227  44.53s
      3     [36m0.68917[0m     [32m1.16978[0m    0.58914      0.53173  44.72s
      4     [36m0.60924[0m     [32m0.94370[0m    0.64558      0.57852  43.57s
      5     [36m0.55790[0m     [32m0.91286[0m    0.61116      0.63351  43.43s
      6     [36m0.53044[0m     0.92728    0.57203      0.67056  43.55s
      7     [36m0.51519[0m     [32m0.85134[0m    0.60516      0.63079  43.17s
      8     [36m0.50718[0m     0.89355    0.56760      0.58935  42.93s
      9     [36m0.49162[0m     0.91630    0.53653      0.59074  43.02s
     10     0.50237     0.88711    0.56630      0.62590  43.26s
     11     [36m0.47344[0m     1.09345    0.43297      0.56995  43.01s
     12     [36m0.46868[0m     1.00642    0.46569      0.57505  43.28s
     13     0.47766     1.07248    0.44538      0.59700  42.98s
     14     [36m0.46398[0m     1.22441    0.37894      0.64269  43.01s
     15     0.47223     1.18082    0.39992      0.60674  42.94s
     16     [36m0.43067[0m     1.24230    0.34668      0.62416  43.00s
     17     [36m0.42466[0m     1.16820    0.36352      0.63613  43.03s
Early stopping.
Best valid loss was 0.851342 at epoch 7.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[ 0.0047849   0.02014448  0.00694022  0.14008181  0.01481425  0.01214296
  0.00325698  0.03877702  0.0188178   0.01811315  0.00254234  0.01798872
  0.0165421   0.08165281  0.00622277  0.02402068  0.0048522   0.0043614
  0.00333291  0.03483121  0.03338668  0.0209524   0.00155638  0.06088408
  0.01773996  0.01545693  0.02158668  0.24040824  0.01388864  0.01769636]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.902708393148
Error rate (%):  9.72916068523
[[45976   194]
 [ 4889  1186]]
(52245,)
(52245,)
roc_auc: 0.662344825127
log_loss: 1.12998943275
roc_auc for the hours: 0.663157894737
log_loss for the hours: 0.808583053351
saving predictions to csv file
hourspatient2_12_net29_10-24-04-38-51.csv
Accuracy validation for the hours:  0.906976744186
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [12]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.075965952
saving predictions to csv file
patient2_12_net29_10-24-04-42-28.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config6.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_13']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config6.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_13'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-24 04:42:30.585202
Hostname: kat
gpu2
Configuration 'config6.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net29
evaluation:
    online_training: False
    model: net29

end Configuration
['patient2_13']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [13]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.78342144
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 310.902963257 337.861572266
20 495.955010986 532.738879395
30 683.185546875 729.780834961
40 898.82401123 954.485388184
50 1167.24829102 1228.47143555
60 1520.5864502 1581.93601074
70 2018.97246094 2072.08920898
80 2789.6487793 2824.08540039
90 4233.0871582 4224.4074707
100 35079.8945312 31263.9492188
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net29
Model name for the evaluation phase:  net29
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m8.82111[0m     [32m3.05224[0m    2.89005      0.49226  44.94s
      2     [36m1.01881[0m     [32m1.35188[0m    0.75362      0.49757  44.28s
      3     [36m0.70494[0m     [32m1.22986[0m    0.57319      0.48939  44.59s
      4     [36m0.61615[0m     [32m0.97506[0m    0.63192      0.51688  45.24s
      5     [36m0.55335[0m     [32m0.96835[0m    0.57144      0.55056  44.63s
      6     [36m0.52786[0m     [32m0.92242[0m    0.57225      0.56890  43.55s
      7     [36m0.51550[0m     [32m0.88813[0m    0.58043      0.63492  43.59s
      8     [36m0.50603[0m     0.92934    0.54450      0.63307  43.25s
      9     [36m0.49722[0m     [32m0.81571[0m    0.60956      0.65678  43.62s
     10     [36m0.49346[0m     0.86088    0.57321      0.67694  43.23s
     11     0.52157     0.86041    0.60619      0.67077  43.20s
     12     [36m0.48012[0m     0.86702    0.55376      0.64922  43.54s
     13     [36m0.47461[0m     0.90004    0.52732      0.65396  43.29s
     14     0.48507     0.87744    0.55282      0.67461  43.29s
     15     [36m0.47031[0m     0.97186    0.48392      0.65785  43.83s
     16     0.48385     1.00919    0.47944      0.59748  44.17s
     17     [36m0.45740[0m     0.97225    0.47046      0.63160  43.56s
     18     [36m0.45044[0m     1.04448    0.43126      0.63783  43.32s
     19     [36m0.44445[0m     1.09165    0.40714      0.61528  43.61s
Early stopping.
Best valid loss was 0.815706 at epoch 9.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[ 0.97866702  0.9881373   0.9838568   0.98115987  0.95847023  0.9779247
  0.94966924  0.95537043  0.93544918  0.97082001  0.9531557   0.97466099
  0.96617818  0.9884454   0.91618317  0.94821447  0.80380201  0.98095965
  0.90902728  0.9648515   0.96429694  0.99306035  0.81741452  0.9288013
  0.88554233  0.93898571  0.96654397  0.97286946  0.92909086  0.97552341]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.720260311992
Error rate (%):  27.9739688008
[[34321 11849]
 [ 2766  3309]]
(52245,)
(52245,)
roc_auc: 0.627149056404
log_loss: 1.92663902688
roc_auc for the hours: 0.694736842105
log_loss for the hours: 1.01400957059
saving predictions to csv file
hourspatient2_13_net29_10-24-05-08-18.csv
Accuracy validation for the hours:  0.767441860465
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [13]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.075380224
saving predictions to csv file
patient2_13_net29_10-24-05-11-43.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config6.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_14']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config6.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_14'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-24 05:11:44.720944
Hostname: kat
gpu2
Configuration 'config6.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net29
evaluation:
    online_training: False
    model: net29

end Configuration
['patient2_14']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [14]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.78452736
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 266.172717285 282.912625122
20 417.956640625 438.4277771
30 566.452648926 591.266082764
40 733.547790527 761.89486084
50 939.345672607 969.588409424
60 1211.49157715 1239.79914551
70 1602.63823242 1619.38890381
80 2236.86499023 2222.94345703
90 3516.40424805 3422.74516602
100 38412.0351562 39300.5585938
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net29
Model name for the evaluation phase:  net29
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m6.55782[0m     [32m2.28908[0m    2.86483      0.59224  43.40s
      2     [36m0.93312[0m     [32m1.58239[0m    0.58969      0.56830  43.27s
      3     [36m0.68509[0m     [32m1.40381[0m    0.48802      0.55232  43.38s
      4     [36m0.61271[0m     [32m1.20143[0m    0.50998      0.62375  43.41s
      5     [36m0.56834[0m     1.29915    0.43747      0.63846  43.36s
      6     [36m0.54562[0m     1.33231    0.40953      0.64618  43.31s
      7     [36m0.53574[0m     1.32364    0.40475      0.61560  43.33s
      8     0.54472     1.23484    0.44113      0.52589  43.42s
      9     [36m0.51305[0m     1.25284    0.40951      0.52139  44.04s
     10     0.52477     1.25697    0.41749      0.59548  43.83s
     11     [36m0.50737[0m     1.31989    0.38441      0.57998  43.77s
     12     0.51047     [32m1.16965[0m    0.43643      0.46698  44.02s
     13     0.50979     [32m1.16228[0m    0.43861      0.47271  43.84s
     14     [36m0.49361[0m     [32m1.16172[0m    0.42490      0.47041  43.74s
     15     0.50070     1.27790    0.39181      0.47714  43.69s
     16     [36m0.49033[0m     1.20743    0.40609      0.50522  44.23s
     17     [36m0.46913[0m     1.42322    0.32962      0.54915  44.87s
     18     [36m0.45341[0m     1.42335    0.31855      0.56209  45.37s
     19     0.45492     1.29246    0.35198      0.51727  44.20s
     20     [36m0.42715[0m     1.36610    0.31268      0.52729  44.05s
     21     0.44740     1.52884    0.29264      0.53470  43.73s
     22     [36m0.38278[0m     1.67394    0.22867      0.53833  43.88s
     23     [36m0.35863[0m     1.54422    0.23224      0.51520  43.74s
     24     0.37764     1.81737    0.20779      0.56183  44.23s
Early stopping.
Best valid loss was 1.161719 at epoch 14.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[  3.74456472e-03   1.00954319e-03   3.03679565e-03   7.66424288e-04
   7.37607363e-04   7.50798150e-04   1.32230425e-03   2.50705372e-04
   4.30107408e-04   1.97869274e-04   6.73140457e-04   2.04983837e-04
   3.48171481e-04   2.75324535e-04   3.82193335e-04   6.45950349e-05
   1.14463284e-04   7.51282496e-05   5.07368299e-04   7.98665278e-05
   1.51689688e-04   1.22825484e-04   1.56213064e-04   4.41538541e-05
   2.76207895e-04   7.71853884e-05   6.17107085e-04   1.32043482e-04
   1.31780354e-04   1.24810846e-04]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.61942769643
Error rate (%):  38.057230357
[[29896 16274]
 [ 3609  2466]]
(52245,)
(52245,)
roc_auc: 0.518095697507
log_loss: 3.00914972944
roc_auc for the hours: 0.471052631579
log_loss for the hours: 1.60317039332
saving predictions to csv file
hourspatient2_14_net29_10-24-05-47-15.csv
Accuracy validation for the hours:  0.674418604651
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [14]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.076363264
saving predictions to csv file
patient2_14_net29_10-24-05-50-40.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config6.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_15']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config6.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_15'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-24 05:50:41.232165
Hostname: kat
gpu2
Configuration 'config6.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net29
evaluation:
    online_training: False
    model: net29

end Configuration
['patient2_15']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [15]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.784535552
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 207.538546753 227.35309906
20 331.033721924 357.463000488
30 457.867379761 491.204870605
40 608.373034668 648.207519531
50 801.816497803 847.310424805
60 1065.05288086 1112.36008301
70 1442.92700195 1484.37923584
80 2028.23110352 2052.16914063
90 3108.79804688 3089.25849609
100 28167.1855469 26524.03125
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net29
Model name for the evaluation phase:  net29
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m6.58348[0m     [32m1.61256[0m    4.08263      0.55087  40.06s
      2     [36m0.84925[0m     [32m1.12967[0m    0.75177      0.56613  41.56s
      3     [36m0.64839[0m     [32m0.97505[0m    0.66498      0.57975  44.51s
      4     [36m0.58669[0m     [32m0.81290[0m    0.72172      0.67682  43.74s
      5     [36m0.54538[0m     0.85977    0.63433      0.64146  43.44s
      6     [36m0.52438[0m     0.84894    0.61768      0.68130  43.48s
      7     [36m0.51084[0m     [32m0.78758[0m    0.64862      0.71684  43.27s
      8     [36m0.49815[0m     [32m0.78174[0m    0.63723      0.71556  43.58s
      9     0.50182     [32m0.75366[0m    0.66583      0.66980  43.80s
     10     [36m0.49057[0m     0.75919    0.64618      0.67952  43.71s
     11     [36m0.48599[0m     0.81077    0.59942      0.63582  43.39s
     12     [36m0.47921[0m     0.77381    0.61929      0.64500  43.37s
     13     [36m0.47244[0m     0.84057    0.56205      0.60383  43.28s
     14     [36m0.47037[0m     0.94822    0.49606      0.55022  43.29s
     15     [36m0.46503[0m     0.85719    0.54250      0.65931  43.23s
     16     [36m0.45535[0m     0.85741    0.53108      0.63771  43.33s
     17     [36m0.44306[0m     0.90514    0.48949      0.66777  43.47s
     18     [36m0.42735[0m     0.94475    0.45234      0.62966  43.43s
     19     0.42914     0.98128    0.43733      0.62562  43.39s
Early stopping.
Best valid loss was 0.753665 at epoch 9.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[ 0.99977106  0.99580282  0.99862039  0.99913448  0.99988961  0.99965835
  0.99933249  0.99906057  0.9999218   0.99955684  0.99987531  0.99915433
  0.99980265  0.99978846  0.99914503  0.99854589  0.99985695  0.99937207
  0.99909794  0.99785966  0.99985671  0.99949968  0.99944979  0.99753416
  0.99996722  0.99980563  0.99943978  0.99621898  0.99965787  0.99443299]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.789740645038
Error rate (%):  21.0259354962
[[37692  8478]
 [ 2507  3568]]
(52245,)
(52245,)
roc_auc: 0.7106253504
log_loss: 1.17644967531
roc_auc for the hours: 0.742105263158
log_loss for the hours: 0.59396018579
saving predictions to csv file
hourspatient2_15_net29_10-24-06-14-55.csv
Accuracy validation for the hours:  0.813953488372
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [15]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.076441088
saving predictions to csv file
patient2_15_net29_10-24-06-18-15.csv
