['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config5.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_0']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config5.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_0'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-11 01:39:31.567367
Hostname: kat
gpu2
Configuration 'config5.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net13
evaluation:
    online_training: False
    model: net13

end Configuration
['patient2_0']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [0]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.749789184
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 367.479559326 395.117904663
20 582.979382324 615.201062012
30 795.170080566 830.338665771
40 1032.00554199 1067.2041748
50 1317.6385498 1346.52661133
60 1685.20253906 1697.71447754
70 2197.84929199 2175.63908691
80 3011.64487305 2914.53989258
90 4710.7300293 4431.95449219
100 63321.7421875 58944.8007812
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net13
Model name for the evaluation phase:  net13
Training model...
# Neural Network with 95970 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x131x66
  2          32x133x5
  3          32x133x5
  4          32x67x3
  5          32x67x3
  6          32x67x3
  7          32x34x2
  8          2x34x2
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m0.77744[0m     [32m0.87549[0m    0.88800      0.57530  14.53s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.43058[0m     1.39216    0.30929      0.55839  14.75s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.14985[0m     3.92080    0.03822      0.51826  15.25s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.06126[0m     3.92513    0.01561      0.52594  14.89s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.04478[0m     4.69047    0.00955      0.50614  14.68s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.02674[0m     4.36297    0.00613      0.53652  14.68s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     0.03449     5.26758    0.00655      0.51910  14.71s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.02225[0m     6.15576    0.00361      0.51313  14.72s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.02179[0m     5.18477    0.00420      0.52553  14.79s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     10     0.02721     5.58622    0.00487      0.50851  15.72s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.01919[0m     5.88968    0.00326      0.57692  16.42s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.875490 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x64x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x1x64).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.853172552397
Error rate (%):  14.6827447603
[[43460  2710]
 [ 4961  1114]]
(52245,)
(52245,)
roc_auc: 0.643636220053
log_loss: nan
roc_auc for the hours: 0.742105263158
log_loss for the hours: 0.614964630718
saving predictions to csv file
hourspatient2_0_net13_10-11-01-45-05.csv
Accuracy validation for the hours:  0.883720930233
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [0]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.04083456
saving predictions to csv file
patient2_0_net13_10-11-01-48-41.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config5.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_1']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config5.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_1'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-11 01:48:42.169050
Hostname: kat
gpu2
Configuration 'config5.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net13
evaluation:
    online_training: False
    model: net13

end Configuration
['patient2_1']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [1]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.749867008
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 263.661355591 284.954690552
20 416.892218018 440.678961182
30 568.269549561 590.942108154
40 738.6140625 756.022766113
50 948.0390625 954.364257812
60 1230.36213379 1214.27253418
70 1653.89840088 1589.50096436
80 2395.20083008 2220.65932617
90 4170.49838867 3672.37075195
100 56617.8046875 55581.1640625
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net13
Model name for the evaluation phase:  net13
Training model...
# Neural Network with 95970 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x131x66
  2          32x133x5
  3          32x133x5
  4          32x67x3
  5          32x67x3
  6          32x67x3
  7          32x34x2
  8          2x34x2
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m0.73829[0m     [32m0.94102[0m    0.78457      0.55545  15.18s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.44852[0m     1.48330    0.30238      0.49995  14.94s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.20593[0m     3.51801    0.05853      0.47070  14.67s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.08249[0m     3.28361    0.02512      0.44379  14.88s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.05299[0m     3.70340    0.01431      0.47021  14.81s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.03464[0m     5.68848    0.00609      0.48451  14.89s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     0.03881     6.04960    0.00642      0.46769  15.17s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.03255[0m     5.89606    0.00552      0.45791  16.07s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      9     2.87481     [32m0.88346[0m    3.25404      0.54671  16.11s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     10     0.41199     1.49774    0.27507      0.48304  16.20s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     11     0.22281     2.39653    0.09297      0.47819  16.03s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     12     0.09703     4.13293    0.02348      0.44857  16.32s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     13     0.05429     4.85154    0.01119      0.46233  16.22s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     14     0.03809     4.10172    0.00929      0.46069  16.44s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     15     [36m0.02573[0m     4.88808    0.00526      0.46716  16.48s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     16     [36m0.01864[0m     6.41301    0.00291      0.46669  16.35s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     17     [36m0.01761[0m     6.12902    0.00287      0.46926  16.39s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     18     [36m0.01582[0m     8.45985    0.00187      0.47715  16.34s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     19     [36m0.01490[0m     7.35699    0.00203      0.46953  16.37s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.883458 at epoch 9.
Loaded parameters to layer 'conv2d1' (shape 32x1x64x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x1x64).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.665652215523
Error rate (%):  33.4347784477
[[32102 14068]
 [ 3400  2675]]
(52245,)
(52245,)
roc_auc: 0.557855622137
log_loss: inf
roc_auc for the hours: 0.578947368421
log_loss for the hours: 0.970695022627
saving predictions to csv file
hourspatient2_1_net13_10-11-01-56-24.csv
Accuracy validation for the hours:  0.674418604651
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [1]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.03688192
saving predictions to csv file
patient2_1_net13_10-11-01-59-26.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config5.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_2']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config5.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_2'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-11 01:59:27.480159
Hostname: kat
gpu2
Configuration 'config5.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net13
evaluation:
    online_training: False
    model: net13

end Configuration
['patient2_2']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [2]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.749297664
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 209.986540222 225.906962585
20 329.095306396 346.162701416
30 444.230593872 460.11050415
40 570.524414062 582.58815918
50 722.16116333 726.961212158
60 921.348901367 911.623071289
70 1211.68074951 1175.55042725
80 1700.91003418 1611.25981445
90 2771.39865723 2552.46484375
100 58473.7617188 75930.625
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net13
Model name for the evaluation phase:  net13
Training model...
# Neural Network with 95970 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x131x66
  2          32x133x5
  3          32x133x5
  4          32x67x3
  5          32x67x3
  6          32x67x3
  7          32x34x2
  8          2x34x2
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m0.62631[0m     [32m1.20629[0m    0.51920      0.57840  14.94s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.45234[0m     1.57789    0.28668      0.56035  14.64s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.32519[0m     2.63168    0.12357      0.58749  14.86s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     0.51458     2.21625    0.23219      0.56959  14.81s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.19804[0m     3.35430    0.05904      0.60178  15.05s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.06665[0m     6.42366    0.01038      0.58852  14.76s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.04243[0m     7.65128    0.00555      0.54615  15.93s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.02769[0m     6.11932    0.00453      0.55191  16.28s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.02462[0m     7.34631    0.00335      0.55260  16.45s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     10     0.03622    10.34142    0.00350      0.52552  16.45s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     11     1.03297     2.62516    0.39349      0.57329  16.49s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 1.206289 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x64x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x1x64).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.587884008039
Error rate (%):  41.2115991961
[[27246 18924]
 [ 2607  3468]]
(52245,)
(52245,)
roc_auc: 0.640570127753
log_loss: 3.02299299602
roc_auc for the hours: 0.597368421053
log_loss for the hours: 1.97416598826
saving predictions to csv file
hourspatient2_2_net13_10-11-02-05-10.csv
Accuracy validation for the hours:  0.581395348837
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [2]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.041997824
saving predictions to csv file
patient2_2_net13_10-11-02-08-24.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config5.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_3']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config5.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_3'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-11 02:08:25.624358
Hostname: kat
gpu2
Configuration 'config5.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net13
evaluation:
    online_training: False
    model: net13

end Configuration
['patient2_3']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [3]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.748179456
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 232.146871948 248.098060608
20 362.633648682 379.823339844
30 488.15196228 505.159686279
40 627.292626953 642.350366211
50 799.678375244 809.175415039
60 1039.14638672 1037.57441406
70 1420.94019775 1395.75299072
80 2108.71582031 2036.62312012
90 3569.3847168 3399.96303711
100 147926.25 114985.820312
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net13
Model name for the evaluation phase:  net13
Training model...
# Neural Network with 95970 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x131x66
  2          32x133x5
  3          32x133x5
  4          32x67x3
  5          32x67x3
  6          32x67x3
  7          32x34x2
  8          2x34x2
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m0.73378[0m     [32m0.83927[0m    0.87431      0.53199  14.73s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.48843[0m     [32m0.79740[0m    0.61252      0.53010  14.72s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.41904[0m     1.24711    0.33601      0.56108  14.94s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.33924[0m     2.46778    0.13747      0.57247  15.11s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.20054[0m     3.59005    0.05586      0.60198  14.92s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.06747[0m     3.63167    0.01858      0.55061  15.34s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.04335[0m     8.77168    0.00494      0.60923  16.28s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.02906[0m     8.12251    0.00358      0.61013  16.32s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      9     1.92354     1.11569    1.72408      0.50444  16.53s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     10     0.44441     1.07897    0.41188      0.55997  16.65s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     11     0.28490     2.67408    0.10654      0.56987  16.51s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     12     0.10503     4.31213    0.02436      0.59094  16.28s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.797403 at epoch 2.
Loaded parameters to layer 'conv2d1' (shape 32x1x64x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x1x64).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.65154560245
Error rate (%):  34.845439755
[[31775 14395]
 [ 3810  2265]]
(52245,)
(52245,)
roc_auc: 0.598063157182
log_loss: nan
roc_auc for the hours: 0.568421052632
log_loss for the hours: 1.05230604828
saving predictions to csv file
hourspatient2_3_net13_10-11-02-14-35.csv
Accuracy validation for the hours:  0.627906976744
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [3]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.04091648
saving predictions to csv file
patient2_3_net13_10-11-02-17-37.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config5.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_4']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config5.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_4'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-11 02:17:38.914120
Hostname: kat
gpu2
Configuration 'config5.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net13
evaluation:
    online_training: False
    model: net13

end Configuration
['patient2_4']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [4]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.750280704
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 165.436743164 175.107310486
20 259.898529053 270.363952637
30 352.872415161 363.763861084
40 459.585931396 469.051629639
50 596.801239014 602.84375
60 794.120068359 791.004992676
70 1106.86796875 1082.3704834
80 1648.70195313 1577.21459961
90 2803.05773926 2610.05686035
100 44210.6640625 39898.75
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net13
Model name for the evaluation phase:  net13
Training model...
# Neural Network with 95970 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x131x66
  2          32x133x5
  3          32x133x5
  4          32x67x3
  5          32x67x3
  6          32x67x3
  7          32x34x2
  8          2x34x2
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m0.60734[0m     [32m0.66858[0m    0.90840      0.73344  14.71s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.31696[0m     1.48416    0.21356      0.71513  14.91s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.10797[0m     2.44827    0.04410      0.66261  15.15s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.05192[0m     2.47360    0.02099      0.65637  14.93s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.03708[0m     2.59315    0.01430      0.67407  15.15s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     0.03834     4.61094    0.00831      0.68362  14.98s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.02616[0m     4.71029    0.00555      0.69255  16.17s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.01831[0m     6.55933    0.00279      0.68749  16.45s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      9     0.07273     5.02411    0.01448      0.66040  16.49s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.00969[0m     3.91073    0.00248      0.67114  16.55s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     11     0.01289     4.14521    0.00311      0.64664  17.10s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.668580 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x64x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x1x64).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.859718633362
Error rate (%):  14.0281366638
[[41525  4645]
 [ 2684  3391]]
(52245,)
(52245,)
roc_auc: 0.732367493188
log_loss: inf
roc_auc for the hours: 0.752631578947
log_loss for the hours: 0.695541705042
saving predictions to csv file
hourspatient2_4_net13_10-11-02-23-10.csv
Accuracy validation for the hours:  0.883720930233
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [4]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.042108416
saving predictions to csv file
patient2_4_net13_10-11-02-26-34.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config5.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_5']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config5.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_5'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-11 02:26:35.205849
Hostname: kat
gpu2
Configuration 'config5.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net13
evaluation:
    online_training: False
    model: net13

end Configuration
['patient2_5']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [5]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.74838016
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 185.196789551 197.613002014
20 294.801989746 307.815057373
30 407.290542603 420.04319458
40 542.552478027 552.726599121
50 726.239715576 729.61151123
60 1003.9644165 990.04107666
70 1455.43812256 1400.85588379
80 2251.58901367 2106.12675781
90 4066.22578125 3684.91796875
100 67580.4921875 68869.3984375
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net13
Model name for the evaluation phase:  net13
Training model...
# Neural Network with 95970 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x131x66
  2          32x133x5
  3          32x133x5
  4          32x67x3
  5          32x67x3
  6          32x67x3
  7          32x34x2
  8          2x34x2
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m0.73055[0m     [32m0.91540[0m    0.79806      0.58904  14.60s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.44351[0m     1.55708    0.28484      0.59804  14.57s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.28774[0m     2.54398    0.11311      0.60937  14.94s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.12795[0m     4.24141    0.03017      0.53799  14.79s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.08195[0m     2.95678    0.02772      0.60859  14.96s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.05910[0m     4.33032    0.01365      0.57868  14.81s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.04142[0m     5.61059    0.00738      0.55338  16.51s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      8     2.38664     [32m0.79432[0m    3.00462      0.60496  16.52s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      9     0.46114     1.51668    0.30405      0.58630  16.40s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     10     0.31279     2.43248    0.12859      0.62060  16.27s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     11     0.16637     2.65486    0.06267      0.60934  16.93s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     12     0.07642     4.32639    0.01766      0.56201  16.96s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     13     0.05017     4.34610    0.01154      0.55969  17.14s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     14     [36m0.03342[0m     5.07371    0.00659      0.54220  16.65s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     15     0.03399     5.46329    0.00622      0.55263  16.76s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     16     [36m0.01955[0m     5.11187    0.00383      0.53890  16.39s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     17     0.02197     8.73319    0.00252      0.55243  16.54s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     18     [36m0.01923[0m     5.82490    0.00330      0.57638  16.47s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.794324 at epoch 8.
Loaded parameters to layer 'conv2d1' (shape 32x1x64x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x1x64).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 0 0 0 1 1 1 0 1 1 1 1 1 1 0 1 1 1 1 1 1 0 0 1 1 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.582160972342
Error rate (%):  41.7839027658
[[26470 19700]
 [ 2130  3945]]
(52245,)
(52245,)
roc_auc: 0.634289021339
log_loss: nan
roc_auc for the hours: 0.657894736842
log_loss for the hours: 2.15759326255
saving predictions to csv file
hourspatient2_5_net13_10-11-02-34-03.csv
Accuracy validation for the hours:  0.604651162791
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [5]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.041731584
saving predictions to csv file
patient2_5_net13_10-11-02-37-08.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config5.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_6']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config5.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_6'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-11 02:37:09.398318
Hostname: kat
gpu2
Configuration 'config5.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net13
evaluation:
    online_training: False
    model: net13

end Configuration
['patient2_6']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [6]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.74917888
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 163.101298523 175.881399536
20 258.470428467 274.155731201
30 355.682626343 373.270678711
40 471.085089111 488.984100342
50 626.310150146 642.409729004
60 861.122949219 869.392102051
70 1253.91723633 1241.61234131
80 1956.83286133 1902.809375
90 3422.80100098 3262.08793945
100 47858.3515625 52179.953125
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net13
Model name for the evaluation phase:  net13
Training model...
# Neural Network with 95970 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x131x66
  2          32x133x5
  3          32x133x5
  4          32x67x3
  5          32x67x3
  6          32x67x3
  7          32x34x2
  8          2x34x2
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m0.67188[0m     [32m0.62375[0m    1.07716      0.69313  14.79s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.41826[0m     1.09657    0.38143      0.65823  14.75s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.20741[0m     1.67352    0.12394      0.67169  14.73s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.08898[0m     2.55219    0.03486      0.65421  14.77s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.05216[0m     3.09289    0.01686      0.62295  14.83s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.03528[0m     4.53342    0.00778      0.57671  14.83s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     0.03848     3.27106    0.01176      0.58662  16.18s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.02139[0m     4.42167    0.00484      0.56525  16.86s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      9     0.02652     4.83026    0.00549      0.59746  16.56s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     10     0.02485     6.57439    0.00378      0.58400  16.31s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     11     0.02526     4.94486    0.00511      0.66860  16.37s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.623751 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x64x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x1x64).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.814183175423
Error rate (%):  18.5816824577
[[39302  6868]
 [ 2840  3235]]
(52245,)
(52245,)
roc_auc: 0.737083342915
log_loss: nan
roc_auc for the hours: 0.752631578947
log_loss for the hours: 0.495627950924
saving predictions to csv file
hourspatient2_6_net13_10-11-02-42-40.csv
Accuracy validation for the hours:  0.813953488372
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [6]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.041104896
saving predictions to csv file
patient2_6_net13_10-11-02-46-08.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config5.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_7']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config5.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_7'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-11 02:46:09.761991
Hostname: kat
gpu2
Configuration 'config5.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net13
evaluation:
    online_training: False
    model: net13

end Configuration
['patient2_7']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [7]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.748535808
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 177.49072113 198.887155151
20 286.226177979 314.740679932
30 400.515246582 436.170880127
40 540.098596191 582.037194824
50 725.995513916 773.688720703
60 988.882971191 1040.23283691
70 1379.6152832 1428.96156006
80 1995.99584961 2035.20236816
90 3121.08054199 3130.02658691
100 70629.9609375 92128.8515625
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net13
Model name for the evaluation phase:  net13
Training model...
# Neural Network with 95970 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x131x66
  2          32x133x5
  3          32x133x5
  4          32x67x3
  5          32x67x3
  6          32x67x3
  7          32x34x2
  8          2x34x2
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m0.66015[0m     [32m0.68229[0m    0.96754      0.64672  14.76s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.46678[0m     1.12956    0.41324      0.62354  14.95s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.38017[0m     1.15150    0.33016      0.59492  15.81s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.20138[0m     2.95057    0.06825      0.60624  14.79s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.05374[0m     4.94759    0.01086      0.50346  15.05s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     0.05822     4.81328    0.01210      0.59567  14.79s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.02131[0m     5.29945    0.00402      0.62358  15.56s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      8     0.02864     4.90491    0.00584      0.56784  16.14s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      9     1.01722     0.94502    1.07641      0.65947  16.25s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     10     0.25003     1.70694    0.14648      0.59957  16.26s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     11     0.04726     2.86419    0.01650      0.61763  16.08s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.682293 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x64x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x1x64).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.778926213035
Error rate (%):  22.1073786965
[[37884  8286]
 [ 3264  2811]]
(52245,)
(52245,)
roc_auc: 0.6709464361
log_loss: 0.885238790162
roc_auc for the hours: 0.684210526316
log_loss for the hours: 0.652544924926
saving predictions to csv file
hourspatient2_7_net13_10-11-02-51-59.csv
Accuracy validation for the hours:  0.790697674419
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [7]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.039777792
saving predictions to csv file
patient2_7_net13_10-11-02-55-16.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config5.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_8']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config5.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_8'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-11 02:55:17.332979
Hostname: kat
gpu2
Configuration 'config5.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net13
evaluation:
    online_training: False
    model: net13

end Configuration
['patient2_8']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [8]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.748716032
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 304.582891846 331.561761475
20 484.435198975 519.064501953
30 665.606323242 707.089782715
40 874.991894531 920.50123291
50 1137.25024414 1183.24688721
60 1487.04992676 1528.72434082
70 1983.92612305 2011.19562988
80 2754.95263672 2754.76303711
90 4202.81694336 4159.4034668
100 105201.65625 53464.578125
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net13
Model name for the evaluation phase:  net13
Training model...
# Neural Network with 95970 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x131x66
  2          32x133x5
  3          32x133x5
  4          32x67x3
  5          32x67x3
  6          32x67x3
  7          32x34x2
  8          2x34x2
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m0.72587[0m     [32m0.99138[0m    0.73218      0.59587  14.95s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.41583[0m     1.99645    0.20829      0.52876  15.51s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.18506[0m     2.51758    0.07351      0.54818  15.11s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.06959[0m     5.46822    0.01273      0.53634  14.93s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.04604[0m     3.68021    0.01251      0.51885  15.16s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.03145[0m     6.75464    0.00466      0.50223  15.04s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     0.03184     5.00902    0.00636      0.54377  16.03s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.03097[0m     6.40189    0.00484      0.51210  16.27s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.01915[0m     9.76100    0.00196      0.51220  16.56s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     10     0.02055     6.29708    0.00326      0.55460  16.30s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     11     0.02699     7.86177    0.00343      0.49549  16.36s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     12     0.99438     [32m0.89415[0m    1.11209      0.64382  16.33s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     13     0.19249     3.40777    0.05648      0.54780  16.41s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     14     0.03777     5.36793    0.00704      0.50619  16.42s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     15     [36m0.01707[0m     6.16637    0.00277      0.51985  16.55s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     16     [36m0.01287[0m     6.10128    0.00211      0.51810  16.18s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     17     [36m0.01097[0m     6.98569    0.00157      0.52433  16.41s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     18     [36m0.00854[0m     7.77740    0.00110      0.53667  17.09s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     19     0.01048     7.55978    0.00139      0.53669  17.29s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     20     [36m0.00762[0m     6.45714    0.00118      0.53828  17.23s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     21     0.08457     5.31245    0.01592      0.52813  16.97s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     22     0.01081     8.33728    0.00130      0.53264  16.83s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.894153 at epoch 12.
Loaded parameters to layer 'conv2d1' (shape 32x1x64x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x1x64).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.814010910135
Error rate (%):  18.5989089865
[[40364  5806]
 [ 3911  2164]]
(52245,)
(52245,)
roc_auc: 0.642522098061
log_loss: nan
roc_auc for the hours: 0.721052631579
log_loss for the hours: 0.8284490638
saving predictions to csv file
hourspatient2_8_net13_10-11-03-03-58.csv
Accuracy validation for the hours:  0.813953488372
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [8]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.041391616
saving predictions to csv file
patient2_8_net13_10-11-03-07-02.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config5.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_9']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config5.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_9'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-11 03:07:03.702571
Hostname: kat
gpu2
Configuration 'config5.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net13
evaluation:
    online_training: False
    model: net13

end Configuration
['patient2_9']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [9]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.749502464
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 283.37227478 306.047775269
20 448.091705322 476.795318604
30 612.117547607 646.27376709
40 800.063977051 838.327783203
50 1035.82800293 1076.41149902
60 1355.32043457 1393.14555664
70 1821.88786621 1848.28326416
80 2583.80039063 2579.61362305
90 4184.19125977 4103.89086914
100 81443.234375 46753.0546875
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net13
Model name for the evaluation phase:  net13
Training model...
# Neural Network with 95970 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x131x66
  2          32x133x5
  3          32x133x5
  4          32x67x3
  5          32x67x3
  6          32x67x3
  7          32x34x2
  8          2x34x2
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m0.72390[0m     [32m0.82692[0m    0.87541      0.63328  14.69s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.33999[0m     1.76367    0.19277      0.61848  14.70s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.11625[0m     2.65316    0.04381      0.60029  14.91s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.05661[0m     4.56646    0.01240      0.61303  15.06s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.04395[0m     4.37182    0.01005      0.58980  15.13s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.02993[0m     4.51219    0.00663      0.61794  15.01s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     0.03565     5.90809    0.00603      0.58837  15.97s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.01847[0m     5.47309    0.00338      0.59669  16.55s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      9     0.03185     4.52879    0.00703      0.62030  16.06s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     10     0.01942     4.51038    0.00431      0.60802  15.88s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.01732[0m     5.77477    0.00300      0.60178  16.47s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.826924 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x64x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x1x64).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.804344913389
Error rate (%):  19.5655086611
[[39617  6553]
 [ 3669  2406]]
(52245,)
(52245,)
roc_auc: 0.627112651313
log_loss: nan
roc_auc for the hours: 0.642105263158
log_loss for the hours: 0.700246224102
saving predictions to csv file
hourspatient2_9_net13_10-11-03-12-57.csv
Accuracy validation for the hours:  0.813953488372
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [9]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.042264064
saving predictions to csv file
patient2_9_net13_10-11-03-16-48.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config5.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_10']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config5.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_10'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-11 03:16:49.412455
Hostname: kat
gpu2
Configuration 'config5.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net13
evaluation:
    online_training: False
    model: net13

end Configuration
['patient2_10']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [10]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.747921408
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 235.353125 259.209658813
20 373.425970459 404.270147705
30 511.624740601 548.895672607
40 670.266955566 710.672009277
50 867.946899414 908.465515137
60 1130.38996582 1165.67106934
70 1502.52767334 1525.50710449
80 2081.78022461 2081.2378418
90 3192.88137207 3135.13125
100 33467.8828125 31567.0722656
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net13
Model name for the evaluation phase:  net13
Training model...
# Neural Network with 95970 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x131x66
  2          32x133x5
  3          32x133x5
  4          32x67x3
  5          32x67x3
  6          32x67x3
  7          32x34x2
  8          2x34x2
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m0.66191[0m     [32m0.74418[0m    0.88944      0.64786  14.69s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.36125[0m     1.66637    0.21679      0.65142  14.90s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.10826[0m     2.87852    0.03761      0.66251  14.72s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.05622[0m     4.37777    0.01284      0.58606  14.72s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.03150[0m     4.62868    0.00680      0.59610  15.11s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.02943[0m     3.20878    0.00917      0.57744  15.01s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     0.06741     4.08067    0.01652      0.59694  15.54s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.01570[0m     4.90807    0.00320      0.58232  16.34s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      9     0.02147     5.88222    0.00365      0.54847  16.27s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.00996[0m     7.51614    0.00132      0.53780  16.28s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     11     0.01472     5.43976    0.00271      0.57827  16.39s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.744184 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x64x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x1x64).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.710747439946
Error rate (%):  28.9252560054
[[33778 12392]
 [ 2720  3355]]
(52245,)
(52245,)
roc_auc: 0.669400499674
log_loss: nan
roc_auc for the hours: 0.715789473684
log_loss for the hours: 0.717460541839
saving predictions to csv file
hourspatient2_10_net13_10-11-03-22-29.csv
Accuracy validation for the hours:  0.767441860465
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [10]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.041166336
saving predictions to csv file
patient2_10_net13_10-11-03-25-52.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config5.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_11']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config5.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_11'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-11 03:25:53.281667
Hostname: kat
gpu2
Configuration 'config5.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net13
evaluation:
    online_training: False
    model: net13

end Configuration
['patient2_11']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [11]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.74973184
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 185.314794922 208.111297607
20 299.770111084 330.638024902
30 420.835580444 458.932080078
40 567.582995605 611.673339844
50 760.888244629 809.9090271
60 1030.30930176 1080.86318359
70 1423.52952881 1473.30863037
80 2039.71828613 2086.87138672
90 3209.50048828 3264.72282715
100 47304.0664062 104914.585938
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net13
Model name for the evaluation phase:  net13
Training model...
# Neural Network with 95970 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x131x66
  2          32x133x5
  3          32x133x5
  4          32x67x3
  5          32x67x3
  6          32x67x3
  7          32x34x2
  8          2x34x2
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m0.66048[0m     [32m0.76111[0m    0.86778      0.60858  15.15s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.43085[0m     1.02047    0.42221      0.61807  15.00s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.20427[0m     2.39227    0.08539      0.57315  14.90s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.06744[0m     3.08467    0.02186      0.57721  14.98s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     0.09529     2.87539    0.03314      0.56088  15.00s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.01968[0m     4.25743    0.00462      0.56511  15.02s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     0.05974     4.57045    0.01307      0.51012  16.24s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.01858[0m     5.83763    0.00318      0.54747  16.40s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.00910[0m     6.02596    0.00151      0.55684  16.31s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     10     0.83434     [32m0.72494[0m    1.15091      0.64628  16.30s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     11     0.22599     1.96467    0.11503      0.61535  16.44s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     12     0.04704     4.16263    0.01130      0.56035  16.48s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     13     0.01993     4.27769    0.00466      0.57891  16.59s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     14     0.01479     5.60893    0.00264      0.54870  16.49s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     15     0.01377     5.05567    0.00272      0.55026  16.74s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     16     0.01183     6.42338    0.00184      0.57273  16.53s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     17     [36m0.00859[0m     7.37615    0.00116      0.55987  16.41s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     18     0.01369     6.20756    0.00220      0.57329  16.78s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     19     0.35877     3.57210    0.10044      0.57743  16.45s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     20     0.01408     5.11454    0.00275      0.59681  16.65s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.724942 at epoch 10.
Loaded parameters to layer 'conv2d1' (shape 32x1x64x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x1x64).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.808421858551
Error rate (%):  19.1578141449
[[39831  6339]
 [ 3670  2405]]
(52245,)
(52245,)
roc_auc: 0.714781427735
log_loss: nan
roc_auc for the hours: 0.747368421053
log_loss for the hours: 0.491225764607
saving predictions to csv file
hourspatient2_11_net13_10-11-03-33-58.csv
Accuracy validation for the hours:  0.790697674419
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [11]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.041342464
saving predictions to csv file
patient2_11_net13_10-11-03-36-56.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config5.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_12']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config5.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_12'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-11 03:36:57.832573
Hostname: kat
gpu2
Configuration 'config5.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net13
evaluation:
    online_training: False
    model: net13

end Configuration
['patient2_12']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [12]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.7488512
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 246.400856018 260.383670044
20 388.318774414 405.029217529
30 528.878991699 548.355413818
40 689.669812012 711.362548828
50 892.074920654 915.121887207
60 1170.23933105 1190.96369629
70 1584.49351807 1593.89857178
80 2252.05878906 2238.45820313
90 3510.49829102 3446.85510254
100 68512.453125 43195.7773438
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net13
Model name for the evaluation phase:  net13
Training model...
# Neural Network with 95970 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x131x66
  2          32x133x5
  3          32x133x5
  4          32x67x3
  5          32x67x3
  6          32x67x3
  7          32x34x2
  8          2x34x2
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m0.66152[0m     [32m0.69000[0m    0.95872      0.61251  14.65s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.37371[0m     1.06337    0.35143      0.62581  14.59s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.15374[0m     3.67225    0.04187      0.62495  14.70s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.06784[0m     4.62891    0.01466      0.60366  14.64s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.03941[0m     5.81196    0.00678      0.59703  14.70s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.03462[0m     2.43355    0.01423      0.60561  15.08s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     0.05005     3.87565    0.01292      0.61202  16.58s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.01616[0m     5.43523    0.00297      0.60683  16.15s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      9     0.04883     2.68645    0.01818      0.51488  16.36s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     10     0.76692     2.67268    0.28695      0.60080  16.43s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     11     0.02983     4.08722    0.00730      0.61504  16.37s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.689998 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x64x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x1x64).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.729141544645
Error rate (%):  27.0858455355
[[35282 10888]
 [ 3263  2812]]
(52245,)
(52245,)
roc_auc: 0.650983720033
log_loss: nan
roc_auc for the hours: 0.663157894737
log_loss for the hours: 0.730004896529
saving predictions to csv file
hourspatient2_12_net13_10-11-03-42-36.csv
Accuracy validation for the hours:  0.767441860465
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [12]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.040887808
saving predictions to csv file
patient2_12_net13_10-11-03-45-35.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config5.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_13']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config5.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_13'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-11 03:45:36.155136
Hostname: kat
gpu2
Configuration 'config5.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net13
evaluation:
    online_training: False
    model: net13

end Configuration
['patient2_13']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [13]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.749223936
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 310.902963257 337.861572266
20 495.955010986 532.738879395
30 683.185546875 729.780834961
40 898.82401123 954.485388184
50 1167.24829102 1228.47143555
60 1520.5864502 1581.93601074
70 2018.97246094 2072.08920898
80 2789.6487793 2824.08540039
90 4233.0871582 4224.4074707
100 35079.8945312 31263.9492188
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net13
Model name for the evaluation phase:  net13
Training model...
# Neural Network with 95970 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x131x66
  2          32x133x5
  3          32x133x5
  4          32x67x3
  5          32x67x3
  6          32x67x3
  7          32x34x2
  8          2x34x2
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m0.70813[0m     [32m1.10416[0m    0.64133      0.57261  14.53s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.35680[0m     1.78029    0.20042      0.62075  14.51s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.11477[0m     3.85271    0.02979      0.51300  14.78s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.05859[0m     4.59589    0.01275      0.50782  15.50s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.04095[0m     5.11014    0.00801      0.50377  14.80s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.03349[0m     6.58829    0.00508      0.50326  14.56s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.02454[0m     5.35320    0.00458      0.52240  15.94s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.02315[0m     7.48340    0.00309      0.54757  15.96s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      9     0.02550     6.10198    0.00418      0.53028  16.40s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.01760[0m     7.82911    0.00225      0.51191  16.47s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.01744[0m     5.68969    0.00307      0.55724  16.41s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 1.104163 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x64x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x1x64).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.804612881615
Error rate (%):  19.5387118385
[[40748  5422]
 [ 4786  1289]]
(52245,)
(52245,)
roc_auc: 0.622608746884
log_loss: inf
roc_auc for the hours: 0.673684210526
log_loss for the hours: 0.746085917405
saving predictions to csv file
hourspatient2_13_net13_10-11-03-51-06.csv
Accuracy validation for the hours:  0.813953488372
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [13]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.041739776
saving predictions to csv file
patient2_13_net13_10-11-03-54-13.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config5.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_14']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config5.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_14'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-11 03:54:14.203418
Hostname: kat
gpu2
Configuration 'config5.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net13
evaluation:
    online_training: False
    model: net13

end Configuration
['patient2_14']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [14]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.749473792
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 266.172717285 282.912625122
20 417.956640625 438.4277771
30 566.452648926 591.266082764
40 733.547790527 761.89486084
50 939.345672607 969.588409424
60 1211.49157715 1239.79914551
70 1602.63823242 1619.38890381
80 2236.86499023 2222.94345703
90 3516.40424805 3422.74516602
100 38412.0351562 39300.5585938
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net13
Model name for the evaluation phase:  net13
Training model...
# Neural Network with 95970 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x131x66
  2          32x133x5
  3          32x133x5
  4          32x67x3
  5          32x67x3
  6          32x67x3
  7          32x34x2
  8          2x34x2
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m0.69630[0m     [32m1.01784[0m    0.68410      0.62005  14.73s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.39553[0m     2.66539    0.14840      0.60630  14.69s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.13160[0m     4.11592    0.03197      0.53477  14.72s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.05140[0m     4.63832    0.01108      0.57093  14.72s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.03844[0m     5.05762    0.00760      0.61231  14.79s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.02870[0m     8.47141    0.00339      0.53911  14.75s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.02399[0m     4.53488    0.00529      0.60520  15.49s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.02305[0m     8.52318    0.00270      0.57590  16.10s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.02260[0m     6.21103    0.00364      0.60283  16.29s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.01763[0m     8.13907    0.00217      0.52594  15.92s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     11     1.02887     [32m0.93884[0m    1.09590      0.55040  16.29s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     12     0.22847     3.70367    0.06169      0.53194  16.08s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     13     0.03810     5.64772    0.00675      0.53550  16.11s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     14     0.01850     6.68238    0.00277      0.52466  15.87s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     15     [36m0.01274[0m     7.75110    0.00164      0.55243  16.15s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     16     [36m0.01037[0m     8.15516    0.00127      0.54655  15.88s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     17     [36m0.00922[0m     6.86476    0.00134      0.53663  16.22s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     18     [36m0.00873[0m    10.42639    0.00084      0.54987  16.30s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     19     0.00958     9.11121    0.00105      0.54695  15.94s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     20     0.01144     7.07942    0.00162      0.56366  16.25s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     21     0.01115     9.03480    0.00123      0.55340  16.22s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.938837 at epoch 11.
Loaded parameters to layer 'conv2d1' (shape 32x1x64x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x1x64).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.713733371615
Error rate (%):  28.6266628385
[[34859 11311]
 [ 3645  2430]]
(52245,)
(52245,)
roc_auc: 0.57019098679
log_loss: nan
roc_auc for the hours: 0.531578947368
log_loss for the hours: 1.10335818079
saving predictions to csv file
hourspatient2_14_net13_10-11-04-02-30.csv
Accuracy validation for the hours:  0.767441860465
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [14]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.036468224
saving predictions to csv file
patient2_14_net13_10-11-04-05-31.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config5.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_15']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config5.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_15'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-11 04:05:32.532662
Hostname: kat
gpu2
Configuration 'config5.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net13
evaluation:
    online_training: False
    model: net13

end Configuration
['patient2_15']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [15]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.749113344
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 207.538546753 227.35309906
20 331.033721924 357.463000488
30 457.867379761 491.204870605
40 608.373034668 648.207519531
50 801.816497803 847.310424805
60 1065.05288086 1112.36008301
70 1442.92700195 1484.37923584
80 2028.23110352 2052.16914063
90 3108.79804688 3089.25849609
100 28167.1855469 26524.03125
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net13
Model name for the evaluation phase:  net13
Training model...
# Neural Network with 95970 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x131x66
  2          32x133x5
  3          32x133x5
  4          32x67x3
  5          32x67x3
  6          32x67x3
  7          32x34x2
  8          2x34x2
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m0.63744[0m     [32m0.72378[0m    0.88071      0.70491  15.43s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.30538[0m     1.68963    0.18074      0.71255  14.37s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.09306[0m     2.65107    0.03510      0.65343  14.73s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.05520[0m     2.82990    0.01951      0.67068  14.43s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.03933[0m     2.33587    0.01684      0.65878  14.47s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.02499[0m     2.91754    0.00856      0.69212  14.50s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.02202[0m     4.08067    0.00540      0.63122  14.48s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.02055[0m     3.77176    0.00545      0.60372  15.01s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      9     0.02087     3.40228    0.00613      0.61234  15.46s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.01781[0m     3.90204    0.00457      0.63896  15.61s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     11     3.40163     0.74977    4.53690      0.61349  15.75s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.723783 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x64x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x1x64).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.788573069193
Error rate (%):  21.1426930807
[[37658  8512]
 [ 2534  3541]]
(52245,)
(52245,)
roc_auc: 0.700917361228
log_loss: nan
roc_auc for the hours: 0.752631578947
log_loss for the hours: 0.528901555315
saving predictions to csv file
hourspatient2_15_net13_10-11-04-10-53.csv
Accuracy validation for the hours:  0.813953488372
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [15]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.041522688
saving predictions to csv file
patient2_15_net13_10-11-04-13-53.csv
