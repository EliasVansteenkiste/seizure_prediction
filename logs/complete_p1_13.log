['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_0']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_0'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-10 10:45:22.259572
Hostname: kat
gpu2
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net11
evaluation:
    online_training: False
    model: net11

end Configuration
['patient1_0']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [0]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.750239744
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 199.036781311 184.038919067
20 483.221002197 465.519171143
30 718.880554199 694.377087402
40 969.482617188 933.868884277
50 1265.8637085 1213.74743652
60 1644.84228516 1568.92561035
70 2171.59033203 2061.92285156
80 2997.35341797 2842.94628906
90 4640.41015625 4440.24106445
100 101397.328125 96893.890625
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net11
Model name for the evaluation phase:  net11
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m3.02905[0m     [32m0.72072[0m    4.20284      0.50871  15.61s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      2     [36m0.72183[0m     [32m0.70426[0m    1.02495      0.46811  15.78s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      3     [36m0.70062[0m     [32m0.69612[0m    1.00647      0.48634  15.32s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      4     [36m0.69205[0m     [32m0.69458[0m    0.99635      0.47579  15.74s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      5     [36m0.68331[0m     0.70346    0.97137      0.48678  15.98s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      6     [36m0.66436[0m     0.70672    0.94006      0.46833  16.51s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      7     [36m0.65447[0m     0.72406    0.90389      0.45983  17.00s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      8     [36m0.64039[0m     0.77491    0.82641      0.35652  17.18s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      9     [36m0.63835[0m     0.75919    0.84082      0.46541  16.95s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     10     [36m0.63388[0m     0.76178    0.83210      0.46625  17.03s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     11     [36m0.62970[0m     0.75601    0.83292      0.45866  16.83s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     12     [36m0.62563[0m     0.73907    0.84652      0.44976  16.74s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     13     [36m0.61934[0m     0.75183    0.82377      0.45432  16.76s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     14     [36m0.60373[0m     0.76998    0.78408      0.47062  16.72s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
Early stopping.
Best valid loss was 0.694585 at epoch 4.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.506879814287
Error rate (%):  49.3120185713
[[45397 43298]
 [ 3435  2640]]
(94770,)
(94770,)
roc_auc: 0.503233305425
log_loss: 1.32329403537
roc_auc for the hours: 0.476712328767
log_loss for the hours: 1.11916207819
saving predictions to csv file
hourspatient1_0_net11_10-10-10-54-07.csv
Accuracy validation for the hours:  0.525641025641
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [0]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.048182784
saving predictions to csv file
patient1_0_net11_10-10-11-12-51.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_1']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_1'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-10 11:12:52.567014
Hostname: kat
gpu2
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net11
evaluation:
    online_training: False
    model: net11

end Configuration
['patient1_1']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [1]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.749391872
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 203.761627197 188.411010742
20 496.77197876 482.61751709
30 732.597296143 714.697686768
40 973.972167969 949.532727051
50 1245.81005859 1212.85552979
60 1576.76357422 1532.16108398
70 2013.54516602 1951.80438232
80 2668.75805664 2577.9690918
90 3942.10078125 3797.89812012
100 71591.0625 60304.03125
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net11
Model name for the evaluation phase:  net11
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m2.83673[0m     [32m0.69977[0m    4.05379      0.46518  15.72s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      2     [36m0.71801[0m     [32m0.68932[0m    1.04163      0.49064  15.73s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      3     [36m0.69857[0m     [32m0.68875[0m    1.01425      0.45659  15.84s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      4     [36m0.68958[0m     0.69065    0.99845      0.42764  15.71s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      5     [36m0.68488[0m     0.69527    0.98505      0.43038  16.13s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      6     [36m0.68245[0m     [32m0.68654[0m    0.99405      0.56238  15.93s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      7     [36m0.68148[0m     [32m0.68479[0m    0.99516      0.44198  16.40s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      8     0.68224     [32m0.68094[0m    1.00191      0.45707  16.78s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      9     [36m0.67436[0m     0.68544    0.98384      0.43703  17.19s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     10     0.67523     0.68367    0.98766      0.44402  16.97s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     11     [36m0.66764[0m     0.68354    0.97674      0.44646  17.04s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     12     [36m0.66408[0m     [32m0.67195[0m    0.98829      0.56834  17.19s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     13     [36m0.66208[0m     0.67651    0.97866      0.60757  17.13s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     14     [36m0.65912[0m     [32m0.66159[0m    0.99626      0.58137  17.09s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     15     0.66027     0.66192    0.99751      0.54629  17.16s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     16     [36m0.65122[0m     [32m0.65902[0m    0.98817      0.57320  17.16s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     17     0.65136     [32m0.65457[0m    0.99510      0.59141  17.22s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     18     [36m0.64197[0m     [32m0.65406[0m    0.98150      0.60586  17.10s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     19     [36m0.63946[0m     [32m0.65206[0m    0.98068      0.59422  17.21s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     20     0.64598     0.65388    0.98792      0.62436  17.06s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     21     [36m0.63260[0m     [32m0.64810[0m    0.97609      0.56984  17.03s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     22     [36m0.63096[0m     [32m0.64734[0m    0.97470      0.59045  16.95s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     23     [36m0.62864[0m     0.65235    0.96366      0.61950  17.02s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     24     [36m0.62054[0m     [32m0.64628[0m    0.96018      0.57003  16.99s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     25     [36m0.61311[0m     [32m0.64541[0m    0.94996      0.57409  17.21s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     26     [36m0.60077[0m     0.65504    0.91716      0.58537  17.01s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     27     [36m0.59026[0m     0.65433    0.90207      0.58161  16.95s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     28     [36m0.57883[0m     0.65711    0.88087      0.59562  16.93s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     29     [36m0.55750[0m     0.65082    0.85661      0.60092  17.05s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     30     [36m0.54141[0m     0.67041    0.80758      0.56752  17.08s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     31     [36m0.53468[0m     0.65091    0.82144      0.60622  16.97s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     32     [36m0.51152[0m     0.68230    0.74970      0.58607  17.17s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     33     [36m0.49590[0m     0.70025    0.70818      0.56208  17.19s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     34     [36m0.48459[0m     0.69689    0.69535      0.57619  17.12s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     35     [36m0.45886[0m     0.73190    0.62694      0.57862  17.11s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
Early stopping.
Best valid loss was 0.645410 at epoch 25.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 0 0 0 0 0 0 1 1 0 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.52085048011
Error rate (%):  47.914951989
[[45816 42879]
 [ 2530  3545]]
(94770,)
(94770,)
roc_auc: 0.60304842716
log_loss: 1.69411329615
roc_auc for the hours: 0.616438356164
log_loss for the hours: 0.832628563756
saving predictions to csv file
hourspatient1_1_net11_10-10-12-02-47.csv
Accuracy validation for the hours:  0.525641025641
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [1]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.047629824
saving predictions to csv file
patient1_1_net11_10-10-12-30-39.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_2']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_2'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-10 12:30:40.717302
Hostname: kat
gpu2
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net11
evaluation:
    online_training: False
    model: net11

end Configuration
['patient1_2']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [2]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.750010368
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 210.389639282 196.646928406
20 506.963934326 496.903918457
30 739.698999023 728.238903809
40 971.565100098 956.919091797
50 1226.64501953 1206.60388184
60 1529.57705078 1501.93178711
70 1919.78259277 1881.66341553
80 2487.38320313 2434.10976563
90 3554.0130127 3481.28129883
100 119907.929688 146484.890625
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net11
Model name for the evaluation phase:  net11
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m2.72249[0m     [32m0.72527[0m    3.75376      0.52312  15.74s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      2     [36m0.71875[0m     [32m0.70603[0m    1.01803      0.53596  15.75s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      3     [36m0.70552[0m     [32m0.70212[0m    1.00485      0.54098  15.99s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      4     [36m0.70060[0m     [32m0.69427[0m    1.00911      0.53800  15.93s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      5     [36m0.69271[0m     0.69609    0.99514      0.52617  15.81s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      6     [36m0.69117[0m     0.69497    0.99453      0.51672  15.93s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      7     [36m0.68380[0m     [32m0.69315[0m    0.98652      0.51718  16.29s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      8     0.68723     0.69338    0.99113      0.52011  16.88s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      9     [36m0.67951[0m     0.69380    0.97940      0.52405  16.90s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     10     [36m0.67879[0m     0.69530    0.97624      0.53348  17.07s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     11     [36m0.67652[0m     0.69665    0.97110      0.52020  16.97s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     12     [36m0.67469[0m     0.71171    0.94799      0.54322  17.15s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     13     0.67686     0.71274    0.94966      0.56162  17.16s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     14     [36m0.66602[0m     0.70448    0.94540      0.51828  17.10s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     15     [36m0.66562[0m     0.71425    0.93191      0.56032  17.21s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     16     [36m0.66018[0m     0.70821    0.93219      0.56457  17.33s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     17     [36m0.64788[0m     0.70563    0.91816      0.53821  17.36s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
Early stopping.
Best valid loss was 0.693151 at epoch 7.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.333544370581
Error rate (%):  66.6455629419
[[27256 61439]
 [ 1721  4354]]
(94770,)
(94770,)
roc_auc: 0.495583730902
log_loss: 2.03996803876
roc_auc for the hours: 0.506849315068
log_loss for the hours: 1.80411544545
saving predictions to csv file
hourspatient1_2_net11_10-10-13-12-07.csv
Accuracy validation for the hours:  0.333333333333
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [2]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.100894208
saving predictions to csv file
patient1_2_net11_10-10-13-39-32.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_3']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_3'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-10 13:39:33.491359
Hostname: kat
gpu2
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net11
evaluation:
    online_training: False
    model: net11

end Configuration
['patient1_3']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [3]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.749043712
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 19.1249866486 16.0321680069
20 110.960594177 117.977423096
30 462.367929077 465.247445679
40 726.516931152 722.714147949
50 983.638244629 972.796356201
60 1269.06445312 1248.00100098
70 1619.77319336 1586.1126709
80 2106.37036133 2054.18427734
90 2963.09577637 2880.79763184
100 141686.875 89649.6484375
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net11
Model name for the evaluation phase:  net11
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m2.10914[0m     [32m0.70623[0m    2.98647      0.39962  15.11s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      2     [36m0.69069[0m     0.72803    0.94871      0.38128  15.12s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      3     [36m0.68227[0m     0.73084    0.93354      0.38437  15.17s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      4     [36m0.67582[0m     0.70943    0.95262      0.49824  15.37s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      5     0.67968     0.75901    0.89549      0.38343  15.64s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      6     [36m0.65524[0m     0.74435    0.88029      0.40174  15.63s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      7     [36m0.65127[0m     0.73837    0.88203      0.42305  15.72s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      8     [36m0.65008[0m     0.73590    0.88338      0.45543  16.58s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      9     [36m0.64975[0m     0.75964    0.85534      0.42622  16.70s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     10     [36m0.64767[0m     0.76497    0.84666      0.41692  17.05s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     11     [36m0.64042[0m     0.78278    0.81813      0.44565  17.06s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
Early stopping.
Best valid loss was 0.706233 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 0 0 0 1 0 0 0 1 0 0 0 1 0 0 0 1 0 0 0 1 0 0 0 1 0 0 0 1 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.70961274665
Error rate (%):  29.038725335
[[66895 21800]
 [ 5720   355]]
(94770,)
(94770,)
roc_auc: 0.397169397972
log_loss: 0.551784357868
roc_auc for the hours: 0.342465753425
log_loss for the hours: 0.505400775048
saving predictions to csv file
hourspatient1_3_net11_10-10-14-30-34.csv
Accuracy validation for the hours:  0.769230769231
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [3]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.046892544
saving predictions to csv file
patient1_3_net11_10-10-14-54-17.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_4']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_4'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-10 14:54:18.208696
Hostname: kat
gpu2
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net11
evaluation:
    online_training: False
    model: net11

end Configuration
['patient1_4']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [4]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.809947136
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 235.407817078 219.809516907
20 571.790344238 556.848303223
30 840.501837158 821.775939941
40 1116.47878418 1091.31035156
50 1434.89074707 1400.26373291
60 1840.24331055 1790.55202637
70 2408.61494141 2333.43139648
80 3297.89345703 3176.70976563
90 4956.27602539 4739.19238281
100 52009.53125 38008.9335938
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net11
Model name for the evaluation phase:  net11
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m3.28781[0m     [32m0.71208[0m    4.61717      0.49810  15.65s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      2     [36m0.72993[0m     0.72145    1.01176      0.49959  15.57s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      3     [36m0.70788[0m     0.71747    0.98663      0.50014  15.42s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      4     [36m0.70426[0m     [32m0.71136[0m    0.99001      0.49932  15.63s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      5     [36m0.69917[0m     0.72409    0.96559      0.49919  15.58s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      6     0.70055     [32m0.71128[0m    0.98491      0.51672  16.72s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      7     [36m0.69502[0m     0.72138    0.96345      0.50230  16.99s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      8     [36m0.68898[0m     0.71661    0.96144      0.53125  17.05s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      9     [36m0.68792[0m     0.71869    0.95718      0.52946  17.29s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     10     0.68834     0.72089    0.95484      0.53971  17.00s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     11     [36m0.68609[0m     0.72334    0.94850      0.54269  16.71s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     12     [36m0.68387[0m     0.71452    0.95709      0.54700  16.83s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     13     [36m0.67365[0m     0.71893    0.93702      0.55324  16.94s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     14     0.67810     0.71256    0.95164      0.55429  16.74s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     15     0.67541     0.71848    0.94006      0.53657  16.90s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     16     [36m0.67161[0m     0.71386    0.94081      0.55406  16.74s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
Early stopping.
Best valid loss was 0.711277 at epoch 6.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.235686398649
Error rate (%):  76.4313601351
[[18065 70630]
 [ 1804  4271]]
(94770,)
(94770,)
roc_auc: 0.38308413282
log_loss: 1.14844200058
roc_auc for the hours: 0.345205479452
log_loss for the hours: 1.07196002205
saving predictions to csv file
hourspatient1_4_net11_10-10-15-04-04.csv
Accuracy validation for the hours:  0.230769230769
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [4]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.098674176
saving predictions to csv file
patient1_4_net11_10-10-15-07-08.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_5']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_5'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-10 15:07:09.655627
Hostname: kat
gpu2
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net11
evaluation:
    online_training: False
    model: net11

end Configuration
['patient1_5']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [5]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.810016768
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 231.335012817 211.108001709
20 564.578271484 538.999780273
30 830.936474609 795.66987915
40 1104.11230469 1055.32932129
50 1420.78125 1352.56451416
60 1826.70258789 1730.86726074
70 2401.11716309 2262.68579102
80 3287.26503906 3085.56469727
90 4899.46132813 4571.94418945
100 55591.203125 52662.2460938
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net11
Model name for the evaluation phase:  net11
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m3.15675[0m     [32m0.71997[0m    4.38458      0.50054  15.86s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      2     [36m0.72920[0m     0.73916    0.98652      0.49959  15.79s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      3     [36m0.70381[0m     0.73200    0.96149      0.50122  15.89s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      4     [36m0.69794[0m     [32m0.70782[0m    0.98605      0.50771  15.88s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      5     [36m0.68859[0m     0.72292    0.95250      0.50459  16.49s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      6     [36m0.68607[0m     0.72672    0.94406      0.50530  17.31s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      7     [36m0.68161[0m     0.72254    0.94335      0.51501  17.24s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      8     [36m0.67733[0m     [32m0.70685[0m    0.95824      0.52500  17.13s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      9     0.67849     0.71336    0.95112      0.52108  16.66s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     10     [36m0.67382[0m     [32m0.69951[0m    0.96329      0.52209  16.88s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     11     [36m0.67207[0m     0.71755    0.93661      0.52155  16.92s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     12     [36m0.66507[0m     0.71826    0.92594      0.53485  17.22s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     13     [36m0.65880[0m     0.70900    0.92919      0.52730  16.82s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     14     [36m0.65767[0m     0.72825    0.90309      0.52721  16.68s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     15     [36m0.65668[0m     [32m0.68070[0m    0.96472      0.55897  16.69s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     16     [36m0.65553[0m     0.69375    0.94491      0.52359  16.56s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     17     [36m0.65302[0m     0.69617    0.93801      0.53875  16.75s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     18     [36m0.64917[0m     0.69656    0.93196      0.53583  16.69s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     19     [36m0.64916[0m     0.69296    0.93679      0.53564  16.68s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     20     0.65111     0.70023    0.92985      0.53686  16.63s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     21     [36m0.64354[0m     0.69562    0.92513      0.53621  16.81s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     22     0.64697     0.70567    0.91682      0.51126  16.79s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     23     [36m0.63769[0m     0.70718    0.90173      0.52309  16.71s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     24     [36m0.63235[0m     0.70811    0.89302      0.50651  16.64s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     25     [36m0.61923[0m     0.72112    0.85870      0.52299  16.83s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
Early stopping.
Best valid loss was 0.680697 at epoch 15.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.802099820618
Error rate (%):  19.7900179382
[[74565 14130]
 [ 4625  1450]]
(94770,)
(94770,)
roc_auc: 0.590973915557
log_loss: 0.518062307306
roc_auc for the hours: 0.646575342466
log_loss for the hours: 0.325508598782
saving predictions to csv file
hourspatient1_5_net11_10-10-15-18-53.csv
Accuracy validation for the hours:  0.897435897436
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [5]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.048408064
saving predictions to csv file
patient1_5_net11_10-10-15-21-55.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_6']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_6'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-10 15:21:56.718666
Hostname: kat
gpu2
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net11
evaluation:
    online_training: False
    model: net11

end Configuration
['patient1_6']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [6]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.809476096
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 199.270783997 178.304678345
20 484.265484619 454.425598145
30 715.207281494 673.034472656
40 957.550097656 897.335144043
50 1246.79968262 1160.86651611
60 1628.27236328 1502.71569824
70 2172.52145996 1989.60817871
80 3015.20869141 2745.85849609
90 4633.05883789 4178.59511719
100 66751.359375 59361.5703125
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net11
Model name for the evaluation phase:  net11
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m2.86318[0m     [32m0.72785[0m    3.93377      0.50027  15.90s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      2     [36m0.73002[0m     [32m0.71325[0m    1.02351      0.49986  15.94s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      3     [36m0.70738[0m     [32m0.69882[0m    1.01225      0.50555  15.84s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      4     [36m0.69869[0m     [32m0.68621[0m    1.01819      0.54314  16.06s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      5     [36m0.69219[0m     0.69032    1.00270      0.52509  16.68s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      6     [36m0.68953[0m     0.69184    0.99667      0.51889  17.47s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      7     [36m0.68136[0m     [32m0.66727[0m    1.02113      0.62889  17.38s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      8     [36m0.67619[0m     [32m0.65264[0m    1.03609      0.65326  17.18s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      9     0.67694     0.65945    1.02652      0.62324  16.90s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     10     [36m0.67323[0m     0.66118    1.01823      0.63866  16.95s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     11     0.67385     0.65806    1.02399      0.62537  16.97s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     12     [36m0.65862[0m     [32m0.64990[0m    1.01341      0.63452  17.01s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     13     [36m0.65572[0m     [32m0.64699[0m    1.01350      0.62811  17.03s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     14     [36m0.65091[0m     [32m0.64498[0m    1.00921      0.63607  16.77s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     15     [36m0.64805[0m     0.64879    0.99887      0.62510  16.88s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     16     [36m0.63731[0m     0.64678    0.98536      0.55999  16.78s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     17     0.63774     [32m0.63854[0m    0.99876      0.63138  16.76s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     18     [36m0.63658[0m     0.65003    0.97932      0.62948  16.70s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     19     [36m0.63510[0m     [32m0.63133[0m    1.00597      0.63931  16.67s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     20     [36m0.61739[0m     0.63135    0.97789      0.63624  16.59s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     21     [36m0.61669[0m     0.64235    0.96005      0.63087  16.55s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     22     [36m0.60624[0m     0.64499    0.93993      0.63358  16.71s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     23     [36m0.60163[0m     0.64940    0.92644      0.63064  16.71s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     24     [36m0.58985[0m     0.66154    0.89163      0.62839  16.77s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     25     [36m0.57742[0m     0.63998    0.90225      0.63764  16.75s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     26     [36m0.56225[0m     0.67811    0.82914      0.63035  16.68s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     27     [36m0.55433[0m     0.65199    0.85020      0.63955  16.65s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     28     [36m0.53643[0m     0.70076    0.76549      0.61480  16.67s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     29     [36m0.53413[0m     0.70996    0.75234      0.62235  16.60s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
Early stopping.
Best valid loss was 0.631334 at epoch 19.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.811944708241
Error rate (%):  18.8055291759
[[76341 12354]
 [ 5468   607]]
(94770,)
(94770,)
roc_auc: 0.638912454644
log_loss: 0.432251837862
roc_auc for the hours: 0.602739726027
log_loss for the hours: 0.292333761807
saving predictions to csv file
hourspatient1_6_net11_10-10-15-35-00.csv
Accuracy validation for the hours:  0.910256410256
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [6]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.04800256
saving predictions to csv file
patient1_6_net11_10-10-15-38-04.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_7']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_7'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-10 15:38:05.605262
Hostname: kat
gpu2
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net11
evaluation:
    online_training: False
    model: net11

end Configuration
['patient1_7']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [7]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.809467904
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 182.900706482 163.150218201
20 446.00692749 416.755505371
30 662.357696533 620.480499268
40 892.956396484 834.12010498
50 1172.0982666 1087.89544678
60 1542.81384277 1420.86425781
70 2076.69821777 1899.79864502
80 2929.02983398 2668.57714844
90 4619.13442383 4199.77285156
100 65353.1796875 57503.8945312
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net11
Model name for the evaluation phase:  net11
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m2.77460[0m     [32m0.72950[0m    3.80344      0.49918  15.58s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      2     [36m0.72465[0m     [32m0.70270[0m    1.03125      0.50936  15.76s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      3     [36m0.69756[0m     [32m0.68163[0m    1.02337      0.56045  15.69s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      4     [36m0.68162[0m     [32m0.65863[0m    1.03490      0.60454  15.83s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      5     [36m0.66979[0m     [32m0.64125[0m    1.04451      0.63276  16.58s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      6     [36m0.66688[0m     [32m0.63920[0m    1.04330      0.63985  17.32s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      7     [36m0.64890[0m     [32m0.63443[0m    1.02280      0.63971  16.90s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      8     [36m0.64201[0m     [32m0.62292[0m    1.03065      0.63723  17.08s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      9     [36m0.64143[0m     0.62545    1.02555      0.61405  17.06s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     10     [36m0.63139[0m     0.63109    1.00047      0.64353  16.86s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     11     [36m0.62006[0m     0.65321    0.94925      0.54541  17.06s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     12     [36m0.61085[0m     0.63401    0.96346      0.63479  16.72s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     13     0.61109     0.62315    0.98064      0.64135  16.67s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     14     [36m0.61057[0m     0.64067    0.95301      0.63011  16.55s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     15     [36m0.60177[0m     0.62421    0.96406      0.63185  16.45s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     16     0.60316     0.62778    0.96078      0.63656  16.44s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     17     [36m0.59904[0m     [32m0.62192[0m    0.96320      0.63030  16.46s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     18     0.60075     0.63512    0.94588      0.58198  16.47s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     19     [36m0.59072[0m     0.62667    0.94264      0.62554  16.54s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     20     0.59211     0.62522    0.94704      0.64434  16.53s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     21     [36m0.58816[0m     0.62520    0.94076      0.63466  16.66s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     22     [36m0.58528[0m     [32m0.60835[0m    0.96208      0.64090  16.88s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     23     [36m0.58429[0m     0.63552    0.91938      0.60755  16.63s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     24     [36m0.57751[0m     0.63109    0.91509      0.62568  16.71s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     25     0.58209     0.62460    0.93194      0.63656  16.62s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     26     0.58460     0.63374    0.92246      0.60678  16.68s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     27     [36m0.56965[0m     [32m0.60762[0m    0.93750      0.65234  16.47s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     28     [36m0.56308[0m     0.62064    0.90726      0.62588  16.92s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     29     [36m0.54588[0m     0.61316    0.89027      0.63592  17.07s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     30     [36m0.53189[0m     0.64648    0.82275      0.61144  17.05s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     31     [36m0.51628[0m     0.64133    0.80501      0.62811  17.18s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     32     [36m0.50708[0m     0.62161    0.81576      0.64055  17.10s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     33     [36m0.48876[0m     0.65872    0.74198      0.62050  16.86s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     34     [36m0.48580[0m     0.69482    0.69918      0.61714  16.49s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     35     [36m0.46186[0m     0.67941    0.67980      0.63355  16.79s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     36     [36m0.44480[0m     0.65688    0.67714      0.64194  16.73s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     37     0.44753     0.68419    0.65410      0.63107  16.75s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
Early stopping.
Best valid loss was 0.607621 at epoch 27.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.726938904717
Error rate (%):  27.3061095283
[[65785 22910]
 [ 2968  3107]]
(94770,)
(94770,)
roc_auc: 0.706927764891
log_loss: 0.793238350989
roc_auc for the hours: 0.778082191781
log_loss for the hours: 0.37397831045
saving predictions to csv file
hourspatient1_7_net11_10-10-15-55-58.csv
Accuracy validation for the hours:  0.820512820513
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [7]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.098985472
saving predictions to csv file
patient1_7_net11_10-10-15-59-03.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_8']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_8'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-10 15:59:04.180380
Hostname: kat
gpu2
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net11
evaluation:
    online_training: False
    model: net11

end Configuration
['patient1_8']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [8]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.809725952
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 179.447947693 164.423493958
20 434.278393555 418.093994141
30 634.319030762 613.24385376
40 834.442565918 807.11171875
50 1056.00579834 1020.13357544
60 1321.37426758 1274.3189209
70 1666.15869141 1603.34324951
80 2169.84814453 2082.13676758
90 3113.30068359 2981.24484863
100 59862.1054688 57871.4179688
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net11
Model name for the evaluation phase:  net11
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m2.39146[0m     [32m0.71008[0m    3.36786      0.50571  15.54s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      2     [36m0.69129[0m     [32m0.67143[0m    1.02958      0.51995  15.61s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      3     [36m0.67035[0m     [32m0.67106[0m    0.99893      0.49716  15.65s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      4     [36m0.66450[0m     0.67775    0.98045      0.46768  15.87s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      5     [36m0.66143[0m     [32m0.66087[0m    1.00084      0.58985  16.99s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      6     0.66493     0.66629    0.99797      0.54254  16.92s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      7     [36m0.65782[0m     0.66966    0.98232      0.49121  16.83s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      8     [36m0.65037[0m     0.67095    0.96934      0.47826  16.80s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      9     [36m0.64556[0m     0.66552    0.97000      0.50270  16.79s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     10     0.64587     [32m0.65844[0m    0.98091      0.53863  16.90s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     11     0.64641     0.65987    0.97961      0.52914  16.80s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     12     [36m0.63838[0m     0.66054    0.96646      0.52404  16.73s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     13     [36m0.63078[0m     [32m0.65325[0m    0.96560      0.57000  16.86s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     14     [36m0.62862[0m     [32m0.65078[0m    0.96595      0.59247  16.71s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     15     [36m0.62333[0m     [32m0.65014[0m    0.95877      0.60243  16.66s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     16     [36m0.62222[0m     0.65835    0.94512      0.59720  16.71s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     17     [36m0.61756[0m     0.66606    0.92719      0.59141  16.65s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     18     [36m0.61457[0m     0.67182    0.91479      0.58659  16.65s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     19     [36m0.61301[0m     0.68219    0.89859      0.58882  16.68s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     20     [36m0.60883[0m     0.65707    0.92657      0.57926  16.60s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     21     [36m0.60145[0m     0.65315    0.92084      0.58177  16.82s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     22     [36m0.59459[0m     [32m0.64765[0m    0.91808      0.58855  16.84s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     23     [36m0.59099[0m     0.65674    0.89988      0.58419  16.79s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     24     [36m0.58269[0m     0.67121    0.86812      0.58795  16.59s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     25     [36m0.57876[0m     0.67252    0.86059      0.55489  16.93s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     26     [36m0.56537[0m     0.65133    0.86803      0.59621  16.59s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     27     [36m0.56139[0m     0.65721    0.85420      0.60310  16.56s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     28     [36m0.55116[0m     0.67180    0.82043      0.58239  16.54s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     29     [36m0.53047[0m     0.70877    0.74845      0.56321  16.58s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     30     [36m0.51810[0m     0.70343    0.73654      0.57782  17.07s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     31     [36m0.50978[0m     0.68092    0.74866      0.58054  16.67s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     32     [36m0.49378[0m     0.77220    0.63945      0.50935  16.55s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
Early stopping.
Best valid loss was 0.647647 at epoch 22.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 0 1 0 1 1 1 0 0 0 0 0 0 1 0 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.457961380184
Error rate (%):  54.2038619816
[[39167 49528]
 [ 1841  4234]]
(94770,)
(94770,)
roc_auc: 0.617181259029
log_loss: 2.09021661068
roc_auc for the hours: 0.641095890411
log_loss for the hours: 0.999293154959
saving predictions to csv file
hourspatient1_8_net11_10-10-16-12-30.csv
Accuracy validation for the hours:  0.461538461538
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [8]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.048285184
saving predictions to csv file
patient1_8_net11_10-10-16-15-33.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_9']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_9'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-10 16:15:34.252054
Hostname: kat
gpu2
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net11
evaluation:
    online_training: False
    model: net11

end Configuration
['patient1_9']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [9]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.810319872
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 3.68383948803 3.51945617199
20 8.91916770935 8.73870506287
30 13.5332503319 13.2244482994
40 19.6162849426 18.9431503296
50 42.7269630432 33.8711013794
60 446.623547363 383.009014893
70 778.942749023 709.81932373
80 1201.11340332 1105.85910645
90 1927.03088379 1777.32213135
100 43853.8789062 40357.3945312
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net11
Model name for the evaluation phase:  net11
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m2.17783[0m     [32m0.68557[0m    3.17669      0.49864  15.47s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      2     [36m0.70645[0m     0.69041    1.02322      0.51805  15.52s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      3     [36m0.70148[0m     0.69221    1.01338      0.48228  15.58s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      4     0.70579     0.68847    1.02516      0.53963  15.97s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      5     [36m0.69795[0m     0.69590    1.00294      0.44253  17.01s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      6     [36m0.69470[0m     0.69664    0.99721      0.43979  17.01s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      7     [36m0.69445[0m     0.69818    0.99466      0.43900  16.85s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      8     [36m0.69372[0m     0.68984    1.00562      0.52880  16.92s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      9     0.69697     0.69749    0.99924      0.43757  16.71s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     10     [36m0.69190[0m     0.69550    0.99484      0.44077  16.61s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     11     [36m0.69065[0m     0.69557    0.99294      0.44592  16.60s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
Early stopping.
Best valid loss was 0.685566 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.0691885617812
Error rate (%):  93.0811438219
[[  482 88213]
 [    0  6075]]
(94770,)
(94770,)
roc_auc: 0.612649373854
log_loss: 1.30217394866
roc_auc for the hours: 0.646575342466
log_loss for the hours: 1.24588642136
saving predictions to csv file
hourspatient1_9_net11_10-10-16-23-07.csv
Accuracy validation for the hours:  0.0641025641026
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [9]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.048272896
saving predictions to csv file
patient1_9_net11_10-10-16-26-19.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_10']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_10'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-10 16:26:20.041899
Hostname: kat
gpu2
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net11
evaluation:
    online_training: False
    model: net11

end Configuration
['patient1_10']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [10]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.808718336
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 181.207902527 167.670619202
20 438.332196045 424.686590576
30 639.719543457 622.390942383
40 839.969042969 817.731738281
50 1060.19781494 1030.7331543
60 1320.43032227 1280.04846191
70 1650.03087158 1595.78609619
80 2111.48989258 2038.48054199
90 2911.55273438 2807.46408691
100 41643.4882812 36225.46875
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net11
Model name for the evaluation phase:  net11
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m2.09989[0m     [32m0.71237[0m    2.94774      0.49755  15.65s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      2     [36m0.69956[0m     [32m0.68211[0m    1.02558      0.54518  15.58s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      3     [36m0.68184[0m     0.68287    0.99848      0.52204  15.81s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      4     [36m0.67569[0m     0.68555    0.98561      0.52664  15.94s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      5     [36m0.67304[0m     0.69393    0.96991      0.55154  16.80s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      6     [36m0.67187[0m     0.68846    0.97590      0.50829  17.04s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      7     [36m0.66452[0m     0.68959    0.96365      0.51718  16.84s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      8     [36m0.66297[0m     0.69103    0.95940      0.52745  17.00s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      9     [36m0.65593[0m     0.69113    0.94908      0.53486  16.97s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     10     [36m0.65319[0m     0.68321    0.95607      0.53429  16.97s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     11     [36m0.65223[0m     0.68912    0.94647      0.53050  17.04s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     12     [36m0.64133[0m     0.69021    0.92919      0.50324  17.04s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
Early stopping.
Best valid loss was 0.682111 at epoch 2.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.18437269178
Error rate (%):  81.562730822
[[11791 76904]
 [  393  5682]]
(94770,)
(94770,)
roc_auc: 0.551948386492
log_loss: 1.58004094241
roc_auc for the hours: 0.553424657534
log_loss for the hours: 1.40792620706
saving predictions to csv file
hourspatient1_10_net11_10-10-16-34-12.csv
Accuracy validation for the hours:  0.192307692308
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [10]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.046810624
saving predictions to csv file
patient1_10_net11_10-10-16-37-47.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_11']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_11'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-10 16:37:49.074910
Hostname: kat
gpu2
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net11
evaluation:
    online_training: False
    model: net11

end Configuration
['patient1_11']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [11]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.809816064
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 172.641601563 159.5427948
20 417.636303711 403.23772583
30 608.427856445 589.179815674
40 796.191516113 769.670605469
50 999.883514404 964.325683594
60 1236.0432373 1189.17692871
70 1532.10228271 1470.09255371
80 1945.44143066 1860.52646484
90 2669.32939453 2545.69404297
100 34311.5273438 30092.4199219
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net11
Model name for the evaluation phase:  net11
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m2.05525[0m     [32m0.75104[0m    2.73653      0.49728  15.89s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      2     [36m0.68108[0m     [32m0.71963[0m    0.94643      0.54410  15.88s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      3     [36m0.65808[0m     0.73742    0.89241      0.54395  15.82s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      4     [36m0.64898[0m     0.74146    0.87528      0.54747  16.06s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      5     [36m0.64000[0m     0.72292    0.88530      0.54830  16.50s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      6     [36m0.63159[0m     0.73557    0.85864      0.55205  17.42s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      7     [36m0.62710[0m     0.72432    0.86578      0.54233  17.18s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      8     [36m0.61936[0m     0.73011    0.84832      0.52418  17.15s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      9     [36m0.61212[0m     0.72434    0.84508      0.55703  17.17s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     10     [36m0.60409[0m     [32m0.71910[0m    0.84007      0.51884  17.12s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     11     [36m0.59038[0m     [32m0.71842[0m    0.82177      0.51125  17.12s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     12     [36m0.57748[0m     0.74097    0.77936      0.44679  17.09s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     13     [36m0.56736[0m     0.74593    0.76060      0.55595  17.14s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     14     0.57241     0.74122    0.77225      0.58489  17.14s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     15     [36m0.56404[0m     0.81008    0.69627      0.58947  17.09s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     16     [36m0.55510[0m     0.82462    0.67316      0.59423  17.16s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     17     [36m0.55305[0m     0.73670    0.75071      0.52903  17.01s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     18     [36m0.53957[0m     0.74498    0.72428      0.55619  17.16s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     19     [36m0.53158[0m     0.75873    0.70061      0.52889  17.09s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     20     [36m0.53087[0m     0.79867    0.66469      0.46611  17.09s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     21     [36m0.52362[0m     0.77332    0.67711      0.47952  17.06s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
Early stopping.
Best valid loss was 0.718419 at epoch 11.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.552157855862
Error rate (%):  44.7842144138
[[50576 38119]
 [ 4323  1752]]
(94770,)
(94770,)
roc_auc: 0.468812139999
log_loss: inf
roc_auc for the hours: 0.421917808219
log_loss for the hours: 0.768549243149
saving predictions to csv file
hourspatient1_11_net11_10-10-16-48-23.csv
Accuracy validation for the hours:  0.576923076923
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [11]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.047891968
saving predictions to csv file
patient1_11_net11_10-10-16-51-29.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_12']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_12'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-10 16:51:30.944171
Hostname: kat
gpu2
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net11
evaluation:
    online_training: False
    model: net11

end Configuration
['patient1_12']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [12]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.813051904
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 194.413856506 178.851933289
20 463.675524902 446.537554932
30 666.165478516 644.010736084
40 859.942541504 831.373522949
50 1065.9508667 1029.34899902
60 1304.29125977 1256.71569824
70 1606.91943359 1543.18864746
80 2047.88012695 1958.46350098
90 2871.70686035 2742.33198242
100 68176.640625 59867.6914062
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net11
Model name for the evaluation phase:  net11
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m2.13520[0m     [32m0.80758[0m    2.64396      0.50000  15.34s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      2     [36m0.67764[0m     [32m0.74595[0m    0.90843      0.54708  15.71s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      3     [36m0.66557[0m     [32m0.73243[0m    0.90871      0.55532  15.54s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      4     [36m0.65718[0m     [32m0.72176[0m    0.91053      0.55991  16.04s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      5     [36m0.65267[0m     [32m0.71593[0m    0.91164      0.56395  16.64s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      6     [36m0.65057[0m     [32m0.71182[0m    0.91395      0.56211  17.18s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      7     [36m0.64136[0m     [32m0.70854[0m    0.90518      0.56018  17.28s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      8     [36m0.63771[0m     [32m0.70105[0m    0.90966      0.56848  17.26s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      9     [36m0.63103[0m     [32m0.68831[0m    0.91679      0.56622  17.38s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     10     [36m0.62775[0m     [32m0.67142[0m    0.93496      0.57007  17.27s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     11     [36m0.62188[0m     0.70738    0.87914      0.56953  17.32s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     12     0.62358     0.68960    0.90425      0.56429  17.23s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     13     [36m0.61292[0m     0.67497    0.90806      0.57703  17.25s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     14     [36m0.61088[0m     [32m0.64561[0m    0.94621      0.58299  17.08s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     15     [36m0.60269[0m     [32m0.64214[0m    0.93857      0.59298  17.00s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     16     [36m0.59299[0m     [32m0.63275[0m    0.93716      0.61041  17.04s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     17     [36m0.58728[0m     0.63710    0.92180      0.60735  17.19s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     18     [36m0.58099[0m     0.63967    0.90827      0.61998  17.09s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     19     [36m0.56844[0m     0.66545    0.85422      0.62986  17.13s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     20     [36m0.56014[0m     0.65201    0.85910      0.60735  17.18s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     21     [36m0.54685[0m     0.68674    0.79630      0.62219  17.74s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     22     [36m0.54355[0m     0.66701    0.81491      0.63385  17.67s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     23     [36m0.53297[0m     0.67780    0.78632      0.61271  17.10s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     24     [36m0.51980[0m     0.69385    0.74915      0.61998  17.13s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     25     [36m0.51264[0m     0.67538    0.75905      0.59924  16.99s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     26     [36m0.50823[0m     0.72555    0.70047      0.61897  17.02s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
Early stopping.
Best valid loss was 0.632750 at epoch 16.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.623899968344
Error rate (%):  37.6100031656
[[55968 32727]
 [ 2916  3159]]
(94770,)
(94770,)
roc_auc: 0.647180056869
log_loss: 0.783077227105
roc_auc for the hours: 0.709589041096
log_loss for the hours: 0.52969845533
saving predictions to csv file
hourspatient1_12_net11_10-10-17-03-29.csv
Accuracy validation for the hours:  0.74358974359
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [12]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.051582464
saving predictions to csv file
patient1_12_net11_10-10-17-06-35.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_13']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_13'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-10 17:06:36.722801
Hostname: kat
gpu2
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net11
evaluation:
    online_training: False
    model: net11

end Configuration
['patient1_13']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [13]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.812654592
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 197.41583252 182.761578369
20 473.741113281 459.648413086
30 683.193365479 665.443499756
40 884.565112305 862.165649414
50 1098.331604 1068.85339355
60 1343.71057129 1304.4578125
70 1651.5090332 1598.25623779
80 2090.38417969 2016.00366211
90 2902.72646484 2791.59272461
100 37327.25 36955.34375
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net11
Model name for the evaluation phase:  net11
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m2.19555[0m     [32m0.74065[0m    2.96436      0.49782  15.26s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      2     [36m0.68689[0m     [32m0.69636[0m    0.98640      0.56228  15.37s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      3     [36m0.66904[0m     [32m0.68888[0m    0.97120      0.58372  15.35s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      4     [36m0.65951[0m     [32m0.67424[0m    0.97815      0.59291  15.45s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      5     [36m0.65458[0m     [32m0.67180[0m    0.97438      0.59498  16.90s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      6     [36m0.64967[0m     [32m0.65803[0m    0.98728      0.60424  17.07s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      7     [36m0.64398[0m     [32m0.65046[0m    0.99003      0.61049  17.24s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      8     [36m0.64128[0m     0.66335    0.96673      0.59918  17.29s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      9     [36m0.63544[0m     [32m0.63739[0m    0.99694      0.61676  17.23s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     10     0.63756     [32m0.62343[0m    1.02267      0.60829  17.32s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     11     [36m0.63219[0m     0.62858    1.00574      0.61968  17.30s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     12     [36m0.62980[0m     0.63618    0.98997      0.61588  17.08s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     13     [36m0.62630[0m     0.63355    0.98857      0.61784  17.25s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     14     [36m0.61698[0m     0.64040    0.96344      0.60385  16.95s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     15     [36m0.61461[0m     0.63170    0.97293      0.62213  17.13s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     16     0.61522     0.62538    0.98375      0.62524  17.22s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     17     [36m0.61265[0m     [32m0.62158[0m    0.98564      0.62328  17.19s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     18     [36m0.60593[0m     [32m0.61268[0m    0.98898      0.64115  17.15s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     19     [36m0.60014[0m     [32m0.60518[0m    0.99167      0.65740  17.04s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     20     [36m0.58338[0m     0.62664    0.93097      0.63624  17.08s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     21     [36m0.57516[0m     0.61681    0.93248      0.65961  17.11s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     22     [36m0.56378[0m     0.61510    0.91657      0.66667  17.00s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     23     [36m0.55711[0m     0.61856    0.90066      0.66133  16.99s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     24     [36m0.54500[0m     0.61281    0.88934      0.63626  16.98s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     25     [36m0.53167[0m     0.62029    0.85713      0.60438  17.17s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     26     [36m0.52851[0m     0.63529    0.83192      0.64417  17.09s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     27     [36m0.50523[0m     0.62545    0.80779      0.64445  17.05s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     28     [36m0.49326[0m     0.62758    0.78598      0.64425  17.02s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     29     [36m0.47404[0m     0.64831    0.73120      0.61123  17.07s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
Early stopping.
Best valid loss was 0.605177 at epoch 19.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.599029228659
Error rate (%):  40.0970771341
[[52616 36079]
 [ 1921  4154]]
(94770,)
(94770,)
roc_auc: 0.71350627909
log_loss: 0.958918578191
roc_auc for the hours: 0.767123287671
log_loss for the hours: 0.611543615634
saving predictions to csv file
hourspatient1_13_net11_10-10-17-19-19.csv
Accuracy validation for the hours:  0.628205128205
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [13]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.05101312
saving predictions to csv file
patient1_13_net11_10-10-17-22-22.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_14']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_14'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-10 17:22:23.627707
Hostname: kat
gpu2
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net11
evaluation:
    online_training: False
    model: net11

end Configuration
['patient1_14']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [14]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.812126208
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 189.141261292 174.980825806
20 452.630731201 438.836401367
30 649.66987915 632.660009766
40 836.557116699 814.948742676
50 1031.56469727 1003.98742676
60 1251.25163574 1216.06953125
70 1519.30529785 1471.67954102
80 1885.33984375 1820.3204834
90 2516.96833496 2415.86462402
100 43412.1367188 33402.015625
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net11
Model name for the evaluation phase:  net11
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m1.98555[0m     [32m0.73848[0m    2.68871      0.49728  15.26s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      2     [36m0.69196[0m     [32m0.69364[0m    0.99757      0.53623  15.30s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      3     [36m0.67616[0m     [32m0.68911[0m    0.98121      0.55477  15.40s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      4     [36m0.66731[0m     [32m0.67780[0m    0.98452      0.56803  15.47s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      5     [36m0.66175[0m     [32m0.66705[0m    0.99206      0.57852  16.50s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      6     [36m0.65779[0m     0.66797    0.98476      0.57706  16.85s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      7     [36m0.65102[0m     0.66902    0.97310      0.57263  16.68s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      8     [36m0.64892[0m     [32m0.64325[0m    1.00882      0.59891  17.17s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      9     [36m0.64021[0m     [32m0.63851[0m    1.00266      0.59892  17.22s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     10     [36m0.63965[0m     0.64732    0.98814      0.59366  17.22s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     11     [36m0.63824[0m     [32m0.63715[0m    1.00171      0.60098  17.13s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     12     [36m0.63189[0m     [32m0.63704[0m    0.99190      0.60346  17.25s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     13     [36m0.62662[0m     [32m0.63495[0m    0.98689      0.60405  17.03s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     14     [36m0.62538[0m     0.63607    0.98320      0.60601  17.12s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     15     [36m0.62306[0m     0.65135    0.95656      0.59406  17.12s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     16     [36m0.61735[0m     0.63663    0.96972      0.61283  17.23s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     17     0.61757     [32m0.63072[0m    0.97915      0.61194  17.06s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     18     [36m0.61135[0m     0.66059    0.92547      0.60098  17.00s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     19     [36m0.60333[0m     0.67474    0.89417      0.58882  17.12s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     20     [36m0.59518[0m     0.63258    0.94088      0.63408  17.17s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     21     [36m0.59221[0m     [32m0.62131[0m    0.95316      0.61486  17.04s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     22     [36m0.57415[0m     [32m0.61909[0m    0.92742      0.60917  16.98s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     23     [36m0.56841[0m     0.65263    0.87095      0.62412  17.03s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     24     [36m0.55164[0m     0.64381    0.85683      0.61319  17.08s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     25     [36m0.53725[0m     0.64103    0.83811      0.61330  17.09s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     26     [36m0.51716[0m     0.68622    0.75363      0.60298  16.96s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     27     [36m0.51271[0m     0.66179    0.77474      0.60963  17.00s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     28     [36m0.49252[0m     0.66745    0.73792      0.60940  17.01s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     29     [36m0.48868[0m     0.67479    0.72420      0.61910  17.10s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     30     [36m0.46626[0m     0.71553    0.65162      0.60331  17.01s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     31     [36m0.45692[0m     0.75774    0.60300      0.60270  17.07s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     32     [36m0.43931[0m     0.72933    0.60235      0.60802  16.99s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
Early stopping.
Best valid loss was 0.619089 at epoch 22.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.684931940487
Error rate (%):  31.5068059513
[[62146 26549]
 [ 3310  2765]]
(94770,)
(94770,)
roc_auc: 0.652690813318
log_loss: 1.02386722757
roc_auc for the hours: 0.671232876712
log_loss for the hours: 0.467716000158
saving predictions to csv file
hourspatient1_14_net11_10-10-17-36-07.csv
Accuracy validation for the hours:  0.807692307692
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [14]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.101213696
saving predictions to csv file
patient1_14_net11_10-10-17-39-12.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_15']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_15'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-10 17:39:13.727160
Hostname: kat
gpu2
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net11
evaluation:
    online_training: False
    model: net11

end Configuration
['patient1_15']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [15]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.812498944
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 192.412426758 176.768930054
20 459.689099121 442.431689453
30 658.81307373 637.209912109
40 846.730224609 819.873974609
50 1042.01245117 1009.00811768
60 1261.45869141 1219.99689941
70 1528.8362793 1476.44569092
80 1896.24025879 1829.35996094
90 2539.709375 2448.71398926
100 29197.0292969 29615.0136719
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net11
Model name for the evaluation phase:  net11
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m2.06146[0m     [32m0.71685[0m    2.87571      0.49755  15.26s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      2     [36m0.68751[0m     [32m0.69860[0m    0.98413      0.55441  15.31s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      3     [36m0.67458[0m     0.69969    0.96410      0.55640  15.40s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      4     [36m0.66674[0m     [32m0.69752[0m    0.95587      0.56424  15.45s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      5     [36m0.66090[0m     [32m0.68684[0m    0.96223      0.56881  16.34s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      6     [36m0.65475[0m     [32m0.68375[0m    0.95759      0.57081  16.48s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      7     [36m0.64929[0m     0.68866    0.94283      0.56965  16.46s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      8     [36m0.64623[0m     [32m0.67106[0m    0.96299      0.58587  16.85s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      9     0.64711     [32m0.65734[0m    0.98443      0.59162  17.02s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     10     [36m0.64029[0m     0.65750    0.97384      0.59257  16.97s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     11     [36m0.64015[0m     [32m0.65197[0m    0.98187      0.58227  17.12s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     12     0.64175     0.65247    0.98357      0.58293  16.97s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     13     [36m0.63372[0m     0.65594    0.96614      0.59541  16.98s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     14     [36m0.63120[0m     0.65510    0.96351      0.57704  17.00s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     15     [36m0.63034[0m     0.65771    0.95838      0.59487  16.90s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     16     [36m0.62415[0m     0.66126    0.94387      0.58372  17.02s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     17     [36m0.62236[0m     0.65811    0.94567      0.52309  17.11s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     18     [36m0.61838[0m     0.66349    0.93202      0.54180  17.00s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     19     [36m0.61706[0m     0.67016    0.92077      0.55670  16.96s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     20     [36m0.61395[0m     0.66731    0.92004      0.54118  16.76s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     21     [36m0.61119[0m     0.68062    0.89799      0.54055  16.87s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
Early stopping.
Best valid loss was 0.651970 at epoch 11.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.697636382822
Error rate (%):  30.2363617178
[[64739 23956]
 [ 4699  1376]]
(94770,)
(94770,)
roc_auc: 0.562982218854
log_loss: 0.528585500097
roc_auc for the hours: 0.572602739726
log_loss for the hours: 0.473421645749
saving predictions to csv file
hourspatient1_15_net11_10-10-17-49-38.csv
Accuracy validation for the hours:  0.75641025641
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [15]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.050861568
saving predictions to csv file
patient1_15_net11_10-10-17-52-48.csv
