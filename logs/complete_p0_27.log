['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_0']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_0'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-18 17:06:56.550806
Hostname: kat
gpu3
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net26
evaluation:
    online_training: False
    model: net26

end Configuration
['patient0_0']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [0]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.763244544
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 77.4825836182 42.2078788757
20 305.512463379 300.472479248
30 461.135577393 459.25463562
40 614.021606445 614.238354492
50 784.364746094 787.311828613
60 993.193286133 998.551342773
70 1272.31512451 1279.6506958
80 1694.84467773 1704.01054688
90 2529.98266602 2551.26169434
100 45472.875 51963.8164062
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net26
Model name for the evaluation phase:  net26
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m2.19114[0m     [32m0.72567[0m    3.01947      0.47464  54.20s
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.71257[0m     [32m0.70285[0m    1.01382      0.46430  57.68s
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.69969[0m     [32m0.70057[0m    0.99875      0.46121  57.56s
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.69454[0m     0.70090    0.99091      0.45962  58.19s
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.69208[0m     [32m0.69671[0m    0.99336      0.48323  58.63s
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.69081[0m     [32m0.69466[0m    0.99446      0.49309  58.67s
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.69015[0m     0.70006    0.98584      0.44446  58.61s
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.68881[0m     0.69632    0.98921      0.57223  57.96s
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.68849[0m     [32m0.69441[0m    0.99148      0.56144  58.02s
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.68748[0m     [32m0.69139[0m    0.99434      0.62433  57.93s
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.68744[0m     0.69301    0.99196      0.58350  57.91s
BI_test_bal_complete called with len(X) = 1530
     12     [36m0.68654[0m     0.69375    0.98961      0.56336  57.96s
BI_test_bal_complete called with len(X) = 1530
     13     [36m0.68541[0m     0.69746    0.98272      0.56094  57.92s
BI_test_bal_complete called with len(X) = 1530
     14     [36m0.68377[0m     0.70335    0.97216      0.48651  57.96s
BI_test_bal_complete called with len(X) = 1530
     15     [36m0.68347[0m     0.71132    0.96085      0.53204  57.71s
BI_test_bal_complete called with len(X) = 1530
     16     [36m0.68182[0m     0.71022    0.96001      0.60660  57.82s
BI_test_bal_complete called with len(X) = 1530
     17     [36m0.67945[0m     0.72117    0.94216      0.61247  57.67s
BI_test_bal_complete called with len(X) = 1530
     18     [36m0.67778[0m     0.74687    0.90750      0.56546  57.70s
BI_test_bal_complete called with len(X) = 1530
     19     0.67977     0.76240    0.89162      0.63099  57.76s
BI_test_bal_complete called with len(X) = 1530
     20     [36m0.67292[0m     0.89132    0.75497      0.58699  57.89s
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.691391 at epoch 10.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.8452866303
Error rate (%):  15.47133697
[[44162  2008]
 [ 6075     0]]
(52245,)
(52245,)
roc_auc: 0.607959805015
log_loss: 0.471556318015
roc_auc for the hours: 0.610526315789
log_loss for the hours: 0.466863950498
saving predictions to csv file
hourspatient0_0_net26_10-18-17-35-07.csv
Accuracy validation for the hours:  0.883720930233
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [0]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.02068224
saving predictions to csv file
patient0_0_net26_10-18-17-37-40.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_1']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_1'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-18 17:37:41.804034
Hostname: kat
gpu3
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net26
evaluation:
    online_training: False
    model: net26

end Configuration
['patient0_1']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [1]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.7638016
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 79.8583602905 43.7949028015
20 305.763250732 299.520977783
30 453.40585022 450.005862427
40 592.349865723 590.177758789
50 740.968597412 740.054229736
60 918.324951172 917.797363281
70 1161.24418945 1163.53183594
80 1578.52695313 1588.20612793
90 2613.2675293 2653.38178711
100 212492.21875 103666.890625
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net26
Model name for the evaluation phase:  net26
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m2.68618[0m     [32m0.73144[0m    3.67244      0.47443  53.53s
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.71963[0m     [32m0.70178[0m    1.02544      0.46317  57.46s
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.70433[0m     [32m0.70116[0m    1.00453      0.45801  57.68s
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.69757[0m     [32m0.69978[0m    0.99684      0.45880  57.71s
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.69462[0m     [32m0.69934[0m    0.99325      0.50269  57.49s
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.69265[0m     [32m0.69467[0m    0.99708      0.60915  57.38s
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.69148[0m     0.69778    0.99096      0.51107  57.57s
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.69060[0m     0.69743    0.99020      0.57264  57.27s
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.68937[0m     0.69764    0.98814      0.60213  57.29s
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.68936[0m     0.69652    0.98973      0.62298  57.28s
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.68857[0m     0.69862    0.98562      0.62978  57.53s
BI_test_bal_complete called with len(X) = 1530
     12     [36m0.68821[0m     0.70076    0.98209      0.64146  57.65s
BI_test_bal_complete called with len(X) = 1530
     13     [36m0.68768[0m     0.70588    0.97421      0.62466  57.52s
BI_test_bal_complete called with len(X) = 1530
     14     [36m0.68623[0m     0.72292    0.94925      0.48137  57.64s
BI_test_bal_complete called with len(X) = 1530
     15     [36m0.68559[0m     0.70787    0.96853      0.60687  57.49s
BI_test_bal_complete called with len(X) = 1530
     16     0.68615     0.73697    0.93104      0.61064  57.60s
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.694675 at epoch 6.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.840712029859
Error rate (%):  15.9287970141
[[43922  2248]
 [ 6074     1]]
(52245,)
(52245,)
roc_auc: 0.602433418811
log_loss: 0.542020930971
roc_auc for the hours: 0.626315789474
log_loss for the hours: 0.539166583225
saving predictions to csv file
hourspatient0_1_net26_10-18-18-02-10.csv
Accuracy validation for the hours:  0.883720930233
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [1]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.024147456
saving predictions to csv file
patient0_1_net26_10-18-18-04-20.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_2']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_2'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-18 18:04:21.596452
Hostname: kat
gpu3
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net26
evaluation:
    online_training: False
    model: net26

end Configuration
['patient0_2']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [2]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.763994112
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 72.0125099182 40.3037857056
20 276.55925293 272.411431885
30 416.599380493 415.294677734
40 555.997583008 556.773425293
50 715.97946167 718.930877686
60 923.099047852 927.542578125
70 1228.42805176 1233.38067627
80 1756.11213379 1761.63308105
90 3001.92504883 3026.81286621
100 72650.4921875 53126.640625
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net26
Model name for the evaluation phase:  net26
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m1.87420[0m     [32m0.87333[0m    2.14604      0.47237  52.11s
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.72680[0m     [32m0.76873[0m    0.94545      0.56804  56.13s
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.70655[0m     0.77082    0.91663      0.50077  56.02s
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.69590[0m     0.78795    0.88318      0.56867  55.95s
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.69242[0m     0.79996    0.86556      0.62981  55.96s
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.68901[0m     [32m0.76767[0m    0.89752      0.59019  55.97s
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.68613[0m     [32m0.74807[0m    0.91719      0.61629  56.25s
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.68441[0m     [32m0.72590[0m    0.94285      0.58380  56.01s
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.68204[0m     0.72842    0.93634      0.63011  56.06s
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.67848[0m     [32m0.68976[0m    0.98364      0.61346  55.94s
BI_test_bal_complete called with len(X) = 1530
     11     0.67915     0.78979    0.85990      0.49570  56.22s
BI_test_bal_complete called with len(X) = 1530
     12     0.68611     0.69799    0.98298      0.50278  55.87s
BI_test_bal_complete called with len(X) = 1530
     13     0.68663     0.72503    0.94704      0.50134  55.97s
BI_test_bal_complete called with len(X) = 1530
     14     0.68020     0.75772    0.89769      0.60274  56.30s
BI_test_bal_complete called with len(X) = 1530
     15     0.68593     0.77821    0.88142      0.55605  56.08s
BI_test_bal_complete called with len(X) = 1530
     16     0.68095     0.78329    0.86934      0.55361  56.17s
BI_test_bal_complete called with len(X) = 1530
     17     [36m0.67433[0m     0.78075    0.86370      0.65761  56.45s
BI_test_bal_complete called with len(X) = 1530
     18     [36m0.67272[0m     0.83224    0.80832      0.68002  56.11s
BI_test_bal_complete called with len(X) = 1530
     19     0.67279     0.71181    0.94518      0.64005  56.86s
BI_test_bal_complete called with len(X) = 1530
     20     [36m0.67080[0m     0.79586    0.84287      0.66298  56.73s
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.689763 at epoch 10.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.843104603311
Error rate (%):  15.6895396689
[[44047  2123]
 [ 6074     1]]
(52245,)
(52245,)
roc_auc: 0.648568541203
log_loss: 0.408239570517
roc_auc for the hours: 0.678947368421
log_loss for the hours: 0.399093099891
saving predictions to csv file
hourspatient0_2_net26_10-18-18-51-34.csv
Accuracy validation for the hours:  0.883720930233
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [2]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.02096896
saving predictions to csv file
patient0_2_net26_10-18-18-53-56.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_3']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_3'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-18 18:53:57.580593
Hostname: kat
gpu3
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net26
evaluation:
    online_training: False
    model: net26

end Configuration
['patient0_3']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [3]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.763727872
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 52.0612277985 28.9869352341
20 191.337734985 185.116714478
30 292.577377319 287.197384644
40 400.500439453 396.009564209
50 535.735168457 532.537109375
60 731.05357666 729.604919434
70 1066.69674072 1069.19353027
80 1804.39440918 1808.60009766
90 3908.51987305 3891.41049805
100 124376.210938 175654.078125
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net26
Model name for the evaluation phase:  net26
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m4.09703[0m     [32m0.83379[0m    4.91373      0.47681  53.32s
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.75056[0m     [32m0.72204[0m    1.03949      0.47234  57.62s
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.72051[0m     [32m0.70073[0m    1.02822      0.46924  57.50s
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.70750[0m     0.70631    1.00169      0.47160  57.75s
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.70064[0m     [32m0.69765[0m    1.00428      0.46656  57.92s
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.69709[0m     [32m0.69443[0m    1.00383      0.50855  57.39s
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.69477[0m     [32m0.69404[0m    1.00106      0.55029  57.54s
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.69321[0m     0.69443    0.99825      0.47138  57.57s
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.69175[0m     [32m0.69330[0m    0.99777      0.56526  57.70s
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.69072[0m     [32m0.69083[0m    0.99984      0.63799  57.63s
BI_test_bal_complete called with len(X) = 1530
     11     0.69110     0.69180    0.99898      0.60638  57.47s
BI_test_bal_complete called with len(X) = 1530
     12     [36m0.68943[0m     0.69222    0.99598      0.51494  57.66s
BI_test_bal_complete called with len(X) = 1530
     13     [36m0.68895[0m     [32m0.69077[0m    0.99737      0.60801  57.62s
BI_test_bal_complete called with len(X) = 1530
     14     0.68904     0.69271    0.99470      0.59193  57.63s
BI_test_bal_complete called with len(X) = 1530
     15     [36m0.68745[0m     0.69191    0.99356      0.62116  57.65s
BI_test_bal_complete called with len(X) = 1530
     16     [36m0.68668[0m     [32m0.69074[0m    0.99413      0.65111  57.66s
BI_test_bal_complete called with len(X) = 1530
     17     0.68669     0.69457    0.98865      0.59421  57.37s
BI_test_bal_complete called with len(X) = 1530
     18     [36m0.68543[0m     0.69579    0.98511      0.65321  57.53s
BI_test_bal_complete called with len(X) = 1530
     19     [36m0.68527[0m     0.69675    0.98352      0.57598  57.48s
BI_test_bal_complete called with len(X) = 1530
     20     [36m0.68272[0m     0.71337    0.95703      0.46443  57.68s
BI_test_bal_complete called with len(X) = 1530
     21     0.68487     0.70414    0.97263      0.61816  57.71s
BI_test_bal_complete called with len(X) = 1530
     22     [36m0.68235[0m     0.70844    0.96317      0.61686  57.92s
BI_test_bal_complete called with len(X) = 1530
     23     [36m0.68031[0m     0.71713    0.94865      0.58905  57.63s
BI_test_bal_complete called with len(X) = 1530
     24     0.68864     0.70144    0.98175      0.58812  57.90s
BI_test_bal_complete called with len(X) = 1530
     25     0.68172     0.72443    0.94104      0.49814  57.69s
BI_test_bal_complete called with len(X) = 1530
     26     [36m0.67587[0m     0.72039    0.93820      0.63709  57.80s
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.690737 at epoch 16.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.824959326251
Error rate (%):  17.5040673749
[[42817  3353]
 [ 5792   283]]
(52245,)
(52245,)
roc_auc: 0.638877289245
log_loss: 0.509534373916
roc_auc for the hours: 0.689473684211
log_loss for the hours: 0.503373916759
saving predictions to csv file
hourspatient0_3_net26_10-18-19-29-23.csv
Accuracy validation for the hours:  0.883720930233
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [3]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.020628992
saving predictions to csv file
patient0_3_net26_10-18-19-31-39.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_4']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_4'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-18 19:31:40.702356
Hostname: kat
gpu3
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net26
evaluation:
    online_training: False
    model: net26

end Configuration
['patient0_4']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [4]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.763662336
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 60.27771492 33.2891647339
20 230.724859619 226.139196777
30 348.998257446 345.771307373
40 468.468225098 465.978533936
50 608.787628174 607.555786133
60 801.863439941 803.590454102
70 1127.33896484 1136.01357422
80 1802.12897949 1820.19179688
90 3236.02592773 3251.78005371
100 159526.84375 66619.4296875
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net26
Model name for the evaluation phase:  net26
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m3.56049[0m     [32m0.74114[0m    4.80407      0.47578  53.50s
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.73094[0m     [32m0.72191[0m    1.01251      0.47162  57.71s
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.71001[0m     [32m0.69747[0m    1.01797      0.50634  57.74s
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.70080[0m     0.70153    0.99896      0.48730  57.72s
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.69588[0m     0.70199    0.99129      0.51201  57.90s
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.69329[0m     [32m0.69613[0m    0.99593      0.64842  57.77s
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.69190[0m     0.70214    0.98542      0.47709  57.58s
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.68951[0m     0.71007    0.97105      0.48450  57.60s
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.68791[0m     0.71416    0.96325      0.48926  57.47s
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.68696[0m     0.70652    0.97230      0.63820  57.60s
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.68685[0m     0.71277    0.96364      0.64965  57.92s
BI_test_bal_complete called with len(X) = 1530
     12     0.68790     [32m0.69452[0m    0.99046      0.65836  57.86s
BI_test_bal_complete called with len(X) = 1530
     13     [36m0.68650[0m     0.69562    0.98689      0.65622  57.83s
BI_test_bal_complete called with len(X) = 1530
     14     [36m0.68305[0m     0.71245    0.95873      0.66574  57.89s
BI_test_bal_complete called with len(X) = 1530
     15     0.68321     0.71060    0.96145      0.64734  57.63s
BI_test_bal_complete called with len(X) = 1530
     16     [36m0.68202[0m     0.71462    0.95438      0.65773  57.91s
BI_test_bal_complete called with len(X) = 1530
     17     [36m0.67904[0m     0.72633    0.93489      0.67327  57.92s
BI_test_bal_complete called with len(X) = 1530
     18     0.68068     0.84671    0.80391      0.65270  57.75s
BI_test_bal_complete called with len(X) = 1530
     19     [36m0.67841[0m     0.84803    0.79998      0.63583  57.95s
BI_test_bal_complete called with len(X) = 1530
     20     [36m0.67496[0m     0.72244    0.93427      0.59267  57.72s
BI_test_bal_complete called with len(X) = 1530
     21     0.67744     0.71056    0.95338      0.57023  57.76s
BI_test_bal_complete called with len(X) = 1530
     22     [36m0.66990[0m     1.24879    0.53644      0.57808  57.84s
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.694522 at epoch 12.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.843889367404
Error rate (%):  15.6110632596
[[44089  2081]
 [ 6075     0]]
(52245,)
(52245,)
roc_auc: 0.653830674079
log_loss: 0.464304070009
roc_auc for the hours: 0.663157894737
log_loss for the hours: 0.459314850007
saving predictions to csv file
hourspatient0_4_net26_10-18-20-01-54.csv
Accuracy validation for the hours:  0.883720930233
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [4]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.02035456
saving predictions to csv file
patient0_4_net26_10-18-20-04-06.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_5']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_5'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-18 20:04:07.265021
Hostname: kat
gpu3
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net26
evaluation:
    online_training: False
    model: net26

end Configuration
['patient0_5']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [5]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.763957248
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 44.228635788 24.8328939438
20 167.781503296 163.806289673
30 254.511244202 251.485551453
40 343.928485107 341.169134521
50 452.231292725 450.168884277
60 604.746826172 604.360339355
70 863.724084473 868.017297363
80 1408.11137695 1423.19575195
90 2638.64152832 2674.38774414
100 60107.1914062 35895.5507812
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net26
Model name for the evaluation phase:  net26
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m2.05984[0m     [32m0.69176[0m    2.97768      0.48652  53.47s
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.70315[0m     0.69977    1.00483      0.46801  57.62s
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.69381[0m     [32m0.68968[0m    1.00599      0.51736  57.42s
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.69038[0m     [32m0.68730[0m    1.00449      0.59511  57.53s
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.68733[0m     [32m0.68561[0m    1.00251      0.61356  57.85s
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.68375[0m     [32m0.68474[0m    0.99856      0.60390  57.60s
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.68153[0m     [32m0.67825[0m    1.00483      0.61464  57.53s
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.67685[0m     0.67928    0.99642      0.61449  57.31s
BI_test_bal_complete called with len(X) = 1530
      9     0.68138     0.68245    0.99843      0.60481  57.75s
BI_test_bal_complete called with len(X) = 1530
     10     0.68061     0.69152    0.98422      0.56284  57.44s
BI_test_bal_complete called with len(X) = 1530
     11     0.68237     0.68932    0.98991      0.59654  57.65s
BI_test_bal_complete called with len(X) = 1530
     12     0.68403     0.69307    0.98695      0.53843  57.60s
BI_test_bal_complete called with len(X) = 1530
     13     0.67923     [32m0.67322[0m    1.00894      0.63553  57.67s
BI_test_bal_complete called with len(X) = 1530
     14     [36m0.67486[0m     0.67407    1.00117      0.62837  57.93s
BI_test_bal_complete called with len(X) = 1530
     15     [36m0.66990[0m     0.68104    0.98365      0.63979  57.59s
BI_test_bal_complete called with len(X) = 1530
     16     0.67767     0.69419    0.97620      0.53001  57.71s
BI_test_bal_complete called with len(X) = 1530
     17     0.67971     0.68797    0.98799      0.60967  57.81s
BI_test_bal_complete called with len(X) = 1530
     18     0.68067     0.70081    0.97126      0.60540  57.63s
BI_test_bal_complete called with len(X) = 1530
     19     [36m0.66806[0m     0.81171    0.82302      0.57824  57.69s
BI_test_bal_complete called with len(X) = 1530
     20     0.67529     0.73712    0.91611      0.58224  57.78s
BI_test_bal_complete called with len(X) = 1530
     21     [36m0.65898[0m     0.90564    0.72764      0.54637  58.04s
BI_test_bal_complete called with len(X) = 1530
     22     0.68743     0.71565    0.96056      0.58252  58.49s
BI_test_bal_complete called with len(X) = 1530
     23     0.66643     0.74156    0.89869      0.59276  58.70s
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.673219 at epoch 13.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.672829935879
Error rate (%):  32.7170064121
[[33404 12766]
 [ 4327  1748]]
(52245,)
(52245,)
roc_auc: 0.610081937303
log_loss: 0.538034713954
roc_auc for the hours: 0.636842105263
log_loss for the hours: 0.526349107367
saving predictions to csv file
hourspatient0_5_net26_10-18-20-34-02.csv
Accuracy validation for the hours:  0.744186046512
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [5]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.020780544
saving predictions to csv file
patient0_5_net26_10-18-20-36-17.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_6']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_6'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-18 20:36:18.870510
Hostname: kat
gpu3
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net26
evaluation:
    online_training: False
    model: net26

end Configuration
['patient0_6']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [6]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.764063744
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 52.9203617096 28.9710264206
20 204.033294678 198.010336304
30 310.279055786 304.778164673
40 419.120050049 413.251306152
50 547.291717529 541.047363281
60 717.765319824 711.321618652
70 980.086315918 974.004034424
80 1476.19272461 1468.43618164
90 2691.36994629 2660.87460937
100 459356.3125 258723.5625
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net26
Model name for the evaluation phase:  net26
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m3.04747[0m     [32m0.75101[0m    4.05781      0.47454  53.57s
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.73512[0m     [32m0.72654[0m    1.01181      0.47182  57.36s
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.70972[0m     [32m0.71116[0m    0.99797      0.46986  57.43s
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.70021[0m     [32m0.70609[0m    0.99166      0.46819  57.56s
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.69675[0m     [32m0.69652[0m    1.00034      0.55890  57.64s
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.69386[0m     [32m0.69647[0m    0.99625      0.52257  57.65s
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.69225[0m     0.69902    0.99031      0.45084  57.56s
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.69127[0m     [32m0.69577[0m    0.99352      0.52366  57.58s
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.69001[0m     [32m0.69559[0m    0.99198      0.55215  57.49s
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.68928[0m     [32m0.69361[0m    0.99375      0.59845  57.53s
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.68761[0m     [32m0.69307[0m    0.99212      0.55451  57.57s
BI_test_bal_complete called with len(X) = 1530
     12     [36m0.68738[0m     0.69551    0.98832      0.54101  57.77s
BI_test_bal_complete called with len(X) = 1530
     13     [36m0.68611[0m     0.69401    0.98861      0.55193  57.68s
BI_test_bal_complete called with len(X) = 1530
     14     [36m0.68484[0m     [32m0.69189[0m    0.98980      0.63012  57.85s
BI_test_bal_complete called with len(X) = 1530
     15     0.68638     [32m0.69066[0m    0.99380      0.64869  57.65s
BI_test_bal_complete called with len(X) = 1530
     16     [36m0.68276[0m     0.69536    0.98188      0.55630  57.78s
BI_test_bal_complete called with len(X) = 1530
     17     [36m0.68234[0m     0.69411    0.98304      0.65646  57.76s
BI_test_bal_complete called with len(X) = 1530
     18     [36m0.68198[0m     0.69729    0.97805      0.63231  57.67s
BI_test_bal_complete called with len(X) = 1530
     19     0.68288     0.70249    0.97208      0.58288  57.76s
BI_test_bal_complete called with len(X) = 1530
     20     [36m0.67965[0m     0.70515    0.96385      0.58844  57.56s
BI_test_bal_complete called with len(X) = 1530
     21     0.68530     [32m0.69016[0m    0.99296      0.64842  57.64s
BI_test_bal_complete called with len(X) = 1530
     22     [36m0.67388[0m     0.73048    0.92252      0.61820  57.64s
BI_test_bal_complete called with len(X) = 1530
     23     [36m0.67189[0m     0.82907    0.81042      0.60788  57.65s
BI_test_bal_complete called with len(X) = 1530
     24         nan         nan        nan      0.49948  57.77s
BI_test_bal_complete called with len(X) = 1530
     25         nan         nan        nan      0.49948  57.23s
BI_test_bal_complete called with len(X) = 1530
     26         nan         nan        nan      0.49954  57.52s
BI_test_bal_complete called with len(X) = 1530
     27         nan         nan        nan      0.50155  57.29s
BI_test_bal_complete called with len(X) = 1530
     28         nan         nan        nan      0.50036  57.32s
BI_test_bal_complete called with len(X) = 1530
     29         nan         nan        nan      0.49917  57.45s
BI_test_bal_complete called with len(X) = 1530
     30         nan         nan        nan      0.50041  57.57s
BI_test_bal_complete called with len(X) = 1530
     31         nan         nan        nan      0.49933  57.53s
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.690162 at epoch 21.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.794334386066
Error rate (%):  20.5665613934
[[40533  5637]
 [ 5108   967]]
(52245,)
(52245,)
roc_auc: 0.672093112678
log_loss: 0.492341101522
roc_auc for the hours: 0.731578947368
log_loss for the hours: 0.479606997742
saving predictions to csv file
hourspatient0_6_net26_10-18-21-14-31.csv
Accuracy validation for the hours:  0.883720930233
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [6]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.02107136
saving predictions to csv file
patient0_6_net26_10-18-21-16-45.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_7']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_7'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-18 21:16:47.084697
Hostname: kat
gpu3
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net26
evaluation:
    online_training: False
    model: net26

end Configuration
['patient0_7']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [7]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.763117568
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 42.2832771301 23.406820488
20 162.516268921 157.987145996
30 247.963627625 243.623634338
40 336.95199585 332.831341553
50 445.399627686 441.292938232
60 597.128845215 593.310778809
70 844.070202637 839.791943359
80 1309.5418457 1299.71809082
90 2364.6079834 2327.02700195
100 202022.625 78149.3203125
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net26
Model name for the evaluation phase:  net26
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m1.75703[0m     [32m0.74329[0m    2.36385      0.47598  53.53s
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.72544[0m     [32m0.74057[0m    0.97957      0.47069  57.61s
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.70916[0m     [32m0.71129[0m    0.99701      0.47089  57.83s
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.69967[0m     [32m0.70611[0m    0.99089      0.46850  57.59s
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.69670[0m     [32m0.69837[0m    0.99761      0.46284  57.89s
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.69434[0m     [32m0.69305[0m    1.00186      0.56782  57.73s
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.69213[0m     [32m0.69202[0m    1.00016      0.60887  57.64s
BI_test_bal_complete called with len(X) = 1530
      8     0.69283     0.69221    1.00090      0.60870  57.68s
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.69085[0m     0.69283    0.99713      0.57001  57.66s
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.68975[0m     [32m0.69177[0m    0.99708      0.60248  57.13s
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.68943[0m     [32m0.69177[0m    0.99662      0.57553  56.51s
BI_test_bal_complete called with len(X) = 1530
     12     [36m0.68915[0m     0.69211    0.99573      0.58809  56.42s
BI_test_bal_complete called with len(X) = 1530
     13     [36m0.68830[0m     [32m0.69005[0m    0.99746      0.63604  56.82s
BI_test_bal_complete called with len(X) = 1530
     14     [36m0.68806[0m     0.69069    0.99620      0.62405  56.52s
BI_test_bal_complete called with len(X) = 1530
     15     [36m0.68763[0m     [32m0.68966[0m    0.99705      0.61743  56.18s
BI_test_bal_complete called with len(X) = 1530
     16     0.68855     0.69036    0.99737      0.61706  56.53s
BI_test_bal_complete called with len(X) = 1530
     17     0.68790     [32m0.68960[0m    0.99754      0.58539  56.50s
BI_test_bal_complete called with len(X) = 1530
     18         nan         nan        nan      0.50016  56.70s
BI_test_bal_complete called with len(X) = 1530
     19         nan         nan        nan      0.49964  56.48s
BI_test_bal_complete called with len(X) = 1530
     20         nan         nan        nan      0.49933  56.72s
BI_test_bal_complete called with len(X) = 1530
     21         nan         nan        nan      0.49855  56.13s
BI_test_bal_complete called with len(X) = 1530
     22         nan         nan        nan      0.50165  56.30s
BI_test_bal_complete called with len(X) = 1530
     23         nan         nan        nan      0.49861  56.09s
BI_test_bal_complete called with len(X) = 1530
     24         nan         nan        nan      0.49948  56.41s
BI_test_bal_complete called with len(X) = 1530
     25         nan         nan        nan      0.49948  56.11s
BI_test_bal_complete called with len(X) = 1530
     26         nan         nan        nan      0.49954  56.30s
BI_test_bal_complete called with len(X) = 1530
     27         nan         nan        nan      0.50155  56.61s
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.689599 at epoch 17.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.478418987463
Error rate (%):  52.1581012537
[[20459 25711]
 [ 1539  4536]]
(52245,)
(52245,)
roc_auc: 0.638281020847
log_loss: 0.658535998563
roc_auc for the hours: 0.668421052632
log_loss for the hours: 0.652479199823
saving predictions to csv file
hourspatient0_7_net26_10-18-21-50-52.csv
Accuracy validation for the hours:  0.511627906977
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [7]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 0.968261632
saving predictions to csv file
patient0_7_net26_10-18-21-53-21.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_8']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_8'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-18 21:53:22.553474
Hostname: kat
gpu3
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net26
evaluation:
    online_training: False
    model: net26

end Configuration
['patient0_8']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [8]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.763547648
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 54.1830825806 29.6300670624
20 210.284432983 202.797094727
30 322.79552002 315.015945435
40 440.955853271 432.186102295
50 584.439239502 573.883850098
60 779.399060059 765.642810059
70 1072.5894043 1055.17028809
80 1571.89633789 1552.87558594
90 2680.80834961 2671.50136719
100 68448.984375 353074.21875
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net26
Model name for the evaluation phase:  net26
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m2.36229[0m     [32m0.77649[0m    3.04228      0.47454  53.61s
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.72439[0m     [32m0.71754[0m    1.00955      0.49892  57.58s
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.70686[0m     [32m0.71513[0m    0.98844      0.49490  57.54s
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.69550[0m     [32m0.69839[0m    0.99585      0.64044  57.48s
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.69237[0m     [32m0.69468[0m    0.99667      0.57774  57.56s
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.68938[0m     [32m0.69422[0m    0.99302      0.55813  57.47s
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.68765[0m     0.70430    0.97637      0.63358  57.55s
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.68661[0m     0.70119    0.97921      0.59609  57.57s
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.68582[0m     0.70423    0.97386      0.65221  57.71s
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.68412[0m     0.70537    0.96988      0.58592  57.40s
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.68326[0m     0.72186    0.94652      0.57138  57.37s
BI_test_bal_complete called with len(X) = 1530
     12     [36m0.68299[0m     0.70591    0.96753      0.59283  57.55s
BI_test_bal_complete called with len(X) = 1530
     13     [36m0.68064[0m     0.74054    0.91912      0.62053  57.51s
BI_test_bal_complete called with len(X) = 1530
     14     [36m0.67806[0m     0.71968    0.94216      0.60325  57.51s
BI_test_bal_complete called with len(X) = 1530
     15     [36m0.67756[0m     0.73225    0.92532      0.60480  57.64s
BI_test_bal_complete called with len(X) = 1530
     16     [36m0.67748[0m     0.72733    0.93147      0.59222  57.74s
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.694223 at epoch 6.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 0 0 1 0 0 1 1 1 0 0 0 1 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.504029093693
Error rate (%):  49.5970906307
[[21404 24766]
 [ 1146  4929]]
(52245,)
(52245,)
roc_auc: 0.679936776861
log_loss: 0.649881923956
roc_auc for the hours: 0.721052631579
log_loss for the hours: 0.642928896948
saving predictions to csv file
hourspatient0_8_net26_10-18-22-17-58.csv
Accuracy validation for the hours:  0.581395348837
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [8]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.020604416
saving predictions to csv file
patient0_8_net26_10-18-22-20-13.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_9']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_9'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-18 22:20:14.548688
Hostname: kat
gpu3
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net26
evaluation:
    online_training: False
    model: net26

end Configuration
['patient0_9']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [9]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.764899328
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 66.6869514465 35.6989082336
20 256.319952393 245.103649902
30 392.878082275 380.05057373
40 536.743615723 521.363696289
50 716.260894775 697.441894531
60 975.356860352 953.108215332
70 1387.67550049 1363.3236084
80 2106.65888672 2072.82099609
90 3733.63100586 3669.75898437
100 262006.171875 86094.46875
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net26
Model name for the evaluation phase:  net26
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1         nan         nan        nan      0.50015  52.70s
BI_test_bal_complete called with len(X) = 1530
      2         nan         nan        nan      0.50026  57.37s
BI_test_bal_complete called with len(X) = 1530
      3         nan         nan        nan      0.50170  58.06s
BI_test_bal_complete called with len(X) = 1530
      4         nan         nan        nan      0.50041  58.27s
BI_test_bal_complete called with len(X) = 1530
      5         nan         nan        nan      0.50104  57.92s
BI_test_bal_complete called with len(X) = 1530
      6         nan         nan        nan      0.50041  57.55s
BI_test_bal_complete called with len(X) = 1530
      7         nan         nan        nan      0.49974  57.37s
BI_test_bal_complete called with len(X) = 1530
      8         nan         nan        nan      0.50010  57.24s
BI_test_bal_complete called with len(X) = 1530
      9         nan         nan        nan      0.50062  57.30s
BI_test_bal_complete called with len(X) = 1530
     10         nan         nan        nan      0.49948  57.29s
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was inf at epoch 0.
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_10']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_10'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-18 22:38:29.726981
Hostname: kat
gpu3
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net26
evaluation:
    online_training: False
    model: net26

end Configuration
['patient0_10']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [10]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.764555264
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 49.5935062408 26.4832733154
20 190.337982178 178.602871704
30 296.224377441 280.857037354
40 415.984814453 394.469250488
50 577.838653564 548.425720215
60 818.775402832 780.941381836
70 1187.2631958 1144.36071777
80 1820.75270996 1769.78515625
90 3363.41669922 3314.3128418
100 50863.234375 51923.34375
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net26
Model name for the evaluation phase:  net26
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m5.43637[0m     [32m0.78752[0m    6.90320      0.47154  53.62s
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.73344[0m     [32m0.74627[0m    0.98282      0.45472  57.29s
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.71125[0m     [32m0.72021[0m    0.98756      0.46388  57.28s
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.69914[0m     0.72162    0.96885      0.51394  57.55s
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.69367[0m     [32m0.71297[0m    0.97294      0.56056  57.50s
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.69072[0m     [32m0.70036[0m    0.98624      0.60957  57.59s
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.68907[0m     0.70219    0.98130      0.60126  57.47s
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.68673[0m     0.70681    0.97159      0.62255  57.29s
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.68480[0m     0.72426    0.94551      0.60512  57.35s
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.68157[0m     0.71185    0.95747      0.61656  57.37s
BI_test_bal_complete called with len(X) = 1530
     11     0.68541     0.74121    0.92472      0.58961  57.80s
BI_test_bal_complete called with len(X) = 1530
     12     0.69434     [32m0.69454[0m    0.99970      0.57130  57.53s
BI_test_bal_complete called with len(X) = 1530
     13     0.68775     0.70183    0.97995      0.59735  57.66s
BI_test_bal_complete called with len(X) = 1530
     14     0.68426     0.70325    0.97301      0.61149  57.43s
BI_test_bal_complete called with len(X) = 1530
     15     0.68240     0.70434    0.96884      0.59569  57.48s
BI_test_bal_complete called with len(X) = 1530
     16     0.68243     0.70886    0.96271      0.59284  57.55s
BI_test_bal_complete called with len(X) = 1530
     17     [36m0.67649[0m     0.73346    0.92232      0.58103  57.32s
BI_test_bal_complete called with len(X) = 1530
     18     [36m0.67441[0m     0.74985    0.89939      0.53037  57.47s
BI_test_bal_complete called with len(X) = 1530
     19         nan         nan        nan      0.49964  57.30s
BI_test_bal_complete called with len(X) = 1530
     20         nan         nan        nan      0.49933  57.05s
BI_test_bal_complete called with len(X) = 1530
     21         nan         nan        nan      0.49855  57.12s
BI_test_bal_complete called with len(X) = 1530
     22         nan         nan        nan      0.50165  57.22s
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.694545 at epoch 12.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.833897980668
Error rate (%):  16.6102019332
[[43535  2635]
 [ 6043    32]]
(52245,)
(52245,)
roc_auc: 0.575452923576
log_loss: 0.571658541044
roc_auc for the hours: 0.605263157895
log_loss for the hours: 0.569091742122
saving predictions to csv file
hourspatient0_10_net26_10-18-23-13-11.csv
Accuracy validation for the hours:  0.883720930233
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [10]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.0227712
saving predictions to csv file
patient0_10_net26_10-18-23-15-39.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_11']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_11'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-18 23:15:40.552039
Hostname: kat
gpu3
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net26
evaluation:
    online_training: False
    model: net26

end Configuration
['patient0_11']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [11]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.76388352
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 37.4027713776 20.3596906662
20 138.625271606 132.382019043
30 211.681109619 204.980381775
40 289.691271973 281.780712891
50 389.566116333 380.066696167
60 543.70489502 531.805041504
70 834.583398437 818.790313721
80 1463.92446289 1432.4847168
90 3328.68920898 3260.95727539
100 410646.09375 69810.453125
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net26
Model name for the evaluation phase:  net26
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1         nan         nan        nan      0.50015  52.78s
BI_test_bal_complete called with len(X) = 1530
      2         nan         nan        nan      0.50026  57.19s
BI_test_bal_complete called with len(X) = 1530
      3         nan         nan        nan      0.50170  57.32s
BI_test_bal_complete called with len(X) = 1530
      4         nan         nan        nan      0.50041  57.52s
BI_test_bal_complete called with len(X) = 1530
      5         nan         nan        nan      0.50104  57.33s
BI_test_bal_complete called with len(X) = 1530
      6         nan         nan        nan      0.50041  57.30s
BI_test_bal_complete called with len(X) = 1530
      7         nan         nan        nan      0.49974  57.35s
BI_test_bal_complete called with len(X) = 1530
      8         nan         nan        nan      0.50010  57.07s
BI_test_bal_complete called with len(X) = 1530
      9         nan         nan        nan      0.50062  57.12s
BI_test_bal_complete called with len(X) = 1530
     10         nan         nan        nan      0.49948  57.00s
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was inf at epoch 0.
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_12']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_12'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-18 23:31:53.605568
Hostname: kat
gpu3
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net26
evaluation:
    online_training: False
    model: net26

end Configuration
['patient0_12']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [12]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.763871232
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 65.1829460144 35.0811794281
20 246.685302734 233.028952026
30 381.222595215 364.982098389
40 530.423962402 509.868566895
50 730.584533691 703.699279785
60 1040.28303223 1008.42225342
70 1558.99154053 1521.31486816
80 2527.43164063 2455.40673828
90 5046.20957031 4843.92373047
100 126710.1875 64910.4453125
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net26
Model name for the evaluation phase:  net26
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1         nan         nan        nan      0.50015  52.67s
BI_test_bal_complete called with len(X) = 1530
      2         nan         nan        nan      0.50026  57.26s
BI_test_bal_complete called with len(X) = 1530
      3         nan         nan        nan      0.50170  57.11s
BI_test_bal_complete called with len(X) = 1530
      4         nan         nan        nan      0.50041  57.22s
BI_test_bal_complete called with len(X) = 1530
      5         nan         nan        nan      0.50104  57.54s
BI_test_bal_complete called with len(X) = 1530
      6         nan         nan        nan      0.50041  57.32s
BI_test_bal_complete called with len(X) = 1530
      7         nan         nan        nan      0.49974  57.20s
BI_test_bal_complete called with len(X) = 1530
      8         nan         nan        nan      0.50010  57.30s
BI_test_bal_complete called with len(X) = 1530
      9         nan         nan        nan      0.50062  57.47s
BI_test_bal_complete called with len(X) = 1530
     10         nan         nan        nan      0.49948  57.19s
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was inf at epoch 0.
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_13']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_13'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-18 23:48:22.370437
Hostname: kat
gpu3
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net26
evaluation:
    online_training: False
    model: net26

end Configuration
['patient0_13']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [13]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.766640128
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 69.0897041321 37.7125782013
20 266.439715576 253.817520142
30 414.331445313 399.039959717
40 579.853991699 560.493823242
50 802.805938721 779.214904785
60 1136.38771973 1110.1892334
70 1641.78244629 1620.17226562
80 2489.06611328 2463.09140625
90 4471.61362305 4441.97880859
100 100082.695312 85056.0390625
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net26
Model name for the evaluation phase:  net26
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m4.36457[0m     [32m0.74522[0m    5.85676      0.47392  53.85s
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.75197[0m     [32m0.70238[0m    1.07060      0.46513  57.72s
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.71800[0m     [32m0.70012[0m    1.02555      0.45379  57.50s
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.70437[0m     [32m0.69942[0m    1.00708      0.44176  57.39s
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.69808[0m     [32m0.69790[0m    1.00027      0.47660  57.63s
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.69420[0m     [32m0.69704[0m    0.99593      0.54030  57.57s
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.69260[0m     [32m0.69594[0m    0.99519      0.58489  57.60s
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.68995[0m     0.69893    0.98715      0.54794  57.62s
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.68918[0m     0.70480    0.97784      0.46716  57.45s
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.68797[0m     [32m0.69512[0m    0.98971      0.63468  57.45s
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.68651[0m     0.70271    0.97695      0.57387  57.34s
BI_test_bal_complete called with len(X) = 1530
     12     [36m0.68588[0m     0.70117    0.97819      0.56460  57.60s
BI_test_bal_complete called with len(X) = 1530
     13     [36m0.68395[0m     [32m0.69465[0m    0.98459      0.63211  57.46s
BI_test_bal_complete called with len(X) = 1530
     14     [36m0.68336[0m     0.70161    0.97398      0.62672  57.72s
BI_test_bal_complete called with len(X) = 1530
     15     [36m0.68188[0m     0.70866    0.96221      0.63368  57.41s
BI_test_bal_complete called with len(X) = 1530
     16     0.68692     0.70052    0.98059      0.63579  57.59s
BI_test_bal_complete called with len(X) = 1530
     17     [36m0.67988[0m     0.71699    0.94824      0.59255  57.37s
BI_test_bal_complete called with len(X) = 1530
     18     [36m0.67920[0m     0.73538    0.92361      0.57891  57.43s
BI_test_bal_complete called with len(X) = 1530
     19     [36m0.67593[0m     0.73004    0.92588      0.63501  57.57s
BI_test_bal_complete called with len(X) = 1530
     20     [36m0.67456[0m     0.80601    0.83691      0.59680  57.58s
BI_test_bal_complete called with len(X) = 1530
     21     [36m0.66662[0m     0.79406    0.83950      0.63076  57.73s
BI_test_bal_complete called with len(X) = 1530
     22     0.67551     0.87600    0.77113      0.61127  57.49s
BI_test_bal_complete called with len(X) = 1530
     23     [36m0.65446[0m     1.36698    0.47876      0.59553  57.58s
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.694653 at epoch 13.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.838357737583
Error rate (%):  16.1642262417
[[43751  2419]
 [ 6026    49]]
(52245,)
(52245,)
roc_auc: 0.668585699121
log_loss: 0.463448577045
roc_auc for the hours: 0.7
log_loss for the hours: 0.4566496375
saving predictions to csv file
hourspatient0_13_net26_10-19-00-17-28.csv
Accuracy validation for the hours:  0.883720930233
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [13]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.023598592
saving predictions to csv file
patient0_13_net26_10-19-00-19-37.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_14']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_14'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-19 00:19:38.843755
Hostname: kat
gpu3
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net26
evaluation:
    online_training: False
    model: net26

end Configuration
['patient0_14']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [14]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.76384256
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 51.4431194305 28.1161405563
20 195.642379761 187.486203003
30 299.57428894 291.18163147
40 410.908746338 402.061425781
50 555.348205566 546.590423584
60 781.114685059 775.59395752
70 1179.35510254 1183.46280518
80 1939.34797363 1949.83596191
90 3877.67912598 3944.7189209
100 65181.1953125 57682.203125
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net26
Model name for the evaluation phase:  net26
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m3.93042[0m     [32m0.69668[0m    5.64163      0.55407  53.54s
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.74630[0m     [32m0.69194[0m    1.07856      0.60657  57.65s
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.71854[0m     0.69525    1.03350      0.51324  57.40s
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.70368[0m     [32m0.69087[0m    1.01854      0.57125  57.75s
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.69823[0m     0.69954    0.99812      0.49917  57.62s
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.69596[0m     0.70204    0.99133      0.49990  57.52s
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.69355[0m     0.69319    1.00052      0.50798  57.40s
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.69194[0m     0.69224    0.99956      0.51571  57.48s
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.69109[0m     0.69270    0.99767      0.50929  57.82s
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.68993[0m     0.69147    0.99777      0.53830  57.63s
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.68954[0m     0.69634    0.99023      0.50078  57.90s
BI_test_bal_complete called with len(X) = 1530
     12     [36m0.68944[0m     [32m0.69019[0m    0.99891      0.62982  57.83s
BI_test_bal_complete called with len(X) = 1530
     13     [36m0.68752[0m     [32m0.68938[0m    0.99729      0.61628  57.58s
BI_test_bal_complete called with len(X) = 1530
     14     [36m0.68676[0m     [32m0.68829[0m    0.99777      0.63074  57.85s
BI_test_bal_complete called with len(X) = 1530
     15     [36m0.68588[0m     0.68877    0.99580      0.62830  57.46s
BI_test_bal_complete called with len(X) = 1530
     16     [36m0.68518[0m     0.69141    0.99099      0.57711  57.66s
BI_test_bal_complete called with len(X) = 1530
     17     0.68937     0.69407    0.99323      0.50477  57.63s
BI_test_bal_complete called with len(X) = 1530
     18     [36m0.68458[0m     0.69922    0.97906      0.58657  57.63s
BI_test_bal_complete called with len(X) = 1530
     19     [36m0.68132[0m     0.70191    0.97067      0.59483  57.71s
BI_test_bal_complete called with len(X) = 1530
     20     [36m0.67903[0m     0.74297    0.91394      0.59236  58.04s
BI_test_bal_complete called with len(X) = 1530
     21     [36m0.67793[0m     0.79684    0.85078      0.60019  57.68s
BI_test_bal_complete called with len(X) = 1530
     22     0.67804     0.72695    0.93271      0.56960  57.46s
BI_test_bal_complete called with len(X) = 1530
     23         nan         nan        nan      0.49861  57.61s
BI_test_bal_complete called with len(X) = 1530
     24         nan         nan        nan      0.49948  57.25s
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.688294 at epoch 14.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.726787252369
Error rate (%):  27.3212747631
[[35709 10461]
 [ 3813  2262]]
(52245,)
(52245,)
roc_auc: 0.68529107405
log_loss: 0.555746516313
roc_auc for the hours: 0.747368421053
log_loss for the hours: 0.551319602617
saving predictions to csv file
hourspatient0_14_net26_10-19-00-52-38.csv
Accuracy validation for the hours:  0.790697674419
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [14]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.020985344
saving predictions to csv file
patient0_14_net26_10-19-00-54-50.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_15']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_15'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-19 00:54:52.094701
Hostname: kat
gpu3
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net26
evaluation:
    online_training: False
    model: net26

end Configuration
['patient0_15']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [15]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.763871232
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 34.6773342133 19.007179451
20 129.966018677 125.497892761
30 197.840336609 193.760687256
40 269.3421875 264.920050049
50 359.024520874 354.514923096
60 493.65269165 489.852355957
70 739.064575195 735.682330322
80 1252.53088379 1250.05979004
90 2505.61677246 2502.26618652
100 37134.734375 63323.234375
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net26
Model name for the evaluation phase:  net26
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m1.98429[0m     [32m0.71999[0m    2.75599      0.47196  53.73s
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.71671[0m     [32m0.70640[0m    1.01459      0.46606  57.61s
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.70260[0m     0.70816    0.99215      0.46491  57.69s
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.69583[0m     [32m0.69897[0m    0.99551      0.53356  57.70s
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.69297[0m     [32m0.69582[0m    0.99590      0.59648  57.41s
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.69101[0m     0.69673    0.99178      0.59008  57.77s
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.69025[0m     [32m0.69396[0m    0.99466      0.59106  57.56s
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.68873[0m     0.69443    0.99179      0.59413  57.50s
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.68803[0m     [32m0.69372[0m    0.99180      0.59252  57.43s
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.68725[0m     0.69389    0.99043      0.60010  56.68s
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.68659[0m     [32m0.69268[0m    0.99122      0.57936  56.55s
BI_test_bal_complete called with len(X) = 1530
     12     [36m0.68542[0m     0.69305    0.98899      0.60344  56.04s
BI_test_bal_complete called with len(X) = 1530
     13     [36m0.68423[0m     0.69908    0.97876      0.59683  56.61s
BI_test_bal_complete called with len(X) = 1530
     14     0.68423     0.70723    0.96749      0.55806  56.10s
BI_test_bal_complete called with len(X) = 1530
     15     0.68477     0.69350    0.98741      0.59828  56.11s
BI_test_bal_complete called with len(X) = 1530
     16     [36m0.68102[0m     0.70237    0.96961      0.56551  56.36s
BI_test_bal_complete called with len(X) = 1530
     17     [36m0.67963[0m     0.71212    0.95438      0.58124  56.16s
BI_test_bal_complete called with len(X) = 1530
     18     0.68753     0.70228    0.97900      0.57022  55.98s
BI_test_bal_complete called with len(X) = 1530
     19     [36m0.67864[0m     0.70843    0.95795      0.57361  56.27s
BI_test_bal_complete called with len(X) = 1530
     20     [36m0.67778[0m     0.71091    0.95340      0.56469  56.10s
BI_test_bal_complete called with len(X) = 1530
     21     [36m0.67231[0m     0.75053    0.89577      0.60318  56.04s
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.692676 at epoch 11.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.832405014834
Error rate (%):  16.7594985166
[[43354  2816]
 [ 5940   135]]
(52245,)
(52245,)
roc_auc: 0.624607085462
log_loss: 0.517915202448
roc_auc for the hours: 0.668421052632
log_loss for the hours: 0.511255800377
saving predictions to csv file
hourspatient0_15_net26_10-19-01-21-34.csv
Accuracy validation for the hours:  0.883720930233
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [15]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.024233472
saving predictions to csv file
patient0_15_net26_10-19-01-23-52.csv
