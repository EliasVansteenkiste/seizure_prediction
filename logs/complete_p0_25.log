['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config1.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_0']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config1.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_0'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-17 00:47:29.973535
Hostname: kat
gpu0
Configuration 'config1.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 128
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net13
evaluation:
    online_training: False
    model: net13

end Configuration
['patient0_0']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 128)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [0]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.83787776
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 40.3686702728 22.0375383377
20 156.885797119 151.019311523
30 239.797695923 233.875378418
40 325.424224854 319.224285889
50 427.042526245 420.959976196
60 560.747253418 555.391540527
70 753.48291626 751.001837158
80 1067.38918457 1069.86003418
90 1718.7770752 1726.12036133
100 45472.875 51963.8164062
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net13
Model name for the evaluation phase:  net13
Training model...
# Neural Network with 95970 learnable parameters

## Layer information

  #    name  size
---  ------  ----------
  0          1x192x128
  1          32x131x130
  2          32x133x69
  3          32x133x69
  4          32x67x35
  5          32x67x35
  6          32x67x35
  7          32x34x18
  8          2x34x18
  9          2
 10          2

BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m0.89923[0m     [32m0.71304[0m    1.26113      0.46563  181.67s
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.62185[0m     0.71398    0.87096      0.49210  185.77s
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.57082[0m     0.95835    0.59563      0.49453  186.81s
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.39583[0m     2.10646    0.18791      0.45995  187.30s
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.25868[0m     2.49447    0.10370      0.46793  188.95s
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.19676[0m     3.04397    0.06464      0.45965  189.42s
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.17372[0m     3.09174    0.05619      0.46108  190.62s
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.15408[0m     3.61705    0.04260      0.45874  189.91s
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.14130[0m     4.14797    0.03407      0.46362  189.16s
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.12829[0m     3.96401    0.03236      0.46355  189.23s
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.12603[0m     4.52542    0.02785      0.46638  189.39s
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.713036 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x64x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x1x64).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 128)
magnitudes_seizure_val.shape (5, 1, 1406, 128)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.845382333238
Error rate (%):  15.4617666762
[[44167  2003]
 [ 6075     0]]
(52245,)
(52245,)
roc_auc: 0.590954254763
log_loss: 0.709662220516
roc_auc for the hours: 0.5
log_loss for the hours: 0.500534142967
saving predictions to csv file
hourspatient0_0_net13_10-17-01-29-50.csv
Accuracy validation for the hours:  0.883720930233
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 128)
(1584, 1, 234, 128)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [0]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.188564992
saving predictions to csv file
patient0_0_net13_10-17-01-32-58.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config1.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_1']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config1.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_1'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-17 01:32:59.613897
Hostname: kat
gpu0
Configuration 'config1.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 128
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net13
evaluation:
    online_training: False
    model: net13

end Configuration
['patient0_1']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 128)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [1]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.840728576
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 42.6292736053 23.5565195084
20 162.895623779 158.21725769
30 244.90839386 240.540263367
40 325.704229736 321.187445068
50 416.734436035 412.241989136
60 531.050476074 526.896484375
70 691.477087402 688.666900635
80 953.697094727 952.840478516
90 1582.49206543 1592.20968018
100 212492.21875 103666.890625
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net13
Model name for the evaluation phase:  net13
Training model...
# Neural Network with 95970 learnable parameters

## Layer information

  #    name  size
---  ------  ----------
  0          1x192x128
  1          32x131x130
  2          32x133x69
  3          32x133x69
  4          32x67x35
  5          32x67x35
  6          32x67x35
  7          32x34x18
  8          2x34x18
  9          2
 10          2

BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m0.85482[0m     [32m0.69615[0m    1.22791      0.58532  189.50s
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.62019[0m     0.69654    0.89038      0.59401  189.34s
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.59589[0m     0.76368    0.78029      0.50062  189.31s
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.48286[0m     1.26281    0.38237      0.48693  189.10s
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.29614[0m     1.70057    0.17414      0.46638  189.29s
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.20744[0m     2.64485    0.07843      0.46721  189.30s
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.16691[0m     3.93934    0.04237      0.46407  189.33s
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.14926[0m     2.76342    0.05401      0.47477  188.47s
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.13590[0m     3.76317    0.03611      0.48057  189.26s
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.12445[0m     2.23926    0.05558      0.49046  188.67s
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.11857[0m     2.75263    0.04307      0.48244  189.03s
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.696154 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x64x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x1x64).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 128)
magnitudes_seizure_val.shape (5, 1, 1406, 128)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.794717197818
Error rate (%):  20.5282802182
[[41075  5095]
 [ 5630   445]]
(52245,)
(52245,)
roc_auc: 0.624934091312
log_loss: 0.703938343544
roc_auc for the hours: 0.647368421053
log_loss for the hours: 0.40710379517
saving predictions to csv file
hourspatient0_1_net13_10-17-02-21-31.csv
Accuracy validation for the hours:  0.813953488372
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 128)
(1584, 1, 234, 128)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [1]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.183023104
saving predictions to csv file
patient0_1_net13_10-17-02-29-46.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config1.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_2']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config1.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_2'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-17 02:29:47.921996
Hostname: kat
gpu0
Configuration 'config1.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 128
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net13
evaluation:
    online_training: False
    model: net13

end Configuration
['patient0_2']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 128)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [2]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.841986048
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 34.5497390747 19.1746992111
20 132.506976318 127.481881714
30 204.017333984 198.980325317
40 279.878057861 274.572357178
50 371.984359741 366.711410522
60 494.871417236 490.603491211
70 674.983905029 673.286212158
80 987.921252441 991.197412109
90 1775.41981201 1781.10570068
100 72650.4921875 53126.640625
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net13
Model name for the evaluation phase:  net13
Training model...
# Neural Network with 95970 learnable parameters

## Layer information

  #    name  size
---  ------  ----------
  0          1x192x128
  1          32x131x130
  2          32x133x69
  3          32x133x69
  4          32x67x35
  5          32x67x35
  6          32x67x35
  7          32x34x18
  8          2x34x18
  9          2
 10          2

BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m0.80996[0m     [32m0.92325[0m    0.87729      0.46646  182.74s
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.60014[0m     0.98194    0.61118      0.46412  188.82s
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.56707[0m     1.22987    0.46108      0.49216  189.62s
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.49219[0m     1.51432    0.32502      0.50700  189.91s
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.32664[0m     2.16747    0.15070      0.50263  190.02s
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.21788[0m     2.14919    0.10138      0.47736  190.47s
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.18434[0m     2.72690    0.06760      0.46892  190.77s
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.14411[0m     3.23401    0.04456      0.47187  190.57s
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.13564[0m     3.99776    0.03393      0.46403  189.39s
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.12776[0m     4.18135    0.03055      0.46530  190.24s
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.11783[0m     5.02649    0.02344      0.47364  191.01s
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.923246 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x64x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x1x64).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 128)
magnitudes_seizure_val.shape (5, 1, 1406, 128)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.845803426165
Error rate (%):  15.4196573835
[[44189  1981]
 [ 6075     0]]
(52245,)
(52245,)
roc_auc: 0.57538775201
log_loss: 1.4767206806
roc_auc for the hours: 0.5
log_loss for the hours: 1.01305358906
saving predictions to csv file
hourspatient0_2_net13_10-17-03-21-07.csv
Accuracy validation for the hours:  0.883720930233
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 128)
(1584, 1, 234, 128)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [2]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.185697792
saving predictions to csv file
patient0_2_net13_10-17-03-24-36.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config1.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_3']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config1.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_3'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-17 03:24:37.331735
Hostname: kat
gpu0
Configuration 'config1.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 128
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net13
evaluation:
    online_training: False
    model: net13

end Configuration
['patient0_3']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 128)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [3]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.841187328
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 20.2347444534 11.3799097061
20 73.1064926147 70.3971450806
30 111.55086441 109.194099426
40 153.340545654 151.003677368
50 207.774673462 205.628082275
60 291.057458496 289.547351074
70 437.377017212 436.872653198
80 744.19128418 745.48112793
90 1806.00810547 1810.0895874
100 124376.210938 175654.078125
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net13
Model name for the evaluation phase:  net13
Training model...
# Neural Network with 95970 learnable parameters

## Layer information

  #    name  size
---  ------  ----------
  0          1x192x128
  1          32x131x130
  2          32x133x69
  3          32x133x69
  4          32x67x35
  5          32x67x35
  6          32x67x35
  7          32x34x18
  8          2x34x18
  9          2
 10          2

BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m0.73801[0m     [32m0.67290[0m    1.09676      0.58160  97.32s
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.59537[0m     0.75731    0.78616      0.51864  98.57s
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.52831[0m     0.82624    0.63942      0.52879  100.09s
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.38056[0m     1.09718    0.34685      0.52285  100.21s
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.26170[0m     1.95247    0.13403      0.47351  103.38s
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.19654[0m     2.09208    0.09395      0.46535  188.65s
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.16408[0m     2.73809    0.05993      0.46717  189.52s
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.13991[0m     2.53388    0.05521      0.46081  189.63s
BI_test_bal_complete called with len(X) = 1530
      9     0.14329     3.54172    0.04046      0.48119  190.61s
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.12702[0m     2.52879    0.05023      0.47283  191.75s
BI_test_bal_complete called with len(X) = 1530
     11     0.13192     3.27734    0.04025      0.46576  191.38s
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.672899 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x64x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x1x64).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 128)
magnitudes_seizure_val.shape (5, 1, 1406, 128)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.836654225285
Error rate (%):  16.3345774715
[[43438  2732]
 [ 5802   273]]
(52245,)
(52245,)
roc_auc: 0.638561733297
log_loss: 0.576613869307
roc_auc for the hours: 0.621052631579
log_loss for the hours: 0.373256546889
saving predictions to csv file
hourspatient0_3_net13_10-17-04-06-26.csv
Accuracy validation for the hours:  0.883720930233
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 128)
(1584, 1, 234, 128)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [3]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.185677312
saving predictions to csv file
patient0_3_net13_10-17-04-11-30.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config1.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_4']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config1.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_4'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-17 04:11:31.551289
Hostname: kat
gpu0
Configuration 'config1.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 128
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net13
evaluation:
    online_training: False
    model: net13

end Configuration
['patient0_4']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 128)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [4]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.8426496
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 29.4645965576 16.4549375534
20 111.481929016 108.219261169
30 169.086058044 165.92673645
40 228.125921631 224.610177612
50 298.772399902 294.955917358
60 396.434741211 393.273370361
70 556.535955811 555.386444092
80 885.772229004 890.811157227
90 1918.86500244 1930.80887451
100 159526.84375 66619.4296875
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net13
Model name for the evaluation phase:  net13
Training model...
# Neural Network with 95970 learnable parameters

## Layer information

  #    name  size
---  ------  ----------
  0          1x192x128
  1          32x131x130
  2          32x133x69
  3          32x133x69
  4          32x67x35
  5          32x67x35
  6          32x67x35
  7          32x34x18
  8          2x34x18
  9          2
 10          2

BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m0.83850[0m     [32m0.78885[0m    1.06294      0.47897  96.54s
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.61181[0m     0.93813    0.65216      0.48147  98.68s
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.54483[0m     1.11591    0.48824      0.46719  100.46s
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.39330[0m     1.54118    0.25519      0.47519  148.59s
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.26378[0m     2.44185    0.10802      0.47712  189.69s
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.20868[0m     3.32820    0.06270      0.45986  190.02s
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.17387[0m     3.14927    0.05521      0.46263  190.47s
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.15098[0m     2.41715    0.06246      0.48087  190.63s
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.14497[0m     3.97024    0.03651      0.45515  190.66s
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.12681[0m     3.80934    0.03329      0.46427  190.91s
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.12375[0m     4.03801    0.03065      0.45944  191.08s
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.788851 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x64x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x1x64).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 128)
magnitudes_seizure_val.shape (5, 1, 1406, 128)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.848808498421
Error rate (%):  15.1191501579
[[44346  1824]
 [ 6075     0]]
(52245,)
(52245,)
roc_auc: 0.625670562628
log_loss: 1.08213560659
roc_auc for the hours: 0.505263157895
log_loss for the hours: 0.613685900597
saving predictions to csv file
hourspatient0_4_net13_10-17-04-57-08.csv
Accuracy validation for the hours:  0.883720930233
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 128)
(1584, 1, 234, 128)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [4]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.183625216
saving predictions to csv file
patient0_4_net13_10-17-05-01-13.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config1.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_5']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config1.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_5'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-17 05:01:15.193501
Hostname: kat
gpu0
Configuration 'config1.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 128
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net13
evaluation:
    online_training: False
    model: net13

end Configuration
['patient0_5']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 128)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [5]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.842625024
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 19.0023464203 10.6479258537
20 70.7771087646 68.7903015137
30 107.397582245 105.700828552
40 145.808868408 144.108334351
50 193.684593201 192.215415955
60 263.740808105 262.932489014
70 383.182885742 383.343640137
80 626.600488281 629.474084473
90 1419.05472412 1434.52126465
100 60107.1914062 35895.5507812
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net13
Model name for the evaluation phase:  net13
Training model...
# Neural Network with 95970 learnable parameters

## Layer information

  #    name  size
---  ------  ----------
  0          1x192x128
  1          32x131x130
  2          32x133x69
  3          32x133x69
  4          32x67x35
  5          32x67x35
  6          32x67x35
  7          32x34x18
  8          2x34x18
  9          2
 10          2

BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m0.73917[0m     [32m0.68479[0m    1.07941      0.59132  103.26s
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.59692[0m     0.81902    0.72882      0.52142  103.43s
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.49114[0m     1.39335    0.35249      0.46482  103.09s
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.30067[0m     2.65922    0.11307      0.44544  102.29s
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.20871[0m     3.38141    0.06172      0.46008  168.71s
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.17685[0m     3.94909    0.04478      0.47436  192.74s
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.13875[0m     4.05846    0.03419      0.46015  191.79s
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.12342[0m     3.49183    0.03535      0.45677  193.47s
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.12164[0m     4.15629    0.02927      0.45680  192.64s
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.11134[0m     4.67420    0.02382      0.47087  192.71s
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.10694[0m     4.48693    0.02383      0.46431  193.35s
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.684790 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x64x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x1x64).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 128)
magnitudes_seizure_val.shape (5, 1, 1406, 128)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.826509713848
Error rate (%):  17.3490286152
[[42874  3296]
 [ 5768   307]]
(52245,)
(52245,)
roc_auc: 0.609662601354
log_loss: 0.657631701287
roc_auc for the hours: 0.578947368421
log_loss for the hours: 0.408469880162
saving predictions to csv file
hourspatient0_5_net13_10-17-05-45-22.csv
Accuracy validation for the hours:  0.883720930233
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 128)
(1584, 1, 234, 128)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [5]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.186955264
saving predictions to csv file
patient0_5_net13_10-17-05-54-09.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config1.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_6']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config1.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_6'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-17 05:54:10.295522
Hostname: kat
gpu0
Configuration 'config1.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 128
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net13
evaluation:
    online_training: False
    model: net13

end Configuration
['patient0_6']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 128)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [6]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.841240576
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 21.8430782318 12.1184614182
20 82.2111785889 79.1888824463
30 125.698859406 122.693761444
40 172.197686768 168.917745972
50 231.304153442 227.765602112
60 318.301220703 314.528430176
70 461.971438599 457.640737915
80 732.126062012 726.779321289
90 1478.5770752 1470.84337158
100 459356.3125 258723.5625
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net13
Model name for the evaluation phase:  net13
Training model...
# Neural Network with 95970 learnable parameters

## Layer information

  #    name  size
---  ------  ----------
  0          1x192x128
  1          32x131x130
  2          32x133x69
  3          32x133x69
  4          32x67x35
  5          32x67x35
  6          32x67x35
  7          32x34x18
  8          2x34x18
  9          2
 10          2

BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m0.77245[0m     [32m0.73376[0m    1.05272      0.58140  102.91s
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.60702[0m     [32m0.69580[0m    0.87240      0.58813  111.53s
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.57825[0m     0.75367    0.76726      0.54767  191.75s
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.46325[0m     1.49956    0.30892      0.49794  190.87s
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.30543[0m     1.62090    0.18843      0.47279  191.38s
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.21659[0m     2.03809    0.10627      0.47488  192.00s
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.17764[0m     3.07154    0.05784      0.49412  192.11s
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.14931[0m     2.93019    0.05095      0.48542  192.05s
BI_test_bal_complete called with len(X) = 1530
      9     0.14966     2.35187    0.06363      0.45845  191.68s
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.12584[0m     3.33311    0.03775      0.47004  191.21s
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.11935[0m     4.14470    0.02880      0.48151  191.45s
BI_test_bal_complete called with len(X) = 1530
     12     [36m0.11489[0m     3.75685    0.03058      0.48953  190.49s
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.695802 at epoch 2.
Loaded parameters to layer 'conv2d1' (shape 32x1x64x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x1x64).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 128)
magnitudes_seizure_val.shape (5, 1, 1406, 128)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.787348071586
Error rate (%):  21.2651928414
[[39704  6466]
 [ 4644  1431]]
(52245,)
(52245,)
roc_auc: 0.630233335205
log_loss: 0.735506328006
roc_auc for the hours: 0.615789473684
log_loss for the hours: 0.390086017345
saving predictions to csv file
hourspatient0_6_net13_10-17-06-43-25.csv
Accuracy validation for the hours:  0.883720930233
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 128)
(1584, 1, 234, 128)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [6]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.1855872
saving predictions to csv file
patient0_6_net13_10-17-06-46-32.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config1.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_7']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config1.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_7'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-17 06:46:34.248782
Hostname: kat
gpu0
Configuration 'config1.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 128
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net13
evaluation:
    online_training: False
    model: net13

end Configuration
['patient0_7']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 128)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [7]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.842436608
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 20.2332551956 11.3582895279
20 76.7655639648 73.9334228516
30 117.059531403 114.219662476
40 159.061575317 155.967034912
50 209.972038269 206.739105225
60 280.395715332 277.055847168
70 393.506695557 390.545504761
80 620.914428711 618.847387695
90 1313.27186279 1304.44517822
100 202022.625 78149.3203125
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net13
Model name for the evaluation phase:  net13
Training model...
# Neural Network with 95970 learnable parameters

## Layer information

  #    name  size
---  ------  ----------
  0          1x192x128
  1          32x131x130
  2          32x133x69
  3          32x133x69
  4          32x67x35
  5          32x67x35
  6          32x67x35
  7          32x34x18
  8          2x34x18
  9          2
 10          2

BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m0.77524[0m     [32m0.69234[0m    1.11975      0.50894  133.07s
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.59607[0m     0.74197    0.80336      0.54125  187.38s
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.50544[0m     1.06310    0.47544      0.47152  190.62s
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.33942[0m     1.88443    0.18012      0.44822  191.16s
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.25253[0m     1.80291    0.14007      0.45296  191.71s
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.19369[0m     2.45628    0.07885      0.45395  190.71s
BI_test_bal_complete called with len(X) = 1530
      7     0.19440     3.25881    0.05965      0.44497  192.12s
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.14576[0m     2.29043    0.06364      0.44261  192.45s
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.13686[0m     3.87677    0.03530      0.44461  192.43s
BI_test_bal_complete called with len(X) = 1530
     10     0.57479     0.79027    0.72733      0.56389  192.60s
BI_test_bal_complete called with len(X) = 1530
     11     0.31675     3.39913    0.09319      0.44038  191.63s
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.692336 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x64x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x1x64).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 128)
magnitudes_seizure_val.shape (5, 1, 1406, 128)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.826471432673
Error rate (%):  17.3528567327
[[43131  3039]
 [ 6027    48]]
(52245,)
(52245,)
roc_auc: 0.585725578489
log_loss: 0.671943833869
roc_auc for the hours: 0.484210526316
log_loss for the hours: 0.465438508266
saving predictions to csv file
hourspatient0_7_net13_10-17-07-35-39.csv
Accuracy validation for the hours:  0.883720930233
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 128)
(1584, 1, 234, 128)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [7]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.194446848
saving predictions to csv file
patient0_7_net13_10-17-07-39-08.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config1.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_8']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config1.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_8'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-17 07:39:09.838627
Hostname: kat
gpu0
Configuration 'config1.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 128
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net13
evaluation:
    online_training: False
    model: net13

end Configuration
['patient0_8']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 128)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [8]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.842473472
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 20.8659296036 11.5784304619
20 78.3073684692 75.3775619507
30 119.852696228 116.784126282
40 164.660690308 161.057009888
50 222.435791016 218.076637268
60 310.434735107 304.75513916
70 466.909881592 458.976223755
80 783.04284668 769.942822266
90 1572.24412842 1553.47054443
100 68448.984375 353074.21875
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net13
Model name for the evaluation phase:  net13
Training model...
# Neural Network with 95970 learnable parameters

## Layer information

  #    name  size
---  ------  ----------
  0          1x192x128
  1          32x131x130
  2          32x133x69
  3          32x133x69
  4          32x67x35
  5          32x67x35
  6          32x67x35
  7          32x34x18
  8          2x34x18
  9          2
 10          2

BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m0.78783[0m     [32m0.68588[0m    1.14865      0.61292  181.92s
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.58907[0m     0.73656    0.79976      0.57212  188.98s
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.50141[0m     1.11766    0.44863      0.48597  190.04s
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.32632[0m     2.02532    0.16112      0.47962  190.50s
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.22111[0m     2.53379    0.08726      0.46494  190.56s
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.17733[0m     2.66766    0.06647      0.48151  190.54s
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.15222[0m     2.73493    0.05566      0.49401  191.67s
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.13630[0m     3.33361    0.04089      0.49245  191.91s
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.12709[0m     5.34674    0.02377      0.48336  191.38s
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.12317[0m     3.52456    0.03495      0.48304  191.21s
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.11366[0m     3.36394    0.03379      0.45913  191.06s
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.685878 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x64x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x1x64).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 128)
magnitudes_seizure_val.shape (5, 1, 1406, 128)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.823887453345
Error rate (%):  17.6112546655
[[42362  3808]
 [ 5393   682]]
(52245,)
(52245,)
roc_auc: 0.641919203587
log_loss: 0.659817486466
roc_auc for the hours: 0.626315789474
log_loss for the hours: 0.392463620068
saving predictions to csv file
hourspatient0_8_net13_10-17-08-27-20.csv
Accuracy validation for the hours:  0.883720930233
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 128)
(1584, 1, 234, 128)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [8]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.194192896
saving predictions to csv file
patient0_8_net13_10-17-08-30-19.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config1.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_9']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config1.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_9'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-17 08:30:21.455362
Hostname: kat
gpu0
Configuration 'config1.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 128
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net13
evaluation:
    online_training: False
    model: net13

end Configuration
['patient0_9']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 128)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [9]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.842661888
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 33.1481372833 17.9880355835
20 126.107350159 120.250483704
30 192.098429871 185.700975037
40 260.367803955 252.961431885
50 342.709716797 334.134490967
60 457.155877686 447.077502441
70 645.221862793 633.492224121
80 1035.69150391 1021.41870117
90 2117.92038574 2087.38054199
100 262006.171875 86094.46875
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net13
Model name for the evaluation phase:  net13
Training model...
# Neural Network with 95970 learnable parameters

## Layer information

  #    name  size
---  ------  ----------
  0          1x192x128
  1          32x131x130
  2          32x133x69
  3          32x133x69
  4          32x67x35
  5          32x67x35
  6          32x67x35
  7          32x34x18
  8          2x34x18
  9          2
 10          2

BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m0.85309[0m     [32m0.76428[0m    1.11620      0.56031  99.88s
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.57540[0m     0.92946    0.61907      0.53712  100.04s
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.50498[0m     0.94671    0.53340      0.55922  128.99s
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.37860[0m     2.00206    0.18911      0.48548  190.98s
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.27529[0m     2.15482    0.12776      0.49034  191.60s
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.21748[0m     2.63723    0.08246      0.47716  191.35s
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.17673[0m     3.21273    0.05501      0.48369  191.63s
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.15627[0m     2.73059    0.05723      0.46939  191.58s
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.15111[0m     3.73547    0.04045      0.47148  190.57s
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.13205[0m     3.34104    0.03952      0.49201  190.62s
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.12706[0m     4.16600    0.03050      0.46804  190.97s
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.764276 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x64x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x1x64).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 128)
magnitudes_seizure_val.shape (5, 1, 1406, 128)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.849344434874
Error rate (%):  15.0655565126
[[43423  2747]
 [ 5124   951]]
(52245,)
(52245,)
roc_auc: 0.641028346663
log_loss: 0.90289160229
roc_auc for the hours: 0.594736842105
log_loss for the hours: 0.440468765343
saving predictions to csv file
hourspatient0_9_net13_10-17-09-16-13.csv
Accuracy validation for the hours:  0.906976744186
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 128)
(1584, 1, 234, 128)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [9]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.1864064
saving predictions to csv file
patient0_9_net13_10-17-09-20-19.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config1.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_10']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config1.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_10'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-17 09:20:21.231931
Hostname: kat
gpu0
Configuration 'config1.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 128
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net13
evaluation:
    online_training: False
    model: net13

end Configuration
['patient0_10']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 128)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [10]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.841777152
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 23.4653261185 13.0575662613
20 88.3022506714 84.0260269165
30 135.158279419 129.994949341
40 185.193716431 178.621572876
50 248.710952759 239.85987854
60 343.377374268 331.032623291
70 511.054995728 492.868447876
80 869.173669434 840.441760254
90 1826.49324951 1777.41708984
100 50863.234375 51923.34375
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net13
Model name for the evaluation phase:  net13
Training model...
# Neural Network with 95970 learnable parameters

## Layer information

  #    name  size
---  ------  ----------
  0          1x192x128
  1          32x131x130
  2          32x133x69
  3          32x133x69
  4          32x67x35
  5          32x67x35
  6          32x67x35
  7          32x34x18
  8          2x34x18
  9          2
 10          2

BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m0.79884[0m     [32m0.74981[0m    1.06539      0.60589  98.07s
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.59349[0m     0.79996    0.74189      0.58947  98.90s
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.52675[0m     0.99052    0.53178      0.55107  185.24s
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.37380[0m     1.99217    0.18763      0.46140  188.53s
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.28218[0m     2.14629    0.13147      0.46256  189.85s
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.21608[0m     2.37672    0.09092      0.48203  190.63s
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.18398[0m     3.36612    0.05466      0.47904  190.74s
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.15284[0m     3.13296    0.04878      0.50848  190.89s
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.15003[0m     4.32679    0.03467      0.46548  190.95s
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.13340[0m     5.32731    0.02504      0.48139  190.84s
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.12177[0m     6.65149    0.01831      0.47913  189.61s
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.749806 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x64x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x1x64).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 128)
magnitudes_seizure_val.shape (5, 1, 1406, 128)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.80369413341
Error rate (%):  19.630586659
[[41064  5106]
 [ 5150   925]]
(52245,)
(52245,)
roc_auc: 0.634505262801
log_loss: 0.885701558869
roc_auc for the hours: 0.647368421053
log_loss for the hours: 0.442936394279
saving predictions to csv file
hourspatient0_10_net13_10-17-10-07-51.csv
Accuracy validation for the hours:  0.837209302326
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 128)
(1584, 1, 234, 128)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [10]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.185570816
saving predictions to csv file
patient0_10_net13_10-17-10-11-11.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config1.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_11']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config1.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_11'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-17 10:11:12.350320
Hostname: kat
gpu0
Configuration 'config1.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 128
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net13
evaluation:
    online_training: False
    model: net13

end Configuration
['patient0_11']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 128)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [11]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.841404416
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 16.4892856598 9.04107141495
20 60.8347686768 57.923525238
30 93.0077964783 89.8506088257
40 127.330738831 123.561102295
50 170.022949219 165.505325317
60 231.011865234 225.363320923
70 333.565307617 325.991790771
80 563.472106934 551.855114746
90 1467.08924561 1436.29315186
100 410646.09375 69810.453125
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net13
Model name for the evaluation phase:  net13
Training model...
# Neural Network with 95970 learnable parameters

## Layer information

  #    name  size
---  ------  ----------
  0          1x192x128
  1          32x131x130
  2          32x133x69
  3          32x133x69
  4          32x67x35
  5          32x67x35
  6          32x67x35
  7          32x34x18
  8          2x34x18
  9          2
 10          2

BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m0.71198[0m     [32m0.70104[0m    1.01561      0.61902  97.74s
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.54457[0m     0.81830    0.66550      0.61198  99.81s
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.43319[0m     1.16328    0.37239      0.54726  186.35s
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.31386[0m     2.35330    0.13337      0.47776  190.65s
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.23086[0m     1.93650    0.11921      0.47692  191.61s
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.18453[0m     2.52747    0.07301      0.46835  190.55s
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.16864[0m     3.47245    0.04856      0.48276  191.00s
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.13763[0m     3.34788    0.04111      0.46970  190.64s
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.12921[0m     4.99436    0.02587      0.47220  190.32s
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.12815[0m     6.62727    0.01934      0.46767  190.21s
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.11628[0m     5.11110    0.02275      0.48317  189.35s
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.701041 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x64x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x1x64).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 128)
magnitudes_seizure_val.shape (5, 1, 1406, 128)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.840176093406
Error rate (%):  15.9823906594
[[43791  2379]
 [ 5971   104]]
(52245,)
(52245,)
roc_auc: 0.617592540005
log_loss: 0.750597242883
roc_auc for the hours: 0.605263157895
log_loss for the hours: 0.391750732992
saving predictions to csv file
hourspatient0_11_net13_10-17-10-55-56.csv
Accuracy validation for the hours:  0.883720930233
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 128)
(1584, 1, 234, 128)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [11]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.188601856
saving predictions to csv file
patient0_11_net13_10-17-10-59-00.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config1.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_12']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config1.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_12'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-17 10:59:01.571369
Hostname: kat
gpu0
Configuration 'config1.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 128
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net13
evaluation:
    online_training: False
    model: net13

end Configuration
['patient0_12']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 128)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [12]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.84262912
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 31.2921819687 17.1695497513
20 116.418011475 110.933314514
30 177.509857178 171.083369446
40 242.212423706 234.046005249
50 323.385238647 312.698242188
60 443.190197754 428.908685303
70 652.038452148 633.147918701
80 1108.93925781 1083.68652344
90 2536.97341309 2467.60610352
100 126710.1875 64910.4453125
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net13
Model name for the evaluation phase:  net13
Training model...
# Neural Network with 95970 learnable parameters

## Layer information

  #    name  size
---  ------  ----------
  0          1x192x128
  1          32x131x130
  2          32x133x69
  3          32x133x69
  4          32x67x35
  5          32x67x35
  6          32x67x35
  7          32x34x18
  8          2x34x18
  9          2
 10          2

BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m0.76862[0m     [32m0.75171[0m    1.02250      0.60300  179.73s
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.56246[0m     0.76953    0.73091      0.59009  188.07s
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.49361[0m     0.93130    0.53002      0.53178  189.27s
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.38540[0m     1.42464    0.27053      0.48693  188.76s
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.28998[0m     1.40999    0.20566      0.48621  188.97s
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.21205[0m     2.72319    0.07787      0.48306  189.43s
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.17922[0m     3.54455    0.05056      0.47161  188.86s
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.15906[0m     2.84262    0.05596      0.47942  189.17s
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.15135[0m     3.66158    0.04134      0.47003  189.12s
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.13320[0m     4.71559    0.02825      0.46004  188.14s
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.12798[0m     4.34317    0.02947      0.45820  188.92s
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.751709 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x64x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x1x64).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 128)
magnitudes_seizure_val.shape (5, 1, 1406, 128)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.840826873385
Error rate (%):  15.9173126615
[[43924  2246]
 [ 6070     5]]
(52245,)
(52245,)
roc_auc: 0.643334164044
log_loss: 0.909373693366
roc_auc for the hours: 0.563157894737
log_loss for the hours: 0.436821130156
saving predictions to csv file
hourspatient0_12_net13_10-17-11-59-06.csv
Accuracy validation for the hours:  0.883720930233
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 128)
(1584, 1, 234, 128)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [12]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.186824192
saving predictions to csv file
patient0_12_net13_10-17-12-02-05.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config1.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_13']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config1.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_13'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-17 12:02:06.921985
Hostname: kat
gpu0
Configuration 'config1.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 128
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net13
evaluation:
    online_training: False
    model: net13

end Configuration
['patient0_13']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 128)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [13]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.842063872
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 36.7663345337 20.2703630447
20 139.972335815 133.900891113
30 213.685165405 207.029425049
40 290.820898438 282.934844971
50 386.505371094 376.928451538
60 525.723022461 514.648864746
70 764.39508667 752.071484375
80 1244.59372559 1228.78828125
90 2503.78869629 2477.69484863
100 100082.695312 85056.0390625
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net13
Model name for the evaluation phase:  net13
Training model...
# Neural Network with 95970 learnable parameters

## Layer information

  #    name  size
---  ------  ----------
  0          1x192x128
  1          32x131x130
  2          32x133x69
  3          32x133x69
  4          32x67x35
  5          32x67x35
  6          32x67x35
  7          32x34x18
  8          2x34x18
  9          2
 10          2

BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m0.84462[0m     [32m0.76952[0m    1.09760      0.58109  120.63s
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.59047[0m     0.79219    0.74536      0.56975  187.95s
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.51967[0m     1.02633    0.50634      0.47751  190.87s
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.39449[0m     1.29634    0.30431      0.52841  191.01s
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.28789[0m     1.83570    0.15683      0.49985  191.49s
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.22572[0m     2.04016    0.11064      0.47840  191.22s
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.20805[0m     2.94743    0.07059      0.46128  190.67s
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.16461[0m     2.50536    0.06570      0.45998  189.66s
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.14975[0m     2.66384    0.05622      0.45060  189.50s
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.13910[0m     4.20338    0.03309      0.45138  189.85s
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.13179[0m     3.41085    0.03864      0.48037  189.90s
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.769517 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x64x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x1x64).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 128)
magnitudes_seizure_val.shape (5, 1, 1406, 128)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.837994066418
Error rate (%):  16.2005933582
[[43706  2464]
 [ 6000    75]]
(52245,)
(52245,)
roc_auc: 0.632617683262
log_loss: 0.931822324221
roc_auc for the hours: 0.573684210526
log_loss for the hours: 0.46073477635
saving predictions to csv file
hourspatient0_13_net13_10-17-12-49-06.csv
Accuracy validation for the hours:  0.883720930233
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 128)
(1584, 1, 234, 128)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [13]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.186213888
saving predictions to csv file
patient0_13_net13_10-17-13-01-19.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config1.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_14']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config1.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_14'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-17 13:01:20.739011
Hostname: kat
gpu0
Configuration 'config1.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 128
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net13
evaluation:
    online_training: False
    model: net13

end Configuration
['patient0_14']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 128)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [14]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.84148224
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 25.0792503357 13.7819263458
20 93.6351669312 89.5840805054
30 142.149465942 137.865058899
40 192.51451416 187.778079224
50 254.139053345 249.065841675
60 341.618377686 336.578552246
70 488.420474243 484.621878052
80 819.462915039 820.113891602
90 1944.10743408 1956.14970703
100 65181.1953125 57682.203125
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net13
Model name for the evaluation phase:  net13
Training model...
# Neural Network with 95970 learnable parameters

## Layer information

  #    name  size
---  ------  ----------
  0          1x192x128
  1          32x131x130
  2          32x133x69
  3          32x133x69
  4          32x67x35
  5          32x67x35
  6          32x67x35
  7          32x34x18
  8          2x34x18
  9          2
 10          2

BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m0.80162[0m     [32m0.69610[0m    1.15159      0.58202  180.90s
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.59557[0m     0.73658    0.80857      0.59690  189.09s
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.48864[0m     1.09284    0.44713      0.52115  190.57s
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.35006[0m     1.66046    0.21082      0.48806  189.61s
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.25976[0m     1.68567    0.15410      0.46907  189.51s
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.21336[0m     2.85159    0.07482      0.47892  189.73s
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.18651[0m     3.51659    0.05304      0.47378  189.41s
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.14314[0m     5.00147    0.02862      0.47539  189.63s
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.14153[0m     3.19303    0.04433      0.47272  189.41s
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.12984[0m     4.61838    0.02811      0.47726  188.65s
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.12316[0m     6.27745    0.01962      0.47073  189.14s
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.696095 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x64x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x1x64).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 128)
magnitudes_seizure_val.shape (5, 1, 1406, 128)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.821896832233
Error rate (%):  17.8103167767
[[42379  3791]
 [ 5514   561]]
(52245,)
(52245,)
roc_auc: 0.610514666232
log_loss: 0.746055374478
roc_auc for the hours: 0.615789473684
log_loss for the hours: 0.439538040435
saving predictions to csv file
hourspatient0_14_net13_10-17-13-59-50.csv
Accuracy validation for the hours:  0.883720930233
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 128)
(1584, 1, 234, 128)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [14]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.185824768
saving predictions to csv file
patient0_14_net13_10-17-14-11-16.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config1.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_15']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config1.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_15'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-17 14:11:17.337326
Hostname: kat
gpu0
Configuration 'config1.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 128
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net13
evaluation:
    online_training: False
    model: net13

end Configuration
['patient0_15']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 128)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [15]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.841728
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 15.8140995979 8.71762123108
20 58.5607398987 56.0894172668
30 89.283164978 86.6440727234
40 121.753817749 118.755133057
50 161.916046143 158.544067383
60 218.51607666 214.983123779
70 310.822363281 307.678326416
80 510.516369629 508.665307617
90 1254.83146973 1252.8588501
100 37134.734375 63323.234375
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net13
Model name for the evaluation phase:  net13
Training model...
# Neural Network with 95970 learnable parameters

## Layer information

  #    name  size
---  ------  ----------
  0          1x192x128
  1          32x131x130
  2          32x133x69
  3          32x133x69
  4          32x67x35
  5          32x67x35
  6          32x67x35
  7          32x34x18
  8          2x34x18
  9          2
 10          2

BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m0.68745[0m     [32m0.65949[0m    1.04239      0.62315  180.83s
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.57138[0m     0.81698    0.69939      0.59411  187.64s
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.42122[0m     1.63211    0.25808      0.51444  188.41s
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.26883[0m     2.90114    0.09267      0.46634  188.32s
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.19332[0m     2.57731    0.07501      0.49303  188.93s
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.15439[0m     2.16262    0.07139      0.48565  188.61s
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.14469[0m     4.06089    0.03563      0.47161  188.93s
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.12770[0m     3.58856    0.03559      0.46991  188.94s
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.11690[0m     4.41486    0.02648      0.47623  188.24s
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.11648[0m     3.02151    0.03855      0.46138  188.89s
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.10909[0m     3.86092    0.02826      0.46669  188.65s
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.659494 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x64x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x1x64).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 128)
magnitudes_seizure_val.shape (5, 1, 1406, 128)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.821724566944
Error rate (%):  17.8275433056
[[42512  3658]
 [ 5656   419]]
(52245,)
(52245,)
roc_auc: 0.626660288378
log_loss: 0.525200631373
roc_auc for the hours: 0.605263157895
log_loss for the hours: 0.385250663335
saving predictions to csv file
hourspatient0_15_net13_10-17-15-02-51.csv
Accuracy validation for the hours:  0.883720930233
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 128)
(1584, 1, 234, 128)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [15]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.185656832
saving predictions to csv file
patient0_15_net13_10-17-15-05-11.csv
