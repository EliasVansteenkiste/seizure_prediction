['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run2.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu1', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2', '--channels=0']
Command line arguments: Namespace(channels=[0], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run2.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient2'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu1')
Git reference:  Timestamp: 2016-09-26 01:19:17.124276
Hostname: kat
gpu1
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 512
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net0
evaluation:
    online_training: False
    model: net0

end Configuration
Loading and preprocessing data...
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_3/3_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.720453632
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 370.383615112 382.042739868
20 585.952758789 603.113830566
30 798.876318359 815.979187012
40 1037.00437012 1049.37390137
50 1324.60302734 1323.22802734
60 1695.00808105 1667.13757324
70 2212.20117188 2132.72290039
80 3034.4668457 2848.29077148
90 4751.07553711 4309.59814453
100 63321.7421875 54863.8242188
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net0
Model name for the evaluation phase:  net0
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x512x64
  1          64x512x64
  2          64x512x64
  3          64x256x32
  4          64x256x32
  5          64x256x32
  6          64x256x32
  7          64x128x16
  8          64x128x16
  9          64x128x16
 10          2x128x16
 11          2
 12          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m2.24484[0m     [32m0.74161[0m    3.02697      0.62695  214.18s
      2     [36m0.51650[0m     0.85255    0.60583      0.62581  229.93s
      3     [36m0.50786[0m     0.88138    0.57621      0.62288  228.12s
      4     [36m0.49447[0m     0.95391    0.51836      0.62174  230.51s
      5     [36m0.46715[0m     1.20824    0.38664      0.55094  234.31s
      6     [36m0.43940[0m     1.28557    0.34180      0.57503  237.34s
Early stopping.
Best valid loss was 0.741615 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d6' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d6' (shape 64).
Loaded parameters to layer 'conv2d9' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d9' (shape 64).
Loaded parameters to layer 'conv2d10' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d10' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[1 1 0 0 0 1 0 0 1 1 1 1 0 0 1 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.609114583333
Error rate (%):  39.0885416667
yVal [0 0 1 ..., 0 1 1]
[[3306  514]
 [2488 1372]]
roc_auc: 0.746737175488
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run2.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu1', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2', '--channels=1']
Command line arguments: Namespace(channels=[1], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run2.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient2'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu1')
Git reference:  Timestamp: 2016-09-26 02:04:42.643029
Hostname: kat
gpu1
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 512
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net0
evaluation:
    online_training: False
    model: net0

end Configuration
Loading and preprocessing data...
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_3/3_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.720277504
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 265.569192505 275.922683716
20 418.741949463 432.515045166
30 570.463165283 582.129150391
40 741.529833984 745.226196289
50 952.19519043 940.145874023
60 1236.58071289 1194.78979492
70 1663.88118896 1561.48345947
80 2413.32441406 2174.828125
90 4212.56235352 3563.96838379
100 56617.8046875 55581.1640625
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net0
Model name for the evaluation phase:  net0
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x512x64
  1          64x512x64
  2          64x512x64
  3          64x256x32
  4          64x256x32
  5          64x256x32
  6          64x256x32
  7          64x128x16
  8          64x128x16
  9          64x128x16
 10          2x128x16
 11          2
 12          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m1.90220[0m     [32m1.07036[0m    1.77716      0.48747  224.21s
      2     [36m0.52185[0m     1.31653    0.39638      0.48747  233.59s
      3     [36m0.50334[0m     1.18214    0.42579      0.48747  227.49s
      4     [36m0.48714[0m     [32m1.06485[0m    0.45747      0.47835  228.88s
      5     [36m0.46179[0m     [32m0.84099[0m    0.54911      0.67806  234.04s
      6     [36m0.41754[0m     0.91451    0.45657      0.56380  233.24s
      7     [36m0.37057[0m     1.26655    0.29258      0.46289  228.25s
      8     [36m0.30144[0m     2.32460    0.12967      0.47689  226.26s
      9     [36m0.28555[0m     2.71454    0.10519      0.48145  232.14s
     10     [36m0.19962[0m     3.29635    0.06056      0.49609  231.83s
Early stopping.
Best valid loss was 0.840989 at epoch 5.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d6' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d6' (shape 64).
Loaded parameters to layer 'conv2d9' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d9' (shape 64).
Loaded parameters to layer 'conv2d10' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d10' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[0 1 0 0 0 0 1 0 1 1 1 1 0 0 1 0 1 0 0 0 0 0 1 0 0 0 1 1 1 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.686588541667
Error rate (%):  31.3411458333
yVal [0 0 1 ..., 0 1 1]
[[3193  627]
 [1780 2080]]
roc_auc: 0.676852501153
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run2.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu1', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2', '--channels=2']
Command line arguments: Namespace(channels=[2], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run2.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient2'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu1')
Git reference:  Timestamp: 2016-09-26 02:50:02.457976
Hostname: kat
gpu1
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 512
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net0
evaluation:
    online_training: False
    model: net0

end Configuration
Loading and preprocessing data...
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_3/3_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.722522112
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 211.564569092 218.920532227
20 330.673291016 339.741790771
30 446.107928467 453.246795654
40 572.932189941 574.249145508
50 725.553161621 715.946166992
60 926.149853516 896.588439941
70 1218.91170654 1154.75012207
80 1712.55070801 1579.12597656
90 2791.07785645 2495.08483887
100 58473.7617188 75930.625
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net0
Model name for the evaluation phase:  net0
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x512x64
  1          64x512x64
  2          64x512x64
  3          64x256x32
  4          64x256x32
  5          64x256x32
  6          64x256x32
  7          64x128x16
  8          64x128x16
  9          64x128x16
 10          2x128x16
 11          2
 12          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m1.55839[0m     [32m0.82486[0m    1.88927      0.56136  225.51s
      2     [36m0.49399[0m     1.06196    0.46517      0.57926  229.78s
      3     [36m0.46914[0m     1.27145    0.36898      0.58691  233.39s
      4     [36m0.44150[0m     1.81904    0.24271      0.56006  231.92s
      5     [36m0.41816[0m     2.34543    0.17829      0.53939  232.42s
      6     [36m0.38995[0m     3.19439    0.12207      0.55046  240.00s
Early stopping.
Best valid loss was 0.824861 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d6' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d6' (shape 64).
Loaded parameters to layer 'conv2d9' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d9' (shape 64).
Loaded parameters to layer 'conv2d10' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d10' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 0 0 1 1 0 1 1 1 1 0 0 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.56171875
Error rate (%):  43.828125
yVal [0 0 1 ..., 0 1 1]
[[2005 1815]
 [1551 2309]]
roc_auc: 0.612600846377
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run2.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu1', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2', '--channels=3']
Command line arguments: Namespace(channels=[3], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run2.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient2'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu1')
Git reference:  Timestamp: 2016-09-26 03:19:57.598389
Hostname: kat
gpu1
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 512
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net0
evaluation:
    online_training: False
    model: net0

end Configuration
Loading and preprocessing data...
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_3/3_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.721027072
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 234.08664093 239.721954346
20 364.584063721 371.962585449
30 490.508004761 496.504821777
40 630.362109375 631.961303711
50 803.842010498 795.534606934
60 1044.95795898 1019.23065186
70 1429.24927979 1370.09783936
80 2121.47871094 1998.69506836
90 3590.03435059 3337.28955078
100 147926.25 114985.820312
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net0
Model name for the evaluation phase:  net0
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x512x64
  1          64x512x64
  2          64x512x64
  3          64x256x32
  4          64x256x32
  5          64x256x32
  6          64x256x32
  7          64x128x16
  8          64x128x16
  9          64x128x16
 10          2x128x16
 11          2
 12          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m1.70327[0m     [32m0.83309[0m    2.04452      0.48893  234.90s
      2     [36m0.48918[0m     1.23348    0.39659      0.57308  234.18s
      3     [36m0.45197[0m     1.30257    0.34699      0.57699  238.80s
      4     [36m0.43603[0m     1.53595    0.28389      0.63118  235.87s
      5     [36m0.41226[0m     1.62588    0.25356      0.60075  237.69s
      6     [36m0.36624[0m     2.05911    0.17786      0.55843  231.18s
Early stopping.
Best valid loss was 0.833091 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d6' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d6' (shape 64).
Loaded parameters to layer 'conv2d9' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d9' (shape 64).
Loaded parameters to layer 'conv2d10' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d10' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[1 1 0 0 0 1 0 0 1 1 1 1 0 0 1 1 1 1 0 0 1 0 0 0 0 0 1 1 0 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.479427083333
Error rate (%):  52.0572916667
yVal [0 0 1 ..., 0 1 1]
[[2227 1593]
 [2405 1455]]
roc_auc: 0.569342497898
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run2.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu1', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2', '--channels=4']
Command line arguments: Namespace(channels=[4], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run2.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient2'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu1')
Git reference:  Timestamp: 2016-09-26 03:50:34.966803
Hostname: kat
gpu1
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 512
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net0
evaluation:
    online_training: False
    model: net0

end Configuration
Loading and preprocessing data...
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_3/3_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.721104896
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 166.741564941 169.260734558
20 261.176831055 264.865814209
30 354.425119019 357.479827881
40 461.596020508 461.342407227
50 599.61050415 592.545623779
60 798.440466309 775.908874512
70 1114.19197998 1058.04302979
80 1661.69353027 1535.50854492
90 2826.51435547 2533.14819336
100 44210.6640625 39898.75
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net0
Model name for the evaluation phase:  net0
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x512x64
  1          64x512x64
  2          64x512x64
  3          64x256x32
  4          64x256x32
  5          64x256x32
  6          64x256x32
  7          64x128x16
  8          64x128x16
  9          64x128x16
 10          2x128x16
 11          2
 12          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m1.40304[0m     [32m0.78400[0m    1.78959      0.74349  234.37s
      2     [36m0.48127[0m     0.78767    0.61101      0.74609  233.47s
      3     [36m0.46464[0m     [32m0.73854[0m    0.62913      0.73405  229.94s
      4     [36m0.44851[0m     [32m0.71211[0m    0.62983      0.66406  237.99s
      5     [36m0.41209[0m     [32m0.66183[0m    0.62266      0.67562  233.07s
      6     [36m0.35997[0m     0.71941    0.50037      0.64209  235.22s
      7     [36m0.27346[0m     0.83896    0.32595      0.69922  233.55s
      8     0.30127     1.04739    0.28764      0.67480  229.52s
      9     [36m0.15844[0m     1.48350    0.10680      0.57666  231.67s
     10     [36m0.09083[0m     2.75477    0.03297      0.56966  235.29s
Early stopping.
Best valid loss was 0.661830 at epoch 5.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d6' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d6' (shape 64).
Loaded parameters to layer 'conv2d9' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d9' (shape 64).
Loaded parameters to layer 'conv2d10' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d10' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[1 0 0 0 0 0 1 0 1 1 0 1 0 0 1 0 1 1 0 0 0 0 0 0 0 0 0 1 0 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.676822916667
Error rate (%):  32.3177083333
yVal [0 0 1 ..., 0 1 1]
[[2864  956]
 [1526 2334]]
roc_auc: 0.751430024686
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run2.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu1', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2', '--channels=5']
Command line arguments: Namespace(channels=[5], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run2.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient2'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu1')
Git reference:  Timestamp: 2016-09-26 04:36:40.583004
Hostname: kat
gpu1
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 512
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net0
evaluation:
    online_training: False
    model: net0

end Configuration
Loading and preprocessing data...
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_3/3_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.720809984
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 186.851734924 190.438827515
20 296.48951416 301.152984619
30 409.39744873 412.204345703
40 545.394494629 542.710998535
50 730.416595459 715.384063721
60 1010.47353516 968.890319824
70 1466.35765381 1367.28033447
80 2271.5902832 2048.15332031
90 4106.57885742 3558.15698242
100 67580.4921875 68869.3984375
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net0
Model name for the evaluation phase:  net0
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x512x64
  1          64x512x64
  2          64x512x64
  3          64x256x32
  4          64x256x32
  5          64x256x32
  6          64x256x32
  7          64x128x16
  8          64x128x16
  9          64x128x16
 10          2x128x16
 11          2
 12          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m1.74643[0m     [32m0.74370[0m    2.34829      0.60791  231.77s
      2     [36m0.50873[0m     0.84890    0.59928      0.56738  239.07s
      3     [36m0.47452[0m     0.78234    0.60654      0.55713  231.79s
      4     [36m0.42926[0m     1.09488    0.39206      0.57585  235.15s
      5     [36m0.35644[0m     1.20135    0.29670      0.57161  237.46s
      6     [36m0.32697[0m     1.15734    0.28251      0.59977  237.87s
Early stopping.
Best valid loss was 0.743701 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d6' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d6' (shape 64).
Loaded parameters to layer 'conv2d9' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d9' (shape 64).
Loaded parameters to layer 'conv2d10' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d10' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[0 1 1 0 0 1 1 0 1 1 1 1 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 1 1 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.611588541667
Error rate (%):  38.8411458333
yVal [0 0 1 ..., 0 1 1]
[[2822  998]
 [1985 1875]]
roc_auc: 0.643422164501
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run2.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu1', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2', '--channels=6']
Command line arguments: Namespace(channels=[6], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run2.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient2'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu1')
Git reference:  Timestamp: 2016-09-26 05:07:14.451858
Hostname: kat
gpu1
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 512
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net0
evaluation:
    online_training: False
    model: net0

end Configuration
Loading and preprocessing data...
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_3/3_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.721616896
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 164.47532959 169.942024231
20 259.860992432 268.591369629
30 357.403549194 366.823059082
40 473.373016357 480.896636963
50 629.507781982 631.192077637
60 865.92487793 853.120605469
70 1261.51429443 1216.43780518
80 1970.32902832 1859.09008789
90 3448.32658691 3177.92431641
100 47858.3515625 52179.953125
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net0
Model name for the evaluation phase:  net0
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x512x64
  1          64x512x64
  2          64x512x64
  3          64x256x32
  4          64x256x32
  5          64x256x32
  6          64x256x32
  7          64x128x16
  8          64x128x16
  9          64x128x16
 10          2x128x16
 11          2
 12          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m1.52103[0m     [32m0.81968[0m    1.85563      0.62988  235.32s
      2     [36m0.49069[0m     1.06007    0.46288      0.59359  239.94s
      3     [36m0.44620[0m     1.13991    0.39144      0.67578  239.50s
      4     [36m0.41630[0m     1.65600    0.25139      0.68408  231.13s
      5     [36m0.36191[0m     1.51415    0.23902      0.73730  222.44s
      6     [36m0.30087[0m     1.94417    0.15475      0.65934  238.28s
Early stopping.
Best valid loss was 0.819684 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d6' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d6' (shape 64).
Loaded parameters to layer 'conv2d9' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d9' (shape 64).
Loaded parameters to layer 'conv2d10' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d10' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[1 0 0 0 0 1 0 0 1 1 0 1 0 0 1 0 0 0 0 0 0 1 0 0 1 0 1 0 0 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.619010416667
Error rate (%):  38.0989583333
yVal [0 0 1 ..., 0 1 1]
[[3455  365]
 [2561 1299]]
roc_auc: 0.719078513686
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run2.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu1', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2', '--channels=7']
Command line arguments: Namespace(channels=[7], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run2.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient2'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu1')
Git reference:  Timestamp: 2016-09-26 05:37:42.304828
Hostname: kat
gpu1
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 512
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net0
evaluation:
    online_training: False
    model: net0

end Configuration
Loading and preprocessing data...
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_3/3_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.7201792
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 178.786965942 193.060745239
20 287.408544922 309.894989014
30 401.81534729 431.074569702
40 541.658898926 576.180419922
50 727.914031982 766.537658691
60 991.201574707 1031.5402832
70 1382.93083496 1416.6105957
80 2000.69443359 2018.96716309
90 3129.06638184 3105.98327637
100 66354.203125 92128.8515625
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net0
Model name for the evaluation phase:  net0
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x512x64
  1          64x512x64
  2          64x512x64
  3          64x256x32
  4          64x256x32
  5          64x256x32
  6          64x256x32
  7          64x128x16
  8          64x128x16
  9          64x128x16
 10          2x128x16
 11          2
 12          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m1.66172[0m     [32m0.83075[0m    2.00026      0.48372  228.37s
      2     [36m0.48428[0m     1.37824    0.35137      0.48747  230.02s
      3     [36m0.43383[0m     1.55093    0.27972      0.53874  226.78s
      4     [36m0.41731[0m     1.78971    0.23317      0.53760  230.66s
      5     [36m0.38340[0m     1.73758    0.22065      0.52116  227.83s
      6     [36m0.35138[0m     1.77209    0.19829      0.54688  230.03s
Early stopping.
Best valid loss was 0.830750 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d6' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d6' (shape 64).
Loaded parameters to layer 'conv2d9' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d9' (shape 64).
Loaded parameters to layer 'conv2d10' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d10' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[1 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.484895833333
Error rate (%):  51.5104166667
yVal [0 0 1 ..., 0 1 1]
[[3549  271]
 [3685  175]]
roc_auc: 0.650048219081
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run2.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu1', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2', '--channels=8']
Command line arguments: Namespace(channels=[8], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run2.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient2'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu1')
Git reference:  Timestamp: 2016-09-26 06:07:30.417056
Hostname: kat
gpu1
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 512
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net0
evaluation:
    online_training: False
    model: net0

end Configuration
Loading and preprocessing data...
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_3/3_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.721154048
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 306.942971802 320.542236328
20 486.768151855 508.520324707
30 668.526159668 694.702026367
40 878.795983887 904.719787598
50 1142.65332031 1162.67785645
60 1494.46323242 1501.35644531
70 1994.49293213 1974.20349121
80 2770.04125977 2703.4284668
90 4225.57075195 4081.31066895
100 105201.65625 71258.6328125
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net0
Model name for the evaluation phase:  net0
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x512x64
  1          64x512x64
  2          64x512x64
  3          64x256x32
  4          64x256x32
  5          64x256x32
  6          64x256x32
  7          64x128x16
  8          64x128x16
  9          64x128x16
 10          2x128x16
 11          2
 12          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m2.13738[0m     [32m1.06235[0m    2.01193      0.53369  229.47s
      2     [36m0.47088[0m     1.64215    0.28675      0.48747  233.30s
      3     [36m0.43427[0m     1.85901    0.23360      0.48747  229.35s
      4     [36m0.41172[0m     2.20685    0.18656      0.48698  230.86s
      5     [36m0.38559[0m     1.96368    0.19636      0.54297  231.84s
      6     [36m0.36848[0m     2.36837    0.15559      0.53727  231.07s
Early stopping.
Best valid loss was 1.062353 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d6' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d6' (shape 64).
Loaded parameters to layer 'conv2d9' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d9' (shape 64).
Loaded parameters to layer 'conv2d10' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d10' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 1 1 0 1 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.535026041667
Error rate (%):  46.4973958333
yVal [0 0 1 ..., 0 1 1]
[[3668  152]
 [3419  441]]
roc_auc: 0.618866003852
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run2.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu1', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2', '--channels=9']
Command line arguments: Namespace(channels=[9], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run2.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient2'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu1')
Git reference:  Timestamp: 2016-09-26 06:37:33.360197
Hostname: kat
gpu1
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 512
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net0
evaluation:
    online_training: False
    model: net0

end Configuration
Loading and preprocessing data...
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_3/3_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.71958528
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 285.502749634 296.192626953
20 450.084130859 467.958953857
30 614.532775879 635.983337402
40 803.39387207 825.053771973
50 1040.5769043 1057.9163208
60 1362.47683105 1366.25817871
70 1832.86739502 1809.89105225
80 2600.76484375 2522.00878906
90 4211.33994141 4013.83605957
100 48435.8945312 81443.234375
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net0
Model name for the evaluation phase:  net0
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x512x64
  1          64x512x64
  2          64x512x64
  3          64x256x32
  4          64x256x32
  5          64x256x32
  6          64x256x32
  7          64x128x16
  8          64x128x16
  9          64x128x16
 10          2x128x16
 11          2
 12          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m2.03312[0m     [32m0.80613[0m    2.52207      0.48714  226.10s
      2     [36m0.53557[0m     1.15267    0.46463      0.52132  233.80s
      3     [36m0.47922[0m     1.20333    0.39825      0.64160  229.78s
      4     [36m0.40357[0m     1.79871    0.22437      0.59440  229.66s
      5     [36m0.35402[0m     2.02268    0.17502      0.61540  221.78s
      6     [36m0.32374[0m     2.25424    0.14361      0.63900  230.67s
Early stopping.
Best valid loss was 0.806133 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d6' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d6' (shape 64).
Loaded parameters to layer 'conv2d9' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d9' (shape 64).
Loaded parameters to layer 'conv2d10' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d10' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.486197916667
Error rate (%):  51.3802083333
yVal [0 0 1 ..., 0 1 1]
[[3734   86]
 [3860    0]]
roc_auc: 0.610094674877
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run2.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu1', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2', '--channels=10']
Command line arguments: Namespace(channels=[10], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run2.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient2'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu1')
Git reference:  Timestamp: 2016-09-26 07:07:19.927455
Hostname: kat
gpu1
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 512
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net0
evaluation:
    online_training: False
    model: net0

end Configuration
Loading and preprocessing data...
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_3/3_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.720797696
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 236.922592163 251.930305481
20 374.708331299 398.486328125
30 513.062701416 542.605255127
40 672.122216797 702.880554199
50 870.568389893 898.108978271
60 1134.3536377 1151.20678711
70 1508.80095215 1504.14630127
80 2091.72822266 2048.65869141
90 3209.14863281 3084.92993164
100 33467.8828125 31567.0722656
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net0
Model name for the evaluation phase:  net0
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x512x64
  1          64x512x64
  2          64x512x64
  3          64x256x32
  4          64x256x32
  5          64x256x32
  6          64x256x32
  7          64x128x16
  8          64x128x16
  9          64x128x16
 10          2x128x16
 11          2
 12          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m2.00531[0m     [32m0.71673[0m    2.79784      0.61410  227.25s
      2     [36m0.51639[0m     0.85178    0.60625      0.66732  232.50s
      3     [36m0.50189[0m     0.98884    0.50755      0.66276  232.69s
      4     [36m0.48698[0m     1.41445    0.34429      0.61263  231.76s
      5     [36m0.45940[0m     1.89173    0.24285      0.46029  229.83s
      6     [36m0.39805[0m     3.54335    0.11234      0.48747  231.54s
Early stopping.
Best valid loss was 0.716733 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d6' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d6' (shape 64).
Loaded parameters to layer 'conv2d9' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d9' (shape 64).
Loaded parameters to layer 'conv2d10' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d10' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[1 0 1 0 0 1 1 0 1 1 0 1 0 0 1 1 1 1 0 0 1 1 1 0 1 0 1 1 1 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.618359375
Error rate (%):  38.1640625
yVal [0 0 1 ..., 0 1 1]
[[1673 2147]
 [ 784 3076]]
roc_auc: 0.695593854271
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run2.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu1', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2', '--channels=11']
Command line arguments: Namespace(channels=[11], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run2.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient2'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu1')
Git reference:  Timestamp: 2016-09-26 07:37:23.818160
Hostname: kat
gpu1
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 512
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net0
evaluation:
    online_training: False
    model: net0

end Configuration
Loading and preprocessing data...
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_3/3_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.721055744
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 186.644313049 201.672454834
20 301.005688477 324.787322998
30 422.356951904 452.098190308
40 569.603845215 603.014648438
50 763.689239502 798.601593018
60 1034.57580566 1064.75915527
70 1430.09019775 1450.37493896
80 2050.14526367 2051.67700195
90 3226.79782715 3207.58679199
100 56520.15625 104914.585938
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net0
Model name for the evaluation phase:  net0
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x512x64
  1          64x512x64
  2          64x512x64
  3          64x256x32
  4          64x256x32
  5          64x256x32
  6          64x256x32
  7          64x128x16
  8          64x128x16
  9          64x128x16
 10          2x128x16
 11          2
 12          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m2.06355[0m     [32m0.65192[0m    3.16537      0.74040  222.70s
      2     [36m0.49306[0m     0.80259    0.61433      0.76090  232.42s
      3     [36m0.44884[0m     1.46362    0.30667      0.53141  230.02s
      4     [36m0.38106[0m     2.34499    0.16250      0.58577  231.21s
      5     [36m0.31812[0m     2.87236    0.11075      0.60075  229.94s
      6     [36m0.26008[0m     3.86928    0.06722      0.57259  234.15s
Early stopping.
Best valid loss was 0.651916 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d6' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d6' (shape 64).
Loaded parameters to layer 'conv2d9' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d9' (shape 64).
Loaded parameters to layer 'conv2d10' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d10' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[1 1 0 0 0 1 1 0 1 1 1 1 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 1 1 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.734895833333
Error rate (%):  26.5104166667
yVal [0 0 1 ..., 0 1 1]
[[2568 1252]
 [ 784 3076]]
roc_auc: 0.734756124027
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run2.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu1', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2', '--channels=12']
Command line arguments: Namespace(channels=[12], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run2.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient2'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu1')
Git reference:  Timestamp: 2016-09-26 08:07:33.749107
Hostname: kat
gpu1
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 512
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net0
evaluation:
    online_training: False
    model: net0

end Configuration
Loading and preprocessing data...
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_3/3_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.720846848
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 248.17615509 252.292892456
20 390.046142578 397.643157959
30 530.814239502 540.408538818
40 692.21217041 701.233337402
50 895.86038208 900.681671143
60 1176.14956055 1169.04772949
70 1593.55310059 1562.03234863
80 2265.55048828 2189.94775391
90 3531.49135742 3371.82397461
100 68512.453125 61788.859375
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net0
Model name for the evaluation phase:  net0
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x512x64
  1          64x512x64
  2          64x512x64
  3          64x256x32
  4          64x256x32
  5          64x256x32
  6          64x256x32
  7          64x128x16
  8          64x128x16
  9          64x128x16
 10          2x128x16
 11          2
 12          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m1.86279[0m     [32m0.72332[0m    2.57532      0.60677  235.43s
      2     [36m0.52321[0m     0.98443    0.53149      0.58854  236.78s
      3     [36m0.47924[0m     1.51817    0.31567      0.48747  237.39s
      4     [36m0.44134[0m     1.78797    0.24684      0.59098  232.17s
      5     [36m0.39916[0m     1.68250    0.23724      0.59424  234.75s
      6     [36m0.35087[0m     1.86639    0.18799      0.59180  236.24s
Early stopping.
Best valid loss was 0.723323 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d6' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d6' (shape 64).
Loaded parameters to layer 'conv2d9' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d9' (shape 64).
Loaded parameters to layer 'conv2d10' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d10' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[0 1 0 0 0 0 0 0 1 1 1 1 0 0 1 0 1 0 0 0 1 0 0 0 0 0 0 0 0 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.600651041667
Error rate (%):  39.9348958333
yVal [0 0 1 ..., 0 1 1]
[[3381  439]
 [2628 1232]]
roc_auc: 0.665412201937
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run2.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu1', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2', '--channels=13']
Command line arguments: Namespace(channels=[13], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run2.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient2'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu1')
Git reference:  Timestamp: 2016-09-26 08:37:59.982875
Hostname: kat
gpu1
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 512
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net0
evaluation:
    online_training: False
    model: net0

end Configuration
Loading and preprocessing data...
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_3/3_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.7233536
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 313.265170288 326.406982422
20 498.231085205 521.788146973
30 685.862628174 717.073608398
40 902.230651855 938.709350586
50 1171.92333984 1206.95782471
60 1527.57519531 1552.16845703
70 2029.24715576 2029.27972412
80 2804.71967773 2764.22265625
90 4254.45888672 4141.17211914
100 35079.8945312 31263.9492188
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net0
Model name for the evaluation phase:  net0
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x512x64
  1          64x512x64
  2          64x512x64
  3          64x256x32
  4          64x256x32
  5          64x256x32
  6          64x256x32
  7          64x128x16
  8          64x128x16
  9          64x128x16
 10          2x128x16
 11          2
 12          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m2.16735[0m     [32m0.87683[0m    2.47181      0.47298  230.32s
      2     [36m0.49054[0m     1.65493    0.29641      0.47982  228.59s
      3     [36m0.44413[0m     1.82538    0.24331      0.45931  234.90s
      4     [36m0.41302[0m     1.87019    0.22085      0.45296  232.61s
      5     [36m0.37146[0m     2.66734    0.13926      0.47217  232.08s
      6     [36m0.34401[0m     2.44046    0.14096      0.50391  231.47s
Early stopping.
Best valid loss was 0.876827 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d6' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d6' (shape 64).
Loaded parameters to layer 'conv2d9' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d9' (shape 64).
Loaded parameters to layer 'conv2d10' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d10' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.474479166667
Error rate (%):  52.5520833333
yVal [0 0 1 ..., 0 1 1]
[[3343  477]
 [3559  301]]
roc_auc: 0.599092416515
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run2.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu1', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2', '--channels=14']
Command line arguments: Namespace(channels=[14], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run2.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient2'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu1')
Git reference:  Timestamp: 2016-09-26 09:08:11.759679
Hostname: kat
gpu1
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 512
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net0
evaluation:
    online_training: False
    model: net0

end Configuration
Loading and preprocessing data...
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_3/3_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.720498688
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 268.114727783 273.846969604
20 419.789349365 430.405151367
30 568.496173096 582.308776855
40 736.171875 750.966308594
50 942.937286377 954.910858154
60 1216.87109375 1218.35766602
70 1611.33862305 1587.65899658
80 2251.2371582 2171.8034668
90 3539.77995605 3341.80603027
100 38412.0351562 39300.5585938
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net0
Model name for the evaluation phase:  net0
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x512x64
  1          64x512x64
  2          64x512x64
  3          64x256x32
  4          64x256x32
  5          64x256x32
  6          64x256x32
  7          64x128x16
  8          64x128x16
  9          64x128x16
 10          2x128x16
 11          2
 12          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m1.81129[0m     [32m0.93704[0m    1.93300      0.58464  234.87s
      2     [36m0.51081[0m     1.41055    0.36214      0.56087  236.49s
      3     [36m0.48430[0m     1.70001    0.28488      0.57373  232.31s
      4     [36m0.46338[0m     2.17625    0.21293      0.57487  241.65s
      5     [36m0.42733[0m     2.98725    0.14305      0.51335  234.15s
      6     [36m0.39393[0m     2.98278    0.13207      0.55225  234.79s
Early stopping.
Best valid loss was 0.937037 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d6' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d6' (shape 64).
Loaded parameters to layer 'conv2d9' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d9' (shape 64).
Loaded parameters to layer 'conv2d10' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d10' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 1 0 1 1 0 1 0 0 1 0 0 1 0 0 0 0 0 0 0 0 0 1 0 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.592057291667
Error rate (%):  40.7942708333
yVal [0 0 1 ..., 0 1 1]
[[3368  452]
 [2681 1179]]
roc_auc: 0.571076791091
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run2.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu1', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2', '--channels=15']
Command line arguments: Namespace(channels=[15], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run2.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient2'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu1')
Git reference:  Timestamp: 2016-09-26 09:38:47.774449
Hostname: kat
gpu1
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 512
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net0
evaluation:
    online_training: False
    model: net0

end Configuration
Loading and preprocessing data...
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_3/3_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.720318464
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 209.032162476 220.332107544
20 332.380444336 351.279418945
30 459.308435059 484.765441895
40 610.22890625 640.295166016
50 804.460357666 836.352508545
60 1069.28730469 1096.11523438
70 1449.42525635 1460.753479
80 2038.72851562 2017.47363281
90 3126.08322754 3036.31750488
100 28167.1855469 26524.03125
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net0
Model name for the evaluation phase:  net0
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x512x64
  1          64x512x64
  2          64x512x64
  3          64x256x32
  4          64x256x32
  5          64x256x32
  6          64x256x32
  7          64x128x16
  8          64x128x16
  9          64x128x16
 10          2x128x16
 11          2
 12          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m1.71329[0m     [32m0.79103[0m    2.16591      0.62988  232.18s
      2     [36m0.50385[0m     1.02155    0.49322      0.58757  233.00s
      3     [36m0.47911[0m     1.10681    0.43287      0.58431  234.85s
      4     [36m0.45568[0m     1.35093    0.33731      0.60270  233.92s
      5     [36m0.41344[0m     2.07241    0.19949      0.57878  236.48s
      6     [36m0.37492[0m     2.43615    0.15390      0.58805  236.35s
Early stopping.
Best valid loss was 0.791026 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d6' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d6' (shape 64).
Loaded parameters to layer 'conv2d9' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d9' (shape 64).
Loaded parameters to layer 'conv2d10' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d10' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 1 1 0 1 0 0 1 0 1 0 0 0 0 0 0 0 0 0 0 1 0 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.628645833333
Error rate (%):  37.1354166667
yVal [0 0 1 ..., 0 1 1]
[[3483  337]
 [2515 1345]]
roc_auc: 0.666021688414
