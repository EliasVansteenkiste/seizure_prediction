['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config8.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_0']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config8.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_0'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-12 11:37:14.874240
Hostname: kat
gpu3
Configuration 'config8.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: wideResNet0
evaluation:
    online_training: False
    model: wideResNet0

end Configuration
['patient0_0']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [0]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.741429248
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 77.4825836182 42.2078788757
20 305.512463379 300.472479248
30 461.135577393 459.25463562
40 614.021606445 614.238354492
50 784.364746094 787.311828613
60 993.193286133 998.551342773
70 1272.31512451 1279.6506958
80 1694.84467773 1704.01054688
90 2529.98266602 2551.26169434
100 45472.875 51963.8164062
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  wideResNet0
Model name for the evaluation phase:  wideResNet0
Training model...
# Neural Network with 532482 learnable parameters

## Layer information

  #  name                 size
---  -------------------  ---------
  0  input                1x192x64
  1                       64x192x64
  2  batch_norm1          64x192x64
  3  batch_norm1_nonlin   64x192x64
  4                       64x192x64
  5  res0__conv1          64x192x64
  6  res0__conv1_nonlin   64x192x64
  7  res0__dropout        64x192x64
  8  res0__conv2          64x192x64
  9  res0__projection     64x192x64
 10  res0__sum            64x192x64
 11  res3__bn             64x192x64
 12  res3__nonlin         64x192x64
 13                       64x96x32
 14  res3__conv1          64x96x32
 15  res3__conv1_nonlin   64x96x32
 16  res3__dropout        64x96x32
 17  res3__conv2          64x96x32
 18  res3__projection     64x96x32
 19  res3__sum            64x96x32
 20  res4_1_bn            64x96x32
 21  res4_1_nonlin        64x96x32
 22                       64x96x32
 23  res4_1_conv1         64x96x32
 24  res4_1_conv1_nonlin  64x96x32
 25  res4_1_dropout       64x96x32
 26  res4_1_conv2         64x96x32
 27  res4_1_sum           64x96x32
 28  res4_2_bn            64x96x32
 29  res4_2_nonlin        64x96x32
 30                       64x96x32
 31  res4_2_conv1         64x96x32
 32  res4_2_conv1_nonlin  64x96x32
 33  res4_2_dropout       64x96x32
 34  res4_2_conv2         64x96x32
 35  res4_2_sum           64x96x32
 36  res5__bn             64x96x32
 37  res5__nonlin         64x96x32
 38                       64x48x16
 39  res5__conv1          64x48x16
 40  res5__conv1_nonlin   64x48x16
 41  res5__dropout        64x48x16
 42  res5__conv2          64x48x16
 43  res5__projection     64x48x16
 44  res5__sum            64x48x16
 45  res6_1_bn            64x48x16
 46  res6_1_nonlin        64x48x16
 47                       64x48x16
 48  res6_1_conv1         64x48x16
 49  res6_1_conv1_nonlin  64x48x16
 50  res6_1_dropout       64x48x16
 51  res6_1_conv2         64x48x16
 52  res6_1_sum           64x48x16
 53  res6_2_bn            64x48x16
 54  res6_2_nonlin        64x48x16
 55                       64x48x16
 56  res6_2_conv1         64x48x16
 57  res6_2_conv1_nonlin  64x48x16
 58  res6_2_dropout       64x48x16
 59  res6_2_conv2         64x48x16
 60  res6_2_sum           64x48x16
 61  bn_post_conv         64x48x16
 62  post_conv_nonlin     64x48x16
 63  last_conv            2x48x16
 64  global_pool          2
 65  softmax              2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m0.60446[0m     [32m1.09033[0m    0.55438      0.51332  488.11s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.50794[0m     [32m0.87536[0m    0.58027      0.55928  493.56s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.35455[0m     1.26189    0.28097      0.58489  496.32s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.23800[0m     1.56966    0.15163      0.52847  499.48s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.17332[0m     2.04412    0.08479      0.51146  504.96s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.13964[0m     2.47000    0.05653      0.47829  504.96s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.12159[0m     2.74681    0.04427      0.48236  509.85s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.875356 at epoch 2.
Loaded parameters to layer 'conv2ddnn1' (shape 64x1x3x3).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'conv2ddnn4' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv2' (shape 64).
Loaded parameters to layer 'res0__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn13' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv2' (shape 64).
Loaded parameters to layer 'res3__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn22' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv2' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn30' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv2' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn38' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv2' (shape 64).
Loaded parameters to layer 'res5__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn47' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv2' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn55' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv2' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'last_conv' (shape 2x64x3x3).
Loaded parameters to layer 'last_conv' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.849976074265
Error rate (%):  15.0023925735
[[44407  1763]
 [ 6075     0]]
(52245,)
(52245,)
roc_auc: 0.470295166102
log_loss: inf
roc_auc for the hours: 0.342105263158
log_loss for the hours: 3.58134120673
saving predictions to csv file
hourspatient0_0_wideResNet0_10-12-12-48-52.csv
Accuracy validation for the hours:  0.883720930233
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [0]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.223282688
saving predictions to csv file
patient0_0_wideResNet0_10-12-12-53-06.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config8.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_1']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config8.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_1'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-12 12:53:07.960560
Hostname: kat
gpu3
Configuration 'config8.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: wideResNet1
evaluation:
    online_training: False
    model: wideResNet1

end Configuration
['patient0_1']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [1]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.744681472
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 79.8583602905 43.7949028015
20 305.763250732 299.520977783
30 453.40585022 450.005862427
40 592.349865723 590.177758789
50 740.968597412 740.054229736
60 918.324951172 917.797363281
70 1161.24418945 1163.53183594
80 1578.52695313 1588.20612793
90 2613.2675293 2653.38178711
100 212492.21875 103666.890625
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  wideResNet1
Model name for the evaluation phase:  wideResNet1
Training model...
# Neural Network with 606338 learnable parameters

## Layer information

  #  name                 size
---  -------------------  ---------
  0  input                1x192x64
  1  conv2d_1             64x192x64
  2  conv2d_2             64x192x64
  3  dropout1             64x192x64
  4  conv2d_3             64x96x32
  5  batch_norm1          64x96x32
  6  batch_norm1_nonlin   64x96x32
  7                       64x96x32
  8  res0__conv1          64x96x32
  9  res0__conv1_nonlin   64x96x32
 10  res0__dropout        64x96x32
 11  res0__conv2          64x96x32
 12  res0__projection     64x96x32
 13  res0__sum            64x96x32
 14  res3__bn             64x96x32
 15  res3__nonlin         64x96x32
 16                       64x48x16
 17  res3__conv1          64x48x16
 18  res3__conv1_nonlin   64x48x16
 19  res3__dropout        64x48x16
 20  res3__conv2          64x48x16
 21  res3__projection     64x48x16
 22  res3__sum            64x48x16
 23  res4_1_bn            64x48x16
 24  res4_1_nonlin        64x48x16
 25                       64x48x16
 26  res4_1_conv1         64x48x16
 27  res4_1_conv1_nonlin  64x48x16
 28  res4_1_dropout       64x48x16
 29  res4_1_conv2         64x48x16
 30  res4_1_sum           64x48x16
 31  res4_2_bn            64x48x16
 32  res4_2_nonlin        64x48x16
 33                       64x48x16
 34  res4_2_conv1         64x48x16
 35  res4_2_conv1_nonlin  64x48x16
 36  res4_2_dropout       64x48x16
 37  res4_2_conv2         64x48x16
 38  res4_2_sum           64x48x16
 39  res5__bn             64x48x16
 40  res5__nonlin         64x48x16
 41                       64x24x8
 42  res5__conv1          64x24x8
 43  res5__conv1_nonlin   64x24x8
 44  res5__dropout        64x24x8
 45  res5__conv2          64x24x8
 46  res5__projection     64x24x8
 47  res5__sum            64x24x8
 48  res6_1_bn            64x24x8
 49  res6_1_nonlin        64x24x8
 50                       64x24x8
 51  res6_1_conv1         64x24x8
 52  res6_1_conv1_nonlin  64x24x8
 53  res6_1_dropout       64x24x8
 54  res6_1_conv2         64x24x8
 55  res6_1_sum           64x24x8
 56  res6_2_bn            64x24x8
 57  res6_2_nonlin        64x24x8
 58                       64x24x8
 59  res6_2_conv1         64x24x8
 60  res6_2_conv1_nonlin  64x24x8
 61  res6_2_dropout       64x24x8
 62  res6_2_conv2         64x24x8
 63  res6_2_sum           64x24x8
 64  bn_post_conv         64x24x8
 65  post_conv_nonlin     64x24x8
 66  last_conv            2x24x8
 67  global_pool          2
 68  softmax              2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m0.59874[0m     [32m1.70785[0m    0.35058      0.50098  259.38s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.52547[0m     [32m1.55506[0m    0.33791      0.50931  263.02s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.42882[0m     1.81075    0.23682      0.50541  260.02s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.33240[0m     2.18917    0.15184      0.50237  260.19s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.23513[0m     2.00987    0.11699      0.42442  257.15s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.17246[0m     2.35390    0.07327      0.41937  254.06s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.13201[0m     3.10329    0.04254      0.43745  260.72s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 1.555059 at epoch 2.
Loaded parameters to layer 'conv2d_1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d_1' (shape 64).
Loaded parameters to layer 'conv2d_2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d_2' (shape 64).
Loaded parameters to layer 'conv2d_3' (shape 64x64x3x3).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'conv2ddnn7' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv2' (shape 64).
Loaded parameters to layer 'res0__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn16' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv2' (shape 64).
Loaded parameters to layer 'res3__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn25' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv2' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn33' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv2' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn41' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv2' (shape 64).
Loaded parameters to layer 'res5__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn50' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv2' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn58' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv2' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'last_conv' (shape 2x64x3x3).
Loaded parameters to layer 'last_conv' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.118231409704
Error rate (%):  88.1768590296
[[  102 46068]
 [    0  6075]]
(52245,)
(52245,)
roc_auc: 0.531244933958
log_loss: nan
roc_auc for the hours: 0.657894736842
log_loss for the hours: nan
saving predictions to csv file
hourspatient0_1_wideResNet1_10-12-13-35-15.csv
Accuracy validation for the hours:  0.116279069767
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [1]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.292152832
saving predictions to csv file
patient0_1_wideResNet1_10-12-13-38-37.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config8.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_2']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config8.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_2'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-12 13:38:39.565497
Hostname: kat
gpu3
Configuration 'config8.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: wideResNet1
evaluation:
    online_training: False
    model: wideResNet1

end Configuration
['patient0_2']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [2]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.745472
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 72.0125099182 40.3037857056
20 276.55925293 272.411431885
30 416.599380493 415.294677734
40 555.997583008 556.773425293
50 715.97946167 718.930877686
60 923.099047852 927.542578125
70 1228.42805176 1233.38067627
80 1756.11213379 1761.63308105
90 3001.92504883 3026.81286621
100 72650.4921875 53126.640625
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  wideResNet1
Model name for the evaluation phase:  wideResNet1
Training model...
# Neural Network with 606338 learnable parameters

## Layer information

  #  name                 size
---  -------------------  ---------
  0  input                1x192x64
  1  conv2d_1             64x192x64
  2  conv2d_2             64x192x64
  3  dropout1             64x192x64
  4  conv2d_3             64x96x32
  5  batch_norm1          64x96x32
  6  batch_norm1_nonlin   64x96x32
  7                       64x96x32
  8  res0__conv1          64x96x32
  9  res0__conv1_nonlin   64x96x32
 10  res0__dropout        64x96x32
 11  res0__conv2          64x96x32
 12  res0__projection     64x96x32
 13  res0__sum            64x96x32
 14  res3__bn             64x96x32
 15  res3__nonlin         64x96x32
 16                       64x48x16
 17  res3__conv1          64x48x16
 18  res3__conv1_nonlin   64x48x16
 19  res3__dropout        64x48x16
 20  res3__conv2          64x48x16
 21  res3__projection     64x48x16
 22  res3__sum            64x48x16
 23  res4_1_bn            64x48x16
 24  res4_1_nonlin        64x48x16
 25                       64x48x16
 26  res4_1_conv1         64x48x16
 27  res4_1_conv1_nonlin  64x48x16
 28  res4_1_dropout       64x48x16
 29  res4_1_conv2         64x48x16
 30  res4_1_sum           64x48x16
 31  res4_2_bn            64x48x16
 32  res4_2_nonlin        64x48x16
 33                       64x48x16
 34  res4_2_conv1         64x48x16
 35  res4_2_conv1_nonlin  64x48x16
 36  res4_2_dropout       64x48x16
 37  res4_2_conv2         64x48x16
 38  res4_2_sum           64x48x16
 39  res5__bn             64x48x16
 40  res5__nonlin         64x48x16
 41                       64x24x8
 42  res5__conv1          64x24x8
 43  res5__conv1_nonlin   64x24x8
 44  res5__dropout        64x24x8
 45  res5__conv2          64x24x8
 46  res5__projection     64x24x8
 47  res5__sum            64x24x8
 48  res6_1_bn            64x24x8
 49  res6_1_nonlin        64x24x8
 50                       64x24x8
 51  res6_1_conv1         64x24x8
 52  res6_1_conv1_nonlin  64x24x8
 53  res6_1_dropout       64x24x8
 54  res6_1_conv2         64x24x8
 55  res6_1_sum           64x24x8
 56  res6_2_bn            64x24x8
 57  res6_2_nonlin        64x24x8
 58                       64x24x8
 59  res6_2_conv1         64x24x8
 60  res6_2_conv1_nonlin  64x24x8
 61  res6_2_dropout       64x24x8
 62  res6_2_conv2         64x24x8
 63  res6_2_sum           64x24x8
 64  bn_post_conv         64x24x8
 65  post_conv_nonlin     64x24x8
 66  last_conv            2x24x8
 67  global_pool          2
 68  softmax              2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m0.57638[0m     [32m1.43163[0m    0.40260      0.49477  259.58s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.46501[0m     [32m1.15673[0m    0.40201      0.54813  266.93s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.34837[0m     1.87177    0.18612      0.48553  265.14s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.23725[0m     2.41708    0.09816      0.48824  263.46s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.16856[0m     4.92860    0.03420      0.45294  257.70s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.12160[0m     5.31556    0.02288      0.45435  256.18s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.10104[0m     6.04193    0.01672      0.45203  256.66s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 1.156730 at epoch 2.
Loaded parameters to layer 'conv2d_1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d_1' (shape 64).
Loaded parameters to layer 'conv2d_2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d_2' (shape 64).
Loaded parameters to layer 'conv2d_3' (shape 64x64x3x3).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'conv2ddnn7' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv2' (shape 64).
Loaded parameters to layer 'res0__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn16' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv2' (shape 64).
Loaded parameters to layer 'res3__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn25' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv2' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn33' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv2' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn41' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv2' (shape 64).
Loaded parameters to layer 'res5__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn50' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv2' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn58' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv2' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'last_conv' (shape 2x64x3x3).
Loaded parameters to layer 'last_conv' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.812403100775
Error rate (%):  18.7596899225
[[42127  4043]
 [ 5758   317]]
(52245,)
(52245,)
roc_auc: 0.550243795741
log_loss: 2.39775638243
roc_auc for the hours: 0.494736842105
log_loss for the hours: 1.07619759914
saving predictions to csv file
hourspatient0_2_wideResNet1_10-12-14-20-11.csv
Accuracy validation for the hours:  0.860465116279
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [2]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.293070336
saving predictions to csv file
patient0_2_wideResNet1_10-12-14-23-32.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config8.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_3']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config8.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_3'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-12 14:23:34.951960
Hostname: kat
gpu3
Configuration 'config8.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: wideResNet1
evaluation:
    online_training: False
    model: wideResNet1

end Configuration
['patient0_3']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [3]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.745406464
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 52.0612277985 28.9869352341
20 191.337734985 185.116714478
30 292.577377319 287.197384644
40 400.500439453 396.009564209
50 535.735168457 532.537109375
60 731.05357666 729.604919434
70 1066.69674072 1069.19353027
80 1804.39440918 1808.60009766
90 3908.51987305 3891.41049805
100 124376.210938 175654.078125
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  wideResNet1
Model name for the evaluation phase:  wideResNet1
Training model...
# Neural Network with 606338 learnable parameters

## Layer information

  #  name                 size
---  -------------------  ---------
  0  input                1x192x64
  1  conv2d_1             64x192x64
  2  conv2d_2             64x192x64
  3  dropout1             64x192x64
  4  conv2d_3             64x96x32
  5  batch_norm1          64x96x32
  6  batch_norm1_nonlin   64x96x32
  7                       64x96x32
  8  res0__conv1          64x96x32
  9  res0__conv1_nonlin   64x96x32
 10  res0__dropout        64x96x32
 11  res0__conv2          64x96x32
 12  res0__projection     64x96x32
 13  res0__sum            64x96x32
 14  res3__bn             64x96x32
 15  res3__nonlin         64x96x32
 16                       64x48x16
 17  res3__conv1          64x48x16
 18  res3__conv1_nonlin   64x48x16
 19  res3__dropout        64x48x16
 20  res3__conv2          64x48x16
 21  res3__projection     64x48x16
 22  res3__sum            64x48x16
 23  res4_1_bn            64x48x16
 24  res4_1_nonlin        64x48x16
 25                       64x48x16
 26  res4_1_conv1         64x48x16
 27  res4_1_conv1_nonlin  64x48x16
 28  res4_1_dropout       64x48x16
 29  res4_1_conv2         64x48x16
 30  res4_1_sum           64x48x16
 31  res4_2_bn            64x48x16
 32  res4_2_nonlin        64x48x16
 33                       64x48x16
 34  res4_2_conv1         64x48x16
 35  res4_2_conv1_nonlin  64x48x16
 36  res4_2_dropout       64x48x16
 37  res4_2_conv2         64x48x16
 38  res4_2_sum           64x48x16
 39  res5__bn             64x48x16
 40  res5__nonlin         64x48x16
 41                       64x24x8
 42  res5__conv1          64x24x8
 43  res5__conv1_nonlin   64x24x8
 44  res5__dropout        64x24x8
 45  res5__conv2          64x24x8
 46  res5__projection     64x24x8
 47  res5__sum            64x24x8
 48  res6_1_bn            64x24x8
 49  res6_1_nonlin        64x24x8
 50                       64x24x8
 51  res6_1_conv1         64x24x8
 52  res6_1_conv1_nonlin  64x24x8
 53  res6_1_dropout       64x24x8
 54  res6_1_conv2         64x24x8
 55  res6_1_sum           64x24x8
 56  res6_2_bn            64x24x8
 57  res6_2_nonlin        64x24x8
 58                       64x24x8
 59  res6_2_conv1         64x24x8
 60  res6_2_conv1_nonlin  64x24x8
 61  res6_2_dropout       64x24x8
 62  res6_2_conv2         64x24x8
 63  res6_2_sum           64x24x8
 64  bn_post_conv         64x24x8
 65  post_conv_nonlin     64x24x8
 66  last_conv            2x24x8
 67  global_pool          2
 68  softmax              2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m0.60043[0m     [32m1.67225[0m    0.35906      0.37584  263.08s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.51833[0m     [32m0.74338[0m    0.69726      0.59625  261.56s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.41302[0m     0.89418    0.46190      0.62452  256.93s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.29966[0m     1.29181    0.23197      0.59713  256.67s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.21929[0m     1.49898    0.14629      0.53993  262.03s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.16244[0m     2.18249    0.07443      0.54998  267.27s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.12761[0m     2.31059    0.05523      0.52399  264.41s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.743376 at epoch 2.
Loaded parameters to layer 'conv2d_1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d_1' (shape 64).
Loaded parameters to layer 'conv2d_2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d_2' (shape 64).
Loaded parameters to layer 'conv2d_3' (shape 64x64x3x3).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'conv2ddnn7' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv2' (shape 64).
Loaded parameters to layer 'res0__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn16' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv2' (shape 64).
Loaded parameters to layer 'res3__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn25' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv2' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn33' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv2' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn41' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv2' (shape 64).
Loaded parameters to layer 'res5__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn50' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv2' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn58' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv2' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'last_conv' (shape 2x64x3x3).
Loaded parameters to layer 'last_conv' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.116279069767
Error rate (%):  88.3720930233
[[    0 46170]
 [    0  6075]]
(52245,)
(52245,)
roc_auc: 0.532300084408
log_loss: nan
roc_auc for the hours: 0.657894736842
log_loss for the hours: nan
saving predictions to csv file
hourspatient0_3_wideResNet1_10-12-15-02-57.csv
Accuracy validation for the hours:  0.116279069767
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [3]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.293799424
saving predictions to csv file
patient0_3_wideResNet1_10-12-15-06-06.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config8.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_4']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config8.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_4'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-12 15:06:08.162001
Hostname: kat
gpu3
Configuration 'config8.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: wideResNet1
evaluation:
    online_training: False
    model: wideResNet1

end Configuration
['patient0_4']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [4]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.747008
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 60.27771492 33.2891647339
20 230.724859619 226.139196777
30 348.998257446 345.771307373
40 468.468225098 465.978533936
50 608.787628174 607.555786133
60 801.863439941 803.590454102
70 1127.33896484 1136.01357422
80 1802.12897949 1820.19179688
90 3236.02592773 3251.78005371
100 159526.84375 66619.4296875
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  wideResNet1
Model name for the evaluation phase:  wideResNet1
Training model...
# Neural Network with 606338 learnable parameters

## Layer information

  #  name                 size
---  -------------------  ---------
  0  input                1x192x64
  1  conv2d_1             64x192x64
  2  conv2d_2             64x192x64
  3  dropout1             64x192x64
  4  conv2d_3             64x96x32
  5  batch_norm1          64x96x32
  6  batch_norm1_nonlin   64x96x32
  7                       64x96x32
  8  res0__conv1          64x96x32
  9  res0__conv1_nonlin   64x96x32
 10  res0__dropout        64x96x32
 11  res0__conv2          64x96x32
 12  res0__projection     64x96x32
 13  res0__sum            64x96x32
 14  res3__bn             64x96x32
 15  res3__nonlin         64x96x32
 16                       64x48x16
 17  res3__conv1          64x48x16
 18  res3__conv1_nonlin   64x48x16
 19  res3__dropout        64x48x16
 20  res3__conv2          64x48x16
 21  res3__projection     64x48x16
 22  res3__sum            64x48x16
 23  res4_1_bn            64x48x16
 24  res4_1_nonlin        64x48x16
 25                       64x48x16
 26  res4_1_conv1         64x48x16
 27  res4_1_conv1_nonlin  64x48x16
 28  res4_1_dropout       64x48x16
 29  res4_1_conv2         64x48x16
 30  res4_1_sum           64x48x16
 31  res4_2_bn            64x48x16
 32  res4_2_nonlin        64x48x16
 33                       64x48x16
 34  res4_2_conv1         64x48x16
 35  res4_2_conv1_nonlin  64x48x16
 36  res4_2_dropout       64x48x16
 37  res4_2_conv2         64x48x16
 38  res4_2_sum           64x48x16
 39  res5__bn             64x48x16
 40  res5__nonlin         64x48x16
 41                       64x24x8
 42  res5__conv1          64x24x8
 43  res5__conv1_nonlin   64x24x8
 44  res5__dropout        64x24x8
 45  res5__conv2          64x24x8
 46  res5__projection     64x24x8
 47  res5__sum            64x24x8
 48  res6_1_bn            64x24x8
 49  res6_1_nonlin        64x24x8
 50                       64x24x8
 51  res6_1_conv1         64x24x8
 52  res6_1_conv1_nonlin  64x24x8
 53  res6_1_dropout       64x24x8
 54  res6_1_conv2         64x24x8
 55  res6_1_sum           64x24x8
 56  res6_2_bn            64x24x8
 57  res6_2_nonlin        64x24x8
 58                       64x24x8
 59  res6_2_conv1         64x24x8
 60  res6_2_conv1_nonlin  64x24x8
 61  res6_2_dropout       64x24x8
 62  res6_2_conv2         64x24x8
 63  res6_2_sum           64x24x8
 64  bn_post_conv         64x24x8
 65  post_conv_nonlin     64x24x8
 66  last_conv            2x24x8
 67  global_pool          2
 68  softmax              2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m0.57452[0m     [32m0.83531[0m    0.68779      0.55595  258.88s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.44208[0m     2.54732    0.17355      0.49814  261.38s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.25494[0m     1.90015    0.13417      0.46021  260.00s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.16807[0m     4.41906    0.03803      0.44607  260.83s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.13108[0m     4.40272    0.02977      0.44757  260.70s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.12952[0m     2.25655    0.05740      0.48654  258.41s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.835314 at epoch 1.
Loaded parameters to layer 'conv2d_1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d_1' (shape 64).
Loaded parameters to layer 'conv2d_2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d_2' (shape 64).
Loaded parameters to layer 'conv2d_3' (shape 64x64x3x3).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'conv2ddnn7' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv2' (shape 64).
Loaded parameters to layer 'res0__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn16' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv2' (shape 64).
Loaded parameters to layer 'res3__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn25' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv2' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn33' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv2' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn41' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv2' (shape 64).
Loaded parameters to layer 'res5__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn50' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv2' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn58' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv2' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'last_conv' (shape 2x64x3x3).
Loaded parameters to layer 'last_conv' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.530443104603
Error rate (%):  46.9556895397
[[24311 21859]
 [ 2673  3402]]
(52245,)
(52245,)
roc_auc: 0.582559316036
log_loss: nan
roc_auc for the hours: 0.584210526316
log_loss for the hours: 0.814613657982
saving predictions to csv file
hourspatient0_4_wideResNet1_10-12-15-43-38.csv
Accuracy validation for the hours:  0.581395348837
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [4]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.242755072
saving predictions to csv file
patient0_4_wideResNet1_10-12-15-46-57.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config8.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_5']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config8.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_5'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-12 15:46:59.278457
Hostname: kat
gpu3
Configuration 'config8.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: wideResNet1
evaluation:
    online_training: False
    model: wideResNet1

end Configuration
['patient0_5']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [5]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.745644032
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 44.228635788 24.8328939438
20 167.781503296 163.806289673
30 254.511244202 251.485551453
40 343.928485107 341.169134521
50 452.231292725 450.168884277
60 604.746826172 604.360339355
70 863.724084473 868.017297363
80 1408.11137695 1423.19575195
90 2638.64152832 2674.38774414
100 60107.1914062 35895.5507812
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  wideResNet1
Model name for the evaluation phase:  wideResNet1
Training model...
# Neural Network with 606338 learnable parameters

## Layer information

  #  name                 size
---  -------------------  ---------
  0  input                1x192x64
  1  conv2d_1             64x192x64
  2  conv2d_2             64x192x64
  3  dropout1             64x192x64
  4  conv2d_3             64x96x32
  5  batch_norm1          64x96x32
  6  batch_norm1_nonlin   64x96x32
  7                       64x96x32
  8  res0__conv1          64x96x32
  9  res0__conv1_nonlin   64x96x32
 10  res0__dropout        64x96x32
 11  res0__conv2          64x96x32
 12  res0__projection     64x96x32
 13  res0__sum            64x96x32
 14  res3__bn             64x96x32
 15  res3__nonlin         64x96x32
 16                       64x48x16
 17  res3__conv1          64x48x16
 18  res3__conv1_nonlin   64x48x16
 19  res3__dropout        64x48x16
 20  res3__conv2          64x48x16
 21  res3__projection     64x48x16
 22  res3__sum            64x48x16
 23  res4_1_bn            64x48x16
 24  res4_1_nonlin        64x48x16
 25                       64x48x16
 26  res4_1_conv1         64x48x16
 27  res4_1_conv1_nonlin  64x48x16
 28  res4_1_dropout       64x48x16
 29  res4_1_conv2         64x48x16
 30  res4_1_sum           64x48x16
 31  res4_2_bn            64x48x16
 32  res4_2_nonlin        64x48x16
 33                       64x48x16
 34  res4_2_conv1         64x48x16
 35  res4_2_conv1_nonlin  64x48x16
 36  res4_2_dropout       64x48x16
 37  res4_2_conv2         64x48x16
 38  res4_2_sum           64x48x16
 39  res5__bn             64x48x16
 40  res5__nonlin         64x48x16
 41                       64x24x8
 42  res5__conv1          64x24x8
 43  res5__conv1_nonlin   64x24x8
 44  res5__dropout        64x24x8
 45  res5__conv2          64x24x8
 46  res5__projection     64x24x8
 47  res5__sum            64x24x8
 48  res6_1_bn            64x24x8
 49  res6_1_nonlin        64x24x8
 50                       64x24x8
 51  res6_1_conv1         64x24x8
 52  res6_1_conv1_nonlin  64x24x8
 53  res6_1_dropout       64x24x8
 54  res6_1_conv2         64x24x8
 55  res6_1_sum           64x24x8
 56  res6_2_bn            64x24x8
 57  res6_2_nonlin        64x24x8
 58                       64x24x8
 59  res6_2_conv1         64x24x8
 60  res6_2_conv1_nonlin  64x24x8
 61  res6_2_dropout       64x24x8
 62  res6_2_conv2         64x24x8
 63  res6_2_sum           64x24x8
 64  bn_post_conv         64x24x8
 65  post_conv_nonlin     64x24x8
 66  last_conv            2x24x8
 67  global_pool          2
 68  softmax              2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m0.59527[0m     [32m0.85167[0m    0.69895      0.51051  256.31s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.49324[0m     1.64569    0.29971      0.42703  263.54s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.35144[0m     1.74175    0.20177      0.53650  258.65s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.22890[0m     2.59251    0.08829      0.49526  261.12s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.17004[0m     2.33451    0.07284      0.50305  260.73s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.13849[0m     2.31400    0.05985      0.51470  258.52s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.851671 at epoch 1.
Loaded parameters to layer 'conv2d_1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d_1' (shape 64).
Loaded parameters to layer 'conv2d_2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d_2' (shape 64).
Loaded parameters to layer 'conv2d_3' (shape 64x64x3x3).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'conv2ddnn7' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv2' (shape 64).
Loaded parameters to layer 'res0__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn16' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv2' (shape 64).
Loaded parameters to layer 'res3__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn25' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv2' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn33' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv2' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn41' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv2' (shape 64).
Loaded parameters to layer 'res5__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn50' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv2' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn58' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv2' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'last_conv' (shape 2x64x3x3).
Loaded parameters to layer 'last_conv' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.260847928031
Error rate (%):  73.9152071969
[[ 8703 37467]
 [ 1150  4925]]
(52245,)
(52245,)
roc_auc: 0.539636612234
log_loss: 3.71217527993
roc_auc for the hours: 0.573684210526
log_loss for the hours: 2.03378614495
saving predictions to csv file
hourspatient0_5_wideResNet1_10-12-16-25-29.csv
Accuracy validation for the hours:  0.232558139535
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [5]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.24125184
saving predictions to csv file
patient0_5_wideResNet1_10-12-16-28-47.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config8.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_6']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config8.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_6'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-12 16:28:49.966829
Hostname: kat
gpu3
Configuration 'config8.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: wideResNet1
evaluation:
    online_training: False
    model: wideResNet1

end Configuration
['patient0_6']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [6]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.74582016
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 52.9203617096 28.9710264206
20 204.033294678 198.010336304
30 310.279055786 304.778164673
40 419.120050049 413.251306152
50 547.291717529 541.047363281
60 717.765319824 711.321618652
70 980.086315918 974.004034424
80 1476.19272461 1468.43618164
90 2691.36994629 2660.87460937
100 459356.3125 258723.5625
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  wideResNet1
Model name for the evaluation phase:  wideResNet1
Training model...
# Neural Network with 606338 learnable parameters

## Layer information

  #  name                 size
---  -------------------  ---------
  0  input                1x192x64
  1  conv2d_1             64x192x64
  2  conv2d_2             64x192x64
  3  dropout1             64x192x64
  4  conv2d_3             64x96x32
  5  batch_norm1          64x96x32
  6  batch_norm1_nonlin   64x96x32
  7                       64x96x32
  8  res0__conv1          64x96x32
  9  res0__conv1_nonlin   64x96x32
 10  res0__dropout        64x96x32
 11  res0__conv2          64x96x32
 12  res0__projection     64x96x32
 13  res0__sum            64x96x32
 14  res3__bn             64x96x32
 15  res3__nonlin         64x96x32
 16                       64x48x16
 17  res3__conv1          64x48x16
 18  res3__conv1_nonlin   64x48x16
 19  res3__dropout        64x48x16
 20  res3__conv2          64x48x16
 21  res3__projection     64x48x16
 22  res3__sum            64x48x16
 23  res4_1_bn            64x48x16
 24  res4_1_nonlin        64x48x16
 25                       64x48x16
 26  res4_1_conv1         64x48x16
 27  res4_1_conv1_nonlin  64x48x16
 28  res4_1_dropout       64x48x16
 29  res4_1_conv2         64x48x16
 30  res4_1_sum           64x48x16
 31  res4_2_bn            64x48x16
 32  res4_2_nonlin        64x48x16
 33                       64x48x16
 34  res4_2_conv1         64x48x16
 35  res4_2_conv1_nonlin  64x48x16
 36  res4_2_dropout       64x48x16
 37  res4_2_conv2         64x48x16
 38  res4_2_sum           64x48x16
 39  res5__bn             64x48x16
 40  res5__nonlin         64x48x16
 41                       64x24x8
 42  res5__conv1          64x24x8
 43  res5__conv1_nonlin   64x24x8
 44  res5__dropout        64x24x8
 45  res5__conv2          64x24x8
 46  res5__projection     64x24x8
 47  res5__sum            64x24x8
 48  res6_1_bn            64x24x8
 49  res6_1_nonlin        64x24x8
 50                       64x24x8
 51  res6_1_conv1         64x24x8
 52  res6_1_conv1_nonlin  64x24x8
 53  res6_1_dropout       64x24x8
 54  res6_1_conv2         64x24x8
 55  res6_1_sum           64x24x8
 56  res6_2_bn            64x24x8
 57  res6_2_nonlin        64x24x8
 58                       64x24x8
 59  res6_2_conv1         64x24x8
 60  res6_2_conv1_nonlin  64x24x8
 61  res6_2_dropout       64x24x8
 62  res6_2_conv2         64x24x8
 63  res6_2_sum           64x24x8
 64  bn_post_conv         64x24x8
 65  post_conv_nonlin     64x24x8
 66  last_conv            2x24x8
 67  global_pool          2
 68  softmax              2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m0.59226[0m     [32m0.96267[0m    0.61523      0.50005  256.48s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.48576[0m     1.06128    0.45772      0.48551  263.66s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.31329[0m     2.41175    0.12990      0.46968  262.09s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.20667[0m     2.66493    0.07755      0.48855  261.88s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.15165[0m     2.78616    0.05443      0.46854  262.39s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.12491[0m     4.41277    0.02831      0.47178  257.25s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.962674 at epoch 1.
Loaded parameters to layer 'conv2d_1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d_1' (shape 64).
Loaded parameters to layer 'conv2d_2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d_2' (shape 64).
Loaded parameters to layer 'conv2d_3' (shape 64x64x3x3).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'conv2ddnn7' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv2' (shape 64).
Loaded parameters to layer 'res0__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn16' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv2' (shape 64).
Loaded parameters to layer 'res3__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn25' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv2' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn33' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv2' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn41' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv2' (shape 64).
Loaded parameters to layer 'res5__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn50' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv2' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn58' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv2' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'last_conv' (shape 2x64x3x3).
Loaded parameters to layer 'last_conv' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.116279069767
Error rate (%):  88.3720930233
[[    0 46170]
 [    0  6075]]
(52245,)
(52245,)
roc_auc: 0.445217709467
log_loss: nan
roc_auc for the hours: 0.476315789474
log_loss for the hours: nan
saving predictions to csv file
hourspatient0_6_wideResNet1_10-12-17-05-41.csv
Accuracy validation for the hours:  0.116279069767
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [6]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.241378816
saving predictions to csv file
patient0_6_wideResNet1_10-12-17-08-57.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config8.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_7']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config8.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_7'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-12 17:09:00.331203
Hostname: kat
gpu3
Configuration 'config8.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: wideResNet1
evaluation:
    online_training: False
    model: wideResNet1

end Configuration
['patient0_7']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [7]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.746655744
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 42.2832771301 23.406820488
20 162.516268921 157.987145996
30 247.963627625 243.623634338
40 336.95199585 332.831341553
50 445.399627686 441.292938232
60 597.128845215 593.310778809
70 844.070202637 839.791943359
80 1309.5418457 1299.71809082
90 2364.6079834 2327.02700195
100 202022.625 78149.3203125
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  wideResNet1
Model name for the evaluation phase:  wideResNet1
Training model...
# Neural Network with 606338 learnable parameters

## Layer information

  #  name                 size
---  -------------------  ---------
  0  input                1x192x64
  1  conv2d_1             64x192x64
  2  conv2d_2             64x192x64
  3  dropout1             64x192x64
  4  conv2d_3             64x96x32
  5  batch_norm1          64x96x32
  6  batch_norm1_nonlin   64x96x32
  7                       64x96x32
  8  res0__conv1          64x96x32
  9  res0__conv1_nonlin   64x96x32
 10  res0__dropout        64x96x32
 11  res0__conv2          64x96x32
 12  res0__projection     64x96x32
 13  res0__sum            64x96x32
 14  res3__bn             64x96x32
 15  res3__nonlin         64x96x32
 16                       64x48x16
 17  res3__conv1          64x48x16
 18  res3__conv1_nonlin   64x48x16
 19  res3__dropout        64x48x16
 20  res3__conv2          64x48x16
 21  res3__projection     64x48x16
 22  res3__sum            64x48x16
 23  res4_1_bn            64x48x16
 24  res4_1_nonlin        64x48x16
 25                       64x48x16
 26  res4_1_conv1         64x48x16
 27  res4_1_conv1_nonlin  64x48x16
 28  res4_1_dropout       64x48x16
 29  res4_1_conv2         64x48x16
 30  res4_1_sum           64x48x16
 31  res4_2_bn            64x48x16
 32  res4_2_nonlin        64x48x16
 33                       64x48x16
 34  res4_2_conv1         64x48x16
 35  res4_2_conv1_nonlin  64x48x16
 36  res4_2_dropout       64x48x16
 37  res4_2_conv2         64x48x16
 38  res4_2_sum           64x48x16
 39  res5__bn             64x48x16
 40  res5__nonlin         64x48x16
 41                       64x24x8
 42  res5__conv1          64x24x8
 43  res5__conv1_nonlin   64x24x8
 44  res5__dropout        64x24x8
 45  res5__conv2          64x24x8
 46  res5__projection     64x24x8
 47  res5__sum            64x24x8
 48  res6_1_bn            64x24x8
 49  res6_1_nonlin        64x24x8
 50                       64x24x8
 51  res6_1_conv1         64x24x8
 52  res6_1_conv1_nonlin  64x24x8
 53  res6_1_dropout       64x24x8
 54  res6_1_conv2         64x24x8
 55  res6_1_sum           64x24x8
 56  res6_2_bn            64x24x8
 57  res6_2_nonlin        64x24x8
 58                       64x24x8
 59  res6_2_conv1         64x24x8
 60  res6_2_conv1_nonlin  64x24x8
 61  res6_2_dropout       64x24x8
 62  res6_2_conv2         64x24x8
 63  res6_2_sum           64x24x8
 64  bn_post_conv         64x24x8
 65  post_conv_nonlin     64x24x8
 66  last_conv            2x24x8
 67  global_pool          2
 68  softmax              2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m0.59901[0m     [32m0.79184[0m    0.75647      0.44012  262.35s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.49995[0m     1.39233    0.35907      0.38905  261.44s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.35517[0m     1.46460    0.24250      0.36261  260.77s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.25228[0m     4.26393    0.05916      0.45081  258.39s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.19443[0m     2.37266    0.08195      0.42680  256.48s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.15524[0m     5.35882    0.02897      0.46167  258.20s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.791844 at epoch 1.
Loaded parameters to layer 'conv2d_1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d_1' (shape 64).
Loaded parameters to layer 'conv2d_2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d_2' (shape 64).
Loaded parameters to layer 'conv2d_3' (shape 64x64x3x3).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'conv2ddnn7' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv2' (shape 64).
Loaded parameters to layer 'res0__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn16' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv2' (shape 64).
Loaded parameters to layer 'res3__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn25' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv2' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn33' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv2' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn41' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv2' (shape 64).
Loaded parameters to layer 'res5__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn50' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv2' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn58' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv2' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'last_conv' (shape 2x64x3x3).
Loaded parameters to layer 'last_conv' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.395329696622
Error rate (%):  60.4670303378
[[17934 28236]
 [ 3355  2720]]
(52245,)
(52245,)
roc_auc: 0.446848948821
log_loss: 1.86588472841
roc_auc for the hours: 0.389473684211
log_loss for the hours: 1.19693614109
saving predictions to csv file
hourspatient0_7_wideResNet1_10-12-17-44-22.csv
Accuracy validation for the hours:  0.348837209302
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [7]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.242247168
saving predictions to csv file
patient0_7_wideResNet1_10-12-17-47-56.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config8.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_8']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config8.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_8'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-12 17:47:58.558035
Hostname: kat
gpu3
Configuration 'config8.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: wideResNet1
evaluation:
    online_training: False
    model: wideResNet1

end Configuration
['patient0_8']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [8]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.745521152
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 54.1830825806 29.6300670624
20 210.284432983 202.797094727
30 322.79552002 315.015945435
40 440.955853271 432.186102295
50 584.439239502 573.883850098
60 779.399060059 765.642810059
70 1072.5894043 1055.17028809
80 1571.89633789 1552.87558594
90 2680.80834961 2671.50136719
100 68448.984375 353074.21875
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  wideResNet1
Model name for the evaluation phase:  wideResNet1
Training model...
# Neural Network with 606338 learnable parameters

## Layer information

  #  name                 size
---  -------------------  ---------
  0  input                1x192x64
  1  conv2d_1             64x192x64
  2  conv2d_2             64x192x64
  3  dropout1             64x192x64
  4  conv2d_3             64x96x32
  5  batch_norm1          64x96x32
  6  batch_norm1_nonlin   64x96x32
  7                       64x96x32
  8  res0__conv1          64x96x32
  9  res0__conv1_nonlin   64x96x32
 10  res0__dropout        64x96x32
 11  res0__conv2          64x96x32
 12  res0__projection     64x96x32
 13  res0__sum            64x96x32
 14  res3__bn             64x96x32
 15  res3__nonlin         64x96x32
 16                       64x48x16
 17  res3__conv1          64x48x16
 18  res3__conv1_nonlin   64x48x16
 19  res3__dropout        64x48x16
 20  res3__conv2          64x48x16
 21  res3__projection     64x48x16
 22  res3__sum            64x48x16
 23  res4_1_bn            64x48x16
 24  res4_1_nonlin        64x48x16
 25                       64x48x16
 26  res4_1_conv1         64x48x16
 27  res4_1_conv1_nonlin  64x48x16
 28  res4_1_dropout       64x48x16
 29  res4_1_conv2         64x48x16
 30  res4_1_sum           64x48x16
 31  res4_2_bn            64x48x16
 32  res4_2_nonlin        64x48x16
 33                       64x48x16
 34  res4_2_conv1         64x48x16
 35  res4_2_conv1_nonlin  64x48x16
 36  res4_2_dropout       64x48x16
 37  res4_2_conv2         64x48x16
 38  res4_2_sum           64x48x16
 39  res5__bn             64x48x16
 40  res5__nonlin         64x48x16
 41                       64x24x8
 42  res5__conv1          64x24x8
 43  res5__conv1_nonlin   64x24x8
 44  res5__dropout        64x24x8
 45  res5__conv2          64x24x8
 46  res5__projection     64x24x8
 47  res5__sum            64x24x8
 48  res6_1_bn            64x24x8
 49  res6_1_nonlin        64x24x8
 50                       64x24x8
 51  res6_1_conv1         64x24x8
 52  res6_1_conv1_nonlin  64x24x8
 53  res6_1_dropout       64x24x8
 54  res6_1_conv2         64x24x8
 55  res6_1_sum           64x24x8
 56  res6_2_bn            64x24x8
 57  res6_2_nonlin        64x24x8
 58                       64x24x8
 59  res6_2_conv1         64x24x8
 60  res6_2_conv1_nonlin  64x24x8
 61  res6_2_dropout       64x24x8
 62  res6_2_conv2         64x24x8
 63  res6_2_sum           64x24x8
 64  bn_post_conv         64x24x8
 65  post_conv_nonlin     64x24x8
 66  last_conv            2x24x8
 67  global_pool          2
 68  softmax              2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m0.59191[0m     [32m0.84863[0m    0.69749      0.51848  261.68s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.49754[0m     [32m0.78283[0m    0.63556      0.54606  263.15s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.35559[0m     1.35096    0.26321      0.46937  259.11s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.24819[0m     1.69170    0.14671      0.44865  256.96s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.18200[0m     1.81804    0.10011      0.47340  258.67s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.13970[0m     3.19051    0.04379      0.47756  260.09s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.11082[0m     3.00631    0.03686      0.47250  259.60s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.782829 at epoch 2.
Loaded parameters to layer 'conv2d_1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d_1' (shape 64).
Loaded parameters to layer 'conv2d_2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d_2' (shape 64).
Loaded parameters to layer 'conv2d_3' (shape 64x64x3x3).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'conv2ddnn7' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv2' (shape 64).
Loaded parameters to layer 'res0__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn16' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv2' (shape 64).
Loaded parameters to layer 'res3__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn25' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv2' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn33' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv2' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn41' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv2' (shape 64).
Loaded parameters to layer 'res5__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn50' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv2' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn58' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv2' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'last_conv' (shape 2x64x3x3).
Loaded parameters to layer 'last_conv' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.375308641975
Error rate (%):  62.4691358025
[[14435 31735]
 [  902  5173]]
(52245,)
(52245,)
roc_auc: 0.614725000022
log_loss: nan
roc_auc for the hours: 0.726315789474
log_loss for the hours: inf
saving predictions to csv file
hourspatient0_8_wideResNet1_10-12-18-29-43.csv
Accuracy validation for the hours:  0.279069767442
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [8]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.294958592
saving predictions to csv file
patient0_8_wideResNet1_10-12-18-32-58.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config8.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_9']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config8.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_9'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-12 18:33:00.274212
Hostname: kat
gpu3
Configuration 'config8.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: wideResNet1
evaluation:
    online_training: False
    model: wideResNet1

end Configuration
['patient0_9']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [9]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.746426368
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 66.6869514465 35.6989082336
20 256.319952393 245.103649902
30 392.878082275 380.05057373
40 536.743615723 521.363696289
50 716.260894775 697.441894531
60 975.356860352 953.108215332
70 1387.67550049 1363.3236084
80 2106.65888672 2072.82099609
90 3733.63100586 3669.75898437
100 262006.171875 86094.46875
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  wideResNet1
Model name for the evaluation phase:  wideResNet1
Training model...
# Neural Network with 606338 learnable parameters

## Layer information

  #  name                 size
---  -------------------  ---------
  0  input                1x192x64
  1  conv2d_1             64x192x64
  2  conv2d_2             64x192x64
  3  dropout1             64x192x64
  4  conv2d_3             64x96x32
  5  batch_norm1          64x96x32
  6  batch_norm1_nonlin   64x96x32
  7                       64x96x32
  8  res0__conv1          64x96x32
  9  res0__conv1_nonlin   64x96x32
 10  res0__dropout        64x96x32
 11  res0__conv2          64x96x32
 12  res0__projection     64x96x32
 13  res0__sum            64x96x32
 14  res3__bn             64x96x32
 15  res3__nonlin         64x96x32
 16                       64x48x16
 17  res3__conv1          64x48x16
 18  res3__conv1_nonlin   64x48x16
 19  res3__dropout        64x48x16
 20  res3__conv2          64x48x16
 21  res3__projection     64x48x16
 22  res3__sum            64x48x16
 23  res4_1_bn            64x48x16
 24  res4_1_nonlin        64x48x16
 25                       64x48x16
 26  res4_1_conv1         64x48x16
 27  res4_1_conv1_nonlin  64x48x16
 28  res4_1_dropout       64x48x16
 29  res4_1_conv2         64x48x16
 30  res4_1_sum           64x48x16
 31  res4_2_bn            64x48x16
 32  res4_2_nonlin        64x48x16
 33                       64x48x16
 34  res4_2_conv1         64x48x16
 35  res4_2_conv1_nonlin  64x48x16
 36  res4_2_dropout       64x48x16
 37  res4_2_conv2         64x48x16
 38  res4_2_sum           64x48x16
 39  res5__bn             64x48x16
 40  res5__nonlin         64x48x16
 41                       64x24x8
 42  res5__conv1          64x24x8
 43  res5__conv1_nonlin   64x24x8
 44  res5__dropout        64x24x8
 45  res5__conv2          64x24x8
 46  res5__projection     64x24x8
 47  res5__sum            64x24x8
 48  res6_1_bn            64x24x8
 49  res6_1_nonlin        64x24x8
 50                       64x24x8
 51  res6_1_conv1         64x24x8
 52  res6_1_conv1_nonlin  64x24x8
 53  res6_1_dropout       64x24x8
 54  res6_1_conv2         64x24x8
 55  res6_1_sum           64x24x8
 56  res6_2_bn            64x24x8
 57  res6_2_nonlin        64x24x8
 58                       64x24x8
 59  res6_2_conv1         64x24x8
 60  res6_2_conv1_nonlin  64x24x8
 61  res6_2_dropout       64x24x8
 62  res6_2_conv2         64x24x8
 63  res6_2_sum           64x24x8
 64  bn_post_conv         64x24x8
 65  post_conv_nonlin     64x24x8
 66  last_conv            2x24x8
 67  global_pool          2
 68  softmax              2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m0.57398[0m     [32m1.52896[0m    0.37541      0.50016  257.64s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.51003[0m     [32m0.90671[0m    0.56250      0.57628  262.94s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.41681[0m     0.91759    0.45424      0.53238  259.69s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.32819[0m     1.24007    0.26465      0.51052  258.30s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.25637[0m     1.47251    0.17410      0.47939  259.88s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.18838[0m     2.57308    0.07321      0.48385  264.33s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.14743[0m     2.72109    0.05418      0.45120  262.75s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.906714 at epoch 2.
Loaded parameters to layer 'conv2d_1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d_1' (shape 64).
Loaded parameters to layer 'conv2d_2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d_2' (shape 64).
Loaded parameters to layer 'conv2d_3' (shape 64x64x3x3).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'conv2ddnn7' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv2' (shape 64).
Loaded parameters to layer 'res0__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn16' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv2' (shape 64).
Loaded parameters to layer 'res3__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn25' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv2' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn33' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv2' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn41' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv2' (shape 64).
Loaded parameters to layer 'res5__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn50' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv2' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn58' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv2' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'last_conv' (shape 2x64x3x3).
Loaded parameters to layer 'last_conv' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.576859029572
Error rate (%):  42.3140970428
[[28256 17914]
 [ 4193  1882]]
(52245,)
(52245,)
roc_auc: 0.5473015435
log_loss: inf
roc_auc for the hours: 0.478947368421
log_loss for the hours: 0.846146231117
saving predictions to csv file
hourspatient0_9_wideResNet1_10-12-19-14-05.csv
Accuracy validation for the hours:  0.604651162791
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [9]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.294860288
saving predictions to csv file
patient0_9_wideResNet1_10-12-19-17-31.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config8.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_10']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config8.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_10'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-12 19:17:33.106212
Hostname: kat
gpu3
Configuration 'config8.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: wideResNet1
evaluation:
    online_training: False
    model: wideResNet1

end Configuration
['patient0_10']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [10]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.745521152
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 49.5935062408 26.4832733154
20 190.337982178 178.602871704
30 296.224377441 280.857037354
40 415.984814453 394.469250488
50 577.838653564 548.425720215
60 818.775402832 780.941381836
70 1187.2631958 1144.36071777
80 1820.75270996 1769.78515625
90 3363.41669922 3314.3128418
100 50863.234375 51923.34375
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  wideResNet1
Model name for the evaluation phase:  wideResNet1
Training model...
# Neural Network with 606338 learnable parameters

## Layer information

  #  name                 size
---  -------------------  ---------
  0  input                1x192x64
  1  conv2d_1             64x192x64
  2  conv2d_2             64x192x64
  3  dropout1             64x192x64
  4  conv2d_3             64x96x32
  5  batch_norm1          64x96x32
  6  batch_norm1_nonlin   64x96x32
  7                       64x96x32
  8  res0__conv1          64x96x32
  9  res0__conv1_nonlin   64x96x32
 10  res0__dropout        64x96x32
 11  res0__conv2          64x96x32
 12  res0__projection     64x96x32
 13  res0__sum            64x96x32
 14  res3__bn             64x96x32
 15  res3__nonlin         64x96x32
 16                       64x48x16
 17  res3__conv1          64x48x16
 18  res3__conv1_nonlin   64x48x16
 19  res3__dropout        64x48x16
 20  res3__conv2          64x48x16
 21  res3__projection     64x48x16
 22  res3__sum            64x48x16
 23  res4_1_bn            64x48x16
 24  res4_1_nonlin        64x48x16
 25                       64x48x16
 26  res4_1_conv1         64x48x16
 27  res4_1_conv1_nonlin  64x48x16
 28  res4_1_dropout       64x48x16
 29  res4_1_conv2         64x48x16
 30  res4_1_sum           64x48x16
 31  res4_2_bn            64x48x16
 32  res4_2_nonlin        64x48x16
 33                       64x48x16
 34  res4_2_conv1         64x48x16
 35  res4_2_conv1_nonlin  64x48x16
 36  res4_2_dropout       64x48x16
 37  res4_2_conv2         64x48x16
 38  res4_2_sum           64x48x16
 39  res5__bn             64x48x16
 40  res5__nonlin         64x48x16
 41                       64x24x8
 42  res5__conv1          64x24x8
 43  res5__conv1_nonlin   64x24x8
 44  res5__dropout        64x24x8
 45  res5__conv2          64x24x8
 46  res5__projection     64x24x8
 47  res5__sum            64x24x8
 48  res6_1_bn            64x24x8
 49  res6_1_nonlin        64x24x8
 50                       64x24x8
 51  res6_1_conv1         64x24x8
 52  res6_1_conv1_nonlin  64x24x8
 53  res6_1_dropout       64x24x8
 54  res6_1_conv2         64x24x8
 55  res6_1_sum           64x24x8
 56  res6_2_bn            64x24x8
 57  res6_2_nonlin        64x24x8
 58                       64x24x8
 59  res6_2_conv1         64x24x8
 60  res6_2_conv1_nonlin  64x24x8
 61  res6_2_dropout       64x24x8
 62  res6_2_conv2         64x24x8
 63  res6_2_sum           64x24x8
 64  bn_post_conv         64x24x8
 65  post_conv_nonlin     64x24x8
 66  last_conv            2x24x8
 67  global_pool          2
 68  softmax              2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m0.59409[0m     [32m0.75705[0m    0.78474      0.46859  252.77s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.49839[0m     0.81987    0.60789      0.55372  258.07s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.37287[0m     0.92772    0.40192      0.59796  258.88s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.25645[0m     1.72636    0.14855      0.53702  258.67s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.18055[0m     1.40139    0.12884      0.51793  254.70s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.14518[0m     4.18820    0.03466      0.47993  254.96s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.757051 at epoch 1.
Loaded parameters to layer 'conv2d_1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d_1' (shape 64).
Loaded parameters to layer 'conv2d_2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d_2' (shape 64).
Loaded parameters to layer 'conv2d_3' (shape 64x64x3x3).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'conv2ddnn7' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv2' (shape 64).
Loaded parameters to layer 'res0__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn16' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv2' (shape 64).
Loaded parameters to layer 'res3__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn25' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv2' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn33' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv2' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn41' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv2' (shape 64).
Loaded parameters to layer 'res5__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn50' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv2' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn58' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv2' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'last_conv' (shape 2x64x3x3).
Loaded parameters to layer 'last_conv' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.604440616327
Error rate (%):  39.5559383673
[[30394 15776]
 [ 4890  1185]]
(52245,)
(52245,)
roc_auc: 0.348097927591
log_loss: nan
roc_auc for the hours: 0.257894736842
log_loss for the hours: 0.872287540935
saving predictions to csv file
hourspatient0_10_wideResNet1_10-12-19-51-10.csv
Accuracy validation for the hours:  0.697674418605
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [10]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.241063424
saving predictions to csv file
patient0_10_wideResNet1_10-12-19-54-19.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config8.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_11']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config8.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_11'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-12 19:54:21.692940
Hostname: kat
gpu3
Configuration 'config8.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: wideResNet1
evaluation:
    online_training: False
    model: wideResNet1

end Configuration
['patient0_11']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [11]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.74594304
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 37.4027713776 20.3596906662
20 138.625271606 132.382019043
30 211.681109619 204.980381775
40 289.691271973 281.780712891
50 389.566116333 380.066696167
60 543.70489502 531.805041504
70 834.583398437 818.790313721
80 1463.92446289 1432.4847168
90 3328.68920898 3260.95727539
100 410646.09375 69810.453125
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  wideResNet1
Model name for the evaluation phase:  wideResNet1
Training model...
# Neural Network with 606338 learnable parameters

## Layer information

  #  name                 size
---  -------------------  ---------
  0  input                1x192x64
  1  conv2d_1             64x192x64
  2  conv2d_2             64x192x64
  3  dropout1             64x192x64
  4  conv2d_3             64x96x32
  5  batch_norm1          64x96x32
  6  batch_norm1_nonlin   64x96x32
  7                       64x96x32
  8  res0__conv1          64x96x32
  9  res0__conv1_nonlin   64x96x32
 10  res0__dropout        64x96x32
 11  res0__conv2          64x96x32
 12  res0__projection     64x96x32
 13  res0__sum            64x96x32
 14  res3__bn             64x96x32
 15  res3__nonlin         64x96x32
 16                       64x48x16
 17  res3__conv1          64x48x16
 18  res3__conv1_nonlin   64x48x16
 19  res3__dropout        64x48x16
 20  res3__conv2          64x48x16
 21  res3__projection     64x48x16
 22  res3__sum            64x48x16
 23  res4_1_bn            64x48x16
 24  res4_1_nonlin        64x48x16
 25                       64x48x16
 26  res4_1_conv1         64x48x16
 27  res4_1_conv1_nonlin  64x48x16
 28  res4_1_dropout       64x48x16
 29  res4_1_conv2         64x48x16
 30  res4_1_sum           64x48x16
 31  res4_2_bn            64x48x16
 32  res4_2_nonlin        64x48x16
 33                       64x48x16
 34  res4_2_conv1         64x48x16
 35  res4_2_conv1_nonlin  64x48x16
 36  res4_2_dropout       64x48x16
 37  res4_2_conv2         64x48x16
 38  res4_2_sum           64x48x16
 39  res5__bn             64x48x16
 40  res5__nonlin         64x48x16
 41                       64x24x8
 42  res5__conv1          64x24x8
 43  res5__conv1_nonlin   64x24x8
 44  res5__dropout        64x24x8
 45  res5__conv2          64x24x8
 46  res5__projection     64x24x8
 47  res5__sum            64x24x8
 48  res6_1_bn            64x24x8
 49  res6_1_nonlin        64x24x8
 50                       64x24x8
 51  res6_1_conv1         64x24x8
 52  res6_1_conv1_nonlin  64x24x8
 53  res6_1_dropout       64x24x8
 54  res6_1_conv2         64x24x8
 55  res6_1_sum           64x24x8
 56  res6_2_bn            64x24x8
 57  res6_2_nonlin        64x24x8
 58                       64x24x8
 59  res6_2_conv1         64x24x8
 60  res6_2_conv1_nonlin  64x24x8
 61  res6_2_dropout       64x24x8
 62  res6_2_conv2         64x24x8
 63  res6_2_sum           64x24x8
 64  bn_post_conv         64x24x8
 65  post_conv_nonlin     64x24x8
 66  last_conv            2x24x8
 67  global_pool          2
 68  softmax              2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m0.59945[0m     [32m0.68336[0m    0.87721      0.54984  256.60s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.50457[0m     1.14145    0.44204      0.53726  258.83s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.35485[0m     1.93510    0.18338      0.54000  258.41s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.24261[0m     2.45095    0.09899      0.51031  254.34s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.17140[0m     3.24809    0.05277      0.49747  253.93s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.12272[0m     4.11405    0.02983      0.49118  254.81s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.683364 at epoch 1.
Loaded parameters to layer 'conv2d_1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d_1' (shape 64).
Loaded parameters to layer 'conv2d_2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d_2' (shape 64).
Loaded parameters to layer 'conv2d_3' (shape 64x64x3x3).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'conv2ddnn7' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv2' (shape 64).
Loaded parameters to layer 'res0__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn16' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv2' (shape 64).
Loaded parameters to layer 'res3__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn25' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv2' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn33' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv2' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn41' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv2' (shape 64).
Loaded parameters to layer 'res5__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn50' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv2' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn58' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv2' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'last_conv' (shape 2x64x3x3).
Loaded parameters to layer 'last_conv' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.630567518423
Error rate (%):  36.9432481577
[[30061 16109]
 [ 3192  2883]]
(52245,)
(52245,)
roc_auc: 0.604519388447
log_loss: 0.665259979048
roc_auc for the hours: 0.663157894737
log_loss for the hours: 0.528132299864
saving predictions to csv file
hourspatient0_11_wideResNet1_10-12-20-27-57.csv
Accuracy validation for the hours:  0.744186046512
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [11]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.241427968
saving predictions to csv file
patient0_11_wideResNet1_10-12-20-31-08.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config8.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_12']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config8.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_12'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-12 20:31:10.548712
Hostname: kat
gpu3
Configuration 'config8.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: wideResNet1
evaluation:
    online_training: False
    model: wideResNet1

end Configuration
['patient0_12']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [12]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.745467904
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 65.1829460144 35.0811794281
20 246.685302734 233.028952026
30 381.222595215 364.982098389
40 530.423962402 509.868566895
50 730.584533691 703.699279785
60 1040.28303223 1008.42225342
70 1558.99154053 1521.31486816
80 2527.43164063 2455.40673828
90 5046.20957031 4843.92373047
100 126710.1875 64910.4453125
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  wideResNet1
Model name for the evaluation phase:  wideResNet1
Training model...
# Neural Network with 606338 learnable parameters

## Layer information

  #  name                 size
---  -------------------  ---------
  0  input                1x192x64
  1  conv2d_1             64x192x64
  2  conv2d_2             64x192x64
  3  dropout1             64x192x64
  4  conv2d_3             64x96x32
  5  batch_norm1          64x96x32
  6  batch_norm1_nonlin   64x96x32
  7                       64x96x32
  8  res0__conv1          64x96x32
  9  res0__conv1_nonlin   64x96x32
 10  res0__dropout        64x96x32
 11  res0__conv2          64x96x32
 12  res0__projection     64x96x32
 13  res0__sum            64x96x32
 14  res3__bn             64x96x32
 15  res3__nonlin         64x96x32
 16                       64x48x16
 17  res3__conv1          64x48x16
 18  res3__conv1_nonlin   64x48x16
 19  res3__dropout        64x48x16
 20  res3__conv2          64x48x16
 21  res3__projection     64x48x16
 22  res3__sum            64x48x16
 23  res4_1_bn            64x48x16
 24  res4_1_nonlin        64x48x16
 25                       64x48x16
 26  res4_1_conv1         64x48x16
 27  res4_1_conv1_nonlin  64x48x16
 28  res4_1_dropout       64x48x16
 29  res4_1_conv2         64x48x16
 30  res4_1_sum           64x48x16
 31  res4_2_bn            64x48x16
 32  res4_2_nonlin        64x48x16
 33                       64x48x16
 34  res4_2_conv1         64x48x16
 35  res4_2_conv1_nonlin  64x48x16
 36  res4_2_dropout       64x48x16
 37  res4_2_conv2         64x48x16
 38  res4_2_sum           64x48x16
 39  res5__bn             64x48x16
 40  res5__nonlin         64x48x16
 41                       64x24x8
 42  res5__conv1          64x24x8
 43  res5__conv1_nonlin   64x24x8
 44  res5__dropout        64x24x8
 45  res5__conv2          64x24x8
 46  res5__projection     64x24x8
 47  res5__sum            64x24x8
 48  res6_1_bn            64x24x8
 49  res6_1_nonlin        64x24x8
 50                       64x24x8
 51  res6_1_conv1         64x24x8
 52  res6_1_conv1_nonlin  64x24x8
 53  res6_1_dropout       64x24x8
 54  res6_1_conv2         64x24x8
 55  res6_1_sum           64x24x8
 56  res6_2_bn            64x24x8
 57  res6_2_nonlin        64x24x8
 58                       64x24x8
 59  res6_2_conv1         64x24x8
 60  res6_2_conv1_nonlin  64x24x8
 61  res6_2_dropout       64x24x8
 62  res6_2_conv2         64x24x8
 63  res6_2_sum           64x24x8
 64  bn_post_conv         64x24x8
 65  post_conv_nonlin     64x24x8
 66  last_conv            2x24x8
 67  global_pool          2
 68  softmax              2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m0.57309[0m     [32m0.80896[0m    0.70842      0.53224  255.64s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.49170[0m     0.81400    0.60405      0.58311  257.90s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.40380[0m     1.00395    0.40221      0.46659  254.17s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.31329[0m     1.27362    0.24598      0.43813  253.64s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.23868[0m     1.67777    0.14226      0.45377  252.20s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.18741[0m     1.93231    0.09699      0.46054  252.58s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.808958 at epoch 1.
Loaded parameters to layer 'conv2d_1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d_1' (shape 64).
Loaded parameters to layer 'conv2d_2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d_2' (shape 64).
Loaded parameters to layer 'conv2d_3' (shape 64x64x3x3).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'conv2ddnn7' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv2' (shape 64).
Loaded parameters to layer 'res0__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn16' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv2' (shape 64).
Loaded parameters to layer 'res3__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn25' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv2' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn33' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv2' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn41' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv2' (shape 64).
Loaded parameters to layer 'res5__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn50' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv2' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn58' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv2' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'last_conv' (shape 2x64x3x3).
Loaded parameters to layer 'last_conv' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.28582639487
Error rate (%):  71.417360513
[[11111 35059]
 [ 2253  3822]]
(52245,)
(52245,)
roc_auc: 0.39420190903
log_loss: nan
roc_auc for the hours: 0.389473684211
log_loss for the hours: 2.29794607875
saving predictions to csv file
hourspatient0_12_wideResNet1_10-12-21-04-40.csv
Accuracy validation for the hours:  0.255813953488
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [12]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.240961024
saving predictions to csv file
patient0_12_wideResNet1_10-12-21-07-47.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config8.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_13']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config8.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_13'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-12 21:07:49.409254
Hostname: kat
gpu3
Configuration 'config8.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: wideResNet1
evaluation:
    online_training: False
    model: wideResNet1

end Configuration
['patient0_13']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [13]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.74569728
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 69.0897041321 37.7125782013
20 266.439715576 253.817520142
30 414.331445313 399.039959717
40 579.853991699 560.493823242
50 802.805938721 779.214904785
60 1136.38771973 1110.1892334
70 1641.78244629 1620.17226562
80 2489.06611328 2463.09140625
90 4471.61362305 4441.97880859
100 100082.695312 85056.0390625
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  wideResNet1
Model name for the evaluation phase:  wideResNet1
Training model...
# Neural Network with 606338 learnable parameters

## Layer information

  #  name                 size
---  -------------------  ---------
  0  input                1x192x64
  1  conv2d_1             64x192x64
  2  conv2d_2             64x192x64
  3  dropout1             64x192x64
  4  conv2d_3             64x96x32
  5  batch_norm1          64x96x32
  6  batch_norm1_nonlin   64x96x32
  7                       64x96x32
  8  res0__conv1          64x96x32
  9  res0__conv1_nonlin   64x96x32
 10  res0__dropout        64x96x32
 11  res0__conv2          64x96x32
 12  res0__projection     64x96x32
 13  res0__sum            64x96x32
 14  res3__bn             64x96x32
 15  res3__nonlin         64x96x32
 16                       64x48x16
 17  res3__conv1          64x48x16
 18  res3__conv1_nonlin   64x48x16
 19  res3__dropout        64x48x16
 20  res3__conv2          64x48x16
 21  res3__projection     64x48x16
 22  res3__sum            64x48x16
 23  res4_1_bn            64x48x16
 24  res4_1_nonlin        64x48x16
 25                       64x48x16
 26  res4_1_conv1         64x48x16
 27  res4_1_conv1_nonlin  64x48x16
 28  res4_1_dropout       64x48x16
 29  res4_1_conv2         64x48x16
 30  res4_1_sum           64x48x16
 31  res4_2_bn            64x48x16
 32  res4_2_nonlin        64x48x16
 33                       64x48x16
 34  res4_2_conv1         64x48x16
 35  res4_2_conv1_nonlin  64x48x16
 36  res4_2_dropout       64x48x16
 37  res4_2_conv2         64x48x16
 38  res4_2_sum           64x48x16
 39  res5__bn             64x48x16
 40  res5__nonlin         64x48x16
 41                       64x24x8
 42  res5__conv1          64x24x8
 43  res5__conv1_nonlin   64x24x8
 44  res5__dropout        64x24x8
 45  res5__conv2          64x24x8
 46  res5__projection     64x24x8
 47  res5__sum            64x24x8
 48  res6_1_bn            64x24x8
 49  res6_1_nonlin        64x24x8
 50                       64x24x8
 51  res6_1_conv1         64x24x8
 52  res6_1_conv1_nonlin  64x24x8
 53  res6_1_dropout       64x24x8
 54  res6_1_conv2         64x24x8
 55  res6_1_sum           64x24x8
 56  res6_2_bn            64x24x8
 57  res6_2_nonlin        64x24x8
 58                       64x24x8
 59  res6_2_conv1         64x24x8
 60  res6_2_conv1_nonlin  64x24x8
 61  res6_2_dropout       64x24x8
 62  res6_2_conv2         64x24x8
 63  res6_2_sum           64x24x8
 64  bn_post_conv         64x24x8
 65  post_conv_nonlin     64x24x8
 66  last_conv            2x24x8
 67  global_pool          2
 68  softmax              2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m0.57984[0m     [32m0.88926[0m    0.65205      0.53990  246.81s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.50442[0m     [32m0.85695[0m    0.58862      0.52443  245.69s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.43740[0m     0.86460    0.50590      0.52713  242.20s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.36272[0m     1.02057    0.35541      0.51691  241.99s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.28186[0m     1.68397    0.16738      0.38237  241.85s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.22818[0m     1.93427    0.11797      0.44589  242.11s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.17113[0m     1.85735    0.09214      0.44096  241.95s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.856953 at epoch 2.
Loaded parameters to layer 'conv2d_1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d_1' (shape 64).
Loaded parameters to layer 'conv2d_2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d_2' (shape 64).
Loaded parameters to layer 'conv2d_3' (shape 64x64x3x3).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'conv2ddnn7' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv2' (shape 64).
Loaded parameters to layer 'res0__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn16' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv2' (shape 64).
Loaded parameters to layer 'res3__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn25' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv2' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn33' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv2' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn41' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv2' (shape 64).
Loaded parameters to layer 'res5__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn50' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv2' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn58' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv2' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'last_conv' (shape 2x64x3x3).
Loaded parameters to layer 'last_conv' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.175059814336
Error rate (%):  82.4940185664
[[ 3531 42639]
 [  460  5615]]
(52245,)
(52245,)
roc_auc: 0.43530861167
log_loss: nan
roc_auc for the hours: 0.423684210526
log_loss for the hours: nan
saving predictions to csv file
hourspatient0_13_wideResNet1_10-12-21-43-52.csv
Accuracy validation for the hours:  0.186046511628
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [13]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.29480704
saving predictions to csv file
patient0_13_wideResNet1_10-12-21-46-54.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config8.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_14']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config8.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_14'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-12 21:46:57.367844
Hostname: kat
gpu3
Configuration 'config8.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: wideResNet1
evaluation:
    online_training: False
    model: wideResNet1

end Configuration
['patient0_14']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [14]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.746135552
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 51.4431194305 28.1161405563
20 195.642379761 187.486203003
30 299.57428894 291.18163147
40 410.908746338 402.061425781
50 555.348205566 546.590423584
60 781.114685059 775.59395752
70 1179.35510254 1183.46280518
80 1939.34797363 1949.83596191
90 3877.67912598 3944.7189209
100 65181.1953125 57682.203125
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  wideResNet1
Model name for the evaluation phase:  wideResNet1
Training model...
# Neural Network with 606338 learnable parameters

## Layer information

  #  name                 size
---  -------------------  ---------
  0  input                1x192x64
  1  conv2d_1             64x192x64
  2  conv2d_2             64x192x64
  3  dropout1             64x192x64
  4  conv2d_3             64x96x32
  5  batch_norm1          64x96x32
  6  batch_norm1_nonlin   64x96x32
  7                       64x96x32
  8  res0__conv1          64x96x32
  9  res0__conv1_nonlin   64x96x32
 10  res0__dropout        64x96x32
 11  res0__conv2          64x96x32
 12  res0__projection     64x96x32
 13  res0__sum            64x96x32
 14  res3__bn             64x96x32
 15  res3__nonlin         64x96x32
 16                       64x48x16
 17  res3__conv1          64x48x16
 18  res3__conv1_nonlin   64x48x16
 19  res3__dropout        64x48x16
 20  res3__conv2          64x48x16
 21  res3__projection     64x48x16
 22  res3__sum            64x48x16
 23  res4_1_bn            64x48x16
 24  res4_1_nonlin        64x48x16
 25                       64x48x16
 26  res4_1_conv1         64x48x16
 27  res4_1_conv1_nonlin  64x48x16
 28  res4_1_dropout       64x48x16
 29  res4_1_conv2         64x48x16
 30  res4_1_sum           64x48x16
 31  res4_2_bn            64x48x16
 32  res4_2_nonlin        64x48x16
 33                       64x48x16
 34  res4_2_conv1         64x48x16
 35  res4_2_conv1_nonlin  64x48x16
 36  res4_2_dropout       64x48x16
 37  res4_2_conv2         64x48x16
 38  res4_2_sum           64x48x16
 39  res5__bn             64x48x16
 40  res5__nonlin         64x48x16
 41                       64x24x8
 42  res5__conv1          64x24x8
 43  res5__conv1_nonlin   64x24x8
 44  res5__dropout        64x24x8
 45  res5__conv2          64x24x8
 46  res5__projection     64x24x8
 47  res5__sum            64x24x8
 48  res6_1_bn            64x24x8
 49  res6_1_nonlin        64x24x8
 50                       64x24x8
 51  res6_1_conv1         64x24x8
 52  res6_1_conv1_nonlin  64x24x8
 53  res6_1_dropout       64x24x8
 54  res6_1_conv2         64x24x8
 55  res6_1_sum           64x24x8
 56  res6_2_bn            64x24x8
 57  res6_2_nonlin        64x24x8
 58                       64x24x8
 59  res6_2_conv1         64x24x8
 60  res6_2_conv1_nonlin  64x24x8
 61  res6_2_dropout       64x24x8
 62  res6_2_conv2         64x24x8
 63  res6_2_sum           64x24x8
 64  bn_post_conv         64x24x8
 65  post_conv_nonlin     64x24x8
 66  last_conv            2x24x8
 67  global_pool          2
 68  softmax              2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m0.59561[0m     [32m0.74789[0m    0.79639      0.56826  239.11s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.50935[0m     0.81025    0.62864      0.52732  242.57s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.40835[0m     0.84873    0.48113      0.55359  242.28s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.30127[0m     1.70447    0.17675      0.44432  241.94s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.20601[0m     1.63783    0.12578      0.45842  241.56s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.15303[0m     2.19082    0.06985      0.48055  241.81s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.747885 at epoch 1.
Loaded parameters to layer 'conv2d_1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d_1' (shape 64).
Loaded parameters to layer 'conv2d_2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d_2' (shape 64).
Loaded parameters to layer 'conv2d_3' (shape 64x64x3x3).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'conv2ddnn7' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv2' (shape 64).
Loaded parameters to layer 'res0__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn16' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv2' (shape 64).
Loaded parameters to layer 'res3__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn25' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv2' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn33' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv2' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn41' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv2' (shape 64).
Loaded parameters to layer 'res5__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn50' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv2' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn58' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv2' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'last_conv' (shape 2x64x3x3).
Loaded parameters to layer 'last_conv' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.306708775959
Error rate (%):  69.3291224041
[[11419 34751]
 [ 1470  4605]]
(52245,)
(52245,)
roc_auc: 0.48469585028
log_loss: nan
roc_auc for the hours: 0.505263157895
log_loss for the hours: 2.00639941318
saving predictions to csv file
hourspatient0_14_wideResNet1_10-12-22-18-45.csv
Accuracy validation for the hours:  0.232558139535
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [14]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.241899008
saving predictions to csv file
patient0_14_wideResNet1_10-12-22-21-46.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config8.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_15']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config8.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_15'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-12 22:21:48.884412
Hostname: kat
gpu3
Configuration 'config8.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: wideResNet1
evaluation:
    online_training: False
    model: wideResNet1

end Configuration
['patient0_15']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [15]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.7448576
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 34.6773342133 19.007179451
20 129.966018677 125.497892761
30 197.840336609 193.760687256
40 269.3421875 264.920050049
50 359.024520874 354.514923096
60 493.65269165 489.852355957
70 739.064575195 735.682330322
80 1252.53088379 1250.05979004
90 2505.61677246 2502.26618652
100 37134.734375 63323.234375
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  wideResNet1
Model name for the evaluation phase:  wideResNet1
Training model...
# Neural Network with 606338 learnable parameters

## Layer information

  #  name                 size
---  -------------------  ---------
  0  input                1x192x64
  1  conv2d_1             64x192x64
  2  conv2d_2             64x192x64
  3  dropout1             64x192x64
  4  conv2d_3             64x96x32
  5  batch_norm1          64x96x32
  6  batch_norm1_nonlin   64x96x32
  7                       64x96x32
  8  res0__conv1          64x96x32
  9  res0__conv1_nonlin   64x96x32
 10  res0__dropout        64x96x32
 11  res0__conv2          64x96x32
 12  res0__projection     64x96x32
 13  res0__sum            64x96x32
 14  res3__bn             64x96x32
 15  res3__nonlin         64x96x32
 16                       64x48x16
 17  res3__conv1          64x48x16
 18  res3__conv1_nonlin   64x48x16
 19  res3__dropout        64x48x16
 20  res3__conv2          64x48x16
 21  res3__projection     64x48x16
 22  res3__sum            64x48x16
 23  res4_1_bn            64x48x16
 24  res4_1_nonlin        64x48x16
 25                       64x48x16
 26  res4_1_conv1         64x48x16
 27  res4_1_conv1_nonlin  64x48x16
 28  res4_1_dropout       64x48x16
 29  res4_1_conv2         64x48x16
 30  res4_1_sum           64x48x16
 31  res4_2_bn            64x48x16
 32  res4_2_nonlin        64x48x16
 33                       64x48x16
 34  res4_2_conv1         64x48x16
 35  res4_2_conv1_nonlin  64x48x16
 36  res4_2_dropout       64x48x16
 37  res4_2_conv2         64x48x16
 38  res4_2_sum           64x48x16
 39  res5__bn             64x48x16
 40  res5__nonlin         64x48x16
 41                       64x24x8
 42  res5__conv1          64x24x8
 43  res5__conv1_nonlin   64x24x8
 44  res5__dropout        64x24x8
 45  res5__conv2          64x24x8
 46  res5__projection     64x24x8
 47  res5__sum            64x24x8
 48  res6_1_bn            64x24x8
 49  res6_1_nonlin        64x24x8
 50                       64x24x8
 51  res6_1_conv1         64x24x8
 52  res6_1_conv1_nonlin  64x24x8
 53  res6_1_dropout       64x24x8
 54  res6_1_conv2         64x24x8
 55  res6_1_sum           64x24x8
 56  res6_2_bn            64x24x8
 57  res6_2_nonlin        64x24x8
 58                       64x24x8
 59  res6_2_conv1         64x24x8
 60  res6_2_conv1_nonlin  64x24x8
 61  res6_2_dropout       64x24x8
 62  res6_2_conv2         64x24x8
 63  res6_2_sum           64x24x8
 64  bn_post_conv         64x24x8
 65  post_conv_nonlin     64x24x8
 66  last_conv            2x24x8
 67  global_pool          2
 68  softmax              2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m0.59882[0m     [32m1.47792[0m    0.40518      0.50543  239.46s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.53638[0m     [32m0.90338[0m    0.59375      0.50072  242.64s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.46513[0m     0.92483    0.50294      0.46021  242.40s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.36221[0m     1.30123    0.27836      0.43401  242.68s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.26182[0m     1.77001    0.14792      0.44033  242.52s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.19866[0m     1.82490    0.10886      0.46229  242.36s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.15313[0m     2.59717    0.05896      0.44965  242.21s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.903380 at epoch 2.
Loaded parameters to layer 'conv2d_1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d_1' (shape 64).
Loaded parameters to layer 'conv2d_2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d_2' (shape 64).
Loaded parameters to layer 'conv2d_3' (shape 64x64x3x3).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'conv2ddnn7' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv2' (shape 64).
Loaded parameters to layer 'res0__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn16' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv2' (shape 64).
Loaded parameters to layer 'res3__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn25' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv2' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn33' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv2' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn41' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv2' (shape 64).
Loaded parameters to layer 'res5__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn50' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv2' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn58' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv2' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'last_conv' (shape 2x64x3x3).
Loaded parameters to layer 'last_conv' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.116279069767
Error rate (%):  88.3720930233
[[    0 46170]
 [    0  6075]]
(52245,)
(52245,)
roc_auc: 0.42004408649
log_loss: nan
roc_auc for the hours: 0.473684210526
log_loss for the hours: nan
saving predictions to csv file
hourspatient0_15_wideResNet1_10-12-22-57-43.csv
Accuracy validation for the hours:  0.116279069767
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [15]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.292681216
saving predictions to csv file
patient0_15_wideResNet1_10-12-23-00-45.csv
