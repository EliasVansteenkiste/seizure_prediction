['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config9.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_0']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config9.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_0'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-12 12:06:14.798139
Hostname: kat
gpu0
Configuration 'config9.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: wideResNet1
evaluation:
    online_training: False
    model: wideResNet1

end Configuration
['patient0_0']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [0]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.75147264
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 77.4825836182 42.2078788757
20 305.512463379 300.472479248
30 461.135577393 459.25463562
40 614.021606445 614.238354492
50 784.364746094 787.311828613
60 993.193286133 998.551342773
70 1272.31512451 1279.6506958
80 1694.84467773 1704.01054688
90 2529.98266602 2551.26169434
100 45472.875 51963.8164062
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  wideResNet1
Model name for the evaluation phase:  wideResNet1
Training model...
# Neural Network with 606338 learnable parameters

## Layer information

  #  name                 size
---  -------------------  ---------
  0  input                1x192x64
  1  conv2d_1             64x192x64
  2  conv2d_2             64x192x64
  3  dropout1             64x192x64
  4  conv2d_3             64x96x32
  5  batch_norm1          64x96x32
  6  batch_norm1_nonlin   64x96x32
  7                       64x96x32
  8  res0__conv1          64x96x32
  9  res0__conv1_nonlin   64x96x32
 10  res0__dropout        64x96x32
 11  res0__conv2          64x96x32
 12  res0__projection     64x96x32
 13  res0__sum            64x96x32
 14  res3__bn             64x96x32
 15  res3__nonlin         64x96x32
 16                       64x48x16
 17  res3__conv1          64x48x16
 18  res3__conv1_nonlin   64x48x16
 19  res3__dropout        64x48x16
 20  res3__conv2          64x48x16
 21  res3__projection     64x48x16
 22  res3__sum            64x48x16
 23  res4_1_bn            64x48x16
 24  res4_1_nonlin        64x48x16
 25                       64x48x16
 26  res4_1_conv1         64x48x16
 27  res4_1_conv1_nonlin  64x48x16
 28  res4_1_dropout       64x48x16
 29  res4_1_conv2         64x48x16
 30  res4_1_sum           64x48x16
 31  res4_2_bn            64x48x16
 32  res4_2_nonlin        64x48x16
 33                       64x48x16
 34  res4_2_conv1         64x48x16
 35  res4_2_conv1_nonlin  64x48x16
 36  res4_2_dropout       64x48x16
 37  res4_2_conv2         64x48x16
 38  res4_2_sum           64x48x16
 39  res5__bn             64x48x16
 40  res5__nonlin         64x48x16
 41                       64x24x8
 42  res5__conv1          64x24x8
 43  res5__conv1_nonlin   64x24x8
 44  res5__dropout        64x24x8
 45  res5__conv2          64x24x8
 46  res5__projection     64x24x8
 47  res5__sum            64x24x8
 48  res6_1_bn            64x24x8
 49  res6_1_nonlin        64x24x8
 50                       64x24x8
 51  res6_1_conv1         64x24x8
 52  res6_1_conv1_nonlin  64x24x8
 53  res6_1_dropout       64x24x8
 54  res6_1_conv2         64x24x8
 55  res6_1_sum           64x24x8
 56  res6_2_bn            64x24x8
 57  res6_2_nonlin        64x24x8
 58                       64x24x8
 59  res6_2_conv1         64x24x8
 60  res6_2_conv1_nonlin  64x24x8
 61  res6_2_dropout       64x24x8
 62  res6_2_conv2         64x24x8
 63  res6_2_sum           64x24x8
 64  bn_post_conv         64x24x8
 65  post_conv_nonlin     64x24x8
 66  last_conv            2x24x8
 67  global_pool          2
 68  softmax              2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m0.59414[0m     [32m0.83717[0m    0.70971      0.43929  186.51s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.50837[0m     1.19365    0.42590      0.43169  186.61s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.36233[0m     1.66412    0.21773      0.47236  186.83s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.24644[0m     1.77701    0.13868      0.50516  188.31s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.18591[0m     2.34679    0.07922      0.49551  190.45s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.14060[0m     3.02670    0.04645      0.48932  189.63s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.837167 at epoch 1.
Loaded parameters to layer 'conv2d_1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d_1' (shape 64).
Loaded parameters to layer 'conv2d_2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d_2' (shape 64).
Loaded parameters to layer 'conv2d_3' (shape 64x64x3x3).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'conv2ddnn7' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv2' (shape 64).
Loaded parameters to layer 'res0__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn16' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv2' (shape 64).
Loaded parameters to layer 'res3__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn25' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv2' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn33' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv2' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn41' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv2' (shape 64).
Loaded parameters to layer 'res5__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn50' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv2' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn58' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv2' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'last_conv' (shape 2x64x3x3).
Loaded parameters to layer 'last_conv' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.605091396306
Error rate (%):  39.4908603694
[[30952 15218]
 [ 5414   661]]
(52245,)
(52245,)
roc_auc: 0.348029668491
log_loss: inf
roc_auc for the hours: 0.247368421053
log_loss for the hours: 0.673550515398
saving predictions to csv file
hourspatient0_0_wideResNet1_10-12-12-32-03.csv
Accuracy validation for the hours:  0.627906976744
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [0]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.30543616
saving predictions to csv file
patient0_0_wideResNet1_10-12-12-35-00.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config9.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_1']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config9.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_1'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-12 12:35:02.490143
Hostname: kat
gpu0
Configuration 'config9.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: wideResNet1
evaluation:
    online_training: False
    model: wideResNet1

end Configuration
['patient0_1']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [1]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.754868224
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 79.8583602905 43.7949028015
20 305.763250732 299.520977783
30 453.40585022 450.005862427
40 592.349865723 590.177758789
50 740.968597412 740.054229736
60 918.324951172 917.797363281
70 1161.24418945 1163.53183594
80 1578.52695313 1588.20612793
90 2613.2675293 2653.38178711
100 212492.21875 103666.890625
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  wideResNet1
Model name for the evaluation phase:  wideResNet1
Training model...
# Neural Network with 606338 learnable parameters

## Layer information

  #  name                 size
---  -------------------  ---------
  0  input                1x192x64
  1  conv2d_1             64x192x64
  2  conv2d_2             64x192x64
  3  dropout1             64x192x64
  4  conv2d_3             64x96x32
  5  batch_norm1          64x96x32
  6  batch_norm1_nonlin   64x96x32
  7                       64x96x32
  8  res0__conv1          64x96x32
  9  res0__conv1_nonlin   64x96x32
 10  res0__dropout        64x96x32
 11  res0__conv2          64x96x32
 12  res0__projection     64x96x32
 13  res0__sum            64x96x32
 14  res3__bn             64x96x32
 15  res3__nonlin         64x96x32
 16                       64x48x16
 17  res3__conv1          64x48x16
 18  res3__conv1_nonlin   64x48x16
 19  res3__dropout        64x48x16
 20  res3__conv2          64x48x16
 21  res3__projection     64x48x16
 22  res3__sum            64x48x16
 23  res4_1_bn            64x48x16
 24  res4_1_nonlin        64x48x16
 25                       64x48x16
 26  res4_1_conv1         64x48x16
 27  res4_1_conv1_nonlin  64x48x16
 28  res4_1_dropout       64x48x16
 29  res4_1_conv2         64x48x16
 30  res4_1_sum           64x48x16
 31  res4_2_bn            64x48x16
 32  res4_2_nonlin        64x48x16
 33                       64x48x16
 34  res4_2_conv1         64x48x16
 35  res4_2_conv1_nonlin  64x48x16
 36  res4_2_dropout       64x48x16
 37  res4_2_conv2         64x48x16
 38  res4_2_sum           64x48x16
 39  res5__bn             64x48x16
 40  res5__nonlin         64x48x16
 41                       64x24x8
 42  res5__conv1          64x24x8
 43  res5__conv1_nonlin   64x24x8
 44  res5__dropout        64x24x8
 45  res5__conv2          64x24x8
 46  res5__projection     64x24x8
 47  res5__sum            64x24x8
 48  res6_1_bn            64x24x8
 49  res6_1_nonlin        64x24x8
 50                       64x24x8
 51  res6_1_conv1         64x24x8
 52  res6_1_conv1_nonlin  64x24x8
 53  res6_1_dropout       64x24x8
 54  res6_1_conv2         64x24x8
 55  res6_1_sum           64x24x8
 56  res6_2_bn            64x24x8
 57  res6_2_nonlin        64x24x8
 58                       64x24x8
 59  res6_2_conv1         64x24x8
 60  res6_2_conv1_nonlin  64x24x8
 61  res6_2_dropout       64x24x8
 62  res6_2_conv2         64x24x8
 63  res6_2_sum           64x24x8
 64  bn_post_conv         64x24x8
 65  post_conv_nonlin     64x24x8
 66  last_conv            2x24x8
 67  global_pool          2
 68  softmax              2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m0.59863[0m     [32m1.46917[0m    0.40746      0.50109  193.68s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.52796[0m     1.52982    0.34511      0.50642  197.02s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.45129[0m     1.87218    0.24105      0.48286  193.98s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.35459[0m     2.23157    0.15890      0.52165  195.27s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.25333[0m     [32m1.43979[0m    0.17595      0.47164  191.66s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.18648[0m     2.01322    0.09263      0.48829  195.60s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.13944[0m     2.46592    0.05655      0.45513  194.56s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.11543[0m     2.99132    0.03859      0.47314  199.18s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.09961[0m     4.87586    0.02043      0.48984  195.31s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.07960[0m     3.74330    0.02127      0.49379  196.78s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 1.439789 at epoch 5.
Loaded parameters to layer 'conv2d_1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d_1' (shape 64).
Loaded parameters to layer 'conv2d_2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d_2' (shape 64).
Loaded parameters to layer 'conv2d_3' (shape 64x64x3x3).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'conv2ddnn7' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv2' (shape 64).
Loaded parameters to layer 'res0__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn16' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv2' (shape 64).
Loaded parameters to layer 'res3__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn25' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv2' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn33' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv2' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn41' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv2' (shape 64).
Loaded parameters to layer 'res5__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn50' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv2' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn58' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv2' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'last_conv' (shape 2x64x3x3).
Loaded parameters to layer 'last_conv' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.462723705618
Error rate (%):  53.7276294382
[[20141 26029]
 [ 2041  4034]]
(52245,)
(52245,)
roc_auc: 0.574690013914
log_loss: nan
roc_auc for the hours: 0.631578947368
log_loss for the hours: 1.05658801527
saving predictions to csv file
hourspatient0_1_wideResNet1_10-12-13-18-51.csv
Accuracy validation for the hours:  0.511627906977
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [1]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.306447872
saving predictions to csv file
patient0_1_wideResNet1_10-12-13-21-52.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config9.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_2']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config9.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_2'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-12 13:21:54.273917
Hostname: kat
gpu0
Configuration 'config9.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: wideResNet1
evaluation:
    online_training: False
    model: wideResNet1

end Configuration
['patient0_2']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [2]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.755728384
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 72.0125099182 40.3037857056
20 276.55925293 272.411431885
30 416.599380493 415.294677734
40 555.997583008 556.773425293
50 715.97946167 718.930877686
60 923.099047852 927.542578125
70 1228.42805176 1233.38067627
80 1756.11213379 1761.63308105
90 3001.92504883 3026.81286621
100 72650.4921875 53126.640625
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  wideResNet1
Model name for the evaluation phase:  wideResNet1
Training model...
# Neural Network with 606338 learnable parameters

## Layer information

  #  name                 size
---  -------------------  ---------
  0  input                1x192x64
  1  conv2d_1             64x192x64
  2  conv2d_2             64x192x64
  3  dropout1             64x192x64
  4  conv2d_3             64x96x32
  5  batch_norm1          64x96x32
  6  batch_norm1_nonlin   64x96x32
  7                       64x96x32
  8  res0__conv1          64x96x32
  9  res0__conv1_nonlin   64x96x32
 10  res0__dropout        64x96x32
 11  res0__conv2          64x96x32
 12  res0__projection     64x96x32
 13  res0__sum            64x96x32
 14  res3__bn             64x96x32
 15  res3__nonlin         64x96x32
 16                       64x48x16
 17  res3__conv1          64x48x16
 18  res3__conv1_nonlin   64x48x16
 19  res3__dropout        64x48x16
 20  res3__conv2          64x48x16
 21  res3__projection     64x48x16
 22  res3__sum            64x48x16
 23  res4_1_bn            64x48x16
 24  res4_1_nonlin        64x48x16
 25                       64x48x16
 26  res4_1_conv1         64x48x16
 27  res4_1_conv1_nonlin  64x48x16
 28  res4_1_dropout       64x48x16
 29  res4_1_conv2         64x48x16
 30  res4_1_sum           64x48x16
 31  res4_2_bn            64x48x16
 32  res4_2_nonlin        64x48x16
 33                       64x48x16
 34  res4_2_conv1         64x48x16
 35  res4_2_conv1_nonlin  64x48x16
 36  res4_2_dropout       64x48x16
 37  res4_2_conv2         64x48x16
 38  res4_2_sum           64x48x16
 39  res5__bn             64x48x16
 40  res5__nonlin         64x48x16
 41                       64x24x8
 42  res5__conv1          64x24x8
 43  res5__conv1_nonlin   64x24x8
 44  res5__dropout        64x24x8
 45  res5__conv2          64x24x8
 46  res5__projection     64x24x8
 47  res5__sum            64x24x8
 48  res6_1_bn            64x24x8
 49  res6_1_nonlin        64x24x8
 50                       64x24x8
 51  res6_1_conv1         64x24x8
 52  res6_1_conv1_nonlin  64x24x8
 53  res6_1_dropout       64x24x8
 54  res6_1_conv2         64x24x8
 55  res6_1_sum           64x24x8
 56  res6_2_bn            64x24x8
 57  res6_2_nonlin        64x24x8
 58                       64x24x8
 59  res6_2_conv1         64x24x8
 60  res6_2_conv1_nonlin  64x24x8
 61  res6_2_dropout       64x24x8
 62  res6_2_conv2         64x24x8
 63  res6_2_sum           64x24x8
 64  bn_post_conv         64x24x8
 65  post_conv_nonlin     64x24x8
 66  last_conv            2x24x8
 67  global_pool          2
 68  softmax              2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m0.57599[0m     [32m1.47549[0m    0.39037      0.49353  197.25s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.46490[0m     [32m1.20283[0m    0.38651      0.54668  196.69s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.35508[0m     2.36703    0.15001      0.47246  194.93s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.24532[0m     1.73037    0.14177      0.52784  197.67s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.17521[0m     3.87042    0.04527      0.44581  198.19s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.13917[0m     3.37007    0.04130      0.46167  197.73s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.10234[0m     7.21496    0.01418      0.46423  198.70s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 1.202833 at epoch 2.
Loaded parameters to layer 'conv2d_1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d_1' (shape 64).
Loaded parameters to layer 'conv2d_2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d_2' (shape 64).
Loaded parameters to layer 'conv2d_3' (shape 64x64x3x3).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'conv2ddnn7' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv2' (shape 64).
Loaded parameters to layer 'res0__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn16' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv2' (shape 64).
Loaded parameters to layer 'res3__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn25' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv2' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn33' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv2' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn41' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv2' (shape 64).
Loaded parameters to layer 'res5__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn50' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv2' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn58' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv2' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'last_conv' (shape 2x64x3x3).
Loaded parameters to layer 'last_conv' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.822892142789
Error rate (%):  17.7107857211
[[42844  3326]
 [ 5927   148]]
(52245,)
(52245,)
roc_auc: 0.544155405279
log_loss: 2.52548646129
roc_auc for the hours: 0.444736842105
log_loss for the hours: 1.28064586161
saving predictions to csv file
hourspatient0_2_wideResNet1_10-12-13-54-33.csv
Accuracy validation for the hours:  0.860465116279
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [2]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.306443776
saving predictions to csv file
patient0_2_wideResNet1_10-12-13-57-34.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config9.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_3']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config9.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_3'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-12 13:57:35.963157
Hostname: kat
gpu0
Configuration 'config9.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: wideResNet1
evaluation:
    online_training: False
    model: wideResNet1

end Configuration
['patient0_3']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [3]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.757448704
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 52.0612277985 28.9869352341
20 191.337734985 185.116714478
30 292.577377319 287.197384644
40 400.500439453 396.009564209
50 535.735168457 532.537109375
60 731.05357666 729.604919434
70 1066.69674072 1069.19353027
80 1804.39440918 1808.60009766
90 3908.51987305 3891.41049805
100 124376.210938 175654.078125
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  wideResNet1
Model name for the evaluation phase:  wideResNet1
Training model...
# Neural Network with 606338 learnable parameters

## Layer information

  #  name                 size
---  -------------------  ---------
  0  input                1x192x64
  1  conv2d_1             64x192x64
  2  conv2d_2             64x192x64
  3  dropout1             64x192x64
  4  conv2d_3             64x96x32
  5  batch_norm1          64x96x32
  6  batch_norm1_nonlin   64x96x32
  7                       64x96x32
  8  res0__conv1          64x96x32
  9  res0__conv1_nonlin   64x96x32
 10  res0__dropout        64x96x32
 11  res0__conv2          64x96x32
 12  res0__projection     64x96x32
 13  res0__sum            64x96x32
 14  res3__bn             64x96x32
 15  res3__nonlin         64x96x32
 16                       64x48x16
 17  res3__conv1          64x48x16
 18  res3__conv1_nonlin   64x48x16
 19  res3__dropout        64x48x16
 20  res3__conv2          64x48x16
 21  res3__projection     64x48x16
 22  res3__sum            64x48x16
 23  res4_1_bn            64x48x16
 24  res4_1_nonlin        64x48x16
 25                       64x48x16
 26  res4_1_conv1         64x48x16
 27  res4_1_conv1_nonlin  64x48x16
 28  res4_1_dropout       64x48x16
 29  res4_1_conv2         64x48x16
 30  res4_1_sum           64x48x16
 31  res4_2_bn            64x48x16
 32  res4_2_nonlin        64x48x16
 33                       64x48x16
 34  res4_2_conv1         64x48x16
 35  res4_2_conv1_nonlin  64x48x16
 36  res4_2_dropout       64x48x16
 37  res4_2_conv2         64x48x16
 38  res4_2_sum           64x48x16
 39  res5__bn             64x48x16
 40  res5__nonlin         64x48x16
 41                       64x24x8
 42  res5__conv1          64x24x8
 43  res5__conv1_nonlin   64x24x8
 44  res5__dropout        64x24x8
 45  res5__conv2          64x24x8
 46  res5__projection     64x24x8
 47  res5__sum            64x24x8
 48  res6_1_bn            64x24x8
 49  res6_1_nonlin        64x24x8
 50                       64x24x8
 51  res6_1_conv1         64x24x8
 52  res6_1_conv1_nonlin  64x24x8
 53  res6_1_dropout       64x24x8
 54  res6_1_conv2         64x24x8
 55  res6_1_sum           64x24x8
 56  res6_2_bn            64x24x8
 57  res6_2_nonlin        64x24x8
 58                       64x24x8
 59  res6_2_conv1         64x24x8
 60  res6_2_conv1_nonlin  64x24x8
 61  res6_2_dropout       64x24x8
 62  res6_2_conv2         64x24x8
 63  res6_2_sum           64x24x8
 64  bn_post_conv         64x24x8
 65  post_conv_nonlin     64x24x8
 66  last_conv            2x24x8
 67  global_pool          2
 68  softmax              2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m0.60016[0m     [32m1.20228[0m    0.49918      0.37936  198.85s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.51536[0m     [32m0.74956[0m    0.68755      0.59077  194.52s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.41694[0m     0.88623    0.47046      0.57943  189.98s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.29966[0m     1.30680    0.22931      0.56445  191.16s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.22328[0m     1.42205    0.15701      0.58601  199.55s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.17386[0m     2.19156    0.07933      0.51604  202.50s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.13360[0m     2.62040    0.05098      0.52616  203.76s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.749563 at epoch 2.
Loaded parameters to layer 'conv2d_1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d_1' (shape 64).
Loaded parameters to layer 'conv2d_2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d_2' (shape 64).
Loaded parameters to layer 'conv2d_3' (shape 64x64x3x3).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'conv2ddnn7' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv2' (shape 64).
Loaded parameters to layer 'res0__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn16' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv2' (shape 64).
Loaded parameters to layer 'res3__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn25' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv2' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn33' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv2' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn41' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv2' (shape 64).
Loaded parameters to layer 'res5__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn50' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv2' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn58' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv2' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'last_conv' (shape 2x64x3x3).
Loaded parameters to layer 'last_conv' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.116279069767
Error rate (%):  88.3720930233
[[    0 46170]
 [    0  6075]]
(52245,)
(52245,)
roc_auc: 0.534020270409
log_loss: nan
roc_auc for the hours: 0.684210526316
log_loss for the hours: nan
saving predictions to csv file
hourspatient0_3_wideResNet1_10-12-14-27-51.csv
Accuracy validation for the hours:  0.116279069767
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [3]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.310490624
saving predictions to csv file
patient0_3_wideResNet1_10-12-14-30-48.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config9.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_4']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config9.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_4'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-12 14:30:50.921438
Hostname: kat
gpu0
Configuration 'config9.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: wideResNet1
evaluation:
    online_training: False
    model: wideResNet1

end Configuration
['patient0_4']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [4]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.755359744
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 60.27771492 33.2891647339
20 230.724859619 226.139196777
30 348.998257446 345.771307373
40 468.468225098 465.978533936
50 608.787628174 607.555786133
60 801.863439941 803.590454102
70 1127.33896484 1136.01357422
80 1802.12897949 1820.19179688
90 3236.02592773 3251.78005371
100 159526.84375 66619.4296875
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  wideResNet1
Model name for the evaluation phase:  wideResNet1
Training model...
# Neural Network with 606338 learnable parameters

## Layer information

  #  name                 size
---  -------------------  ---------
  0  input                1x192x64
  1  conv2d_1             64x192x64
  2  conv2d_2             64x192x64
  3  dropout1             64x192x64
  4  conv2d_3             64x96x32
  5  batch_norm1          64x96x32
  6  batch_norm1_nonlin   64x96x32
  7                       64x96x32
  8  res0__conv1          64x96x32
  9  res0__conv1_nonlin   64x96x32
 10  res0__dropout        64x96x32
 11  res0__conv2          64x96x32
 12  res0__projection     64x96x32
 13  res0__sum            64x96x32
 14  res3__bn             64x96x32
 15  res3__nonlin         64x96x32
 16                       64x48x16
 17  res3__conv1          64x48x16
 18  res3__conv1_nonlin   64x48x16
 19  res3__dropout        64x48x16
 20  res3__conv2          64x48x16
 21  res3__projection     64x48x16
 22  res3__sum            64x48x16
 23  res4_1_bn            64x48x16
 24  res4_1_nonlin        64x48x16
 25                       64x48x16
 26  res4_1_conv1         64x48x16
 27  res4_1_conv1_nonlin  64x48x16
 28  res4_1_dropout       64x48x16
 29  res4_1_conv2         64x48x16
 30  res4_1_sum           64x48x16
 31  res4_2_bn            64x48x16
 32  res4_2_nonlin        64x48x16
 33                       64x48x16
 34  res4_2_conv1         64x48x16
 35  res4_2_conv1_nonlin  64x48x16
 36  res4_2_dropout       64x48x16
 37  res4_2_conv2         64x48x16
 38  res4_2_sum           64x48x16
 39  res5__bn             64x48x16
 40  res5__nonlin         64x48x16
 41                       64x24x8
 42  res5__conv1          64x24x8
 43  res5__conv1_nonlin   64x24x8
 44  res5__dropout        64x24x8
 45  res5__conv2          64x24x8
 46  res5__projection     64x24x8
 47  res5__sum            64x24x8
 48  res6_1_bn            64x24x8
 49  res6_1_nonlin        64x24x8
 50                       64x24x8
 51  res6_1_conv1         64x24x8
 52  res6_1_conv1_nonlin  64x24x8
 53  res6_1_dropout       64x24x8
 54  res6_1_conv2         64x24x8
 55  res6_1_sum           64x24x8
 56  res6_2_bn            64x24x8
 57  res6_2_nonlin        64x24x8
 58                       64x24x8
 59  res6_2_conv1         64x24x8
 60  res6_2_conv1_nonlin  64x24x8
 61  res6_2_dropout       64x24x8
 62  res6_2_conv2         64x24x8
 63  res6_2_sum           64x24x8
 64  bn_post_conv         64x24x8
 65  post_conv_nonlin     64x24x8
 66  last_conv            2x24x8
 67  global_pool          2
 68  softmax              2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m0.57537[0m     [32m0.84214[0m    0.68323      0.54953  197.17s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.44701[0m     2.88446    0.15497      0.49193  190.73s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.26356[0m     1.72268    0.15299      0.45218  194.66s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.17058[0m     2.41570    0.07061      0.46803  195.22s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.13646[0m     2.22148    0.06143      0.47815  204.50s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.11536[0m     2.23709    0.05157      0.46271  203.85s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.842137 at epoch 1.
Loaded parameters to layer 'conv2d_1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d_1' (shape 64).
Loaded parameters to layer 'conv2d_2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d_2' (shape 64).
Loaded parameters to layer 'conv2d_3' (shape 64x64x3x3).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'conv2ddnn7' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv2' (shape 64).
Loaded parameters to layer 'res0__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn16' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv2' (shape 64).
Loaded parameters to layer 'res3__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn25' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv2' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn33' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv2' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn41' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv2' (shape 64).
Loaded parameters to layer 'res5__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn50' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv2' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn58' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv2' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'last_conv' (shape 2x64x3x3).
Loaded parameters to layer 'last_conv' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.526174753565
Error rate (%):  47.3825246435
[[24024 22146]
 [ 2609  3466]]
(52245,)
(52245,)
roc_auc: 0.596469035975
log_loss: nan
roc_auc for the hours: 0.621052631579
log_loss for the hours: 0.81526978106
saving predictions to csv file
hourspatient0_4_wideResNet1_10-12-14-58-15.csv
Accuracy validation for the hours:  0.581395348837
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [4]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.25401088
saving predictions to csv file
patient0_4_wideResNet1_10-12-15-01-09.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config9.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_5']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config9.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_5'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-12 15:01:11.134581
Hostname: kat
gpu0
Configuration 'config9.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: wideResNet1
evaluation:
    online_training: False
    model: wideResNet1

end Configuration
['patient0_5']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [5]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.755273728
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 44.228635788 24.8328939438
20 167.781503296 163.806289673
30 254.511244202 251.485551453
40 343.928485107 341.169134521
50 452.231292725 450.168884277
60 604.746826172 604.360339355
70 863.724084473 868.017297363
80 1408.11137695 1423.19575195
90 2638.64152832 2674.38774414
100 60107.1914062 35895.5507812
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  wideResNet1
Model name for the evaluation phase:  wideResNet1
Training model...
# Neural Network with 606338 learnable parameters

## Layer information

  #  name                 size
---  -------------------  ---------
  0  input                1x192x64
  1  conv2d_1             64x192x64
  2  conv2d_2             64x192x64
  3  dropout1             64x192x64
  4  conv2d_3             64x96x32
  5  batch_norm1          64x96x32
  6  batch_norm1_nonlin   64x96x32
  7                       64x96x32
  8  res0__conv1          64x96x32
  9  res0__conv1_nonlin   64x96x32
 10  res0__dropout        64x96x32
 11  res0__conv2          64x96x32
 12  res0__projection     64x96x32
 13  res0__sum            64x96x32
 14  res3__bn             64x96x32
 15  res3__nonlin         64x96x32
 16                       64x48x16
 17  res3__conv1          64x48x16
 18  res3__conv1_nonlin   64x48x16
 19  res3__dropout        64x48x16
 20  res3__conv2          64x48x16
 21  res3__projection     64x48x16
 22  res3__sum            64x48x16
 23  res4_1_bn            64x48x16
 24  res4_1_nonlin        64x48x16
 25                       64x48x16
 26  res4_1_conv1         64x48x16
 27  res4_1_conv1_nonlin  64x48x16
 28  res4_1_dropout       64x48x16
 29  res4_1_conv2         64x48x16
 30  res4_1_sum           64x48x16
 31  res4_2_bn            64x48x16
 32  res4_2_nonlin        64x48x16
 33                       64x48x16
 34  res4_2_conv1         64x48x16
 35  res4_2_conv1_nonlin  64x48x16
 36  res4_2_dropout       64x48x16
 37  res4_2_conv2         64x48x16
 38  res4_2_sum           64x48x16
 39  res5__bn             64x48x16
 40  res5__nonlin         64x48x16
 41                       64x24x8
 42  res5__conv1          64x24x8
 43  res5__conv1_nonlin   64x24x8
 44  res5__dropout        64x24x8
 45  res5__conv2          64x24x8
 46  res5__projection     64x24x8
 47  res5__sum            64x24x8
 48  res6_1_bn            64x24x8
 49  res6_1_nonlin        64x24x8
 50                       64x24x8
 51  res6_1_conv1         64x24x8
 52  res6_1_conv1_nonlin  64x24x8
 53  res6_1_dropout       64x24x8
 54  res6_1_conv2         64x24x8
 55  res6_1_sum           64x24x8
 56  res6_2_bn            64x24x8
 57  res6_2_nonlin        64x24x8
 58                       64x24x8
 59  res6_2_conv1         64x24x8
 60  res6_2_conv1_nonlin  64x24x8
 61  res6_2_dropout       64x24x8
 62  res6_2_conv2         64x24x8
 63  res6_2_sum           64x24x8
 64  bn_post_conv         64x24x8
 65  post_conv_nonlin     64x24x8
 66  last_conv            2x24x8
 67  global_pool          2
 68  softmax              2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m0.59345[0m     [32m0.96730[0m    0.61352      0.41103  194.28s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.48462[0m     1.14250    0.42417      0.52360  197.06s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.34413[0m     2.20331    0.15619      0.52239  194.51s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.22676[0m     1.87855    0.12071      0.54125  198.86s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.17035[0m     2.46497    0.06911      0.52071  194.77s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.13642[0m     1.72430    0.07912      0.54060  197.23s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.967296 at epoch 1.
Loaded parameters to layer 'conv2d_1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d_1' (shape 64).
Loaded parameters to layer 'conv2d_2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d_2' (shape 64).
Loaded parameters to layer 'conv2d_3' (shape 64x64x3x3).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'conv2ddnn7' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv2' (shape 64).
Loaded parameters to layer 'res0__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn16' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv2' (shape 64).
Loaded parameters to layer 'res3__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn25' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv2' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn33' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv2' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn41' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv2' (shape 64).
Loaded parameters to layer 'res5__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn50' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv2' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn58' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv2' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'last_conv' (shape 2x64x3x3).
Loaded parameters to layer 'last_conv' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.146253229974
Error rate (%):  85.3746770026
[[ 2211 43959]
 [  645  5430]]
(52245,)
(52245,)
roc_auc: 0.478001258544
log_loss: nan
roc_auc for the hours: 0.494736842105
log_loss for the hours: 5.3068496905
saving predictions to csv file
hourspatient0_5_wideResNet1_10-12-15-32-49.csv
Accuracy validation for the hours:  0.139534883721
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [5]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.254014976
saving predictions to csv file
patient0_5_wideResNet1_10-12-15-35-49.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config9.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_6']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config9.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_6'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-12 15:35:51.219658
Hostname: kat
gpu0
Configuration 'config9.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: wideResNet1
evaluation:
    online_training: False
    model: wideResNet1

end Configuration
['patient0_6']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [6]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.755601408
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 52.9203617096 28.9710264206
20 204.033294678 198.010336304
30 310.279055786 304.778164673
40 419.120050049 413.251306152
50 547.291717529 541.047363281
60 717.765319824 711.321618652
70 980.086315918 974.004034424
80 1476.19272461 1468.43618164
90 2691.36994629 2660.87460937
100 459356.3125 258723.5625
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  wideResNet1
Model name for the evaluation phase:  wideResNet1
Training model...
# Neural Network with 606338 learnable parameters

## Layer information

  #  name                 size
---  -------------------  ---------
  0  input                1x192x64
  1  conv2d_1             64x192x64
  2  conv2d_2             64x192x64
  3  dropout1             64x192x64
  4  conv2d_3             64x96x32
  5  batch_norm1          64x96x32
  6  batch_norm1_nonlin   64x96x32
  7                       64x96x32
  8  res0__conv1          64x96x32
  9  res0__conv1_nonlin   64x96x32
 10  res0__dropout        64x96x32
 11  res0__conv2          64x96x32
 12  res0__projection     64x96x32
 13  res0__sum            64x96x32
 14  res3__bn             64x96x32
 15  res3__nonlin         64x96x32
 16                       64x48x16
 17  res3__conv1          64x48x16
 18  res3__conv1_nonlin   64x48x16
 19  res3__dropout        64x48x16
 20  res3__conv2          64x48x16
 21  res3__projection     64x48x16
 22  res3__sum            64x48x16
 23  res4_1_bn            64x48x16
 24  res4_1_nonlin        64x48x16
 25                       64x48x16
 26  res4_1_conv1         64x48x16
 27  res4_1_conv1_nonlin  64x48x16
 28  res4_1_dropout       64x48x16
 29  res4_1_conv2         64x48x16
 30  res4_1_sum           64x48x16
 31  res4_2_bn            64x48x16
 32  res4_2_nonlin        64x48x16
 33                       64x48x16
 34  res4_2_conv1         64x48x16
 35  res4_2_conv1_nonlin  64x48x16
 36  res4_2_dropout       64x48x16
 37  res4_2_conv2         64x48x16
 38  res4_2_sum           64x48x16
 39  res5__bn             64x48x16
 40  res5__nonlin         64x48x16
 41                       64x24x8
 42  res5__conv1          64x24x8
 43  res5__conv1_nonlin   64x24x8
 44  res5__dropout        64x24x8
 45  res5__conv2          64x24x8
 46  res5__projection     64x24x8
 47  res5__sum            64x24x8
 48  res6_1_bn            64x24x8
 49  res6_1_nonlin        64x24x8
 50                       64x24x8
 51  res6_1_conv1         64x24x8
 52  res6_1_conv1_nonlin  64x24x8
 53  res6_1_dropout       64x24x8
 54  res6_1_conv2         64x24x8
 55  res6_1_sum           64x24x8
 56  res6_2_bn            64x24x8
 57  res6_2_nonlin        64x24x8
 58                       64x24x8
 59  res6_2_conv1         64x24x8
 60  res6_2_conv1_nonlin  64x24x8
 61  res6_2_dropout       64x24x8
 62  res6_2_conv2         64x24x8
 63  res6_2_sum           64x24x8
 64  bn_post_conv         64x24x8
 65  post_conv_nonlin     64x24x8
 66  last_conv            2x24x8
 67  global_pool          2
 68  softmax              2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m0.59232[0m     [32m0.93915[0m    0.63070      0.50005  198.24s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.48562[0m     0.99893    0.48614      0.47692  193.80s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.31125[0m     2.08043    0.14961      0.45104  191.85s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.21009[0m     2.82203    0.07444      0.48969  189.15s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.15065[0m     3.23431    0.04658      0.47133  188.33s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.13056[0m     3.06718    0.04257      0.46972  195.87s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.939148 at epoch 1.
Loaded parameters to layer 'conv2d_1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d_1' (shape 64).
Loaded parameters to layer 'conv2d_2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d_2' (shape 64).
Loaded parameters to layer 'conv2d_3' (shape 64x64x3x3).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'conv2ddnn7' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv2' (shape 64).
Loaded parameters to layer 'res0__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn16' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv2' (shape 64).
Loaded parameters to layer 'res3__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn25' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv2' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn33' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv2' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn41' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv2' (shape 64).
Loaded parameters to layer 'res5__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn50' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv2' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn58' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv2' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'last_conv' (shape 2x64x3x3).
Loaded parameters to layer 'last_conv' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.116298210355
Error rate (%):  88.3701789645
[[    1 46169]
 [    0  6075]]
(52245,)
(52245,)
roc_auc: 0.451807296527
log_loss: nan
roc_auc for the hours: 0.45
log_loss for the hours: nan
saving predictions to csv file
hourspatient0_6_wideResNet1_10-12-16-02-32.csv
Accuracy validation for the hours:  0.116279069767
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [6]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.254428672
saving predictions to csv file
patient0_6_wideResNet1_10-12-16-05-30.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config9.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_7']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config9.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_7'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-12 16:05:32.787960
Hostname: kat
gpu0
Configuration 'config9.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: wideResNet1
evaluation:
    online_training: False
    model: wideResNet1

end Configuration
['patient0_7']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [7]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.757035008
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 42.2832771301 23.406820488
20 162.516268921 157.987145996
30 247.963627625 243.623634338
40 336.95199585 332.831341553
50 445.399627686 441.292938232
60 597.128845215 593.310778809
70 844.070202637 839.791943359
80 1309.5418457 1299.71809082
90 2364.6079834 2327.02700195
100 202022.625 78149.3203125
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  wideResNet1
Model name for the evaluation phase:  wideResNet1
Training model...
# Neural Network with 606338 learnable parameters

## Layer information

  #  name                 size
---  -------------------  ---------
  0  input                1x192x64
  1  conv2d_1             64x192x64
  2  conv2d_2             64x192x64
  3  dropout1             64x192x64
  4  conv2d_3             64x96x32
  5  batch_norm1          64x96x32
  6  batch_norm1_nonlin   64x96x32
  7                       64x96x32
  8  res0__conv1          64x96x32
  9  res0__conv1_nonlin   64x96x32
 10  res0__dropout        64x96x32
 11  res0__conv2          64x96x32
 12  res0__projection     64x96x32
 13  res0__sum            64x96x32
 14  res3__bn             64x96x32
 15  res3__nonlin         64x96x32
 16                       64x48x16
 17  res3__conv1          64x48x16
 18  res3__conv1_nonlin   64x48x16
 19  res3__dropout        64x48x16
 20  res3__conv2          64x48x16
 21  res3__projection     64x48x16
 22  res3__sum            64x48x16
 23  res4_1_bn            64x48x16
 24  res4_1_nonlin        64x48x16
 25                       64x48x16
 26  res4_1_conv1         64x48x16
 27  res4_1_conv1_nonlin  64x48x16
 28  res4_1_dropout       64x48x16
 29  res4_1_conv2         64x48x16
 30  res4_1_sum           64x48x16
 31  res4_2_bn            64x48x16
 32  res4_2_nonlin        64x48x16
 33                       64x48x16
 34  res4_2_conv1         64x48x16
 35  res4_2_conv1_nonlin  64x48x16
 36  res4_2_dropout       64x48x16
 37  res4_2_conv2         64x48x16
 38  res4_2_sum           64x48x16
 39  res5__bn             64x48x16
 40  res5__nonlin         64x48x16
 41                       64x24x8
 42  res5__conv1          64x24x8
 43  res5__conv1_nonlin   64x24x8
 44  res5__dropout        64x24x8
 45  res5__conv2          64x24x8
 46  res5__projection     64x24x8
 47  res5__sum            64x24x8
 48  res6_1_bn            64x24x8
 49  res6_1_nonlin        64x24x8
 50                       64x24x8
 51  res6_1_conv1         64x24x8
 52  res6_1_conv1_nonlin  64x24x8
 53  res6_1_dropout       64x24x8
 54  res6_1_conv2         64x24x8
 55  res6_1_sum           64x24x8
 56  res6_2_bn            64x24x8
 57  res6_2_nonlin        64x24x8
 58                       64x24x8
 59  res6_2_conv1         64x24x8
 60  res6_2_conv1_nonlin  64x24x8
 61  res6_2_dropout       64x24x8
 62  res6_2_conv2         64x24x8
 63  res6_2_sum           64x24x8
 64  bn_post_conv         64x24x8
 65  post_conv_nonlin     64x24x8
 66  last_conv            2x24x8
 67  global_pool          2
 68  softmax              2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m0.59845[0m     [32m0.82604[0m    0.72448      0.47179  198.72s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.50108[0m     1.38996    0.36050      0.41130  197.16s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.35593[0m     1.83580    0.19388      0.39113  196.59s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.25136[0m     3.25175    0.07730      0.45566  191.60s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.18855[0m     5.07663    0.03714      0.45656  192.05s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.15882[0m     3.79869    0.04181      0.45569  187.92s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.826041 at epoch 1.
Loaded parameters to layer 'conv2d_1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d_1' (shape 64).
Loaded parameters to layer 'conv2d_2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d_2' (shape 64).
Loaded parameters to layer 'conv2d_3' (shape 64x64x3x3).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'conv2ddnn7' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv2' (shape 64).
Loaded parameters to layer 'res0__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn16' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv2' (shape 64).
Loaded parameters to layer 'res3__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn25' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv2' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn33' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv2' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn41' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv2' (shape 64).
Loaded parameters to layer 'res5__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn50' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv2' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn58' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv2' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'last_conv' (shape 2x64x3x3).
Loaded parameters to layer 'last_conv' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.266341276677
Error rate (%):  73.3658723323
[[10479 35691]
 [ 2639  3436]]
(52245,)
(52245,)
roc_auc: 0.434844340695
log_loss: inf
roc_auc for the hours: 0.389473684211
log_loss for the hours: 1.86956385445
saving predictions to csv file
hourspatient0_7_wideResNet1_10-12-16-32-34.csv
Accuracy validation for the hours:  0.232558139535
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [7]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.255653376
saving predictions to csv file
patient0_7_wideResNet1_10-12-16-35-49.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config9.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_8']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config9.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_8'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-12 16:35:51.354674
Hostname: kat
gpu0
Configuration 'config9.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: wideResNet1
evaluation:
    online_training: False
    model: wideResNet1

end Configuration
['patient0_8']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [8]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.756125696
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 54.1830825806 29.6300670624
20 210.284432983 202.797094727
30 322.79552002 315.015945435
40 440.955853271 432.186102295
50 584.439239502 573.883850098
60 779.399060059 765.642810059
70 1072.5894043 1055.17028809
80 1571.89633789 1552.87558594
90 2680.80834961 2671.50136719
100 68448.984375 353074.21875
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  wideResNet1
Model name for the evaluation phase:  wideResNet1
Training model...
# Neural Network with 606338 learnable parameters

## Layer information

  #  name                 size
---  -------------------  ---------
  0  input                1x192x64
  1  conv2d_1             64x192x64
  2  conv2d_2             64x192x64
  3  dropout1             64x192x64
  4  conv2d_3             64x96x32
  5  batch_norm1          64x96x32
  6  batch_norm1_nonlin   64x96x32
  7                       64x96x32
  8  res0__conv1          64x96x32
  9  res0__conv1_nonlin   64x96x32
 10  res0__dropout        64x96x32
 11  res0__conv2          64x96x32
 12  res0__projection     64x96x32
 13  res0__sum            64x96x32
 14  res3__bn             64x96x32
 15  res3__nonlin         64x96x32
 16                       64x48x16
 17  res3__conv1          64x48x16
 18  res3__conv1_nonlin   64x48x16
 19  res3__dropout        64x48x16
 20  res3__conv2          64x48x16
 21  res3__projection     64x48x16
 22  res3__sum            64x48x16
 23  res4_1_bn            64x48x16
 24  res4_1_nonlin        64x48x16
 25                       64x48x16
 26  res4_1_conv1         64x48x16
 27  res4_1_conv1_nonlin  64x48x16
 28  res4_1_dropout       64x48x16
 29  res4_1_conv2         64x48x16
 30  res4_1_sum           64x48x16
 31  res4_2_bn            64x48x16
 32  res4_2_nonlin        64x48x16
 33                       64x48x16
 34  res4_2_conv1         64x48x16
 35  res4_2_conv1_nonlin  64x48x16
 36  res4_2_dropout       64x48x16
 37  res4_2_conv2         64x48x16
 38  res4_2_sum           64x48x16
 39  res5__bn             64x48x16
 40  res5__nonlin         64x48x16
 41                       64x24x8
 42  res5__conv1          64x24x8
 43  res5__conv1_nonlin   64x24x8
 44  res5__dropout        64x24x8
 45  res5__conv2          64x24x8
 46  res5__projection     64x24x8
 47  res5__sum            64x24x8
 48  res6_1_bn            64x24x8
 49  res6_1_nonlin        64x24x8
 50                       64x24x8
 51  res6_1_conv1         64x24x8
 52  res6_1_conv1_nonlin  64x24x8
 53  res6_1_dropout       64x24x8
 54  res6_1_conv2         64x24x8
 55  res6_1_sum           64x24x8
 56  res6_2_bn            64x24x8
 57  res6_2_nonlin        64x24x8
 58                       64x24x8
 59  res6_2_conv1         64x24x8
 60  res6_2_conv1_nonlin  64x24x8
 61  res6_2_dropout       64x24x8
 62  res6_2_conv2         64x24x8
 63  res6_2_sum           64x24x8
 64  bn_post_conv         64x24x8
 65  post_conv_nonlin     64x24x8
 66  last_conv            2x24x8
 67  global_pool          2
 68  softmax              2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m0.59196[0m     [32m0.97570[0m    0.60671      0.50202  199.25s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.50524[0m     [32m0.76368[0m    0.66158      0.54792  198.57s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.36786[0m     1.16346    0.31618      0.50386  198.37s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.25359[0m     1.95167    0.12993      0.44741  198.19s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.18641[0m     1.64560    0.11328      0.46317  198.02s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.13905[0m     2.84491    0.04888      0.46353  194.85s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.11444[0m     3.82843    0.02989      0.46588  191.77s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.763681 at epoch 2.
Loaded parameters to layer 'conv2d_1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d_1' (shape 64).
Loaded parameters to layer 'conv2d_2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d_2' (shape 64).
Loaded parameters to layer 'conv2d_3' (shape 64x64x3x3).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'conv2ddnn7' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv2' (shape 64).
Loaded parameters to layer 'res0__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn16' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv2' (shape 64).
Loaded parameters to layer 'res3__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn25' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv2' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn33' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv2' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn41' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv2' (shape 64).
Loaded parameters to layer 'res5__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn50' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv2' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn58' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv2' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'last_conv' (shape 2x64x3x3).
Loaded parameters to layer 'last_conv' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 0 0 0 1 0 1 0 1 0 0 0 1 0 1 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.44448272562
Error rate (%):  55.551727438
[[18315 27855]
 [ 1168  4907]]
(52245,)
(52245,)
roc_auc: 0.656770102618
log_loss: nan
roc_auc for the hours: 0.731578947368
log_loss for the hours: 1.28322136603
saving predictions to csv file
hourspatient0_8_wideResNet1_10-12-17-06-15.csv
Accuracy validation for the hours:  0.46511627907
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [8]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.306755072
saving predictions to csv file
patient0_8_wideResNet1_10-12-17-09-19.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config9.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_9']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config9.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_9'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-12 17:09:21.765746
Hostname: kat
gpu0
Configuration 'config9.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: wideResNet1
evaluation:
    online_training: False
    model: wideResNet1

end Configuration
['patient0_9']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [9]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.755687424
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 66.6869514465 35.6989082336
20 256.319952393 245.103649902
30 392.878082275 380.05057373
40 536.743615723 521.363696289
50 716.260894775 697.441894531
60 975.356860352 953.108215332
70 1387.67550049 1363.3236084
80 2106.65888672 2072.82099609
90 3733.63100586 3669.75898437
100 262006.171875 86094.46875
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  wideResNet1
Model name for the evaluation phase:  wideResNet1
Training model...
# Neural Network with 606338 learnable parameters

## Layer information

  #  name                 size
---  -------------------  ---------
  0  input                1x192x64
  1  conv2d_1             64x192x64
  2  conv2d_2             64x192x64
  3  dropout1             64x192x64
  4  conv2d_3             64x96x32
  5  batch_norm1          64x96x32
  6  batch_norm1_nonlin   64x96x32
  7                       64x96x32
  8  res0__conv1          64x96x32
  9  res0__conv1_nonlin   64x96x32
 10  res0__dropout        64x96x32
 11  res0__conv2          64x96x32
 12  res0__projection     64x96x32
 13  res0__sum            64x96x32
 14  res3__bn             64x96x32
 15  res3__nonlin         64x96x32
 16                       64x48x16
 17  res3__conv1          64x48x16
 18  res3__conv1_nonlin   64x48x16
 19  res3__dropout        64x48x16
 20  res3__conv2          64x48x16
 21  res3__projection     64x48x16
 22  res3__sum            64x48x16
 23  res4_1_bn            64x48x16
 24  res4_1_nonlin        64x48x16
 25                       64x48x16
 26  res4_1_conv1         64x48x16
 27  res4_1_conv1_nonlin  64x48x16
 28  res4_1_dropout       64x48x16
 29  res4_1_conv2         64x48x16
 30  res4_1_sum           64x48x16
 31  res4_2_bn            64x48x16
 32  res4_2_nonlin        64x48x16
 33                       64x48x16
 34  res4_2_conv1         64x48x16
 35  res4_2_conv1_nonlin  64x48x16
 36  res4_2_dropout       64x48x16
 37  res4_2_conv2         64x48x16
 38  res4_2_sum           64x48x16
 39  res5__bn             64x48x16
 40  res5__nonlin         64x48x16
 41                       64x24x8
 42  res5__conv1          64x24x8
 43  res5__conv1_nonlin   64x24x8
 44  res5__dropout        64x24x8
 45  res5__conv2          64x24x8
 46  res5__projection     64x24x8
 47  res5__sum            64x24x8
 48  res6_1_bn            64x24x8
 49  res6_1_nonlin        64x24x8
 50                       64x24x8
 51  res6_1_conv1         64x24x8
 52  res6_1_conv1_nonlin  64x24x8
 53  res6_1_dropout       64x24x8
 54  res6_1_conv2         64x24x8
 55  res6_1_sum           64x24x8
 56  res6_2_bn            64x24x8
 57  res6_2_nonlin        64x24x8
 58                       64x24x8
 59  res6_2_conv1         64x24x8
 60  res6_2_conv1_nonlin  64x24x8
 61  res6_2_dropout       64x24x8
 62  res6_2_conv2         64x24x8
 63  res6_2_sum           64x24x8
 64  bn_post_conv         64x24x8
 65  post_conv_nonlin     64x24x8
 66  last_conv            2x24x8
 67  global_pool          2
 68  softmax              2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m0.57400[0m     [32m1.35297[0m    0.42425      0.50295  200.43s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.50847[0m     1.35715    0.37466      0.51780  200.59s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.41648[0m     [32m0.97306[0m    0.42801      0.55246  195.81s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.32778[0m     1.24211    0.26389      0.52691  197.82s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.25702[0m     1.66778    0.15411      0.49871  195.87s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.19871[0m     1.90817    0.10414      0.46332  191.54s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.15455[0m     3.85886    0.04005      0.46981  196.82s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.14456[0m     2.26751    0.06375      0.46818  195.97s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.973055 at epoch 3.
Loaded parameters to layer 'conv2d_1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d_1' (shape 64).
Loaded parameters to layer 'conv2d_2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d_2' (shape 64).
Loaded parameters to layer 'conv2d_3' (shape 64x64x3x3).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'conv2ddnn7' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv2' (shape 64).
Loaded parameters to layer 'res0__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn16' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv2' (shape 64).
Loaded parameters to layer 'res3__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn25' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv2' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn33' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv2' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn41' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv2' (shape 64).
Loaded parameters to layer 'res5__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn50' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv2' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn58' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv2' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'last_conv' (shape 2x64x3x3).
Loaded parameters to layer 'last_conv' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.763384055891
Error rate (%):  23.6615944109
[[39768  6402]
 [ 5960   115]]
(52245,)
(52245,)
roc_auc: 0.46433356062
log_loss: inf
roc_auc for the hours: 0.352631578947
log_loss for the hours: 1.21914810569
saving predictions to csv file
hourspatient0_9_wideResNet1_10-12-17-43-36.csv
Accuracy validation for the hours:  0.860465116279
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [9]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.307377664
saving predictions to csv file
patient0_9_wideResNet1_10-12-17-46-54.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config9.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_10']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config9.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_10'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-12 17:46:56.056806
Hostname: kat
gpu0
Configuration 'config9.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: wideResNet1
evaluation:
    online_training: False
    model: wideResNet1

end Configuration
['patient0_10']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [10]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.754454528
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 49.5935062408 26.4832733154
20 190.337982178 178.602871704
30 296.224377441 280.857037354
40 415.984814453 394.469250488
50 577.838653564 548.425720215
60 818.775402832 780.941381836
70 1187.2631958 1144.36071777
80 1820.75270996 1769.78515625
90 3363.41669922 3314.3128418
100 50863.234375 51923.34375
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  wideResNet1
Model name for the evaluation phase:  wideResNet1
Training model...
# Neural Network with 606338 learnable parameters

## Layer information

  #  name                 size
---  -------------------  ---------
  0  input                1x192x64
  1  conv2d_1             64x192x64
  2  conv2d_2             64x192x64
  3  dropout1             64x192x64
  4  conv2d_3             64x96x32
  5  batch_norm1          64x96x32
  6  batch_norm1_nonlin   64x96x32
  7                       64x96x32
  8  res0__conv1          64x96x32
  9  res0__conv1_nonlin   64x96x32
 10  res0__dropout        64x96x32
 11  res0__conv2          64x96x32
 12  res0__projection     64x96x32
 13  res0__sum            64x96x32
 14  res3__bn             64x96x32
 15  res3__nonlin         64x96x32
 16                       64x48x16
 17  res3__conv1          64x48x16
 18  res3__conv1_nonlin   64x48x16
 19  res3__dropout        64x48x16
 20  res3__conv2          64x48x16
 21  res3__projection     64x48x16
 22  res3__sum            64x48x16
 23  res4_1_bn            64x48x16
 24  res4_1_nonlin        64x48x16
 25                       64x48x16
 26  res4_1_conv1         64x48x16
 27  res4_1_conv1_nonlin  64x48x16
 28  res4_1_dropout       64x48x16
 29  res4_1_conv2         64x48x16
 30  res4_1_sum           64x48x16
 31  res4_2_bn            64x48x16
 32  res4_2_nonlin        64x48x16
 33                       64x48x16
 34  res4_2_conv1         64x48x16
 35  res4_2_conv1_nonlin  64x48x16
 36  res4_2_dropout       64x48x16
 37  res4_2_conv2         64x48x16
 38  res4_2_sum           64x48x16
 39  res5__bn             64x48x16
 40  res5__nonlin         64x48x16
 41                       64x24x8
 42  res5__conv1          64x24x8
 43  res5__conv1_nonlin   64x24x8
 44  res5__dropout        64x24x8
 45  res5__conv2          64x24x8
 46  res5__projection     64x24x8
 47  res5__sum            64x24x8
 48  res6_1_bn            64x24x8
 49  res6_1_nonlin        64x24x8
 50                       64x24x8
 51  res6_1_conv1         64x24x8
 52  res6_1_conv1_nonlin  64x24x8
 53  res6_1_dropout       64x24x8
 54  res6_1_conv2         64x24x8
 55  res6_1_sum           64x24x8
 56  res6_2_bn            64x24x8
 57  res6_2_nonlin        64x24x8
 58                       64x24x8
 59  res6_2_conv1         64x24x8
 60  res6_2_conv1_nonlin  64x24x8
 61  res6_2_dropout       64x24x8
 62  res6_2_conv2         64x24x8
 63  res6_2_sum           64x24x8
 64  bn_post_conv         64x24x8
 65  post_conv_nonlin     64x24x8
 66  last_conv            2x24x8
 67  global_pool          2
 68  softmax              2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m0.59150[0m     [32m0.70384[0m    0.84039      0.56795  195.73s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.49018[0m     0.89293    0.54896      0.51087  201.16s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.35532[0m     1.30774    0.27170      0.53042  198.03s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.24723[0m     3.67876    0.06720      0.48020  195.32s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.19509[0m     1.80613    0.10801      0.52836  193.23s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.13777[0m     2.90909    0.04736      0.49417  196.16s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.703838 at epoch 1.
Loaded parameters to layer 'conv2d_1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d_1' (shape 64).
Loaded parameters to layer 'conv2d_2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d_2' (shape 64).
Loaded parameters to layer 'conv2d_3' (shape 64x64x3x3).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'conv2ddnn7' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv2' (shape 64).
Loaded parameters to layer 'res0__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn16' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv2' (shape 64).
Loaded parameters to layer 'res3__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn25' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv2' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn33' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv2' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn41' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv2' (shape 64).
Loaded parameters to layer 'res5__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn50' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv2' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn58' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv2' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'last_conv' (shape 2x64x3x3).
Loaded parameters to layer 'last_conv' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.36571920758
Error rate (%):  63.428079242
[[15630 30540]
 [ 2598  3477]]
(52245,)
(52245,)
roc_auc: 0.457052704667
log_loss: inf
roc_auc for the hours: 0.415789473684
log_loss for the hours: 1.60377417678
saving predictions to csv file
hourspatient0_10_wideResNet1_10-12-18-17-08.csv
Accuracy validation for the hours:  0.325581395349
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [10]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.253285888
saving predictions to csv file
patient0_10_wideResNet1_10-12-18-19-59.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config9.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_11']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config9.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_11'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-12 18:20:01.489185
Hostname: kat
gpu0
Configuration 'config9.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: wideResNet1
evaluation:
    online_training: False
    model: wideResNet1

end Configuration
['patient0_11']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [11]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.755871744
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 37.4027713776 20.3596906662
20 138.625271606 132.382019043
30 211.681109619 204.980381775
40 289.691271973 281.780712891
50 389.566116333 380.066696167
60 543.70489502 531.805041504
70 834.583398437 818.790313721
80 1463.92446289 1432.4847168
90 3328.68920898 3260.95727539
100 410646.09375 69810.453125
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  wideResNet1
Model name for the evaluation phase:  wideResNet1
Training model...
# Neural Network with 606338 learnable parameters

## Layer information

  #  name                 size
---  -------------------  ---------
  0  input                1x192x64
  1  conv2d_1             64x192x64
  2  conv2d_2             64x192x64
  3  dropout1             64x192x64
  4  conv2d_3             64x96x32
  5  batch_norm1          64x96x32
  6  batch_norm1_nonlin   64x96x32
  7                       64x96x32
  8  res0__conv1          64x96x32
  9  res0__conv1_nonlin   64x96x32
 10  res0__dropout        64x96x32
 11  res0__conv2          64x96x32
 12  res0__projection     64x96x32
 13  res0__sum            64x96x32
 14  res3__bn             64x96x32
 15  res3__nonlin         64x96x32
 16                       64x48x16
 17  res3__conv1          64x48x16
 18  res3__conv1_nonlin   64x48x16
 19  res3__dropout        64x48x16
 20  res3__conv2          64x48x16
 21  res3__projection     64x48x16
 22  res3__sum            64x48x16
 23  res4_1_bn            64x48x16
 24  res4_1_nonlin        64x48x16
 25                       64x48x16
 26  res4_1_conv1         64x48x16
 27  res4_1_conv1_nonlin  64x48x16
 28  res4_1_dropout       64x48x16
 29  res4_1_conv2         64x48x16
 30  res4_1_sum           64x48x16
 31  res4_2_bn            64x48x16
 32  res4_2_nonlin        64x48x16
 33                       64x48x16
 34  res4_2_conv1         64x48x16
 35  res4_2_conv1_nonlin  64x48x16
 36  res4_2_dropout       64x48x16
 37  res4_2_conv2         64x48x16
 38  res4_2_sum           64x48x16
 39  res5__bn             64x48x16
 40  res5__nonlin         64x48x16
 41                       64x24x8
 42  res5__conv1          64x24x8
 43  res5__conv1_nonlin   64x24x8
 44  res5__dropout        64x24x8
 45  res5__conv2          64x24x8
 46  res5__projection     64x24x8
 47  res5__sum            64x24x8
 48  res6_1_bn            64x24x8
 49  res6_1_nonlin        64x24x8
 50                       64x24x8
 51  res6_1_conv1         64x24x8
 52  res6_1_conv1_nonlin  64x24x8
 53  res6_1_dropout       64x24x8
 54  res6_1_conv2         64x24x8
 55  res6_1_sum           64x24x8
 56  res6_2_bn            64x24x8
 57  res6_2_nonlin        64x24x8
 58                       64x24x8
 59  res6_2_conv1         64x24x8
 60  res6_2_conv1_nonlin  64x24x8
 61  res6_2_dropout       64x24x8
 62  res6_2_conv2         64x24x8
 63  res6_2_sum           64x24x8
 64  bn_post_conv         64x24x8
 65  post_conv_nonlin     64x24x8
 66  last_conv            2x24x8
 67  global_pool          2
 68  softmax              2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m0.59830[0m     [32m0.73005[0m    0.81953      0.50678  199.26s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.49688[0m     0.96086    0.51712      0.55765  195.52s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.35219[0m     2.16124    0.16296      0.54473  198.15s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.24480[0m     2.89737    0.08449      0.50938  193.56s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.18266[0m     3.95189    0.04622      0.50036  187.09s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.12696[0m     3.56553    0.03561      0.51047  198.69s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.730046 at epoch 1.
Loaded parameters to layer 'conv2d_1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d_1' (shape 64).
Loaded parameters to layer 'conv2d_2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d_2' (shape 64).
Loaded parameters to layer 'conv2d_3' (shape 64x64x3x3).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'conv2ddnn7' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv2' (shape 64).
Loaded parameters to layer 'res0__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn16' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv2' (shape 64).
Loaded parameters to layer 'res3__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn25' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv2' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn33' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv2' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn41' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv2' (shape 64).
Loaded parameters to layer 'res5__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn50' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv2' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn58' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv2' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'last_conv' (shape 2x64x3x3).
Loaded parameters to layer 'last_conv' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.36169968418
Error rate (%):  63.830031582
[[14386 31784]
 [ 1564  4511]]
(52245,)
(52245,)
roc_auc: 0.576967850964
log_loss: 1.48272687731
roc_auc for the hours: 0.636842105263
log_loss for the hours: 1.08733198267
saving predictions to csv file
hourspatient0_11_wideResNet1_10-12-18-46-21.csv
Accuracy validation for the hours:  0.325581395349
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [11]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.254641664
saving predictions to csv file
patient0_11_wideResNet1_10-12-18-49-14.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config9.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_12']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config9.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_12'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-12 18:49:16.927295
Hostname: kat
gpu0
Configuration 'config9.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: wideResNet1
evaluation:
    online_training: False
    model: wideResNet1

end Configuration
['patient0_12']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [12]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.755642368
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 65.1829460144 35.0811794281
20 246.685302734 233.028952026
30 381.222595215 364.982098389
40 530.423962402 509.868566895
50 730.584533691 703.699279785
60 1040.28303223 1008.42225342
70 1558.99154053 1521.31486816
80 2527.43164063 2455.40673828
90 5046.20957031 4843.92373047
100 126710.1875 64910.4453125
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  wideResNet1
Model name for the evaluation phase:  wideResNet1
Training model...
# Neural Network with 606338 learnable parameters

## Layer information

  #  name                 size
---  -------------------  ---------
  0  input                1x192x64
  1  conv2d_1             64x192x64
  2  conv2d_2             64x192x64
  3  dropout1             64x192x64
  4  conv2d_3             64x96x32
  5  batch_norm1          64x96x32
  6  batch_norm1_nonlin   64x96x32
  7                       64x96x32
  8  res0__conv1          64x96x32
  9  res0__conv1_nonlin   64x96x32
 10  res0__dropout        64x96x32
 11  res0__conv2          64x96x32
 12  res0__projection     64x96x32
 13  res0__sum            64x96x32
 14  res3__bn             64x96x32
 15  res3__nonlin         64x96x32
 16                       64x48x16
 17  res3__conv1          64x48x16
 18  res3__conv1_nonlin   64x48x16
 19  res3__dropout        64x48x16
 20  res3__conv2          64x48x16
 21  res3__projection     64x48x16
 22  res3__sum            64x48x16
 23  res4_1_bn            64x48x16
 24  res4_1_nonlin        64x48x16
 25                       64x48x16
 26  res4_1_conv1         64x48x16
 27  res4_1_conv1_nonlin  64x48x16
 28  res4_1_dropout       64x48x16
 29  res4_1_conv2         64x48x16
 30  res4_1_sum           64x48x16
 31  res4_2_bn            64x48x16
 32  res4_2_nonlin        64x48x16
 33                       64x48x16
 34  res4_2_conv1         64x48x16
 35  res4_2_conv1_nonlin  64x48x16
 36  res4_2_dropout       64x48x16
 37  res4_2_conv2         64x48x16
 38  res4_2_sum           64x48x16
 39  res5__bn             64x48x16
 40  res5__nonlin         64x48x16
 41                       64x24x8
 42  res5__conv1          64x24x8
 43  res5__conv1_nonlin   64x24x8
 44  res5__dropout        64x24x8
 45  res5__conv2          64x24x8
 46  res5__projection     64x24x8
 47  res5__sum            64x24x8
 48  res6_1_bn            64x24x8
 49  res6_1_nonlin        64x24x8
 50                       64x24x8
 51  res6_1_conv1         64x24x8
 52  res6_1_conv1_nonlin  64x24x8
 53  res6_1_dropout       64x24x8
 54  res6_1_conv2         64x24x8
 55  res6_1_sum           64x24x8
 56  res6_2_bn            64x24x8
 57  res6_2_nonlin        64x24x8
 58                       64x24x8
 59  res6_2_conv1         64x24x8
 60  res6_2_conv1_nonlin  64x24x8
 61  res6_2_dropout       64x24x8
 62  res6_2_conv2         64x24x8
 63  res6_2_sum           64x24x8
 64  bn_post_conv         64x24x8
 65  post_conv_nonlin     64x24x8
 66  last_conv            2x24x8
 67  global_pool          2
 68  softmax              2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m0.57288[0m     [32m0.89243[0m    0.64193      0.51082  194.94s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.49216[0m     [32m0.79341[0m    0.62031      0.52701  195.94s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.40078[0m     1.05152    0.38114      0.47102  200.08s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.30997[0m     1.34294    0.23081      0.44844  200.53s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.22931[0m     1.93415    0.11856      0.40438  198.75s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.17657[0m     2.07327    0.08517      0.47364  198.63s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.13469[0m     3.21761    0.04186      0.45968  197.53s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.793406 at epoch 2.
Loaded parameters to layer 'conv2d_1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d_1' (shape 64).
Loaded parameters to layer 'conv2d_2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d_2' (shape 64).
Loaded parameters to layer 'conv2d_3' (shape 64x64x3x3).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'conv2ddnn7' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv2' (shape 64).
Loaded parameters to layer 'res0__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn16' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv2' (shape 64).
Loaded parameters to layer 'res3__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn25' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv2' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn33' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv2' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn41' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv2' (shape 64).
Loaded parameters to layer 'res5__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn50' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv2' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn58' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv2' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'last_conv' (shape 2x64x3x3).
Loaded parameters to layer 'last_conv' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.237706957604
Error rate (%):  76.2293042396
[[ 7958 38212]
 [ 1614  4461]]
(52245,)
(52245,)
roc_auc: 0.428693586326
log_loss: nan
roc_auc for the hours: 0.434210526316
log_loss for the hours: nan
saving predictions to csv file
hourspatient0_12_wideResNet1_10-12-19-19-16.csv
Accuracy validation for the hours:  0.209302325581
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [12]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.307234304
saving predictions to csv file
patient0_12_wideResNet1_10-12-19-22-16.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config9.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_13']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config9.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_13'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-12 19:22:18.527971
Hostname: kat
gpu0
Configuration 'config9.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: wideResNet1
evaluation:
    online_training: False
    model: wideResNet1

end Configuration
['patient0_13']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [13]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.75554816
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 69.0897041321 37.7125782013
20 266.439715576 253.817520142
30 414.331445313 399.039959717
40 579.853991699 560.493823242
50 802.805938721 779.214904785
60 1136.38771973 1110.1892334
70 1641.78244629 1620.17226562
80 2489.06611328 2463.09140625
90 4471.61362305 4441.97880859
100 100082.695312 85056.0390625
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  wideResNet1
Model name for the evaluation phase:  wideResNet1
Training model...
# Neural Network with 606338 learnable parameters

## Layer information

  #  name                 size
---  -------------------  ---------
  0  input                1x192x64
  1  conv2d_1             64x192x64
  2  conv2d_2             64x192x64
  3  dropout1             64x192x64
  4  conv2d_3             64x96x32
  5  batch_norm1          64x96x32
  6  batch_norm1_nonlin   64x96x32
  7                       64x96x32
  8  res0__conv1          64x96x32
  9  res0__conv1_nonlin   64x96x32
 10  res0__dropout        64x96x32
 11  res0__conv2          64x96x32
 12  res0__projection     64x96x32
 13  res0__sum            64x96x32
 14  res3__bn             64x96x32
 15  res3__nonlin         64x96x32
 16                       64x48x16
 17  res3__conv1          64x48x16
 18  res3__conv1_nonlin   64x48x16
 19  res3__dropout        64x48x16
 20  res3__conv2          64x48x16
 21  res3__projection     64x48x16
 22  res3__sum            64x48x16
 23  res4_1_bn            64x48x16
 24  res4_1_nonlin        64x48x16
 25                       64x48x16
 26  res4_1_conv1         64x48x16
 27  res4_1_conv1_nonlin  64x48x16
 28  res4_1_dropout       64x48x16
 29  res4_1_conv2         64x48x16
 30  res4_1_sum           64x48x16
 31  res4_2_bn            64x48x16
 32  res4_2_nonlin        64x48x16
 33                       64x48x16
 34  res4_2_conv1         64x48x16
 35  res4_2_conv1_nonlin  64x48x16
 36  res4_2_dropout       64x48x16
 37  res4_2_conv2         64x48x16
 38  res4_2_sum           64x48x16
 39  res5__bn             64x48x16
 40  res5__nonlin         64x48x16
 41                       64x24x8
 42  res5__conv1          64x24x8
 43  res5__conv1_nonlin   64x24x8
 44  res5__dropout        64x24x8
 45  res5__conv2          64x24x8
 46  res5__projection     64x24x8
 47  res5__sum            64x24x8
 48  res6_1_bn            64x24x8
 49  res6_1_nonlin        64x24x8
 50                       64x24x8
 51  res6_1_conv1         64x24x8
 52  res6_1_conv1_nonlin  64x24x8
 53  res6_1_dropout       64x24x8
 54  res6_1_conv2         64x24x8
 55  res6_1_sum           64x24x8
 56  res6_2_bn            64x24x8
 57  res6_2_nonlin        64x24x8
 58                       64x24x8
 59  res6_2_conv1         64x24x8
 60  res6_2_conv1_nonlin  64x24x8
 61  res6_2_dropout       64x24x8
 62  res6_2_conv2         64x24x8
 63  res6_2_sum           64x24x8
 64  bn_post_conv         64x24x8
 65  post_conv_nonlin     64x24x8
 66  last_conv            2x24x8
 67  global_pool          2
 68  softmax              2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m0.58033[0m     [32m0.73590[0m    0.78860      0.52593  193.51s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.50596[0m     0.91674    0.55191      0.48127  194.52s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.43897[0m     0.81233    0.54039      0.52867  194.90s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.36372[0m     1.04137    0.34927      0.46865  194.58s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.28161[0m     1.67334    0.16829      0.40779  191.14s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.23026[0m     1.61456    0.14261      0.46188  191.81s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.735900 at epoch 1.
Loaded parameters to layer 'conv2d_1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d_1' (shape 64).
Loaded parameters to layer 'conv2d_2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d_2' (shape 64).
Loaded parameters to layer 'conv2d_3' (shape 64x64x3x3).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'conv2ddnn7' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv2' (shape 64).
Loaded parameters to layer 'res0__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn16' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv2' (shape 64).
Loaded parameters to layer 'res3__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn25' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv2' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn33' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv2' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn41' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv2' (shape 64).
Loaded parameters to layer 'res5__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn50' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv2' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn58' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv2' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'last_conv' (shape 2x64x3x3).
Loaded parameters to layer 'last_conv' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.116279069767
Error rate (%):  88.3720930233
[[    0 46170]
 [    0  6075]]
(52245,)
(52245,)
roc_auc: 0.446486552203
log_loss: nan
roc_auc for the hours: 0.468421052632
log_loss for the hours: nan
saving predictions to csv file
hourspatient0_13_wideResNet1_10-12-19-48-16.csv
Accuracy validation for the hours:  0.116279069767
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [13]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.254141952
saving predictions to csv file
patient0_13_wideResNet1_10-12-19-51-18.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config9.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_14']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config9.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_14'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-12 19:51:20.935857
Hostname: kat
gpu0
Configuration 'config9.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: wideResNet1
evaluation:
    online_training: False
    model: wideResNet1

end Configuration
['patient0_14']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [14]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.755556352
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 51.4431194305 28.1161405563
20 195.642379761 187.486203003
30 299.57428894 291.18163147
40 410.908746338 402.061425781
50 555.348205566 546.590423584
60 781.114685059 775.59395752
70 1179.35510254 1183.46280518
80 1939.34797363 1949.83596191
90 3877.67912598 3944.7189209
100 65181.1953125 57682.203125
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  wideResNet1
Model name for the evaluation phase:  wideResNet1
Training model...
# Neural Network with 606338 learnable parameters

## Layer information

  #  name                 size
---  -------------------  ---------
  0  input                1x192x64
  1  conv2d_1             64x192x64
  2  conv2d_2             64x192x64
  3  dropout1             64x192x64
  4  conv2d_3             64x96x32
  5  batch_norm1          64x96x32
  6  batch_norm1_nonlin   64x96x32
  7                       64x96x32
  8  res0__conv1          64x96x32
  9  res0__conv1_nonlin   64x96x32
 10  res0__dropout        64x96x32
 11  res0__conv2          64x96x32
 12  res0__projection     64x96x32
 13  res0__sum            64x96x32
 14  res3__bn             64x96x32
 15  res3__nonlin         64x96x32
 16                       64x48x16
 17  res3__conv1          64x48x16
 18  res3__conv1_nonlin   64x48x16
 19  res3__dropout        64x48x16
 20  res3__conv2          64x48x16
 21  res3__projection     64x48x16
 22  res3__sum            64x48x16
 23  res4_1_bn            64x48x16
 24  res4_1_nonlin        64x48x16
 25                       64x48x16
 26  res4_1_conv1         64x48x16
 27  res4_1_conv1_nonlin  64x48x16
 28  res4_1_dropout       64x48x16
 29  res4_1_conv2         64x48x16
 30  res4_1_sum           64x48x16
 31  res4_2_bn            64x48x16
 32  res4_2_nonlin        64x48x16
 33                       64x48x16
 34  res4_2_conv1         64x48x16
 35  res4_2_conv1_nonlin  64x48x16
 36  res4_2_dropout       64x48x16
 37  res4_2_conv2         64x48x16
 38  res4_2_sum           64x48x16
 39  res5__bn             64x48x16
 40  res5__nonlin         64x48x16
 41                       64x24x8
 42  res5__conv1          64x24x8
 43  res5__conv1_nonlin   64x24x8
 44  res5__dropout        64x24x8
 45  res5__conv2          64x24x8
 46  res5__projection     64x24x8
 47  res5__sum            64x24x8
 48  res6_1_bn            64x24x8
 49  res6_1_nonlin        64x24x8
 50                       64x24x8
 51  res6_1_conv1         64x24x8
 52  res6_1_conv1_nonlin  64x24x8
 53  res6_1_dropout       64x24x8
 54  res6_1_conv2         64x24x8
 55  res6_1_sum           64x24x8
 56  res6_2_bn            64x24x8
 57  res6_2_nonlin        64x24x8
 58                       64x24x8
 59  res6_2_conv1         64x24x8
 60  res6_2_conv1_nonlin  64x24x8
 61  res6_2_dropout       64x24x8
 62  res6_2_conv2         64x24x8
 63  res6_2_sum           64x24x8
 64  bn_post_conv         64x24x8
 65  post_conv_nonlin     64x24x8
 66  last_conv            2x24x8
 67  global_pool          2
 68  softmax              2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m0.59578[0m     [32m0.76535[0m    0.77843      0.56143  194.07s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.50856[0m     0.84881    0.59915      0.50517  194.94s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.41070[0m     0.93432    0.43957      0.50232  194.23s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.30836[0m     1.38681    0.22235      0.46803  194.15s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.21122[0m     1.85321    0.11397      0.42866  194.08s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.15280[0m     2.66085    0.05742      0.48468  189.86s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.765354 at epoch 1.
Loaded parameters to layer 'conv2d_1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d_1' (shape 64).
Loaded parameters to layer 'conv2d_2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d_2' (shape 64).
Loaded parameters to layer 'conv2d_3' (shape 64x64x3x3).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'conv2ddnn7' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv2' (shape 64).
Loaded parameters to layer 'res0__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn16' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv2' (shape 64).
Loaded parameters to layer 'res3__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn25' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv2' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn33' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv2' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn41' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv2' (shape 64).
Loaded parameters to layer 'res5__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn50' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv2' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn58' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv2' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'last_conv' (shape 2x64x3x3).
Loaded parameters to layer 'last_conv' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.28117523208
Error rate (%):  71.882476792
[[ 9885 36285]
 [ 1270  4805]]
(52245,)
(52245,)
roc_auc: 0.478392708643
log_loss: nan
roc_auc for the hours: 0.5
log_loss for the hours: 2.02360426045
saving predictions to csv file
hourspatient0_14_wideResNet1_10-12-20-17-24.csv
Accuracy validation for the hours:  0.232558139535
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [14]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.254060032
saving predictions to csv file
patient0_14_wideResNet1_10-12-20-20-32.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config9.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_15']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config9.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_15'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-12 20:20:34.101990
Hostname: kat
gpu0
Configuration 'config9.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: wideResNet1
evaluation:
    online_training: False
    model: wideResNet1

end Configuration
['patient0_15']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [15]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.754569216
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 34.6773342133 19.007179451
20 129.966018677 125.497892761
30 197.840336609 193.760687256
40 269.3421875 264.920050049
50 359.024520874 354.514923096
60 493.65269165 489.852355957
70 739.064575195 735.682330322
80 1252.53088379 1250.05979004
90 2505.61677246 2502.26618652
100 37134.734375 63323.234375
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  wideResNet1
Model name for the evaluation phase:  wideResNet1
Training model...
# Neural Network with 606338 learnable parameters

## Layer information

  #  name                 size
---  -------------------  ---------
  0  input                1x192x64
  1  conv2d_1             64x192x64
  2  conv2d_2             64x192x64
  3  dropout1             64x192x64
  4  conv2d_3             64x96x32
  5  batch_norm1          64x96x32
  6  batch_norm1_nonlin   64x96x32
  7                       64x96x32
  8  res0__conv1          64x96x32
  9  res0__conv1_nonlin   64x96x32
 10  res0__dropout        64x96x32
 11  res0__conv2          64x96x32
 12  res0__projection     64x96x32
 13  res0__sum            64x96x32
 14  res3__bn             64x96x32
 15  res3__nonlin         64x96x32
 16                       64x48x16
 17  res3__conv1          64x48x16
 18  res3__conv1_nonlin   64x48x16
 19  res3__dropout        64x48x16
 20  res3__conv2          64x48x16
 21  res3__projection     64x48x16
 22  res3__sum            64x48x16
 23  res4_1_bn            64x48x16
 24  res4_1_nonlin        64x48x16
 25                       64x48x16
 26  res4_1_conv1         64x48x16
 27  res4_1_conv1_nonlin  64x48x16
 28  res4_1_dropout       64x48x16
 29  res4_1_conv2         64x48x16
 30  res4_1_sum           64x48x16
 31  res4_2_bn            64x48x16
 32  res4_2_nonlin        64x48x16
 33                       64x48x16
 34  res4_2_conv1         64x48x16
 35  res4_2_conv1_nonlin  64x48x16
 36  res4_2_dropout       64x48x16
 37  res4_2_conv2         64x48x16
 38  res4_2_sum           64x48x16
 39  res5__bn             64x48x16
 40  res5__nonlin         64x48x16
 41                       64x24x8
 42  res5__conv1          64x24x8
 43  res5__conv1_nonlin   64x24x8
 44  res5__dropout        64x24x8
 45  res5__conv2          64x24x8
 46  res5__projection     64x24x8
 47  res5__sum            64x24x8
 48  res6_1_bn            64x24x8
 49  res6_1_nonlin        64x24x8
 50                       64x24x8
 51  res6_1_conv1         64x24x8
 52  res6_1_conv1_nonlin  64x24x8
 53  res6_1_dropout       64x24x8
 54  res6_1_conv2         64x24x8
 55  res6_1_sum           64x24x8
 56  res6_2_bn            64x24x8
 57  res6_2_nonlin        64x24x8
 58                       64x24x8
 59  res6_2_conv1         64x24x8
 60  res6_2_conv1_nonlin  64x24x8
 61  res6_2_dropout       64x24x8
 62  res6_2_conv2         64x24x8
 63  res6_2_sum           64x24x8
 64  bn_post_conv         64x24x8
 65  post_conv_nonlin     64x24x8
 66  last_conv            2x24x8
 67  global_pool          2
 68  softmax              2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m0.59964[0m     [32m0.97715[0m    0.61366      0.51020  193.72s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.53578[0m     [32m0.91194[0m    0.58752      0.50756  194.28s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.46236[0m     0.92434    0.50021      0.53104  194.55s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.37268[0m     1.09409    0.34063      0.48938  194.62s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.27969[0m     1.44712    0.19327      0.44281  194.82s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.21097[0m     1.57057    0.13433      0.46085  193.31s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.16345[0m     1.96905    0.08301      0.45513  190.17s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.911938 at epoch 2.
Loaded parameters to layer 'conv2d_1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d_1' (shape 64).
Loaded parameters to layer 'conv2d_2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d_2' (shape 64).
Loaded parameters to layer 'conv2d_3' (shape 64x64x3x3).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'conv2ddnn7' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv2' (shape 64).
Loaded parameters to layer 'res0__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn16' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv2' (shape 64).
Loaded parameters to layer 'res3__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn25' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv2' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn33' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv2' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn41' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv2' (shape 64).
Loaded parameters to layer 'res5__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn50' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv2' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn58' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv2' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'last_conv' (shape 2x64x3x3).
Loaded parameters to layer 'last_conv' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.134022394488
Error rate (%):  86.5977605512
[[ 1045 45125]
 [  118  5957]]
(52245,)
(52245,)
roc_auc: 0.44622253775
log_loss: nan
roc_auc for the hours: 0.436842105263
log_loss for the hours: inf
saving predictions to csv file
hourspatient0_15_wideResNet1_10-12-20-49-56.csv
Accuracy validation for the hours:  0.116279069767
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [15]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.305616384
saving predictions to csv file
patient0_15_wideResNet1_10-12-20-52-46.csv
