['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config9.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_0']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config9.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_0'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-12 12:22:52.244393
Hostname: kat
gpu2
Configuration 'config9.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: wideResNet1
evaluation:
    online_training: False
    model: wideResNet1

end Configuration
['patient2_0']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [0]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.753020928
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 367.479559326 395.117904663
20 582.979382324 615.201062012
30 795.170080566 830.338665771
40 1032.00554199 1067.2041748
50 1317.6385498 1346.52661133
60 1685.20253906 1697.71447754
70 2197.84929199 2175.63908691
80 3011.64487305 2914.53989258
90 4710.7300293 4431.95449219
100 63321.7421875 58944.8007812
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  wideResNet1
Model name for the evaluation phase:  wideResNet1
Training model...
# Neural Network with 606338 learnable parameters

## Layer information

  #  name                 size
---  -------------------  ---------
  0  input                1x192x64
  1  conv2d_1             64x192x64
  2  conv2d_2             64x192x64
  3  dropout1             64x192x64
  4  conv2d_3             64x96x32
  5  batch_norm1          64x96x32
  6  batch_norm1_nonlin   64x96x32
  7                       64x96x32
  8  res0__conv1          64x96x32
  9  res0__conv1_nonlin   64x96x32
 10  res0__dropout        64x96x32
 11  res0__conv2          64x96x32
 12  res0__projection     64x96x32
 13  res0__sum            64x96x32
 14  res3__bn             64x96x32
 15  res3__nonlin         64x96x32
 16                       64x48x16
 17  res3__conv1          64x48x16
 18  res3__conv1_nonlin   64x48x16
 19  res3__dropout        64x48x16
 20  res3__conv2          64x48x16
 21  res3__projection     64x48x16
 22  res3__sum            64x48x16
 23  res4_1_bn            64x48x16
 24  res4_1_nonlin        64x48x16
 25                       64x48x16
 26  res4_1_conv1         64x48x16
 27  res4_1_conv1_nonlin  64x48x16
 28  res4_1_dropout       64x48x16
 29  res4_1_conv2         64x48x16
 30  res4_1_sum           64x48x16
 31  res4_2_bn            64x48x16
 32  res4_2_nonlin        64x48x16
 33                       64x48x16
 34  res4_2_conv1         64x48x16
 35  res4_2_conv1_nonlin  64x48x16
 36  res4_2_dropout       64x48x16
 37  res4_2_conv2         64x48x16
 38  res4_2_sum           64x48x16
 39  res5__bn             64x48x16
 40  res5__nonlin         64x48x16
 41                       64x24x8
 42  res5__conv1          64x24x8
 43  res5__conv1_nonlin   64x24x8
 44  res5__dropout        64x24x8
 45  res5__conv2          64x24x8
 46  res5__projection     64x24x8
 47  res5__sum            64x24x8
 48  res6_1_bn            64x24x8
 49  res6_1_nonlin        64x24x8
 50                       64x24x8
 51  res6_1_conv1         64x24x8
 52  res6_1_conv1_nonlin  64x24x8
 53  res6_1_dropout       64x24x8
 54  res6_1_conv2         64x24x8
 55  res6_1_sum           64x24x8
 56  res6_2_bn            64x24x8
 57  res6_2_nonlin        64x24x8
 58                       64x24x8
 59  res6_2_conv1         64x24x8
 60  res6_2_conv1_nonlin  64x24x8
 61  res6_2_dropout       64x24x8
 62  res6_2_conv2         64x24x8
 63  res6_2_sum           64x24x8
 64  bn_post_conv         64x24x8
 65  post_conv_nonlin     64x24x8
 66  last_conv            2x24x8
 67  global_pool          2
 68  softmax              2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m0.51450[0m     [32m0.99223[0m    0.51852      0.70955  195.91s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.36616[0m     1.23030    0.29762      0.59957  202.03s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.17061[0m     1.59179    0.10718      0.62442  201.86s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.09066[0m     2.90645    0.03119      0.58796  203.17s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.06349[0m     2.56431    0.02476      0.62093  203.80s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.04651[0m     1.94146    0.02396      0.65356  201.58s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.992232 at epoch 1.
Loaded parameters to layer 'conv2d_1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d_1' (shape 64).
Loaded parameters to layer 'conv2d_2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d_2' (shape 64).
Loaded parameters to layer 'conv2d_3' (shape 64x64x3x3).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'conv2ddnn7' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv2' (shape 64).
Loaded parameters to layer 'res0__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn16' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv2' (shape 64).
Loaded parameters to layer 'res3__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn25' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv2' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn33' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv2' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn41' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv2' (shape 64).
Loaded parameters to layer 'res5__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn50' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv2' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn58' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv2' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'last_conv' (shape 2x64x3x3).
Loaded parameters to layer 'last_conv' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.791061345583
Error rate (%):  20.8938654417
[[38179  7991]
 [ 2925  3150]]
(52245,)
(52245,)
roc_auc: 0.723112013127
log_loss: nan
roc_auc for the hours: 0.723684210526
log_loss for the hours: 1.17559338719
saving predictions to csv file
hourspatient2_0_wideResNet1_10-12-12-56-40.csv
Accuracy validation for the hours:  0.813953488372
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [0]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.348476928
saving predictions to csv file
patient2_0_wideResNet1_10-12-13-01-28.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config9.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_1']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config9.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_1'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-12 13:01:30.936130
Hostname: kat
gpu2
Configuration 'config9.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: wideResNet1
evaluation:
    online_training: False
    model: wideResNet1

end Configuration
['patient2_1']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [1]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.755478528
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 263.661355591 284.954690552
20 416.892218018 440.678961182
30 568.269549561 590.942108154
40 738.6140625 756.022766113
50 948.0390625 954.364257812
60 1230.36213379 1214.27253418
70 1653.89840088 1589.50096436
80 2395.20083008 2220.65932617
90 4170.49838867 3672.37075195
100 56617.8046875 55581.1640625
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  wideResNet1
Model name for the evaluation phase:  wideResNet1
Training model...
# Neural Network with 606338 learnable parameters

## Layer information

  #  name                 size
---  -------------------  ---------
  0  input                1x192x64
  1  conv2d_1             64x192x64
  2  conv2d_2             64x192x64
  3  dropout1             64x192x64
  4  conv2d_3             64x96x32
  5  batch_norm1          64x96x32
  6  batch_norm1_nonlin   64x96x32
  7                       64x96x32
  8  res0__conv1          64x96x32
  9  res0__conv1_nonlin   64x96x32
 10  res0__dropout        64x96x32
 11  res0__conv2          64x96x32
 12  res0__projection     64x96x32
 13  res0__sum            64x96x32
 14  res3__bn             64x96x32
 15  res3__nonlin         64x96x32
 16                       64x48x16
 17  res3__conv1          64x48x16
 18  res3__conv1_nonlin   64x48x16
 19  res3__dropout        64x48x16
 20  res3__conv2          64x48x16
 21  res3__projection     64x48x16
 22  res3__sum            64x48x16
 23  res4_1_bn            64x48x16
 24  res4_1_nonlin        64x48x16
 25                       64x48x16
 26  res4_1_conv1         64x48x16
 27  res4_1_conv1_nonlin  64x48x16
 28  res4_1_dropout       64x48x16
 29  res4_1_conv2         64x48x16
 30  res4_1_sum           64x48x16
 31  res4_2_bn            64x48x16
 32  res4_2_nonlin        64x48x16
 33                       64x48x16
 34  res4_2_conv1         64x48x16
 35  res4_2_conv1_nonlin  64x48x16
 36  res4_2_dropout       64x48x16
 37  res4_2_conv2         64x48x16
 38  res4_2_sum           64x48x16
 39  res5__bn             64x48x16
 40  res5__nonlin         64x48x16
 41                       64x24x8
 42  res5__conv1          64x24x8
 43  res5__conv1_nonlin   64x24x8
 44  res5__dropout        64x24x8
 45  res5__conv2          64x24x8
 46  res5__projection     64x24x8
 47  res5__sum            64x24x8
 48  res6_1_bn            64x24x8
 49  res6_1_nonlin        64x24x8
 50                       64x24x8
 51  res6_1_conv1         64x24x8
 52  res6_1_conv1_nonlin  64x24x8
 53  res6_1_dropout       64x24x8
 54  res6_1_conv2         64x24x8
 55  res6_1_sum           64x24x8
 56  res6_2_bn            64x24x8
 57  res6_2_nonlin        64x24x8
 58                       64x24x8
 59  res6_2_conv1         64x24x8
 60  res6_2_conv1_nonlin  64x24x8
 61  res6_2_dropout       64x24x8
 62  res6_2_conv2         64x24x8
 63  res6_2_sum           64x24x8
 64  bn_post_conv         64x24x8
 65  post_conv_nonlin     64x24x8
 66  last_conv            2x24x8
 67  global_pool          2
 68  softmax              2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m0.48678[0m     [32m0.92078[0m    0.52866      0.56278  205.65s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.32951[0m     2.10258    0.15672      0.54150  204.84s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.19783[0m     1.65173    0.11977      0.55626  205.41s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.11983[0m     1.98987    0.06022      0.56187  202.98s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.08624[0m     1.78172    0.04841      0.59417  199.56s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.06592[0m     1.85758    0.03549      0.57289  196.47s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.920776 at epoch 1.
Loaded parameters to layer 'conv2d_1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d_1' (shape 64).
Loaded parameters to layer 'conv2d_2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d_2' (shape 64).
Loaded parameters to layer 'conv2d_3' (shape 64x64x3x3).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'conv2ddnn7' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv2' (shape 64).
Loaded parameters to layer 'res0__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn16' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv2' (shape 64).
Loaded parameters to layer 'res3__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn25' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv2' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn33' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv2' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn41' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv2' (shape 64).
Loaded parameters to layer 'res5__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn50' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv2' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn58' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv2' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'last_conv' (shape 2x64x3x3).
Loaded parameters to layer 'last_conv' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.603674992822
Error rate (%):  39.6325007178
[[29831 16339]
 [ 4367  1708]]
(52245,)
(52245,)
roc_auc: 0.544653619518
log_loss: nan
roc_auc for the hours: 0.552631578947
log_loss for the hours: 0.734527716205
saving predictions to csv file
hourspatient2_1_wideResNet1_10-12-13-29-20.csv
Accuracy validation for the hours:  0.558139534884
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [1]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.348317184
saving predictions to csv file
patient2_1_wideResNet1_10-12-13-33-48.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config9.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_2']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config9.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_2'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-12 13:33:50.834678
Hostname: kat
gpu2
Configuration 'config9.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: wideResNet1
evaluation:
    online_training: False
    model: wideResNet1

end Configuration
['patient2_2']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [2]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.755666944
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 209.986540222 225.906962585
20 329.095306396 346.162701416
30 444.230593872 460.11050415
40 570.524414062 582.58815918
50 722.16116333 726.961212158
60 921.348901367 911.623071289
70 1211.68074951 1175.55042725
80 1700.91003418 1611.25981445
90 2771.39865723 2552.46484375
100 58473.7617188 75930.625
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  wideResNet1
Model name for the evaluation phase:  wideResNet1
Training model...
# Neural Network with 606338 learnable parameters

## Layer information

  #  name                 size
---  -------------------  ---------
  0  input                1x192x64
  1  conv2d_1             64x192x64
  2  conv2d_2             64x192x64
  3  dropout1             64x192x64
  4  conv2d_3             64x96x32
  5  batch_norm1          64x96x32
  6  batch_norm1_nonlin   64x96x32
  7                       64x96x32
  8  res0__conv1          64x96x32
  9  res0__conv1_nonlin   64x96x32
 10  res0__dropout        64x96x32
 11  res0__conv2          64x96x32
 12  res0__projection     64x96x32
 13  res0__sum            64x96x32
 14  res3__bn             64x96x32
 15  res3__nonlin         64x96x32
 16                       64x48x16
 17  res3__conv1          64x48x16
 18  res3__conv1_nonlin   64x48x16
 19  res3__dropout        64x48x16
 20  res3__conv2          64x48x16
 21  res3__projection     64x48x16
 22  res3__sum            64x48x16
 23  res4_1_bn            64x48x16
 24  res4_1_nonlin        64x48x16
 25                       64x48x16
 26  res4_1_conv1         64x48x16
 27  res4_1_conv1_nonlin  64x48x16
 28  res4_1_dropout       64x48x16
 29  res4_1_conv2         64x48x16
 30  res4_1_sum           64x48x16
 31  res4_2_bn            64x48x16
 32  res4_2_nonlin        64x48x16
 33                       64x48x16
 34  res4_2_conv1         64x48x16
 35  res4_2_conv1_nonlin  64x48x16
 36  res4_2_dropout       64x48x16
 37  res4_2_conv2         64x48x16
 38  res4_2_sum           64x48x16
 39  res5__bn             64x48x16
 40  res5__nonlin         64x48x16
 41                       64x24x8
 42  res5__conv1          64x24x8
 43  res5__conv1_nonlin   64x24x8
 44  res5__dropout        64x24x8
 45  res5__conv2          64x24x8
 46  res5__projection     64x24x8
 47  res5__sum            64x24x8
 48  res6_1_bn            64x24x8
 49  res6_1_nonlin        64x24x8
 50                       64x24x8
 51  res6_1_conv1         64x24x8
 52  res6_1_conv1_nonlin  64x24x8
 53  res6_1_dropout       64x24x8
 54  res6_1_conv2         64x24x8
 55  res6_1_sum           64x24x8
 56  res6_2_bn            64x24x8
 57  res6_2_nonlin        64x24x8
 58                       64x24x8
 59  res6_2_conv1         64x24x8
 60  res6_2_conv1_nonlin  64x24x8
 61  res6_2_dropout       64x24x8
 62  res6_2_conv2         64x24x8
 63  res6_2_sum           64x24x8
 64  bn_post_conv         64x24x8
 65  post_conv_nonlin     64x24x8
 66  last_conv            2x24x8
 67  global_pool          2
 68  softmax              2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m0.46926[0m     [32m2.02136[0m    0.23215      0.51579  203.29s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.36815[0m     2.25858    0.16300      0.54771  204.63s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.26128[0m     2.56943    0.10169      0.53825  204.34s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.17653[0m     3.17858    0.05554      0.58136  205.11s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.11961[0m     2.47648    0.04830      0.62703  207.80s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.08621[0m     3.30268    0.02610      0.60755  204.08s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 2.021356 at epoch 1.
Loaded parameters to layer 'conv2d_1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d_1' (shape 64).
Loaded parameters to layer 'conv2d_2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d_2' (shape 64).
Loaded parameters to layer 'conv2d_3' (shape 64x64x3x3).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'conv2ddnn7' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv2' (shape 64).
Loaded parameters to layer 'res0__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn16' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv2' (shape 64).
Loaded parameters to layer 'res3__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn25' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv2' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn33' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv2' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn41' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv2' (shape 64).
Loaded parameters to layer 'res5__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn50' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv2' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn58' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv2' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'last_conv' (shape 2x64x3x3).
Loaded parameters to layer 'last_conv' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.32613647239
Error rate (%):  67.386352761
[[12583 33587]
 [ 1619  4456]]
(52245,)
(52245,)
roc_auc: 0.602423856726
log_loss: nan
roc_auc for the hours: 0.6
log_loss for the hours: nan
saving predictions to csv file
hourspatient2_2_wideResNet1_10-12-14-02-31.csv
Accuracy validation for the hours:  0.279069767442
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [2]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.34658048
saving predictions to csv file
patient2_2_wideResNet1_10-12-14-07-08.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config9.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_3']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config9.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_3'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-12 14:07:09.956607
Hostname: kat
gpu2
Configuration 'config9.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: wideResNet1
evaluation:
    online_training: False
    model: wideResNet1

end Configuration
['patient2_3']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [3]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.755695616
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 232.146871948 248.098060608
20 362.633648682 379.823339844
30 488.15196228 505.159686279
40 627.292626953 642.350366211
50 799.678375244 809.175415039
60 1039.14638672 1037.57441406
70 1420.94019775 1395.75299072
80 2108.71582031 2036.62312012
90 3569.3847168 3399.96303711
100 147926.25 114985.820312
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  wideResNet1
Model name for the evaluation phase:  wideResNet1
Training model...
# Neural Network with 606338 learnable parameters

## Layer information

  #  name                 size
---  -------------------  ---------
  0  input                1x192x64
  1  conv2d_1             64x192x64
  2  conv2d_2             64x192x64
  3  dropout1             64x192x64
  4  conv2d_3             64x96x32
  5  batch_norm1          64x96x32
  6  batch_norm1_nonlin   64x96x32
  7                       64x96x32
  8  res0__conv1          64x96x32
  9  res0__conv1_nonlin   64x96x32
 10  res0__dropout        64x96x32
 11  res0__conv2          64x96x32
 12  res0__projection     64x96x32
 13  res0__sum            64x96x32
 14  res3__bn             64x96x32
 15  res3__nonlin         64x96x32
 16                       64x48x16
 17  res3__conv1          64x48x16
 18  res3__conv1_nonlin   64x48x16
 19  res3__dropout        64x48x16
 20  res3__conv2          64x48x16
 21  res3__projection     64x48x16
 22  res3__sum            64x48x16
 23  res4_1_bn            64x48x16
 24  res4_1_nonlin        64x48x16
 25                       64x48x16
 26  res4_1_conv1         64x48x16
 27  res4_1_conv1_nonlin  64x48x16
 28  res4_1_dropout       64x48x16
 29  res4_1_conv2         64x48x16
 30  res4_1_sum           64x48x16
 31  res4_2_bn            64x48x16
 32  res4_2_nonlin        64x48x16
 33                       64x48x16
 34  res4_2_conv1         64x48x16
 35  res4_2_conv1_nonlin  64x48x16
 36  res4_2_dropout       64x48x16
 37  res4_2_conv2         64x48x16
 38  res4_2_sum           64x48x16
 39  res5__bn             64x48x16
 40  res5__nonlin         64x48x16
 41                       64x24x8
 42  res5__conv1          64x24x8
 43  res5__conv1_nonlin   64x24x8
 44  res5__dropout        64x24x8
 45  res5__conv2          64x24x8
 46  res5__projection     64x24x8
 47  res5__sum            64x24x8
 48  res6_1_bn            64x24x8
 49  res6_1_nonlin        64x24x8
 50                       64x24x8
 51  res6_1_conv1         64x24x8
 52  res6_1_conv1_nonlin  64x24x8
 53  res6_1_dropout       64x24x8
 54  res6_1_conv2         64x24x8
 55  res6_1_sum           64x24x8
 56  res6_2_bn            64x24x8
 57  res6_2_nonlin        64x24x8
 58                       64x24x8
 59  res6_2_conv1         64x24x8
 60  res6_2_conv1_nonlin  64x24x8
 61  res6_2_dropout       64x24x8
 62  res6_2_conv2         64x24x8
 63  res6_2_sum           64x24x8
 64  bn_post_conv         64x24x8
 65  post_conv_nonlin     64x24x8
 66  last_conv            2x24x8
 67  global_pool          2
 68  softmax              2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m0.46299[0m     [32m0.96713[0m    0.47872      0.64352  204.02s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.35311[0m     1.93352    0.18262      0.64748  208.02s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.26579[0m     1.31528    0.20208      0.61052  207.33s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.18290[0m     2.22668    0.08214      0.62972  207.10s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.14060[0m     1.80645    0.07783      0.68199  205.93s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.10433[0m     1.88850    0.05524      0.64964  204.94s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.967133 at epoch 1.
Loaded parameters to layer 'conv2d_1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d_1' (shape 64).
Loaded parameters to layer 'conv2d_2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d_2' (shape 64).
Loaded parameters to layer 'conv2d_3' (shape 64x64x3x3).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'conv2ddnn7' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv2' (shape 64).
Loaded parameters to layer 'res0__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn16' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv2' (shape 64).
Loaded parameters to layer 'res3__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn25' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv2' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn33' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv2' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn41' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv2' (shape 64).
Loaded parameters to layer 'res5__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn50' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv2' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn58' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv2' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'last_conv' (shape 2x64x3x3).
Loaded parameters to layer 'last_conv' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.525772801225
Error rate (%):  47.4227198775
[[23303 22867]
 [ 1909  4166]]
(52245,)
(52245,)
roc_auc: 0.645762997903
log_loss: nan
roc_auc for the hours: 0.642105263158
log_loss for the hours: nan
saving predictions to csv file
hourspatient2_3_wideResNet1_10-12-14-37-50.csv
Accuracy validation for the hours:  0.558139534884
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [3]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.346781184
saving predictions to csv file
patient2_3_wideResNet1_10-12-14-42-28.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config9.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_4']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config9.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_4'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-12 14:42:30.000705
Hostname: kat
gpu2
Configuration 'config9.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: wideResNet1
evaluation:
    online_training: False
    model: wideResNet1

end Configuration
['patient2_4']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [4]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.755331072
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 165.436743164 175.107310486
20 259.898529053 270.363952637
30 352.872415161 363.763861084
40 459.585931396 469.051629639
50 596.801239014 602.84375
60 794.120068359 791.004992676
70 1106.86796875 1082.3704834
80 1648.70195313 1577.21459961
90 2803.05773926 2610.05686035
100 44210.6640625 39898.75
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  wideResNet1
Model name for the evaluation phase:  wideResNet1
Training model...
# Neural Network with 606338 learnable parameters

## Layer information

  #  name                 size
---  -------------------  ---------
  0  input                1x192x64
  1  conv2d_1             64x192x64
  2  conv2d_2             64x192x64
  3  dropout1             64x192x64
  4  conv2d_3             64x96x32
  5  batch_norm1          64x96x32
  6  batch_norm1_nonlin   64x96x32
  7                       64x96x32
  8  res0__conv1          64x96x32
  9  res0__conv1_nonlin   64x96x32
 10  res0__dropout        64x96x32
 11  res0__conv2          64x96x32
 12  res0__projection     64x96x32
 13  res0__sum            64x96x32
 14  res3__bn             64x96x32
 15  res3__nonlin         64x96x32
 16                       64x48x16
 17  res3__conv1          64x48x16
 18  res3__conv1_nonlin   64x48x16
 19  res3__dropout        64x48x16
 20  res3__conv2          64x48x16
 21  res3__projection     64x48x16
 22  res3__sum            64x48x16
 23  res4_1_bn            64x48x16
 24  res4_1_nonlin        64x48x16
 25                       64x48x16
 26  res4_1_conv1         64x48x16
 27  res4_1_conv1_nonlin  64x48x16
 28  res4_1_dropout       64x48x16
 29  res4_1_conv2         64x48x16
 30  res4_1_sum           64x48x16
 31  res4_2_bn            64x48x16
 32  res4_2_nonlin        64x48x16
 33                       64x48x16
 34  res4_2_conv1         64x48x16
 35  res4_2_conv1_nonlin  64x48x16
 36  res4_2_dropout       64x48x16
 37  res4_2_conv2         64x48x16
 38  res4_2_sum           64x48x16
 39  res5__bn             64x48x16
 40  res5__nonlin         64x48x16
 41                       64x24x8
 42  res5__conv1          64x24x8
 43  res5__conv1_nonlin   64x24x8
 44  res5__dropout        64x24x8
 45  res5__conv2          64x24x8
 46  res5__projection     64x24x8
 47  res5__sum            64x24x8
 48  res6_1_bn            64x24x8
 49  res6_1_nonlin        64x24x8
 50                       64x24x8
 51  res6_1_conv1         64x24x8
 52  res6_1_conv1_nonlin  64x24x8
 53  res6_1_dropout       64x24x8
 54  res6_1_conv2         64x24x8
 55  res6_1_sum           64x24x8
 56  res6_2_bn            64x24x8
 57  res6_2_nonlin        64x24x8
 58                       64x24x8
 59  res6_2_conv1         64x24x8
 60  res6_2_conv1_nonlin  64x24x8
 61  res6_2_dropout       64x24x8
 62  res6_2_conv2         64x24x8
 63  res6_2_sum           64x24x8
 64  bn_post_conv         64x24x8
 65  post_conv_nonlin     64x24x8
 66  last_conv            2x24x8
 67  global_pool          2
 68  softmax              2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m0.47043[0m     [32m0.73545[0m    0.63965      0.57272  206.78s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.33537[0m     0.91030    0.36842      0.68123  207.40s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.20520[0m     1.47613    0.13902      0.64388  206.19s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.12701[0m     1.71556    0.07404      0.62240  202.90s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.08429[0m     1.94273    0.04339      0.62961  196.21s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.06088[0m     2.04396    0.02979      0.60714  194.99s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.735453 at epoch 1.
Loaded parameters to layer 'conv2d_1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d_1' (shape 64).
Loaded parameters to layer 'conv2d_2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d_2' (shape 64).
Loaded parameters to layer 'conv2d_3' (shape 64x64x3x3).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'conv2ddnn7' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv2' (shape 64).
Loaded parameters to layer 'res0__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn16' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv2' (shape 64).
Loaded parameters to layer 'res3__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn25' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv2' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn33' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv2' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn41' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv2' (shape 64).
Loaded parameters to layer 'res5__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn50' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv2' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn58' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv2' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'last_conv' (shape 2x64x3x3).
Loaded parameters to layer 'last_conv' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.12405014834
Error rate (%):  87.594985166
[[  406 45764]
 [    0  6075]]
(52245,)
(52245,)
roc_auc: 0.597927908223
log_loss: nan
roc_auc for the hours: 0.676315789474
log_loss for the hours: nan
saving predictions to csv file
hourspatient2_4_wideResNet1_10-12-15-11-02.csv
Accuracy validation for the hours:  0.116279069767
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [4]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.347633152
saving predictions to csv file
patient2_4_wideResNet1_10-12-15-15-40.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config9.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_5']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config9.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_5'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-12 15:15:42.157888
Hostname: kat
gpu2
Configuration 'config9.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: wideResNet1
evaluation:
    online_training: False
    model: wideResNet1

end Configuration
['patient2_5']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [5]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.756391936
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 185.196789551 197.613002014
20 294.801989746 307.815057373
30 407.290542603 420.04319458
40 542.552478027 552.726599121
50 726.239715576 729.61151123
60 1003.9644165 990.04107666
70 1455.43812256 1400.85588379
80 2251.58901367 2106.12675781
90 4066.22578125 3684.91796875
100 67580.4921875 68869.3984375
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  wideResNet1
Model name for the evaluation phase:  wideResNet1
Training model...
# Neural Network with 606338 learnable parameters

## Layer information

  #  name                 size
---  -------------------  ---------
  0  input                1x192x64
  1  conv2d_1             64x192x64
  2  conv2d_2             64x192x64
  3  dropout1             64x192x64
  4  conv2d_3             64x96x32
  5  batch_norm1          64x96x32
  6  batch_norm1_nonlin   64x96x32
  7                       64x96x32
  8  res0__conv1          64x96x32
  9  res0__conv1_nonlin   64x96x32
 10  res0__dropout        64x96x32
 11  res0__conv2          64x96x32
 12  res0__projection     64x96x32
 13  res0__sum            64x96x32
 14  res3__bn             64x96x32
 15  res3__nonlin         64x96x32
 16                       64x48x16
 17  res3__conv1          64x48x16
 18  res3__conv1_nonlin   64x48x16
 19  res3__dropout        64x48x16
 20  res3__conv2          64x48x16
 21  res3__projection     64x48x16
 22  res3__sum            64x48x16
 23  res4_1_bn            64x48x16
 24  res4_1_nonlin        64x48x16
 25                       64x48x16
 26  res4_1_conv1         64x48x16
 27  res4_1_conv1_nonlin  64x48x16
 28  res4_1_dropout       64x48x16
 29  res4_1_conv2         64x48x16
 30  res4_1_sum           64x48x16
 31  res4_2_bn            64x48x16
 32  res4_2_nonlin        64x48x16
 33                       64x48x16
 34  res4_2_conv1         64x48x16
 35  res4_2_conv1_nonlin  64x48x16
 36  res4_2_dropout       64x48x16
 37  res4_2_conv2         64x48x16
 38  res4_2_sum           64x48x16
 39  res5__bn             64x48x16
 40  res5__nonlin         64x48x16
 41                       64x24x8
 42  res5__conv1          64x24x8
 43  res5__conv1_nonlin   64x24x8
 44  res5__dropout        64x24x8
 45  res5__conv2          64x24x8
 46  res5__projection     64x24x8
 47  res5__sum            64x24x8
 48  res6_1_bn            64x24x8
 49  res6_1_nonlin        64x24x8
 50                       64x24x8
 51  res6_1_conv1         64x24x8
 52  res6_1_conv1_nonlin  64x24x8
 53  res6_1_dropout       64x24x8
 54  res6_1_conv2         64x24x8
 55  res6_1_sum           64x24x8
 56  res6_2_bn            64x24x8
 57  res6_2_nonlin        64x24x8
 58                       64x24x8
 59  res6_2_conv1         64x24x8
 60  res6_2_conv1_nonlin  64x24x8
 61  res6_2_dropout       64x24x8
 62  res6_2_conv2         64x24x8
 63  res6_2_sum           64x24x8
 64  bn_post_conv         64x24x8
 65  post_conv_nonlin     64x24x8
 66  last_conv            2x24x8
 67  global_pool          2
 68  softmax              2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m0.47427[0m     [32m0.84055[0m    0.56424      0.57375  204.80s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.32797[0m     0.94258    0.34795      0.59367  203.72s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.23348[0m     1.36357    0.17123      0.61618  204.90s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.16586[0m     1.49799    0.11072      0.61951  203.34s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.11715[0m     1.68590    0.06949      0.60502  204.08s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.09278[0m     2.37587    0.03905      0.61034  201.32s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.840549 at epoch 1.
Loaded parameters to layer 'conv2d_1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d_1' (shape 64).
Loaded parameters to layer 'conv2d_2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d_2' (shape 64).
Loaded parameters to layer 'conv2d_3' (shape 64x64x3x3).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'conv2ddnn7' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv2' (shape 64).
Loaded parameters to layer 'res0__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn16' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv2' (shape 64).
Loaded parameters to layer 'res3__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn25' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv2' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn33' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv2' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn41' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv2' (shape 64).
Loaded parameters to layer 'res5__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn50' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv2' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn58' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv2' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'last_conv' (shape 2x64x3x3).
Loaded parameters to layer 'last_conv' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.535400516796
Error rate (%):  46.4599483204
[[24438 21732]
 [ 2541  3534]]
(52245,)
(52245,)
roc_auc: 0.559656294371
log_loss: nan
roc_auc for the hours: 0.636842105263
log_loss for the hours: 0.775787689398
saving predictions to csv file
hourspatient2_5_wideResNet1_10-12-15-43-17.csv
Accuracy validation for the hours:  0.511627906977
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [5]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.347674112
saving predictions to csv file
patient2_5_wideResNet1_10-12-15-47-49.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config9.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_6']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config9.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_6'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-12 15:47:51.769685
Hostname: kat
gpu2
Configuration 'config9.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: wideResNet1
evaluation:
    online_training: False
    model: wideResNet1

end Configuration
['patient2_6']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [6]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.75522048
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 163.101298523 175.881399536
20 258.470428467 274.155731201
30 355.682626343 373.270678711
40 471.085089111 488.984100342
50 626.310150146 642.409729004
60 861.122949219 869.392102051
70 1253.91723633 1241.61234131
80 1956.83286133 1902.809375
90 3422.80100098 3262.08793945
100 47858.3515625 52179.953125
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  wideResNet1
Model name for the evaluation phase:  wideResNet1
Training model...
# Neural Network with 606338 learnable parameters

## Layer information

  #  name                 size
---  -------------------  ---------
  0  input                1x192x64
  1  conv2d_1             64x192x64
  2  conv2d_2             64x192x64
  3  dropout1             64x192x64
  4  conv2d_3             64x96x32
  5  batch_norm1          64x96x32
  6  batch_norm1_nonlin   64x96x32
  7                       64x96x32
  8  res0__conv1          64x96x32
  9  res0__conv1_nonlin   64x96x32
 10  res0__dropout        64x96x32
 11  res0__conv2          64x96x32
 12  res0__projection     64x96x32
 13  res0__sum            64x96x32
 14  res3__bn             64x96x32
 15  res3__nonlin         64x96x32
 16                       64x48x16
 17  res3__conv1          64x48x16
 18  res3__conv1_nonlin   64x48x16
 19  res3__dropout        64x48x16
 20  res3__conv2          64x48x16
 21  res3__projection     64x48x16
 22  res3__sum            64x48x16
 23  res4_1_bn            64x48x16
 24  res4_1_nonlin        64x48x16
 25                       64x48x16
 26  res4_1_conv1         64x48x16
 27  res4_1_conv1_nonlin  64x48x16
 28  res4_1_dropout       64x48x16
 29  res4_1_conv2         64x48x16
 30  res4_1_sum           64x48x16
 31  res4_2_bn            64x48x16
 32  res4_2_nonlin        64x48x16
 33                       64x48x16
 34  res4_2_conv1         64x48x16
 35  res4_2_conv1_nonlin  64x48x16
 36  res4_2_dropout       64x48x16
 37  res4_2_conv2         64x48x16
 38  res4_2_sum           64x48x16
 39  res5__bn             64x48x16
 40  res5__nonlin         64x48x16
 41                       64x24x8
 42  res5__conv1          64x24x8
 43  res5__conv1_nonlin   64x24x8
 44  res5__dropout        64x24x8
 45  res5__conv2          64x24x8
 46  res5__projection     64x24x8
 47  res5__sum            64x24x8
 48  res6_1_bn            64x24x8
 49  res6_1_nonlin        64x24x8
 50                       64x24x8
 51  res6_1_conv1         64x24x8
 52  res6_1_conv1_nonlin  64x24x8
 53  res6_1_dropout       64x24x8
 54  res6_1_conv2         64x24x8
 55  res6_1_sum           64x24x8
 56  res6_2_bn            64x24x8
 57  res6_2_nonlin        64x24x8
 58                       64x24x8
 59  res6_2_conv1         64x24x8
 60  res6_2_conv1_nonlin  64x24x8
 61  res6_2_dropout       64x24x8
 62  res6_2_conv2         64x24x8
 63  res6_2_sum           64x24x8
 64  bn_post_conv         64x24x8
 65  post_conv_nonlin     64x24x8
 66  last_conv            2x24x8
 67  global_pool          2
 68  softmax              2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m0.47633[0m     [32m1.05073[0m    0.45334      0.53721  199.64s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.29283[0m     1.17742    0.24870      0.61188  207.21s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.17030[0m     1.52652    0.11156      0.59858  204.72s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.10684[0m     2.12882    0.05019      0.59590  202.28s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.06963[0m     2.51432    0.02769      0.58177  206.17s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.05616[0m     1.77844    0.03158      0.58712  205.12s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 1.050726 at epoch 1.
Loaded parameters to layer 'conv2d_1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d_1' (shape 64).
Loaded parameters to layer 'conv2d_2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d_2' (shape 64).
Loaded parameters to layer 'conv2d_3' (shape 64x64x3x3).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'conv2ddnn7' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv2' (shape 64).
Loaded parameters to layer 'res0__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn16' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv2' (shape 64).
Loaded parameters to layer 'res3__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn25' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv2' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn33' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv2' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn41' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv2' (shape 64).
Loaded parameters to layer 'res5__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn50' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv2' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn58' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv2' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'last_conv' (shape 2x64x3x3).
Loaded parameters to layer 'last_conv' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.883720930233
Error rate (%):  11.6279069767
[[46170     0]
 [ 6075     0]]
(52245,)
(52245,)
roc_auc: 0.619247208607
log_loss: 1.59680823671
roc_auc for the hours: 0.713157894737
log_loss for the hours: 1.31178241461
saving predictions to csv file
hourspatient2_6_wideResNet1_10-12-16-19-31.csv
Accuracy validation for the hours:  0.883720930233
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [6]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.34619136
saving predictions to csv file
patient2_6_wideResNet1_10-12-16-23-53.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config9.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_7']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config9.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_7'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-12 16:23:56.353992
Hostname: kat
gpu2
Configuration 'config9.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: wideResNet1
evaluation:
    online_training: False
    model: wideResNet1

end Configuration
['patient2_7']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [7]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.755859456
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 177.49072113 198.887155151
20 286.226177979 314.740679932
30 400.515246582 436.170880127
40 540.098596191 582.037194824
50 725.995513916 773.688720703
60 988.882971191 1040.23283691
70 1379.6152832 1428.96156006
80 1995.99584961 2035.20236816
90 3121.08054199 3130.02658691
100 70629.9609375 92128.8515625
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  wideResNet1
Model name for the evaluation phase:  wideResNet1
Training model...
# Neural Network with 606338 learnable parameters

## Layer information

  #  name                 size
---  -------------------  ---------
  0  input                1x192x64
  1  conv2d_1             64x192x64
  2  conv2d_2             64x192x64
  3  dropout1             64x192x64
  4  conv2d_3             64x96x32
  5  batch_norm1          64x96x32
  6  batch_norm1_nonlin   64x96x32
  7                       64x96x32
  8  res0__conv1          64x96x32
  9  res0__conv1_nonlin   64x96x32
 10  res0__dropout        64x96x32
 11  res0__conv2          64x96x32
 12  res0__projection     64x96x32
 13  res0__sum            64x96x32
 14  res3__bn             64x96x32
 15  res3__nonlin         64x96x32
 16                       64x48x16
 17  res3__conv1          64x48x16
 18  res3__conv1_nonlin   64x48x16
 19  res3__dropout        64x48x16
 20  res3__conv2          64x48x16
 21  res3__projection     64x48x16
 22  res3__sum            64x48x16
 23  res4_1_bn            64x48x16
 24  res4_1_nonlin        64x48x16
 25                       64x48x16
 26  res4_1_conv1         64x48x16
 27  res4_1_conv1_nonlin  64x48x16
 28  res4_1_dropout       64x48x16
 29  res4_1_conv2         64x48x16
 30  res4_1_sum           64x48x16
 31  res4_2_bn            64x48x16
 32  res4_2_nonlin        64x48x16
 33                       64x48x16
 34  res4_2_conv1         64x48x16
 35  res4_2_conv1_nonlin  64x48x16
 36  res4_2_dropout       64x48x16
 37  res4_2_conv2         64x48x16
 38  res4_2_sum           64x48x16
 39  res5__bn             64x48x16
 40  res5__nonlin         64x48x16
 41                       64x24x8
 42  res5__conv1          64x24x8
 43  res5__conv1_nonlin   64x24x8
 44  res5__dropout        64x24x8
 45  res5__conv2          64x24x8
 46  res5__projection     64x24x8
 47  res5__sum            64x24x8
 48  res6_1_bn            64x24x8
 49  res6_1_nonlin        64x24x8
 50                       64x24x8
 51  res6_1_conv1         64x24x8
 52  res6_1_conv1_nonlin  64x24x8
 53  res6_1_dropout       64x24x8
 54  res6_1_conv2         64x24x8
 55  res6_1_sum           64x24x8
 56  res6_2_bn            64x24x8
 57  res6_2_nonlin        64x24x8
 58                       64x24x8
 59  res6_2_conv1         64x24x8
 60  res6_2_conv1_nonlin  64x24x8
 61  res6_2_dropout       64x24x8
 62  res6_2_conv2         64x24x8
 63  res6_2_sum           64x24x8
 64  bn_post_conv         64x24x8
 65  post_conv_nonlin     64x24x8
 66  last_conv            2x24x8
 67  global_pool          2
 68  softmax              2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m0.48593[0m     [32m0.81319[0m    0.59756      0.54653  203.06s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.35627[0m     2.33740    0.15242      0.50228  202.96s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.24454[0m     1.81975    0.13438      0.57336  208.97s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.16720[0m     2.10799    0.07932      0.57610  207.69s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.11967[0m     2.88210    0.04152      0.61256  206.94s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.08625[0m     3.28578    0.02625      0.59404  206.97s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.813187 at epoch 1.
Loaded parameters to layer 'conv2d_1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d_1' (shape 64).
Loaded parameters to layer 'conv2d_2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d_2' (shape 64).
Loaded parameters to layer 'conv2d_3' (shape 64x64x3x3).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'conv2ddnn7' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv2' (shape 64).
Loaded parameters to layer 'res0__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn16' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv2' (shape 64).
Loaded parameters to layer 'res3__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn25' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv2' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn33' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv2' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn41' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv2' (shape 64).
Loaded parameters to layer 'res5__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn50' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv2' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn58' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv2' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'last_conv' (shape 2x64x3x3).
Loaded parameters to layer 'last_conv' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.883720930233
Error rate (%):  11.6279069767
[[46170     0]
 [ 6075     0]]
(52245,)
(52245,)
roc_auc: 0.577942386831
log_loss: 2.66111172796
roc_auc for the hours: 0.6
log_loss for the hours: 2.33613277036
saving predictions to csv file
hourspatient2_7_wideResNet1_10-12-16-56-57.csv
Accuracy validation for the hours:  0.883720930233
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [7]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.34692864
saving predictions to csv file
patient2_7_wideResNet1_10-12-17-01-22.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config9.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_8']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config9.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_8'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-12 17:01:24.418892
Hostname: kat
gpu2
Configuration 'config9.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: wideResNet1
evaluation:
    online_training: False
    model: wideResNet1

end Configuration
['patient2_8']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [8]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.755908608
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 304.582891846 331.561761475
20 484.435198975 519.064501953
30 665.606323242 707.089782715
40 874.991894531 920.50123291
50 1137.25024414 1183.24688721
60 1487.04992676 1528.72434082
70 1983.92612305 2011.19562988
80 2754.95263672 2754.76303711
90 4202.81694336 4159.4034668
100 105201.65625 53464.578125
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  wideResNet1
Model name for the evaluation phase:  wideResNet1
Training model...
# Neural Network with 606338 learnable parameters

## Layer information

  #  name                 size
---  -------------------  ---------
  0  input                1x192x64
  1  conv2d_1             64x192x64
  2  conv2d_2             64x192x64
  3  dropout1             64x192x64
  4  conv2d_3             64x96x32
  5  batch_norm1          64x96x32
  6  batch_norm1_nonlin   64x96x32
  7                       64x96x32
  8  res0__conv1          64x96x32
  9  res0__conv1_nonlin   64x96x32
 10  res0__dropout        64x96x32
 11  res0__conv2          64x96x32
 12  res0__projection     64x96x32
 13  res0__sum            64x96x32
 14  res3__bn             64x96x32
 15  res3__nonlin         64x96x32
 16                       64x48x16
 17  res3__conv1          64x48x16
 18  res3__conv1_nonlin   64x48x16
 19  res3__dropout        64x48x16
 20  res3__conv2          64x48x16
 21  res3__projection     64x48x16
 22  res3__sum            64x48x16
 23  res4_1_bn            64x48x16
 24  res4_1_nonlin        64x48x16
 25                       64x48x16
 26  res4_1_conv1         64x48x16
 27  res4_1_conv1_nonlin  64x48x16
 28  res4_1_dropout       64x48x16
 29  res4_1_conv2         64x48x16
 30  res4_1_sum           64x48x16
 31  res4_2_bn            64x48x16
 32  res4_2_nonlin        64x48x16
 33                       64x48x16
 34  res4_2_conv1         64x48x16
 35  res4_2_conv1_nonlin  64x48x16
 36  res4_2_dropout       64x48x16
 37  res4_2_conv2         64x48x16
 38  res4_2_sum           64x48x16
 39  res5__bn             64x48x16
 40  res5__nonlin         64x48x16
 41                       64x24x8
 42  res5__conv1          64x24x8
 43  res5__conv1_nonlin   64x24x8
 44  res5__dropout        64x24x8
 45  res5__conv2          64x24x8
 46  res5__projection     64x24x8
 47  res5__sum            64x24x8
 48  res6_1_bn            64x24x8
 49  res6_1_nonlin        64x24x8
 50                       64x24x8
 51  res6_1_conv1         64x24x8
 52  res6_1_conv1_nonlin  64x24x8
 53  res6_1_dropout       64x24x8
 54  res6_1_conv2         64x24x8
 55  res6_1_sum           64x24x8
 56  res6_2_bn            64x24x8
 57  res6_2_nonlin        64x24x8
 58                       64x24x8
 59  res6_2_conv1         64x24x8
 60  res6_2_conv1_nonlin  64x24x8
 61  res6_2_dropout       64x24x8
 62  res6_2_conv2         64x24x8
 63  res6_2_sum           64x24x8
 64  bn_post_conv         64x24x8
 65  post_conv_nonlin     64x24x8
 66  last_conv            2x24x8
 67  global_pool          2
 68  softmax              2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m0.44002[0m     [32m1.75968[0m    0.25006      0.61660  196.07s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.33333[0m     1.98251    0.16814      0.60308  203.06s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.22976[0m     3.15037    0.07293      0.63327  207.90s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.14153[0m     2.23237    0.06340      0.61796  208.53s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.10049[0m     2.01129    0.04996      0.60729  203.49s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.08054[0m     2.77851    0.02899      0.58743  205.28s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 1.759678 at epoch 1.
Loaded parameters to layer 'conv2d_1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d_1' (shape 64).
Loaded parameters to layer 'conv2d_2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d_2' (shape 64).
Loaded parameters to layer 'conv2d_3' (shape 64x64x3x3).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'conv2ddnn7' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv2' (shape 64).
Loaded parameters to layer 'res0__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn16' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv2' (shape 64).
Loaded parameters to layer 'res3__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn25' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv2' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn33' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv2' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn41' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv2' (shape 64).
Loaded parameters to layer 'res5__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn50' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv2' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn58' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv2' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'last_conv' (shape 2x64x3x3).
Loaded parameters to layer 'last_conv' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.813360130156
Error rate (%):  18.6639869844
[[40572  5598]
 [ 4153  1922]]
(52245,)
(52245,)
roc_auc: 0.636343279578
log_loss: nan
roc_auc for the hours: 0.689473684211
log_loss for the hours: inf
saving predictions to csv file
hourspatient2_8_wideResNet1_10-12-17-30-21.csv
Accuracy validation for the hours:  0.790697674419
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [8]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.348153344
saving predictions to csv file
patient2_8_wideResNet1_10-12-17-34-52.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config9.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_9']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config9.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_9'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-12 17:34:54.823599
Hostname: kat
gpu2
Configuration 'config9.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: wideResNet1
evaluation:
    online_training: False
    model: wideResNet1

end Configuration
['patient2_9']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [9]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.755859456
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 283.37227478 306.047775269
20 448.091705322 476.795318604
30 612.117547607 646.27376709
40 800.063977051 838.327783203
50 1035.82800293 1076.41149902
60 1355.32043457 1393.14555664
70 1821.88786621 1848.28326416
80 2583.80039063 2579.61362305
90 4184.19125977 4103.89086914
100 81443.234375 46753.0546875
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  wideResNet1
Model name for the evaluation phase:  wideResNet1
Training model...
# Neural Network with 606338 learnable parameters

## Layer information

  #  name                 size
---  -------------------  ---------
  0  input                1x192x64
  1  conv2d_1             64x192x64
  2  conv2d_2             64x192x64
  3  dropout1             64x192x64
  4  conv2d_3             64x96x32
  5  batch_norm1          64x96x32
  6  batch_norm1_nonlin   64x96x32
  7                       64x96x32
  8  res0__conv1          64x96x32
  9  res0__conv1_nonlin   64x96x32
 10  res0__dropout        64x96x32
 11  res0__conv2          64x96x32
 12  res0__projection     64x96x32
 13  res0__sum            64x96x32
 14  res3__bn             64x96x32
 15  res3__nonlin         64x96x32
 16                       64x48x16
 17  res3__conv1          64x48x16
 18  res3__conv1_nonlin   64x48x16
 19  res3__dropout        64x48x16
 20  res3__conv2          64x48x16
 21  res3__projection     64x48x16
 22  res3__sum            64x48x16
 23  res4_1_bn            64x48x16
 24  res4_1_nonlin        64x48x16
 25                       64x48x16
 26  res4_1_conv1         64x48x16
 27  res4_1_conv1_nonlin  64x48x16
 28  res4_1_dropout       64x48x16
 29  res4_1_conv2         64x48x16
 30  res4_1_sum           64x48x16
 31  res4_2_bn            64x48x16
 32  res4_2_nonlin        64x48x16
 33                       64x48x16
 34  res4_2_conv1         64x48x16
 35  res4_2_conv1_nonlin  64x48x16
 36  res4_2_dropout       64x48x16
 37  res4_2_conv2         64x48x16
 38  res4_2_sum           64x48x16
 39  res5__bn             64x48x16
 40  res5__nonlin         64x48x16
 41                       64x24x8
 42  res5__conv1          64x24x8
 43  res5__conv1_nonlin   64x24x8
 44  res5__dropout        64x24x8
 45  res5__conv2          64x24x8
 46  res5__projection     64x24x8
 47  res5__sum            64x24x8
 48  res6_1_bn            64x24x8
 49  res6_1_nonlin        64x24x8
 50                       64x24x8
 51  res6_1_conv1         64x24x8
 52  res6_1_conv1_nonlin  64x24x8
 53  res6_1_dropout       64x24x8
 54  res6_1_conv2         64x24x8
 55  res6_1_sum           64x24x8
 56  res6_2_bn            64x24x8
 57  res6_2_nonlin        64x24x8
 58                       64x24x8
 59  res6_2_conv1         64x24x8
 60  res6_2_conv1_nonlin  64x24x8
 61  res6_2_dropout       64x24x8
 62  res6_2_conv2         64x24x8
 63  res6_2_sum           64x24x8
 64  bn_post_conv         64x24x8
 65  post_conv_nonlin     64x24x8
 66  last_conv            2x24x8
 67  global_pool          2
 68  softmax              2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m0.46653[0m     [32m0.80044[0m    0.58284      0.60470  204.51s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.30437[0m     1.89479    0.16064      0.61840  200.14s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.18737[0m     1.63986    0.11426      0.59642  198.94s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.12538[0m     3.71508    0.03375      0.58053  195.96s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.08177[0m     2.41542    0.03385      0.59118  201.99s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.05710[0m     3.40938    0.01675      0.58011  209.14s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.800442 at epoch 1.
Loaded parameters to layer 'conv2d_1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d_1' (shape 64).
Loaded parameters to layer 'conv2d_2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d_2' (shape 64).
Loaded parameters to layer 'conv2d_3' (shape 64x64x3x3).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'conv2ddnn7' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv2' (shape 64).
Loaded parameters to layer 'res0__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn16' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv2' (shape 64).
Loaded parameters to layer 'res3__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn25' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv2' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn33' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv2' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn41' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv2' (shape 64).
Loaded parameters to layer 'res5__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn50' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv2' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn58' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv2' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'last_conv' (shape 2x64x3x3).
Loaded parameters to layer 'last_conv' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.7732605991
Error rate (%):  22.67394009
[[37695  8475]
 [ 3371  2704]]
(52245,)
(52245,)
roc_auc: 0.63654663433
log_loss: inf
roc_auc for the hours: 0.631578947368
log_loss for the hours: 0.702050256792
saving predictions to csv file
hourspatient2_9_wideResNet1_10-12-18-03-11.csv
Accuracy validation for the hours:  0.767441860465
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [9]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.347506176
saving predictions to csv file
patient2_9_wideResNet1_10-12-18-07-32.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config9.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_10']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config9.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_10'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-12 18:07:34.786471
Hostname: kat
gpu2
Configuration 'config9.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: wideResNet1
evaluation:
    online_training: False
    model: wideResNet1

end Configuration
['patient2_10']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [10]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.755331072
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 235.353125 259.209658813
20 373.425970459 404.270147705
30 511.624740601 548.895672607
40 670.266955566 710.672009277
50 867.946899414 908.465515137
60 1130.38996582 1165.67106934
70 1502.52767334 1525.50710449
80 2081.78022461 2081.2378418
90 3192.88137207 3135.13125
100 33467.8828125 31567.0722656
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  wideResNet1
Model name for the evaluation phase:  wideResNet1
Training model...
# Neural Network with 606338 learnable parameters

## Layer information

  #  name                 size
---  -------------------  ---------
  0  input                1x192x64
  1  conv2d_1             64x192x64
  2  conv2d_2             64x192x64
  3  dropout1             64x192x64
  4  conv2d_3             64x96x32
  5  batch_norm1          64x96x32
  6  batch_norm1_nonlin   64x96x32
  7                       64x96x32
  8  res0__conv1          64x96x32
  9  res0__conv1_nonlin   64x96x32
 10  res0__dropout        64x96x32
 11  res0__conv2          64x96x32
 12  res0__projection     64x96x32
 13  res0__sum            64x96x32
 14  res3__bn             64x96x32
 15  res3__nonlin         64x96x32
 16                       64x48x16
 17  res3__conv1          64x48x16
 18  res3__conv1_nonlin   64x48x16
 19  res3__dropout        64x48x16
 20  res3__conv2          64x48x16
 21  res3__projection     64x48x16
 22  res3__sum            64x48x16
 23  res4_1_bn            64x48x16
 24  res4_1_nonlin        64x48x16
 25                       64x48x16
 26  res4_1_conv1         64x48x16
 27  res4_1_conv1_nonlin  64x48x16
 28  res4_1_dropout       64x48x16
 29  res4_1_conv2         64x48x16
 30  res4_1_sum           64x48x16
 31  res4_2_bn            64x48x16
 32  res4_2_nonlin        64x48x16
 33                       64x48x16
 34  res4_2_conv1         64x48x16
 35  res4_2_conv1_nonlin  64x48x16
 36  res4_2_dropout       64x48x16
 37  res4_2_conv2         64x48x16
 38  res4_2_sum           64x48x16
 39  res5__bn             64x48x16
 40  res5__nonlin         64x48x16
 41                       64x24x8
 42  res5__conv1          64x24x8
 43  res5__conv1_nonlin   64x24x8
 44  res5__dropout        64x24x8
 45  res5__conv2          64x24x8
 46  res5__projection     64x24x8
 47  res5__sum            64x24x8
 48  res6_1_bn            64x24x8
 49  res6_1_nonlin        64x24x8
 50                       64x24x8
 51  res6_1_conv1         64x24x8
 52  res6_1_conv1_nonlin  64x24x8
 53  res6_1_dropout       64x24x8
 54  res6_1_conv2         64x24x8
 55  res6_1_sum           64x24x8
 56  res6_2_bn            64x24x8
 57  res6_2_nonlin        64x24x8
 58                       64x24x8
 59  res6_2_conv1         64x24x8
 60  res6_2_conv1_nonlin  64x24x8
 61  res6_2_dropout       64x24x8
 62  res6_2_conv2         64x24x8
 63  res6_2_sum           64x24x8
 64  bn_post_conv         64x24x8
 65  post_conv_nonlin     64x24x8
 66  last_conv            2x24x8
 67  global_pool          2
 68  softmax              2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m0.46612[0m     [32m1.30830[0m    0.35628      0.56920  200.78s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.31406[0m     1.61019    0.19504      0.58528  204.46s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.18891[0m     2.23093    0.08468      0.57058  202.31s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.11420[0m     2.06905    0.05519      0.60806  205.44s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.08179[0m     3.07226    0.02662      0.58415  204.39s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.05242[0m     2.37648    0.02206      0.63603  203.37s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 1.308298 at epoch 1.
Loaded parameters to layer 'conv2d_1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d_1' (shape 64).
Loaded parameters to layer 'conv2d_2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d_2' (shape 64).
Loaded parameters to layer 'conv2d_3' (shape 64x64x3x3).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'conv2ddnn7' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv2' (shape 64).
Loaded parameters to layer 'res0__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn16' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv2' (shape 64).
Loaded parameters to layer 'res3__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn25' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv2' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn33' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv2' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn41' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv2' (shape 64).
Loaded parameters to layer 'res5__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn50' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv2' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn58' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv2' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'last_conv' (shape 2x64x3x3).
Loaded parameters to layer 'last_conv' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.873251028807
Error rate (%):  12.6748971193
[[45623   547]
 [ 6075     0]]
(52245,)
(52245,)
roc_auc: 0.482110748344
log_loss: 2.82512664036
roc_auc for the hours: 0.578947368421
log_loss for the hours: 1.94395686221
saving predictions to csv file
hourspatient2_10_wideResNet1_10-12-18-35-48.csv
Accuracy validation for the hours:  0.883720930233
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [10]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.34668288
saving predictions to csv file
patient2_10_wideResNet1_10-12-18-40-13.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config9.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_11']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config9.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_11'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-12 18:40:15.831416
Hostname: kat
gpu2
Configuration 'config9.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: wideResNet1
evaluation:
    online_training: False
    model: wideResNet1

end Configuration
['patient2_11']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [11]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.75460608
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 185.314794922 208.111297607
20 299.770111084 330.638024902
30 420.835580444 458.932080078
40 567.582995605 611.673339844
50 760.888244629 809.9090271
60 1030.30930176 1080.86318359
70 1423.52952881 1473.30863037
80 2039.71828613 2086.87138672
90 3209.50048828 3264.72282715
100 47304.0664062 104914.585938
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  wideResNet1
Model name for the evaluation phase:  wideResNet1
Training model...
# Neural Network with 606338 learnable parameters

## Layer information

  #  name                 size
---  -------------------  ---------
  0  input                1x192x64
  1  conv2d_1             64x192x64
  2  conv2d_2             64x192x64
  3  dropout1             64x192x64
  4  conv2d_3             64x96x32
  5  batch_norm1          64x96x32
  6  batch_norm1_nonlin   64x96x32
  7                       64x96x32
  8  res0__conv1          64x96x32
  9  res0__conv1_nonlin   64x96x32
 10  res0__dropout        64x96x32
 11  res0__conv2          64x96x32
 12  res0__projection     64x96x32
 13  res0__sum            64x96x32
 14  res3__bn             64x96x32
 15  res3__nonlin         64x96x32
 16                       64x48x16
 17  res3__conv1          64x48x16
 18  res3__conv1_nonlin   64x48x16
 19  res3__dropout        64x48x16
 20  res3__conv2          64x48x16
 21  res3__projection     64x48x16
 22  res3__sum            64x48x16
 23  res4_1_bn            64x48x16
 24  res4_1_nonlin        64x48x16
 25                       64x48x16
 26  res4_1_conv1         64x48x16
 27  res4_1_conv1_nonlin  64x48x16
 28  res4_1_dropout       64x48x16
 29  res4_1_conv2         64x48x16
 30  res4_1_sum           64x48x16
 31  res4_2_bn            64x48x16
 32  res4_2_nonlin        64x48x16
 33                       64x48x16
 34  res4_2_conv1         64x48x16
 35  res4_2_conv1_nonlin  64x48x16
 36  res4_2_dropout       64x48x16
 37  res4_2_conv2         64x48x16
 38  res4_2_sum           64x48x16
 39  res5__bn             64x48x16
 40  res5__nonlin         64x48x16
 41                       64x24x8
 42  res5__conv1          64x24x8
 43  res5__conv1_nonlin   64x24x8
 44  res5__dropout        64x24x8
 45  res5__conv2          64x24x8
 46  res5__projection     64x24x8
 47  res5__sum            64x24x8
 48  res6_1_bn            64x24x8
 49  res6_1_nonlin        64x24x8
 50                       64x24x8
 51  res6_1_conv1         64x24x8
 52  res6_1_conv1_nonlin  64x24x8
 53  res6_1_dropout       64x24x8
 54  res6_1_conv2         64x24x8
 55  res6_1_sum           64x24x8
 56  res6_2_bn            64x24x8
 57  res6_2_nonlin        64x24x8
 58                       64x24x8
 59  res6_2_conv1         64x24x8
 60  res6_2_conv1_nonlin  64x24x8
 61  res6_2_dropout       64x24x8
 62  res6_2_conv2         64x24x8
 63  res6_2_sum           64x24x8
 64  bn_post_conv         64x24x8
 65  post_conv_nonlin     64x24x8
 66  last_conv            2x24x8
 67  global_pool          2
 68  softmax              2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m0.44462[0m     [32m1.14650[0m    0.38781      0.67084  205.09s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.27074[0m     1.99551    0.13567      0.63703  205.35s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.18891[0m     2.00314    0.09431      0.63966  200.18s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.12407[0m     2.54776    0.04870      0.60270  203.59s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.09139[0m     1.54662    0.05909      0.68829  203.94s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.06100[0m     2.63044    0.02319      0.64222  207.61s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 1.146504 at epoch 1.
Loaded parameters to layer 'conv2d_1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d_1' (shape 64).
Loaded parameters to layer 'conv2d_2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d_2' (shape 64).
Loaded parameters to layer 'conv2d_3' (shape 64x64x3x3).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'conv2ddnn7' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv2' (shape 64).
Loaded parameters to layer 'res0__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn16' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv2' (shape 64).
Loaded parameters to layer 'res3__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn25' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv2' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn33' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv2' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn41' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv2' (shape 64).
Loaded parameters to layer 'res5__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn50' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv2' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn58' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv2' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'last_conv' (shape 2x64x3x3).
Loaded parameters to layer 'last_conv' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.881117810317
Error rate (%):  11.8882189683
[[46034   136]
 [ 6075     0]]
(52245,)
(52245,)
roc_auc: 0.572094897102
log_loss: 1.74062456295
roc_auc for the hours: 0.573684210526
log_loss for the hours: 1.28225673626
saving predictions to csv file
hourspatient2_11_wideResNet1_10-12-19-07-49.csv
Accuracy validation for the hours:  0.883720930233
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [11]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.34602752
saving predictions to csv file
patient2_11_wideResNet1_10-12-19-12-15.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config9.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_12']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config9.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_12'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-12 19:12:17.702464
Hostname: kat
gpu2
Configuration 'config9.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: wideResNet1
evaluation:
    online_training: False
    model: wideResNet1

end Configuration
['patient2_12']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [12]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.75567104
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 246.400856018 260.383670044
20 388.318774414 405.029217529
30 528.878991699 548.355413818
40 689.669812012 711.362548828
50 892.074920654 915.121887207
60 1170.23933105 1190.96369629
70 1584.49351807 1593.89857178
80 2252.05878906 2238.45820313
90 3510.49829102 3446.85510254
100 68512.453125 43195.7773438
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  wideResNet1
Model name for the evaluation phase:  wideResNet1
Training model...
# Neural Network with 606338 learnable parameters

## Layer information

  #  name                 size
---  -------------------  ---------
  0  input                1x192x64
  1  conv2d_1             64x192x64
  2  conv2d_2             64x192x64
  3  dropout1             64x192x64
  4  conv2d_3             64x96x32
  5  batch_norm1          64x96x32
  6  batch_norm1_nonlin   64x96x32
  7                       64x96x32
  8  res0__conv1          64x96x32
  9  res0__conv1_nonlin   64x96x32
 10  res0__dropout        64x96x32
 11  res0__conv2          64x96x32
 12  res0__projection     64x96x32
 13  res0__sum            64x96x32
 14  res3__bn             64x96x32
 15  res3__nonlin         64x96x32
 16                       64x48x16
 17  res3__conv1          64x48x16
 18  res3__conv1_nonlin   64x48x16
 19  res3__dropout        64x48x16
 20  res3__conv2          64x48x16
 21  res3__projection     64x48x16
 22  res3__sum            64x48x16
 23  res4_1_bn            64x48x16
 24  res4_1_nonlin        64x48x16
 25                       64x48x16
 26  res4_1_conv1         64x48x16
 27  res4_1_conv1_nonlin  64x48x16
 28  res4_1_dropout       64x48x16
 29  res4_1_conv2         64x48x16
 30  res4_1_sum           64x48x16
 31  res4_2_bn            64x48x16
 32  res4_2_nonlin        64x48x16
 33                       64x48x16
 34  res4_2_conv1         64x48x16
 35  res4_2_conv1_nonlin  64x48x16
 36  res4_2_dropout       64x48x16
 37  res4_2_conv2         64x48x16
 38  res4_2_sum           64x48x16
 39  res5__bn             64x48x16
 40  res5__nonlin         64x48x16
 41                       64x24x8
 42  res5__conv1          64x24x8
 43  res5__conv1_nonlin   64x24x8
 44  res5__dropout        64x24x8
 45  res5__conv2          64x24x8
 46  res5__projection     64x24x8
 47  res5__sum            64x24x8
 48  res6_1_bn            64x24x8
 49  res6_1_nonlin        64x24x8
 50                       64x24x8
 51  res6_1_conv1         64x24x8
 52  res6_1_conv1_nonlin  64x24x8
 53  res6_1_dropout       64x24x8
 54  res6_1_conv2         64x24x8
 55  res6_1_sum           64x24x8
 56  res6_2_bn            64x24x8
 57  res6_2_nonlin        64x24x8
 58                       64x24x8
 59  res6_2_conv1         64x24x8
 60  res6_2_conv1_nonlin  64x24x8
 61  res6_2_dropout       64x24x8
 62  res6_2_conv2         64x24x8
 63  res6_2_sum           64x24x8
 64  bn_post_conv         64x24x8
 65  post_conv_nonlin     64x24x8
 66  last_conv            2x24x8
 67  global_pool          2
 68  softmax              2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m0.44489[0m     [32m1.01999[0m    0.43617      0.60253  203.17s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.29284[0m     1.17456    0.24932      0.59781  203.61s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.19373[0m     1.58156    0.12249      0.63173  198.31s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.12963[0m     1.32249    0.09802      0.58713  202.33s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.09345[0m     1.50511    0.06209      0.58694  202.07s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.06604[0m     2.25023    0.02935      0.62643  202.66s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 1.019990 at epoch 1.
Loaded parameters to layer 'conv2d_1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d_1' (shape 64).
Loaded parameters to layer 'conv2d_2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d_2' (shape 64).
Loaded parameters to layer 'conv2d_3' (shape 64x64x3x3).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'conv2ddnn7' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv2' (shape 64).
Loaded parameters to layer 'res0__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn16' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv2' (shape 64).
Loaded parameters to layer 'res3__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn25' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv2' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn33' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv2' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn41' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv2' (shape 64).
Loaded parameters to layer 'res5__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn50' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv2' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn58' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv2' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'last_conv' (shape 2x64x3x3).
Loaded parameters to layer 'last_conv' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.878151019236
Error rate (%):  12.1848980764
[[44800  1370]
 [ 4996  1079]]
(52245,)
(52245,)
roc_auc: 0.633238657279
log_loss: 2.03740702265
roc_auc for the hours: 0.636842105263
log_loss for the hours: 1.41063383413
saving predictions to csv file
hourspatient2_12_wideResNet1_10-12-19-39-31.csv
Accuracy validation for the hours:  0.883720930233
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [12]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.348149248
saving predictions to csv file
patient2_12_wideResNet1_10-12-19-44-01.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config9.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_13']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config9.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_13'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-12 19:44:03.503470
Hostname: kat
gpu2
Configuration 'config9.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: wideResNet1
evaluation:
    online_training: False
    model: wideResNet1

end Configuration
['patient2_13']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [13]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.75841536
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 310.902963257 337.861572266
20 495.955010986 532.738879395
30 683.185546875 729.780834961
40 898.82401123 954.485388184
50 1167.24829102 1228.47143555
60 1520.5864502 1581.93601074
70 2018.97246094 2072.08920898
80 2789.6487793 2824.08540039
90 4233.0871582 4224.4074707
100 35079.8945312 31263.9492188
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  wideResNet1
Model name for the evaluation phase:  wideResNet1
Training model...
# Neural Network with 606338 learnable parameters

## Layer information

  #  name                 size
---  -------------------  ---------
  0  input                1x192x64
  1  conv2d_1             64x192x64
  2  conv2d_2             64x192x64
  3  dropout1             64x192x64
  4  conv2d_3             64x96x32
  5  batch_norm1          64x96x32
  6  batch_norm1_nonlin   64x96x32
  7                       64x96x32
  8  res0__conv1          64x96x32
  9  res0__conv1_nonlin   64x96x32
 10  res0__dropout        64x96x32
 11  res0__conv2          64x96x32
 12  res0__projection     64x96x32
 13  res0__sum            64x96x32
 14  res3__bn             64x96x32
 15  res3__nonlin         64x96x32
 16                       64x48x16
 17  res3__conv1          64x48x16
 18  res3__conv1_nonlin   64x48x16
 19  res3__dropout        64x48x16
 20  res3__conv2          64x48x16
 21  res3__projection     64x48x16
 22  res3__sum            64x48x16
 23  res4_1_bn            64x48x16
 24  res4_1_nonlin        64x48x16
 25                       64x48x16
 26  res4_1_conv1         64x48x16
 27  res4_1_conv1_nonlin  64x48x16
 28  res4_1_dropout       64x48x16
 29  res4_1_conv2         64x48x16
 30  res4_1_sum           64x48x16
 31  res4_2_bn            64x48x16
 32  res4_2_nonlin        64x48x16
 33                       64x48x16
 34  res4_2_conv1         64x48x16
 35  res4_2_conv1_nonlin  64x48x16
 36  res4_2_dropout       64x48x16
 37  res4_2_conv2         64x48x16
 38  res4_2_sum           64x48x16
 39  res5__bn             64x48x16
 40  res5__nonlin         64x48x16
 41                       64x24x8
 42  res5__conv1          64x24x8
 43  res5__conv1_nonlin   64x24x8
 44  res5__dropout        64x24x8
 45  res5__conv2          64x24x8
 46  res5__projection     64x24x8
 47  res5__sum            64x24x8
 48  res6_1_bn            64x24x8
 49  res6_1_nonlin        64x24x8
 50                       64x24x8
 51  res6_1_conv1         64x24x8
 52  res6_1_conv1_nonlin  64x24x8
 53  res6_1_dropout       64x24x8
 54  res6_1_conv2         64x24x8
 55  res6_1_sum           64x24x8
 56  res6_2_bn            64x24x8
 57  res6_2_nonlin        64x24x8
 58                       64x24x8
 59  res6_2_conv1         64x24x8
 60  res6_2_conv1_nonlin  64x24x8
 61  res6_2_dropout       64x24x8
 62  res6_2_conv2         64x24x8
 63  res6_2_sum           64x24x8
 64  bn_post_conv         64x24x8
 65  post_conv_nonlin     64x24x8
 66  last_conv            2x24x8
 67  global_pool          2
 68  softmax              2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m0.48553[0m     [32m1.61315[0m    0.30098      0.63492  196.69s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.37692[0m     1.75199    0.21514      0.68091  196.09s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.23851[0m     2.24630    0.10618      0.66148  201.76s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.14132[0m     2.30423    0.06133      0.65312  202.36s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.08794[0m     2.91190    0.03020      0.61318  202.66s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.06701[0m     3.69801    0.01812      0.57691  201.92s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 1.613155 at epoch 1.
Loaded parameters to layer 'conv2d_1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d_1' (shape 64).
Loaded parameters to layer 'conv2d_2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d_2' (shape 64).
Loaded parameters to layer 'conv2d_3' (shape 64x64x3x3).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'conv2ddnn7' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv2' (shape 64).
Loaded parameters to layer 'res0__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn16' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv2' (shape 64).
Loaded parameters to layer 'res3__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn25' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv2' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn33' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv2' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn41' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv2' (shape 64).
Loaded parameters to layer 'res5__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn50' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv2' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn58' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv2' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'last_conv' (shape 2x64x3x3).
Loaded parameters to layer 'last_conv' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.694363096947
Error rate (%):  30.5636903053
[[32583 13587]
 [ 2381  3694]]
(52245,)
(52245,)
roc_auc: 0.642349369079
log_loss: nan
roc_auc for the hours: 0.663157894737
log_loss for the hours: inf
saving predictions to csv file
hourspatient2_13_wideResNet1_10-12-20-11-00.csv
Accuracy validation for the hours:  0.697674418605
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [13]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.35018496
saving predictions to csv file
patient2_13_wideResNet1_10-12-20-15-21.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config9.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_14']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config9.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_14'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-12 20:15:23.342996
Hostname: kat
gpu2
Configuration 'config9.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: wideResNet1
evaluation:
    online_training: False
    model: wideResNet1

end Configuration
['patient2_14']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [14]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.75536384
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 266.172717285 282.912625122
20 417.956640625 438.4277771
30 566.452648926 591.266082764
40 733.547790527 761.89486084
50 939.345672607 969.588409424
60 1211.49157715 1239.79914551
70 1602.63823242 1619.38890381
80 2236.86499023 2222.94345703
90 3516.40424805 3422.74516602
100 38412.0351562 39300.5585938
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  wideResNet1
Model name for the evaluation phase:  wideResNet1
Training model...
# Neural Network with 606338 learnable parameters

## Layer information

  #  name                 size
---  -------------------  ---------
  0  input                1x192x64
  1  conv2d_1             64x192x64
  2  conv2d_2             64x192x64
  3  dropout1             64x192x64
  4  conv2d_3             64x96x32
  5  batch_norm1          64x96x32
  6  batch_norm1_nonlin   64x96x32
  7                       64x96x32
  8  res0__conv1          64x96x32
  9  res0__conv1_nonlin   64x96x32
 10  res0__dropout        64x96x32
 11  res0__conv2          64x96x32
 12  res0__projection     64x96x32
 13  res0__sum            64x96x32
 14  res3__bn             64x96x32
 15  res3__nonlin         64x96x32
 16                       64x48x16
 17  res3__conv1          64x48x16
 18  res3__conv1_nonlin   64x48x16
 19  res3__dropout        64x48x16
 20  res3__conv2          64x48x16
 21  res3__projection     64x48x16
 22  res3__sum            64x48x16
 23  res4_1_bn            64x48x16
 24  res4_1_nonlin        64x48x16
 25                       64x48x16
 26  res4_1_conv1         64x48x16
 27  res4_1_conv1_nonlin  64x48x16
 28  res4_1_dropout       64x48x16
 29  res4_1_conv2         64x48x16
 30  res4_1_sum           64x48x16
 31  res4_2_bn            64x48x16
 32  res4_2_nonlin        64x48x16
 33                       64x48x16
 34  res4_2_conv1         64x48x16
 35  res4_2_conv1_nonlin  64x48x16
 36  res4_2_dropout       64x48x16
 37  res4_2_conv2         64x48x16
 38  res4_2_sum           64x48x16
 39  res5__bn             64x48x16
 40  res5__nonlin         64x48x16
 41                       64x24x8
 42  res5__conv1          64x24x8
 43  res5__conv1_nonlin   64x24x8
 44  res5__dropout        64x24x8
 45  res5__conv2          64x24x8
 46  res5__projection     64x24x8
 47  res5__sum            64x24x8
 48  res6_1_bn            64x24x8
 49  res6_1_nonlin        64x24x8
 50                       64x24x8
 51  res6_1_conv1         64x24x8
 52  res6_1_conv1_nonlin  64x24x8
 53  res6_1_dropout       64x24x8
 54  res6_1_conv2         64x24x8
 55  res6_1_sum           64x24x8
 56  res6_2_bn            64x24x8
 57  res6_2_nonlin        64x24x8
 58                       64x24x8
 59  res6_2_conv1         64x24x8
 60  res6_2_conv1_nonlin  64x24x8
 61  res6_2_dropout       64x24x8
 62  res6_2_conv2         64x24x8
 63  res6_2_sum           64x24x8
 64  bn_post_conv         64x24x8
 65  post_conv_nonlin     64x24x8
 66  last_conv            2x24x8
 67  global_pool          2
 68  softmax              2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m0.52733[0m     [32m1.45043[0m    0.36357      0.57489  194.66s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.42041[0m     2.29267    0.18337      0.57110  199.53s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.22284[0m     2.82742    0.07881      0.53125  201.56s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.10622[0m     3.71324    0.02860      0.50454  201.63s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.06463[0m     5.15226    0.01254      0.55078  202.22s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.04138[0m     5.51297    0.00751      0.52729  200.69s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 1.450430 at epoch 1.
Loaded parameters to layer 'conv2d_1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d_1' (shape 64).
Loaded parameters to layer 'conv2d_2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d_2' (shape 64).
Loaded parameters to layer 'conv2d_3' (shape 64x64x3x3).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'conv2ddnn7' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv2' (shape 64).
Loaded parameters to layer 'res0__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn16' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv2' (shape 64).
Loaded parameters to layer 'res3__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn25' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv2' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn33' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv2' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn41' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv2' (shape 64).
Loaded parameters to layer 'res5__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn50' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv2' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn58' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv2' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'last_conv' (shape 2x64x3x3).
Loaded parameters to layer 'last_conv' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.88374007082
Error rate (%):  11.625992918
[[46170     0]
 [ 6074     1]]
(52245,)
(52245,)
roc_auc: 0.660133043832
log_loss: 2.66885971858
roc_auc for the hours: 0.565789473684
log_loss for the hours: 2.50148444741
saving predictions to csv file
hourspatient2_14_wideResNet1_10-12-20-42-25.csv
Accuracy validation for the hours:  0.883720930233
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [14]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.347948544
saving predictions to csv file
patient2_14_wideResNet1_10-12-20-46-43.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config9.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_15']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config9.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_15'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-12 20:46:45.950147
Hostname: kat
gpu2
Configuration 'config9.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: wideResNet1
evaluation:
    online_training: False
    model: wideResNet1

end Configuration
['patient2_15']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [15]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.757059584
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 207.538546753 227.35309906
20 331.033721924 357.463000488
30 457.867379761 491.204870605
40 608.373034668 648.207519531
50 801.816497803 847.310424805
60 1065.05288086 1112.36008301
70 1442.92700195 1484.37923584
80 2028.23110352 2052.16914063
90 3108.79804688 3089.25849609
100 28167.1855469 26524.03125
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  wideResNet1
Model name for the evaluation phase:  wideResNet1
Training model...
# Neural Network with 606338 learnable parameters

## Layer information

  #  name                 size
---  -------------------  ---------
  0  input                1x192x64
  1  conv2d_1             64x192x64
  2  conv2d_2             64x192x64
  3  dropout1             64x192x64
  4  conv2d_3             64x96x32
  5  batch_norm1          64x96x32
  6  batch_norm1_nonlin   64x96x32
  7                       64x96x32
  8  res0__conv1          64x96x32
  9  res0__conv1_nonlin   64x96x32
 10  res0__dropout        64x96x32
 11  res0__conv2          64x96x32
 12  res0__projection     64x96x32
 13  res0__sum            64x96x32
 14  res3__bn             64x96x32
 15  res3__nonlin         64x96x32
 16                       64x48x16
 17  res3__conv1          64x48x16
 18  res3__conv1_nonlin   64x48x16
 19  res3__dropout        64x48x16
 20  res3__conv2          64x48x16
 21  res3__projection     64x48x16
 22  res3__sum            64x48x16
 23  res4_1_bn            64x48x16
 24  res4_1_nonlin        64x48x16
 25                       64x48x16
 26  res4_1_conv1         64x48x16
 27  res4_1_conv1_nonlin  64x48x16
 28  res4_1_dropout       64x48x16
 29  res4_1_conv2         64x48x16
 30  res4_1_sum           64x48x16
 31  res4_2_bn            64x48x16
 32  res4_2_nonlin        64x48x16
 33                       64x48x16
 34  res4_2_conv1         64x48x16
 35  res4_2_conv1_nonlin  64x48x16
 36  res4_2_dropout       64x48x16
 37  res4_2_conv2         64x48x16
 38  res4_2_sum           64x48x16
 39  res5__bn             64x48x16
 40  res5__nonlin         64x48x16
 41                       64x24x8
 42  res5__conv1          64x24x8
 43  res5__conv1_nonlin   64x24x8
 44  res5__dropout        64x24x8
 45  res5__conv2          64x24x8
 46  res5__projection     64x24x8
 47  res5__sum            64x24x8
 48  res6_1_bn            64x24x8
 49  res6_1_nonlin        64x24x8
 50                       64x24x8
 51  res6_1_conv1         64x24x8
 52  res6_1_conv1_nonlin  64x24x8
 53  res6_1_dropout       64x24x8
 54  res6_1_conv2         64x24x8
 55  res6_1_sum           64x24x8
 56  res6_2_bn            64x24x8
 57  res6_2_nonlin        64x24x8
 58                       64x24x8
 59  res6_2_conv1         64x24x8
 60  res6_2_conv1_nonlin  64x24x8
 61  res6_2_dropout       64x24x8
 62  res6_2_conv2         64x24x8
 63  res6_2_sum           64x24x8
 64  bn_post_conv         64x24x8
 65  post_conv_nonlin     64x24x8
 66  last_conv            2x24x8
 67  global_pool          2
 68  softmax              2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m0.48751[0m     [32m1.48854[0m    0.32751      0.62457  194.51s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.27795[0m     2.16603    0.12832      0.65649  196.53s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.13410[0m     1.52665    0.08784      0.62638  196.73s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.08081[0m     2.03856    0.03964      0.61703  196.48s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.05553[0m     2.58531    0.02148      0.62093  194.00s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.04063[0m     2.50876    0.01620      0.62674  193.33s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 1.488537 at epoch 1.
Loaded parameters to layer 'conv2d_1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d_1' (shape 64).
Loaded parameters to layer 'conv2d_2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d_2' (shape 64).
Loaded parameters to layer 'conv2d_3' (shape 64x64x3x3).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'batch_norm1' (shape 64).
Loaded parameters to layer 'conv2ddnn7' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv1' (shape 64).
Loaded parameters to layer 'res0__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res0__conv2' (shape 64).
Loaded parameters to layer 'res0__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'res3__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn16' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv1' (shape 64).
Loaded parameters to layer 'res3__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res3__conv2' (shape 64).
Loaded parameters to layer 'res3__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'res4_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn25' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv1' (shape 64).
Loaded parameters to layer 'res4_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_1_conv2' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'res4_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn33' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv1' (shape 64).
Loaded parameters to layer 'res4_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res4_2_conv2' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'res5__bn' (shape 64).
Loaded parameters to layer 'conv2ddnn41' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv1' (shape 64).
Loaded parameters to layer 'res5__conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res5__conv2' (shape 64).
Loaded parameters to layer 'res5__projection' (shape 64x64x1x1).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'res6_1_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn50' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv1' (shape 64).
Loaded parameters to layer 'res6_1_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_1_conv2' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'res6_2_bn' (shape 64).
Loaded parameters to layer 'conv2ddnn58' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv1' (shape 64).
Loaded parameters to layer 'res6_2_conv2' (shape 64x64x3x3).
Loaded parameters to layer 'res6_2_conv2' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'bn_post_conv' (shape 64).
Loaded parameters to layer 'last_conv' (shape 2x64x3x3).
Loaded parameters to layer 'last_conv' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.883854914346
Error rate (%):  11.6145085654
[[46170     0]
 [ 6068     7]]
(52245,)
(52245,)
roc_auc: 0.548424229298
log_loss: 3.36676608419
roc_auc for the hours: 0.589473684211
log_loss for the hours: 2.86937001833
saving predictions to csv file
hourspatient2_15_wideResNet1_10-12-21-13-04.csv
Accuracy validation for the hours:  0.883720930233
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [15]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.348530176
saving predictions to csv file
patient2_15_wideResNet1_10-12-21-17-19.csv
