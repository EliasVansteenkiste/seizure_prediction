['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run1.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--channels=0']
Command line arguments: Namespace(channels=[0], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run1.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-09-25 00:20:34.648850
Hostname: kat
gpu0
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 512
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net0
evaluation:
    online_training: False
    model: net0

end Configuration
Loading and preprocessing data...
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_3/3_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.720068608
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 370.383615112 382.042739868
20 585.952758789 603.113830566
30 798.876318359 815.979187012
40 1037.00437012 1049.37390137
50 1324.60302734 1323.22802734
60 1695.00808105 1667.13757324
70 2212.20117188 2132.72290039
80 3034.4668457 2848.29077148
90 4751.07553711 4309.59814453
100 63321.7421875 54863.8242188
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net0
Model name for the evaluation phase:  net0
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x512x64
  1          64x512x64
  2          64x512x64
  3          64x256x32
  4          64x256x32
  5          64x256x32
  6          64x256x32
  7          64x128x16
  8          64x128x16
  9          64x128x16
 10          2x128x16
 11          2
 12          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m2.32102[0m     [32m0.68640[0m    3.38142      0.71663  209.48s
      2     [36m0.52914[0m     0.76577    0.69099      0.66357  385.19s
      3     [36m0.50313[0m     0.81304    0.61883      0.63216  376.22s
      4     [36m0.49226[0m     0.95956    0.51301      0.63135  384.47s
      5     [36m0.47289[0m     0.97254    0.48625      0.76188  364.88s
      6     [36m0.43914[0m     1.23463    0.35568      0.54069  392.55s
Early stopping.
Best valid loss was 0.686404 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d6' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d6' (shape 64).
Loaded parameters to layer 'conv2d9' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d9' (shape 64).
Loaded parameters to layer 'conv2d10' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d10' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[1 1 0 0 0 1 0 0 1 1 1 0 0 0 1 0 1 0 0 0 1 0 1 0 0 0 0 0 0 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.704296875
Error rate (%):  29.5703125
yVal [0 0 1 ..., 0 1 1]
[[3311  509]
 [1762 2098]]
0.758049873857
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run1.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--channels=1']
Command line arguments: Namespace(channels=[1], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run1.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-09-25 01:34:07.672003
Hostname: kat
gpu0
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 512
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net0
evaluation:
    online_training: False
    model: net0

end Configuration
Loading and preprocessing data...
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_3/3_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.716603392
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 265.569192505 275.922683716
20 418.741949463 432.515045166
30 570.463165283 582.129150391
40 741.529833984 745.226196289
50 952.19519043 940.145874023
60 1236.58071289 1194.78979492
70 1663.88118896 1561.48345947
80 2413.32441406 2174.828125
90 4212.56235352 3563.96838379
100 56617.8046875 55581.1640625
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net0
Model name for the evaluation phase:  net0
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x512x64
  1          64x512x64
  2          64x512x64
  3          64x256x32
  4          64x256x32
  5          64x256x32
  6          64x256x32
  7          64x128x16
  8          64x128x16
  9          64x128x16
 10          2x128x16
 11          2
 12          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m1.93212[0m     [32m1.08091[0m    1.78750      0.50065  313.69s
      2     [36m0.52944[0m     [32m0.99206[0m    0.53368      0.48942  189.84s
      3     [36m0.50015[0m     1.10259    0.45361      0.50049  191.32s
      4     [36m0.48680[0m     [32m0.99124[0m    0.49111      0.50602  191.62s
      5     [36m0.46405[0m     [32m0.84651[0m    0.54819      0.51514  191.81s
      6     [36m0.41769[0m     1.16016    0.36003      0.55290  191.67s
      7     [36m0.37268[0m     1.37021    0.27199      0.48584  241.67s
      8     [36m0.36199[0m     1.29265    0.28004      0.44661  417.63s
      9     [36m0.26700[0m     2.19337    0.12173      0.54102  421.32s
     10     [36m0.18884[0m     2.41339    0.07825      0.50570  394.28s
Early stopping.
Best valid loss was 0.846511 at epoch 5.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d6' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d6' (shape 64).
Loaded parameters to layer 'conv2d9' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d9' (shape 64).
Loaded parameters to layer 'conv2d10' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d10' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[0 1 0 0 0 0 0 0 0 1 1 1 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.507161458333
Error rate (%):  49.2838541667
yVal [0 0 1 ..., 0 1 1]
[[3516  304]
 [3481  379]]
0.689503668991
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run1.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--channels=2']
Command line arguments: Namespace(channels=[2], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run1.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-09-25 02:59:03.001796
Hostname: kat
gpu0
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 512
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net0
evaluation:
    online_training: False
    model: net0

end Configuration
Loading and preprocessing data...
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_3/3_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.6697984
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 211.564569092 218.920532227
20 330.673291016 339.741790771
30 446.107928467 453.246795654
40 572.932189941 574.249145508
50 725.553161621 715.946166992
60 926.149853516 896.588439941
70 1218.91170654 1154.75012207
80 1712.55070801 1579.12597656
90 2791.07785645 2495.08483887
100 58473.7617188 75930.625
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net0
Model name for the evaluation phase:  net0
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x512x64
  1          64x512x64
  2          64x512x64
  3          64x256x32
  4          64x256x32
  5          64x256x32
  6          64x256x32
  7          64x128x16
  8          64x128x16
  9          64x128x16
 10          2x128x16
 11          2
 12          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m1.57572[0m     [32m0.86298[0m    1.82590      0.67253  192.04s
      2     [36m0.50382[0m     1.17985    0.42702      0.50130  190.95s
      3     [36m0.47297[0m     1.45323    0.32546      0.54036  191.99s
      4     [36m0.45065[0m     1.72673    0.26098      0.59440  191.34s
      5     [36m0.42988[0m     2.00857    0.21402      0.57275  191.04s
      6     [36m0.38726[0m     3.04204    0.12730      0.59391  191.64s
Early stopping.
Best valid loss was 0.862980 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d6' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d6' (shape 64).
Loaded parameters to layer 'conv2d9' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d9' (shape 64).
Loaded parameters to layer 'conv2d10' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d10' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[1 1 0 0 0 0 1 0 1 1 1 0 0 0 1 0 1 0 0 0 1 0 0 0 0 0 0 1 0 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.659895833333
Error rate (%):  34.0104166667
yVal [0 0 1 ..., 0 1 1]
[[3142  678]
 [1934 1926]]
0.621746127553
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run1.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--channels=3']
Command line arguments: Namespace(channels=[3], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run1.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-09-25 03:41:48.279960
Hostname: kat
gpu0
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 512
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net0
evaluation:
    online_training: False
    model: net0

end Configuration
Loading and preprocessing data...
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_3/3_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.706097152
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 234.08664093 239.721954346
20 364.584063721 371.962585449
30 490.508004761 496.504821777
40 630.362109375 631.961303711
50 803.842010498 795.534606934
60 1044.95795898 1019.23065186
70 1429.24927979 1370.09783936
80 2121.47871094 1998.69506836
90 3590.03435059 3337.28955078
100 147926.25 114985.820312
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net0
Model name for the evaluation phase:  net0
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x512x64
  1          64x512x64
  2          64x512x64
  3          64x256x32
  4          64x256x32
  5          64x256x32
  6          64x256x32
  7          64x128x16
  8          64x128x16
  9          64x128x16
 10          2x128x16
 11          2
 12          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m1.68796[0m     [32m0.98220[0m    1.71854      0.50065  229.60s
      2     [36m0.50095[0m     1.37202    0.36512      0.60400  230.07s
      3     [36m0.45325[0m     1.49133    0.30393      0.56982  229.82s
      4     [36m0.42831[0m     1.55732    0.27503      0.59749  245.80s
      5     [36m0.40496[0m     1.62933    0.24854      0.55436  280.17s
      6     [36m0.34923[0m     1.92596    0.18133      0.67822  192.60s
Early stopping.
Best valid loss was 0.982202 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d6' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d6' (shape 64).
Loaded parameters to layer 'conv2d9' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d9' (shape 64).
Loaded parameters to layer 'conv2d10' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d10' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.497395833333
Error rate (%):  50.2604166667
yVal [0 0 1 ..., 0 1 1]
[[3820    0]
 [3860    0]]
0.579634389496
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run1.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--channels=4']
Command line arguments: Namespace(channels=[4], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run1.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-09-25 04:24:46.544306
Hostname: kat
gpu0
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 512
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net0
evaluation:
    online_training: False
    model: net0

end Configuration
Loading and preprocessing data...
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_3/3_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.71514112
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 166.741564941 169.260734558
20 261.176831055 264.865814209
30 354.425119019 357.479827881
40 461.596020508 461.342407227
50 599.61050415 592.545623779
60 798.440466309 775.908874512
70 1114.19197998 1058.04302979
80 1661.69353027 1535.50854492
90 2826.51435547 2533.14819336
100 44210.6640625 39898.75
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net0
Model name for the evaluation phase:  net0
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x512x64
  1          64x512x64
  2          64x512x64
  3          64x256x32
  4          64x256x32
  5          64x256x32
  6          64x256x32
  7          64x128x16
  8          64x128x16
  9          64x128x16
 10          2x128x16
 11          2
 12          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m1.43707[0m     [32m0.81825[0m    1.75628      0.76335  241.97s
      2     [36m0.49017[0m     [32m0.71341[0m    0.68709      0.71126  279.43s
      3     [36m0.46584[0m     0.77200    0.60342      0.75146  250.65s
      4     [36m0.45306[0m     [32m0.71024[0m    0.63789      0.73763  244.65s
      5     [36m0.42397[0m     [32m0.70150[0m    0.60437      0.74495  258.39s
      6     [36m0.37044[0m     0.83639    0.44290      0.74740  266.22s
      7     [36m0.27793[0m     1.11839    0.24851      0.74642  224.88s
      8     [36m0.18498[0m     1.35310    0.13671      0.69808  190.66s
      9     [36m0.12134[0m     1.19382    0.10164      0.59880  214.50s
     10     0.18852     1.95263    0.09654      0.58952  221.30s
Early stopping.
Best valid loss was 0.701504 at epoch 5.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d6' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d6' (shape 64).
Loaded parameters to layer 'conv2d9' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d9' (shape 64).
Loaded parameters to layer 'conv2d10' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d10' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[1 0 0 0 0 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 0 0 0 0 0 1 0 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.742317708333
Error rate (%):  25.7682291667
yVal [0 0 1 ..., 0 1 1]
[[3392  428]
 [1551 2309]]
0.771504014866
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run1.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--channels=5']
Command line arguments: Namespace(channels=[5], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run1.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-09-25 05:24:56.364162
Hostname: kat
gpu0
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 512
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net0
evaluation:
    online_training: False
    model: net0

end Configuration
Loading and preprocessing data...
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_3/3_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.674668544
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 186.851734924 190.438827515
20 296.48951416 301.152984619
30 409.39744873 412.204345703
40 545.394494629 542.710998535
50 730.416595459 715.384063721
60 1010.47353516 968.890319824
70 1466.35765381 1367.28033447
80 2271.5902832 2048.15332031
90 4106.57885742 3558.15698242
100 67580.4921875 68869.3984375
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net0
Model name for the evaluation phase:  net0
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x512x64
  1          64x512x64
  2          64x512x64
  3          64x256x32
  4          64x256x32
  5          64x256x32
  6          64x256x32
  7          64x128x16
  8          64x128x16
  9          64x128x16
 10          2x128x16
 11          2
 12          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m1.73991[0m     [32m0.83390[0m    2.08648      0.58561  215.54s
      2     [36m0.52841[0m     [32m0.81895[0m    0.64522      0.56868  194.87s
      3     [36m0.48592[0m     0.90710    0.53569      0.56006  215.58s
      4     [36m0.43138[0m     1.10913    0.38893      0.59570  222.66s
      5     [36m0.34998[0m     0.90128    0.38831      0.67383  213.37s
      6     [36m0.31108[0m     1.49186    0.20852      0.58057  239.97s
      7     [36m0.27907[0m     1.91248    0.14592      0.64665  244.06s
Early stopping.
Best valid loss was 0.818949 at epoch 2.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d6' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d6' (shape 64).
Loaded parameters to layer 'conv2d9' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d9' (shape 64).
Loaded parameters to layer 'conv2d10' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d10' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 0 0 0 0 1 1 0 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.562630208333
Error rate (%):  43.7369791667
yVal [0 0 1 ..., 0 1 1]
[[3311  509]
 [2850 1010]]
0.646104223747
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run1.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--channels=6']
Command line arguments: Namespace(channels=[6], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run1.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-09-25 06:13:56.873091
Hostname: kat
gpu0
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 512
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net0
evaluation:
    online_training: False
    model: net0

end Configuration
Loading and preprocessing data...
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_3/3_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.71440384
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 164.47532959 169.942024231
20 259.860992432 268.591369629
30 357.403549194 366.823059082
40 473.373016357 480.896636963
50 629.507781982 631.192077637
60 865.92487793 853.120605469
70 1261.51429443 1216.43780518
80 1970.32902832 1859.09008789
90 3448.32658691 3177.92431641
100 47858.3515625 52179.953125
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net0
Model name for the evaluation phase:  net0
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x512x64
  1          64x512x64
  2          64x512x64
  3          64x256x32
  4          64x256x32
  5          64x256x32
  6          64x256x32
  7          64x128x16
  8          64x128x16
  9          64x128x16
 10          2x128x16
 11          2
 12          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m1.57347[0m     [32m0.75613[0m    2.08097      0.64404  243.78s
      2     [36m0.52122[0m     0.80325    0.64889      0.74382  205.04s
      3     [36m0.47433[0m     1.00661    0.47121      0.65511  193.86s
      4     [36m0.44142[0m     1.19074    0.37071      0.67057  192.03s
      5     [36m0.38579[0m     1.24646    0.30951      0.78092  288.35s
      6     [36m0.33645[0m     1.68010    0.20026      0.71566  260.82s
Early stopping.
Best valid loss was 0.756127 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d6' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d6' (shape 64).
Loaded parameters to layer 'conv2d9' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d9' (shape 64).
Loaded parameters to layer 'conv2d10' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d10' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[1 0 0 0 0 1 0 0 1 0 0 0 0 0 0 0 1 0 0 0 0 1 0 0 0 0 0 1 1 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.634505208333
Error rate (%):  36.5494791667
yVal [0 0 1 ..., 0 1 1]
[[3505  315]
 [2492 1368]]
0.738450783984
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run1.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--channels=7']
Command line arguments: Namespace(channels=[7], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run1.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-09-25 06:59:56.908711
Hostname: kat
gpu0
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 512
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net0
evaluation:
    online_training: False
    model: net0

end Configuration
Loading and preprocessing data...
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_3/3_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.664436736
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 178.786965942 193.060745239
20 287.408544922 309.894989014
30 401.81534729 431.074569702
40 541.658898926 576.180419922
50 727.914031982 766.537658691
60 991.201574707 1031.5402832
70 1382.93083496 1416.6105957
80 2000.69443359 2018.96716309
90 3129.06638184 3105.98327637
100 66354.203125 92128.8515625
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net0
Model name for the evaluation phase:  net0
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x512x64
  1          64x512x64
  2          64x512x64
  3          64x256x32
  4          64x256x32
  5          64x256x32
  6          64x256x32
  7          64x128x16
  8          64x128x16
  9          64x128x16
 10          2x128x16
 11          2
 12          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m1.86322[0m     [32m0.72841[0m    2.55793      0.71191  190.94s
      2     [36m0.49769[0m     1.04136    0.47792      0.56445  194.87s
      3     [36m0.45042[0m     1.44936    0.31077      0.53906  192.41s
      4     [36m0.42362[0m     1.53525    0.27593      0.58317  194.10s
      5     [36m0.40785[0m     1.38761    0.29392      0.57194  237.76s
      6     [36m0.34072[0m     1.50611    0.22622      0.56755  211.77s
Early stopping.
Best valid loss was 0.728409 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d6' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d6' (shape 64).
Loaded parameters to layer 'conv2d9' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d9' (shape 64).
Loaded parameters to layer 'conv2d10' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d10' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[1 1 0 0 0 1 1 0 1 1 1 0 0 0 1 0 1 0 0 0 1 1 1 0 1 0 0 1 0 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.708072916667
Error rate (%):  29.1927083333
yVal [0 0 1 ..., 0 1 1]
[[2721 1099]
 [1143 2717]]
0.671548334373
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run1.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--channels=8']
Command line arguments: Namespace(channels=[8], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run1.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-09-25 07:41:02.639139
Hostname: kat
gpu0
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 512
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net0
evaluation:
    online_training: False
    model: net0

end Configuration
Loading and preprocessing data...
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_3/3_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.658571264
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 306.942971802 320.542236328
20 486.768151855 508.520324707
30 668.526159668 694.702026367
40 878.795983887 904.719787598
50 1142.65332031 1162.67785645
60 1494.46323242 1501.35644531
70 1994.49293213 1974.20349121
80 2770.04125977 2703.4284668
90 4225.57075195 4081.31066895
100 105201.65625 71258.6328125
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net0
Model name for the evaluation phase:  net0
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x512x64
  1          64x512x64
  2          64x512x64
  3          64x256x32
  4          64x256x32
  5          64x256x32
  6          64x256x32
  7          64x128x16
  8          64x128x16
  9          64x128x16
 10          2x128x16
 11          2
 12          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m2.61905[0m     [32m0.78550[0m    3.33423      0.56738  195.17s
      2     [36m0.49809[0m     1.12976    0.44088      0.62077  192.08s
      3     [36m0.44244[0m     1.33583    0.33121      0.47526  192.28s
      4     [36m0.42615[0m     1.63035    0.26138      0.48438  191.44s
      5     [36m0.40446[0m     1.67303    0.24175      0.64388  191.74s
      6     [36m0.38581[0m     1.85475    0.20801      0.51156  191.79s
Early stopping.
Best valid loss was 0.785504 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d6' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d6' (shape 64).
Loaded parameters to layer 'conv2d9' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d9' (shape 64).
Loaded parameters to layer 'conv2d10' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d10' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 0 0 0 0 0 1 0 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.564322916667
Error rate (%):  43.5677083333
yVal [0 0 1 ..., 0 1 1]
[[3584  236]
 [3110  750]]
0.627833260993
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run1.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--channels=9']
Command line arguments: Namespace(channels=[9], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run1.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-09-25 08:19:40.383710
Hostname: kat
gpu0
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 512
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net0
evaluation:
    online_training: False
    model: net0

end Configuration
Loading and preprocessing data...
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_3/3_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.719458304
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 285.502749634 296.192626953
20 450.084130859 467.958953857
30 614.532775879 635.983337402
40 803.39387207 825.053771973
50 1040.5769043 1057.9163208
60 1362.47683105 1366.25817871
70 1832.86739502 1809.89105225
80 2600.76484375 2522.00878906
90 4211.33994141 4013.83605957
100 48435.8945312 81443.234375
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net0
Model name for the evaluation phase:  net0
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x512x64
  1          64x512x64
  2          64x512x64
  3          64x256x32
  4          64x256x32
  5          64x256x32
  6          64x256x32
  7          64x128x16
  8          64x128x16
  9          64x128x16
 10          2x128x16
 11          2
 12          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m2.04825[0m     [32m0.98095[0m    2.08803      0.50065  190.16s
      2     [36m0.55400[0m     [32m0.92568[0m    0.59848      0.66097  188.30s
      3     [36m0.47634[0m     1.22368    0.38927      0.65690  185.65s
      4     [36m0.41011[0m     1.52500    0.26893      0.65072  185.69s
      5     [36m0.34439[0m     1.77822    0.19367      0.65413  185.12s
      6     [36m0.33311[0m     2.09489    0.15901      0.64925  185.68s
      7     [36m0.25068[0m     2.03838    0.12298      0.67562  185.04s
Early stopping.
Best valid loss was 0.925681 at epoch 2.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d6' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d6' (shape 64).
Loaded parameters to layer 'conv2d9' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d9' (shape 64).
Loaded parameters to layer 'conv2d10' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d10' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.658723958333
Error rate (%):  34.1276041667
yVal [0 0 1 ..., 0 1 1]
[[3689  131]
 [2490 1370]]
0.616817777989
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run1.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--channels=10']
Command line arguments: Namespace(channels=[10], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run1.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-09-25 09:00:34.534981
Hostname: kat
gpu0
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 512
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net0
evaluation:
    online_training: False
    model: net0

end Configuration
Loading and preprocessing data...
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_3/3_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.658726912
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 236.922592163 251.930305481
20 374.708331299 398.486328125
30 513.062701416 542.605255127
40 672.122216797 702.880554199
50 870.568389893 898.108978271
60 1134.3536377 1151.20678711
70 1508.80095215 1504.14630127
80 2091.72822266 2048.65869141
90 3209.14863281 3084.92993164
100 33467.8828125 31567.0722656
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net0
Model name for the evaluation phase:  net0
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x512x64
  1          64x512x64
  2          64x512x64
  3          64x256x32
  4          64x256x32
  5          64x256x32
  6          64x256x32
  7          64x128x16
  8          64x128x16
  9          64x128x16
 10          2x128x16
 11          2
 12          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m2.11697[0m     [32m0.69154[0m    3.06125      0.61458  194.13s
      2     [36m0.53563[0m     0.78379    0.68339      0.67790  192.02s
      3     [36m0.50548[0m     0.90501    0.55853      0.66504  191.24s
      4     [36m0.49287[0m     1.14347    0.43103      0.66130  191.89s
      5     [36m0.47255[0m     1.55261    0.30436      0.45280  191.88s
      6     [36m0.43069[0m     2.18379    0.19722      0.49186  191.51s
Early stopping.
Best valid loss was 0.691538 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d6' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d6' (shape 64).
Loaded parameters to layer 'conv2d9' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d9' (shape 64).
Loaded parameters to layer 'conv2d10' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d10' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 0 0 1 1 0 1 1 0 0 0 0 1 1 1 1 0 0 1 1 1 0 1 0 1 1 1 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.615625
Error rate (%):  38.4375
yVal [0 0 1 ..., 0 1 1]
[[1652 2168]
 [ 784 3076]]
0.671476921303
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run1.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--channels=11']
Command line arguments: Namespace(channels=[11], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run1.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-09-25 09:39:00.740080
Hostname: kat
gpu0
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 512
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net0
evaluation:
    online_training: False
    model: net0

end Configuration
Loading and preprocessing data...
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_3/3_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.718585856
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 186.644313049 201.672454834
20 301.005688477 324.787322998
30 422.356951904 452.098190308
40 569.603845215 603.014648438
50 763.689239502 798.601593018
60 1034.57580566 1064.75915527
70 1430.09019775 1450.37493896
80 2050.14526367 2051.67700195
90 3226.79782715 3207.58679199
100 56520.15625 104914.585938
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net0
Model name for the evaluation phase:  net0
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x512x64
  1          64x512x64
  2          64x512x64
  3          64x256x32
  4          64x256x32
  5          64x256x32
  6          64x256x32
  7          64x128x16
  8          64x128x16
  9          64x128x16
 10          2x128x16
 11          2
 12          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m1.97830[0m     [32m0.65566[0m    3.01725      0.79574  190.95s
      2     [36m0.50202[0m     0.75953    0.66096      0.78353  192.13s
      3     [36m0.45450[0m     1.17281    0.38753      0.54199  191.92s
      4     [36m0.38426[0m     2.34216    0.16406      0.47982  192.42s
      5     [36m0.34477[0m     2.71806    0.12684      0.62174  192.66s
      6     [36m0.28139[0m     3.35417    0.08389      0.57536  192.45s
Early stopping.
Best valid loss was 0.655662 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d6' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d6' (shape 64).
Loaded parameters to layer 'conv2d9' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d9' (shape 64).
Loaded parameters to layer 'conv2d10' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d10' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[1 1 0 0 0 1 1 0 1 1 1 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 1 1 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.792447916667
Error rate (%):  20.7552083333
yVal [0 0 1 ..., 0 1 1]
[[3014  806]
 [ 788 3072]]
roc_auc: 0.732673819277
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run1.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--channels=12']
Command line arguments: Namespace(channels=[12], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run1.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-09-25 10:17:28.815394
Hostname: kat
gpu0
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 512
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net0
evaluation:
    online_training: False
    model: net0

end Configuration
Loading and preprocessing data...
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_3/3_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.65787904
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 248.17615509 252.292892456
20 390.046142578 397.643157959
30 530.814239502 540.408538818
40 692.21217041 701.233337402
50 895.86038208 900.681671143
60 1176.14956055 1169.04772949
70 1593.55310059 1562.03234863
80 2265.55048828 2189.94775391
90 3531.49135742 3371.82397461
100 68512.453125 61788.859375
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net0
Model name for the evaluation phase:  net0
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x512x64
  1          64x512x64
  2          64x512x64
  3          64x256x32
  4          64x256x32
  5          64x256x32
  6          64x256x32
  7          64x128x16
  8          64x128x16
  9          64x128x16
 10          2x128x16
 11          2
 12          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m1.86253[0m     [32m0.85139[0m    2.18763      0.60352  195.60s
      2     [36m0.53737[0m     1.10909    0.48452      0.50049  192.39s
      3     [36m0.48978[0m     1.41644    0.34579      0.49967  191.25s
      4     [36m0.44875[0m     1.57766    0.28444      0.60498  196.65s
      5     [36m0.40502[0m     1.57322    0.25745      0.61410  198.82s
      6     [36m0.35366[0m     2.24138    0.15779      0.60205  181.76s
Early stopping.
Best valid loss was 0.851390 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d6' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d6' (shape 64).
Loaded parameters to layer 'conv2d9' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d9' (shape 64).
Loaded parameters to layer 'conv2d10' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d10' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.592838541667
Error rate (%):  40.7161458333
yVal [0 0 1 ..., 0 1 1]
[[3803   17]
 [3110  750]]
roc_auc: 0.668971597537
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run1.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--channels=13']
Command line arguments: Namespace(channels=[13], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run1.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-09-25 10:56:01.013232
Hostname: kat
gpu0
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 512
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net0
evaluation:
    online_training: False
    model: net0

end Configuration
Loading and preprocessing data...
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_3/3_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.717811712
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 313.265170288 326.406982422
20 498.231085205 521.788146973
30 685.862628174 717.073608398
40 902.230651855 938.709350586
50 1171.92333984 1206.95782471
60 1527.57519531 1552.16845703
70 2029.24715576 2029.27972412
80 2804.71967773 2764.22265625
90 4254.45888672 4141.17211914
100 35079.8945312 31263.9492188
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net0
Model name for the evaluation phase:  net0
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x512x64
  1          64x512x64
  2          64x512x64
  3          64x256x32
  4          64x256x32
  5          64x256x32
  6          64x256x32
  7          64x128x16
  8          64x128x16
  9          64x128x16
 10          2x128x16
 11          2
 12          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m2.57912[0m     [32m0.72540[0m    3.55543      0.54118  193.33s
      2     [36m0.51824[0m     0.91242    0.56798      0.51969  191.22s
      3     [36m0.46224[0m     1.06591    0.43366      0.52327  192.07s
      4     [36m0.43790[0m     1.29501    0.33814      0.54769  192.43s
      5     [36m0.41785[0m     1.29812    0.32188      0.57194  191.76s
      6     [36m0.38309[0m     1.62900    0.23517      0.54460  190.80s
Early stopping.
Best valid loss was 0.725403 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d6' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d6' (shape 64).
Loaded parameters to layer 'conv2d9' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d9' (shape 64).
Loaded parameters to layer 'conv2d10' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d10' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 1 0 1 1 0 0 0 0 1 1 1 1 0 0 0 0 0 0 0 0 0 1 0 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.545833333333
Error rate (%):  45.4166666667
yVal [0 0 1 ..., 0 1 1]
[[2622 1198]
 [2290 1570]]
roc_auc: 0.591850737867
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run1.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--channels=14']
Command line arguments: Namespace(channels=[14], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run1.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-09-25 11:41:25.466709
Hostname: kat
gpu0
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 512
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net0
evaluation:
    online_training: False
    model: net0

end Configuration
Loading and preprocessing data...
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_3/3_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.65814528
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 268.114727783 273.846969604
20 419.789349365 430.405151367
30 568.496173096 582.308776855
40 736.171875 750.966308594
50 942.937286377 954.910858154
60 1216.87109375 1218.35766602
70 1611.33862305 1587.65899658
80 2251.2371582 2171.8034668
90 3539.77995605 3341.80603027
100 38412.0351562 39300.5585938
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net0
Model name for the evaluation phase:  net0
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x512x64
  1          64x512x64
  2          64x512x64
  3          64x256x32
  4          64x256x32
  5          64x256x32
  6          64x256x32
  7          64x128x16
  8          64x128x16
  9          64x128x16
 10          2x128x16
 11          2
 12          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m1.82052[0m     [32m0.98105[0m    1.85569      0.58268  196.95s
      2     [36m0.53059[0m     1.20702    0.43958      0.57454  202.31s
      3     [36m0.49250[0m     1.75614    0.28044      0.51595  212.81s
      4     [36m0.47015[0m     2.14428    0.21926      0.56478  207.81s
      5     [36m0.44197[0m     2.22828    0.19835      0.57992  213.12s
      6     [36m0.39279[0m     2.66911    0.14716      0.54460  235.06s
Early stopping.
Best valid loss was 0.981045 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d6' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d6' (shape 64).
Loaded parameters to layer 'conv2d9' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d9' (shape 64).
Loaded parameters to layer 'conv2d10' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d10' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.588671875
Error rate (%):  41.1328125
yVal [0 0 1 ..., 0 1 1]
[[3706  114]
 [3045  815]]
roc_auc: 0.584960732984
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run1.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--channels=15']
Command line arguments: Namespace(channels=[15], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run1.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-09-25 12:22:07.093039
Hostname: kat
gpu0
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 512
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net0
evaluation:
    online_training: False
    model: net0

end Configuration
Loading and preprocessing data...
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_3/3_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.717422592
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 209.032162476 220.332107544
20 332.380444336 351.279418945
30 459.308435059 484.765441895
40 610.22890625 640.295166016
50 804.460357666 836.352508545
60 1069.28730469 1096.11523438
70 1449.42525635 1460.753479
80 2038.72851562 2017.47363281
90 3126.08322754 3036.31750488
100 28167.1855469 26524.03125
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net0
Model name for the evaluation phase:  net0
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x512x64
  1          64x512x64
  2          64x512x64
  3          64x256x32
  4          64x256x32
  5          64x256x32
  6          64x256x32
  7          64x128x16
  8          64x128x16
  9          64x128x16
 10          2x128x16
 11          2
 12          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m1.91872[0m     [32m0.72065[0m    2.66249      0.68783  190.07s
      2     [36m0.51338[0m     0.78747    0.65194      0.72021  189.23s
      3     [36m0.48237[0m     0.90935    0.53045      0.72607  187.76s
      4     [36m0.46997[0m     1.10505    0.42530      0.73177  188.90s
      5     [36m0.44501[0m     1.09359    0.40693      0.73258  187.78s
      6     [36m0.40421[0m     1.18146    0.34212      0.71810  186.84s
Early stopping.
Best valid loss was 0.720647 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d6' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d6' (shape 64).
Loaded parameters to layer 'conv2d9' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d9' (shape 64).
Loaded parameters to layer 'conv2d10' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d10' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[1 0 0 0 0 1 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 0 0 0 0 0 1 0 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.681380208333
Error rate (%):  31.8619791667
yVal [0 0 1 ..., 0 1 1]
[[2935  885]
 [1562 2298]]
roc_auc: 0.670461675664
