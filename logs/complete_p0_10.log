['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config1.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_0']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config1.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_0'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-04 15:07:54.546718
Hostname: kat
gpu0
Configuration 'config1.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net17
evaluation:
    online_training: False
    model: net17

end Configuration
['patient0_0']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [0]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.747208704
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 77.4825836182 42.2078788757
20 305.512463379 300.472479248
30 461.135577393 459.25463562
40 614.021606445 614.238354492
50 784.364746094 787.311828613
60 993.193286133 998.551342773
70 1272.31512451 1279.6506958
80 1694.84467773 1704.01054688
90 2529.98266602 2551.26169434
100 45472.875 51963.8164062
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net17
Model name for the evaluation phase:  net17
Training model...
# Neural Network with 3937026 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          64x96x32
  4          64x96x32
  5          128x48x16
  6          128x48x16
  7          256x24x8
  8          256x24x8
  9          512x12x4
 10          512x12x4
 11          512x6x4
 12          2x6x4
 13          2
 14          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -----
      1    [36m11.56100[0m     [32m0.87649[0m   13.19007      0.47647  8.28s
      2     [36m0.68683[0m     0.99602    0.68957      0.47386  8.29s
      3     [36m0.65371[0m     [32m0.86791[0m    0.75319      0.46732  8.38s
      4     [36m0.63853[0m     0.90707    0.70395      0.46928  8.14s
      5     [36m0.62419[0m     [32m0.81594[0m    0.76499      0.46863  8.29s
      6     0.62902     0.92705    0.67852      0.47712  8.31s
      7     [36m0.62033[0m     [32m0.74148[0m    0.83661      0.49869  8.31s
      8     0.62493     0.79313    0.78793      0.48366  8.24s
      9     [36m0.61414[0m     [32m0.70498[0m    0.87114      0.51046  8.31s
     10     0.62240     0.80927    0.76909      0.46993  8.35s
     11     [36m0.61385[0m     0.77419    0.79289      0.46471  8.35s
     12     0.61797     0.74503    0.82946      0.50719  8.43s
     13     0.61502     0.72993    0.84257      0.50000  8.40s
     14     [36m0.59279[0m     0.71578    0.82817      0.50915  8.77s
     15     0.59753     0.77015    0.77586      0.48170  8.58s
     16     0.60673     [32m0.67997[0m    0.89228      0.56732  8.69s
     17     0.59998     0.74922    0.80081      0.49869  8.57s
     18     [36m0.59010[0m     0.73851    0.79904      0.49608  8.63s
     19     0.59435     0.70261    0.84591      0.50327  8.70s
     20     [36m0.58574[0m     0.70956    0.82550      0.49935  8.71s
     21     [36m0.57004[0m     0.70602    0.80740      0.48431  8.74s
     22     0.58289     0.73373    0.79442      0.54248  8.52s
     23     [36m0.56945[0m     0.71533    0.79607      0.49020  8.77s
     24     0.57398     0.72912    0.78722      0.47451  8.67s
     25     [36m0.56114[0m     0.76658    0.73200      0.48497  8.73s
     26     0.57359     0.77528    0.73985      0.49542  8.68s
Early stopping.
Best valid loss was 0.679971 at epoch 16.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d3' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d3' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 128).
Loaded parameters to layer 'conv2d7' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d7' (shape 256).
Loaded parameters to layer 'conv2d9' (shape 512x256x3x3).
Loaded parameters to layer 'conv2d9' (shape 512).
Loaded parameters to layer 'conv2d11' (shape 512x512x3x3).
Loaded parameters to layer 'conv2d11' (shape 512).
Loaded parameters to layer 'conv2d12' (shape 2x512x3x3).
Loaded parameters to layer 'conv2d12' (shape 2).
Saving model...
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config1.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_1']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config1.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_1'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-04 15:14:06.919565
Hostname: kat
gpu0
Configuration 'config1.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net17
evaluation:
    online_training: False
    model: net17

end Configuration
['patient0_1']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [1]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.745938944
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 79.8583602905 43.7949028015
20 305.763250732 299.520977783
30 453.40585022 450.005862427
40 592.349865723 590.177758789
50 740.968597412 740.054229736
60 918.324951172 917.797363281
70 1161.24418945 1163.53183594
80 1578.52695313 1588.20612793
90 2613.2675293 2653.38178711
100 212492.21875 103666.890625
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net17
Model name for the evaluation phase:  net17
Training model...
# Neural Network with 3937026 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          64x96x32
  4          64x96x32
  5          128x48x16
  6          128x48x16
  7          256x24x8
  8          256x24x8
  9          512x12x4
 10          512x12x4
 11          512x6x4
 12          2x6x4
 13          2
 14          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -----
      1    [36m12.10826[0m     [32m0.68526[0m   17.66966      0.57386  8.64s
      2     [36m0.67782[0m     [32m0.66410[0m    1.02065      0.62418  8.82s
      3     [36m0.63449[0m     0.68993    0.91964      0.56078  8.52s
      4     [36m0.62726[0m     0.75706    0.82855      0.46797  8.41s
      5     [36m0.61462[0m     0.76833    0.79994      0.47059  8.20s
      6     0.62158     0.76223    0.81548      0.48105  8.31s
      7     0.61635     0.71592    0.86093      0.51046  8.44s
      8     0.61489     0.74807    0.82196      0.48105  8.42s
      9     [36m0.60006[0m     0.76272    0.78673      0.46993  8.59s
     10     0.61478     0.75561    0.81361      0.46863  8.66s
     11     [36m0.59781[0m     0.80388    0.74366      0.46340  8.46s
     12     0.60293     0.82862    0.72764      0.46275  8.53s
Early stopping.
Best valid loss was 0.664104 at epoch 2.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d3' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d3' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 128).
Loaded parameters to layer 'conv2d7' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d7' (shape 256).
Loaded parameters to layer 'conv2d9' (shape 512x256x3x3).
Loaded parameters to layer 'conv2d9' (shape 512).
Loaded parameters to layer 'conv2d11' (shape 512x512x3x3).
Loaded parameters to layer 'conv2d11' (shape 512).
Loaded parameters to layer 'conv2d12' (shape 2x512x3x3).
Loaded parameters to layer 'conv2d12' (shape 2).
Saving model...
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config1.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_2']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config1.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_2'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-04 15:18:16.259276
Hostname: kat
gpu0
Configuration 'config1.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net17
evaluation:
    online_training: False
    model: net17

end Configuration
['patient0_2']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [2]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
