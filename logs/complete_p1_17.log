['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config7.yml', '--no-channels=1', '--target-gpu=gpu1', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_0']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config7.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_0'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu1')
Git reference:  Timestamp: 2016-10-12 01:52:33.291922
Hostname: kat
gpu1
Configuration 'config7.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net17
evaluation:
    online_training: False
    model: net17

end Configuration
['patient1_0']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [0]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.813645824
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 199.036781311 184.038919067
20 483.221002197 465.519171143
30 718.880554199 694.377087402
40 969.482617188 933.868884277
50 1265.8637085 1213.74743652
60 1644.84228516 1568.92561035
70 2171.59033203 2061.92285156
80 2997.35341797 2842.94628906
90 4640.41015625 4440.24106445
100 101397.328125 96893.890625
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net17
Model name for the evaluation phase:  net17
Training model...
# Neural Network with 3937026 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          64x96x32
  4          64x96x32
  5          128x48x16
  6          128x48x16
  7          256x24x8
  8          256x24x8
  9          512x12x4
 10          512x12x4
 11          512x6x4
 12          2x6x4
 13          2
 14          2

BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1    [36m32.31892[0m     [32m1.69520[0m   19.06492      0.43917  17.29s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      2     [36m0.72996[0m     2.66162    0.27426      0.47016  17.45s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      3     [36m0.72186[0m     [32m1.01351[0m    0.71224      0.38768  17.55s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      4     [36m0.67811[0m     1.82604    0.37136      0.45484  17.87s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      5     [36m0.66390[0m     2.36939    0.28020      0.47841  17.85s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      6     0.67243     2.29073    0.29355      0.47871  17.84s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      7     [36m0.66218[0m     2.55287    0.25939      0.48295  18.05s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      8     [36m0.66123[0m     3.07046    0.21535      0.48292  18.23s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      9     [36m0.63490[0m     2.29115    0.27711      0.47658  18.24s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     10     0.65083     1.56950    0.41468      0.45059  18.20s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     11     0.64801     2.19726    0.29492      0.47926  18.04s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     12     0.64885     3.11350    0.20840      0.47872  17.99s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     13     0.64004     1.98125    0.32305      0.45804  18.03s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
Early stopping.
Best valid loss was 1.013512 at epoch 3.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d3' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d3' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 128).
Loaded parameters to layer 'conv2d7' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d7' (shape 256).
Loaded parameters to layer 'conv2d9' (shape 512x256x3x3).
Loaded parameters to layer 'conv2d9' (shape 512).
Loaded parameters to layer 'conv2d11' (shape 512x512x3x3).
Loaded parameters to layer 'conv2d11' (shape 512).
Loaded parameters to layer 'conv2d12' (shape 2x512x3x3).
Loaded parameters to layer 'conv2d12' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.688920544476
Error rate (%):  31.1079455524
[[65080 23615]
 [ 5866   209]]
(94770,)
(94770,)
roc_auc: 0.398006418166
log_loss: inf
roc_auc for the hours: 0.33698630137
log_loss for the hours: 0.810837295125
saving predictions to csv file
hourspatient1_0_net17_10-12-02-01-11.csv
Accuracy validation for the hours:  0.717948717949
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [0]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.145450496
saving predictions to csv file
patient1_0_net17_10-12-02-04-23.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config7.yml', '--no-channels=1', '--target-gpu=gpu1', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_1']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config7.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_1'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu1')
Git reference:  Timestamp: 2016-10-12 02:04:24.548500
Hostname: kat
gpu1
Configuration 'config7.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net17
evaluation:
    online_training: False
    model: net17

end Configuration
['patient1_1']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [1]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.813244416
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 203.761627197 188.411010742
20 496.77197876 482.61751709
30 732.597296143 714.697686768
40 973.972167969 949.532727051
50 1245.81005859 1212.85552979
60 1576.76357422 1532.16108398
70 2013.54516602 1951.80438232
80 2668.75805664 2577.9690918
90 3942.10078125 3797.89812012
100 71591.0625 60304.03125
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net17
Model name for the evaluation phase:  net17
Training model...
# Neural Network with 3937026 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          64x96x32
  4          64x96x32
  5          128x48x16
  6          128x48x16
  7          256x24x8
  8          256x24x8
  9          512x12x4
 10          512x12x4
 11          512x6x4
 12          2x6x4
 13          2
 14          2

BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1    [36m29.19240[0m     [32m0.70180[0m   41.59621      0.46021  17.25s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      2     [36m0.73599[0m     1.02605    0.71730      0.48454  17.38s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      3     [36m0.70654[0m     0.70346    1.00437      0.46677  17.44s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      4     [36m0.69925[0m     0.83717    0.83526      0.47722  17.31s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      5     [36m0.68842[0m     0.82290    0.83658      0.47221  17.57s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      6     0.69669     0.79119    0.88056      0.46732  17.67s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      7     [36m0.67513[0m     0.80624    0.83738      0.46618  17.67s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      8     [36m0.66658[0m     0.89553    0.74433      0.47072  17.86s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      9     0.67092     [32m0.66734[0m    1.00536      0.58137  17.82s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     10     0.66785     0.67441    0.99026      0.59098  17.78s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     11     [36m0.65922[0m     0.68738    0.95904      0.53890  17.80s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     12     [36m0.64197[0m     0.68819    0.93284      0.56113  17.99s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     13     [36m0.63067[0m     0.74316    0.84863      0.50162  17.87s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     14     0.64287     1.04751    0.61371      0.48041  17.84s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     15     0.64969     [32m0.65613[0m    0.99019      0.61605  17.90s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     16     0.63269     0.66314    0.95409      0.60108  17.92s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     17     [36m0.62948[0m     0.65917    0.95495      0.60926  17.93s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     18     [36m0.62597[0m     0.69143    0.90533      0.61374  18.07s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     19     [36m0.62582[0m     0.72108    0.86789      0.61171  17.98s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     20     [36m0.61747[0m     0.65883    0.93722      0.59175  18.04s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     21     [36m0.61319[0m     0.68720    0.89230      0.53827  18.11s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     22     0.61706     [32m0.65510[0m    0.94194      0.61043  18.04s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     23     [36m0.61122[0m     [32m0.64807[0m    0.94313      0.62412  17.93s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     24     [36m0.60530[0m     0.68224    0.88723      0.52857  17.83s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     25     [36m0.59889[0m     [32m0.63574[0m    0.94203      0.61524  17.97s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     26     0.59988     0.65552    0.91512      0.62345  17.94s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     27     [36m0.59492[0m     0.65652    0.90617      0.60608  18.03s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     28     [36m0.58985[0m     0.65631    0.89874      0.58295  17.94s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     29     [36m0.58155[0m     0.65293    0.89067      0.60217  17.94s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     30     [36m0.57737[0m     0.65811    0.87731      0.59470  17.85s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     31     [36m0.57728[0m     0.67358    0.85704      0.56945  17.54s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     32     [36m0.57714[0m     0.66067    0.87357      0.60782  17.46s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     33     [36m0.56795[0m     0.69446    0.81783      0.54148  17.51s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     34     [36m0.56752[0m     0.67059    0.84630      0.59079  17.44s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     35     [36m0.56498[0m     0.67126    0.84167      0.57960  17.44s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
Early stopping.
Best valid loss was 0.635742 at epoch 25.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d3' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d3' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 128).
Loaded parameters to layer 'conv2d7' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d7' (shape 256).
Loaded parameters to layer 'conv2d9' (shape 512x256x3x3).
Loaded parameters to layer 'conv2d9' (shape 512).
Loaded parameters to layer 'conv2d11' (shape 512x512x3x3).
Loaded parameters to layer 'conv2d11' (shape 512).
Loaded parameters to layer 'conv2d12' (shape 2x512x3x3).
Loaded parameters to layer 'conv2d12' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 0 0 1 1 1 0 0 0 1 0 0 0 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.509707713411
Error rate (%):  49.0292286589
[[44170 44525]
 [ 1940  4135]]
(94770,)
(94770,)
roc_auc: 0.604859455242
log_loss: 2.01119020997
roc_auc for the hours: 0.627397260274
log_loss for the hours: 1.10636690081
saving predictions to csv file
hourspatient1_1_net17_10-12-02-19-31.csv
Accuracy validation for the hours:  0.5
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [1]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.139986432
saving predictions to csv file
patient1_1_net17_10-12-02-22-37.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config7.yml', '--no-channels=1', '--target-gpu=gpu1', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_2']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config7.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_2'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu1')
Git reference:  Timestamp: 2016-10-12 02:22:38.922809
Hostname: kat
gpu1
Configuration 'config7.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net17
evaluation:
    online_training: False
    model: net17

end Configuration
['patient1_2']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [2]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.81338368
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 210.389639282 196.646928406
20 506.963934326 496.903918457
30 739.698999023 728.238903809
40 971.565100098 956.919091797
50 1226.64501953 1206.60388184
60 1529.57705078 1501.93178711
70 1919.78259277 1881.66341553
80 2487.38320313 2434.10976563
90 3554.0130127 3481.28129883
100 119907.929688 146484.890625
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net17
Model name for the evaluation phase:  net17
Training model...
# Neural Network with 3937026 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          64x96x32
  4          64x96x32
  5          128x48x16
  6          128x48x16
  7          256x24x8
  8          256x24x8
  9          512x12x4
 10          512x12x4
 11          512x6x4
 12          2x6x4
 13          2
 14          2

BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1    [36m28.55200[0m     [32m0.96673[0m   29.53448      0.45670  17.69s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      2     [36m0.74738[0m     1.18633    0.62999      0.48101  17.90s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      3     [36m0.70655[0m     [32m0.78162[0m    0.90396      0.52704  17.83s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      4     [36m0.70421[0m     0.96991    0.72605      0.53896  17.76s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      5     [36m0.68645[0m     1.45766    0.47092      0.48165  17.88s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      6     [36m0.68496[0m     0.98068    0.69846      0.46244  17.68s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      7     [36m0.67007[0m     [32m0.77717[0m    0.86219      0.45590  17.92s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      8     [36m0.64919[0m     0.88340    0.73488      0.45960  17.88s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      9     0.65378     [32m0.71182[0m    0.91846      0.45735  17.81s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     10     [36m0.64811[0m     0.86906    0.74576      0.57532  18.07s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     11     [36m0.63227[0m     [32m0.67774[0m    0.93291      0.61805  17.88s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     12     [36m0.62606[0m     0.68603    0.91257      0.51477  17.99s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     13     0.63031     0.72416    0.87040      0.62155  18.02s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     14     [36m0.62126[0m     [32m0.66108[0m    0.93977      0.62731  17.94s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     15     [36m0.61724[0m     [32m0.65960[0m    0.93578      0.60927  17.92s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     16     [36m0.61425[0m     0.66264    0.92696      0.57886  17.59s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     17     0.61711     [32m0.65940[0m    0.93587      0.63823  17.61s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     18     [36m0.60334[0m     [32m0.65839[0m    0.91638      0.62970  17.58s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     19     [36m0.60152[0m     0.65931    0.91235      0.63060  17.59s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     20     [36m0.58953[0m     0.67199    0.87728      0.63654  17.55s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     21     0.59029     0.66922    0.88206      0.50933  17.52s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     22     0.59469     0.65898    0.90244      0.62945  17.67s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     23     0.59007     0.69093    0.85402      0.52434  17.53s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     24     [36m0.58152[0m     0.67402    0.86276      0.55646  17.45s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     25     0.58261     0.70830    0.82255      0.48473  17.50s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     26     [36m0.57221[0m     0.69178    0.82715      0.56699  17.69s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     27     0.57232     0.67698    0.84541      0.56870  17.63s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     28     [36m0.56563[0m     0.67516    0.83776      0.55264  17.62s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
Early stopping.
Best valid loss was 0.658395 at epoch 18.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d3' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d3' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 128).
Loaded parameters to layer 'conv2d7' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d7' (shape 256).
Loaded parameters to layer 'conv2d9' (shape 512x256x3x3).
Loaded parameters to layer 'conv2d9' (shape 512).
Loaded parameters to layer 'conv2d11' (shape 512x512x3x3).
Loaded parameters to layer 'conv2d11' (shape 512).
Loaded parameters to layer 'conv2d12' (shape 2x512x3x3).
Loaded parameters to layer 'conv2d12' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 0 0 0 1 0 0 0 1 0 0 0 0 0 0 0 1 0 0 0 1 0 0 1 1 0 0 0 1 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.397731349583
Error rate (%):  60.2268650417
[[32371 56324]
 [  753  5322]]
(94770,)
(94770,)
roc_auc: 0.581198749031
log_loss: inf
roc_auc for the hours: 0.578082191781
log_loss for the hours: 1.91634287857
saving predictions to csv file
hourspatient1_2_net17_10-12-02-35-42.csv
Accuracy validation for the hours:  0.346153846154
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [2]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.080590336
saving predictions to csv file
patient1_2_net17_10-12-02-38-50.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config7.yml', '--no-channels=1', '--target-gpu=gpu1', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_3']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config7.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_3'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu1')
Git reference:  Timestamp: 2016-10-12 02:38:51.649984
Hostname: kat
gpu1
Configuration 'config7.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net17
evaluation:
    online_training: False
    model: net17

end Configuration
['patient1_3']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [3]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.81289216
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 19.1249866486 16.0321680069
20 110.960594177 117.977423096
30 462.367929077 465.247445679
40 726.516931152 722.714147949
50 983.638244629 972.796356201
60 1269.06445312 1248.00100098
70 1619.77319336 1586.1126709
80 2106.37036133 2054.18427734
90 2963.09577637 2880.79763184
100 141686.875 89649.6484375
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net17
Model name for the evaluation phase:  net17
Training model...
# Neural Network with 3937026 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          64x96x32
  4          64x96x32
  5          128x48x16
  6          128x48x16
  7          256x24x8
  8          256x24x8
  9          512x12x4
 10          512x12x4
 11          512x6x4
 12          2x6x4
 13          2
 14          2

BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1    [36m15.88976[0m     [32m0.84613[0m   18.77937      0.41435  17.52s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      2     [36m0.75491[0m     1.63097    0.46286      0.42892  17.46s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      3     [36m0.69824[0m     0.85664    0.81509      0.41297  17.58s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      4     [36m0.66930[0m     [32m0.81320[0m    0.82305      0.41224  17.78s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      5     [36m0.64202[0m     [32m0.79559[0m    0.80698      0.44010  17.83s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      6     [36m0.62679[0m     [32m0.79461[0m    0.78880      0.49390  18.09s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      7     [36m0.62343[0m     [32m0.76171[0m    0.81846      0.56981  18.00s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      8     [36m0.62050[0m     0.86850    0.71445      0.59192  17.87s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      9     [36m0.60919[0m     [32m0.74616[0m    0.81644      0.57893  18.22s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     10     [36m0.59912[0m     0.80082    0.74813      0.57991  18.48s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     11     [36m0.58222[0m     0.78270    0.74386      0.58959  18.68s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     12     [36m0.57404[0m     0.82146    0.69881      0.58905  18.41s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     13     [36m0.57007[0m     0.83985    0.67877      0.58717  18.18s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     14     [36m0.56056[0m     0.89427    0.62684      0.58651  18.33s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     15     0.57130     0.85355    0.66932      0.55667  18.56s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     16     0.57097     0.91505    0.62399      0.58320  18.31s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     17     [36m0.55832[0m     0.90575    0.61641      0.57298  18.45s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     18     [36m0.55130[0m     0.82476    0.66844      0.55910  18.53s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     19     [36m0.52778[0m     1.07291    0.49191      0.55046  18.46s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
Early stopping.
Best valid loss was 0.746159 at epoch 9.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d3' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d3' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 128).
Loaded parameters to layer 'conv2d7' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d7' (shape 256).
Loaded parameters to layer 'conv2d9' (shape 512x256x3x3).
Loaded parameters to layer 'conv2d9' (shape 512).
Loaded parameters to layer 'conv2d11' (shape 512x512x3x3).
Loaded parameters to layer 'conv2d11' (shape 512).
Loaded parameters to layer 'conv2d12' (shape 2x512x3x3).
Loaded parameters to layer 'conv2d12' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.653350216313
Error rate (%):  34.6649783687
[[59056 29639]
 [ 3213  2862]]
(94770,)
(94770,)
roc_auc: 0.574509572152
log_loss: inf
roc_auc for the hours: 0.58904109589
log_loss for the hours: 0.681690360553
saving predictions to csv file
hourspatient1_3_net17_10-12-02-49-22.csv
Accuracy validation for the hours:  0.705128205128
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [3]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.144803328
saving predictions to csv file
patient1_3_net17_10-12-02-52-29.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config7.yml', '--no-channels=1', '--target-gpu=gpu1', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_4']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config7.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_4'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu1')
Git reference:  Timestamp: 2016-10-12 02:52:30.724690
Hostname: kat
gpu1
Configuration 'config7.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net17
evaluation:
    online_training: False
    model: net17

end Configuration
['patient1_4']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [4]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.812834816
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 235.407817078 219.809516907
20 571.790344238 556.848303223
30 840.501837158 821.775939941
40 1116.47878418 1091.31035156
50 1434.89074707 1400.26373291
60 1840.24331055 1790.55202637
70 2408.61494141 2333.43139648
80 3297.89345703 3176.70976563
90 4956.27602539 4739.19238281
100 52009.53125 38008.9335938
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net17
Model name for the evaluation phase:  net17
Training model...
# Neural Network with 3937026 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          64x96x32
  4          64x96x32
  5          128x48x16
  6          128x48x16
  7          256x24x8
  8          256x24x8
  9          512x12x4
 10          512x12x4
 11          512x6x4
 12          2x6x4
 13          2
 14          2

BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1    [36m30.48332[0m     [32m1.15351[0m   26.42657      0.50094  17.63s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      2     [36m0.84852[0m     [32m0.74001[0m    1.14663      0.53880  17.69s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      3     [36m0.78460[0m     1.42964    0.54881      0.49987  17.70s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      4     [36m0.77362[0m     1.38388    0.55902      0.50121  18.61s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      5     [36m0.76338[0m     0.91041    0.83850      0.50783  18.53s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      6     [36m0.71022[0m     0.80492    0.88235      0.54001  18.68s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      7     0.72779     0.77023    0.94490      0.54085  18.68s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      8     0.72278     0.83038    0.87041      0.52413  18.59s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      9     [36m0.70862[0m     0.85475    0.82904      0.52478  18.68s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     10     0.70954     0.82313    0.86201      0.52943  18.37s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     11     0.71144     1.00986    0.70449      0.49797  18.29s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     12     0.73074     0.81104    0.90099      0.51233  18.63s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     13     [36m0.69164[0m     [32m0.73833[0m    0.93675      0.55198  18.75s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     14     [36m0.69049[0m     0.82126    0.84076      0.51931  18.68s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     15     0.69520     0.85926    0.80907      0.50488  18.40s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     16     0.70138     [32m0.68299[0m    1.02692      0.56775  18.06s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     17     [36m0.68948[0m     0.70614    0.97640      0.54942  18.15s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     18     [36m0.68480[0m     0.69037    0.99193      0.56235  18.09s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     19     0.68588     0.69913    0.98105      0.55262  18.01s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     20     [36m0.68386[0m     0.70334    0.97230      0.54452  18.15s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     21     [36m0.67234[0m     0.70777    0.94994      0.55369  18.07s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     22     [36m0.66938[0m     0.70741    0.94624      0.56072  18.25s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     23     0.67125     0.68619    0.97823      0.56084  18.21s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     24     [36m0.66710[0m     0.76322    0.87405      0.52044  18.30s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     25     [36m0.66011[0m     0.71104    0.92838      0.48581  18.14s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     26     [36m0.65422[0m     0.71093    0.92023      0.48730  18.35s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
Early stopping.
Best valid loss was 0.682995 at epoch 16.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d3' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d3' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 128).
Loaded parameters to layer 'conv2d7' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d7' (shape 256).
Loaded parameters to layer 'conv2d9' (shape 512x256x3x3).
Loaded parameters to layer 'conv2d9' (shape 512).
Loaded parameters to layer 'conv2d11' (shape 512x512x3x3).
Loaded parameters to layer 'conv2d11' (shape 512).
Loaded parameters to layer 'conv2d12' (shape 2x512x3x3).
Loaded parameters to layer 'conv2d12' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 0 1 0 1 1 1 1 1 1 1 0 1 1 1 1 1 0 1 0 1 1 1 1 1 1 1 0 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.408684182758
Error rate (%):  59.1315817242
[[34900 53795]
 [ 2244  3831]]
(94770,)
(94770,)
roc_auc: 0.507810149778
log_loss: 1.2547992234
roc_auc for the hours: 0.490410958904
log_loss for the hours: 0.976389869806
saving predictions to csv file
hourspatient1_4_net17_10-12-03-05-16.csv
Accuracy validation for the hours:  0.397435897436
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [4]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.147117568
saving predictions to csv file
patient1_4_net17_10-12-03-08-28.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config7.yml', '--no-channels=1', '--target-gpu=gpu1', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_5']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config7.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_5'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu1')
Git reference:  Timestamp: 2016-10-12 03:08:29.552575
Hostname: kat
gpu1
Configuration 'config7.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net17
evaluation:
    online_training: False
    model: net17

end Configuration
['patient1_5']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [5]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.812961792
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 231.335012817 211.108001709
20 564.578271484 538.999780273
30 830.936474609 795.66987915
40 1104.11230469 1055.32932129
50 1420.78125 1352.56451416
60 1826.70258789 1730.86726074
70 2401.11716309 2262.68579102
80 3287.26503906 3085.56469727
90 4899.46132813 4571.94418945
100 55591.203125 52662.2460938
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net17
Model name for the evaluation phase:  net17
Training model...
# Neural Network with 3937026 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          64x96x32
  4          64x96x32
  5          128x48x16
  6          128x48x16
  7          256x24x8
  8          256x24x8
  9          512x12x4
 10          512x12x4
 11          512x6x4
 12          2x6x4
 13          2
 14          2

BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1    [36m33.92754[0m     [32m0.95913[0m   35.37313      0.47181  17.57s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      2     [36m0.76859[0m     1.62592    0.47271      0.48426  17.68s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      3     [36m0.74716[0m     1.37174    0.54468      0.50148  17.83s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      4     0.77765     1.66428    0.46726      0.50202  18.46s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      5     [36m0.74258[0m     [32m0.74079[0m    1.00242      0.53724  18.65s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      6     [36m0.71822[0m     0.79740    0.90070      0.52075  18.52s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      7     [36m0.71656[0m     1.28165    0.55909      0.49892  18.49s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      8     [36m0.70354[0m     0.74855    0.93987      0.54610  18.47s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      9     [36m0.69264[0m     1.37181    0.50491      0.50095  18.56s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     10     0.69359     0.80740    0.85904      0.53618  18.50s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     11     [36m0.69139[0m     [32m0.69744[0m    0.99132      0.56926  18.23s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     12     [36m0.68625[0m     [32m0.68166[0m    1.00673      0.56438  17.88s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     13     [36m0.67839[0m     0.82052    0.82679      0.53411  18.20s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     14     [36m0.67791[0m     0.74820    0.90605      0.54869  18.38s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     15     [36m0.67598[0m     1.00373    0.67347      0.51573  18.46s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     16     [36m0.66409[0m     0.71438    0.92960      0.54905  18.24s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     17     [36m0.65237[0m     0.68843    0.94762      0.54102  18.27s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     18     [36m0.64903[0m     0.70255    0.92381      0.54963  18.44s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     19     [36m0.64604[0m     0.71417    0.90460      0.54128  18.24s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     20     [36m0.64558[0m     0.70650    0.91377      0.54262  18.29s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     21     [36m0.63405[0m     0.75992    0.83437      0.54341  18.30s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     22     [36m0.63286[0m     0.68765    0.92032      0.54061  18.24s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
Early stopping.
Best valid loss was 0.681662 at epoch 12.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d3' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d3' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 128).
Loaded parameters to layer 'conv2d7' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d7' (shape 256).
Loaded parameters to layer 'conv2d9' (shape 512x256x3x3).
Loaded parameters to layer 'conv2d9' (shape 512).
Loaded parameters to layer 'conv2d11' (shape 512x512x3x3).
Loaded parameters to layer 'conv2d11' (shape 512).
Loaded parameters to layer 'conv2d12' (shape 2x512x3x3).
Loaded parameters to layer 'conv2d12' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 1 0 1 1 0 1 1 1 0 0 1 1 0 1 1 0 0 1 0 0 0 0 1 0 0 0 0 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.428743273188
Error rate (%):  57.1256726812
[[36239 52456]
 [ 1682  4393]]
(94770,)
(94770,)
roc_auc: 0.605995148213
log_loss: inf
roc_auc for the hours: 0.646575342466
log_loss for the hours: 1.11323400042
saving predictions to csv file
hourspatient1_5_net17_10-12-03-20-02.csv
Accuracy validation for the hours:  0.435897435897
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [5]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.136758784
saving predictions to csv file
patient1_5_net17_10-12-03-23-16.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config7.yml', '--no-channels=1', '--target-gpu=gpu1', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_6']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config7.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_6'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu1')
Git reference:  Timestamp: 2016-10-12 03:23:17.107090
Hostname: kat
gpu1
Configuration 'config7.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net17
evaluation:
    online_training: False
    model: net17

end Configuration
['patient1_6']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [6]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.81332224
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 199.270783997 178.304678345
20 484.265484619 454.425598145
30 715.207281494 673.034472656
40 957.550097656 897.335144043
50 1246.79968262 1160.86651611
60 1628.27236328 1502.71569824
70 2172.52145996 1989.60817871
80 3015.20869141 2745.85849609
90 4633.05883789 4178.59511719
100 66751.359375 59361.5703125
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net17
Model name for the evaluation phase:  net17
Training model...
# Neural Network with 3937026 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          64x96x32
  4          64x96x32
  5          128x48x16
  6          128x48x16
  7          256x24x8
  8          256x24x8
  9          512x12x4
 10          512x12x4
 11          512x6x4
 12          2x6x4
 13          2
 14          2

BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1    [36m28.25992[0m     [32m0.77654[0m   36.39228      0.44888  17.73s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      2     [36m0.76621[0m     [32m0.74680[0m    1.02600      0.41807  17.57s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      3     [36m0.73955[0m     0.74880    0.98766      0.53242  17.85s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      4     [36m0.72593[0m     0.82819    0.87652      0.50499  18.46s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      5     [36m0.70514[0m     1.38288    0.50990      0.49919  18.53s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      6     0.70697     1.23543    0.57224      0.50095  18.36s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      7     0.71026     [32m0.68125[0m    1.04259      0.59659  18.46s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      8     0.71987     1.25869    0.57192      0.50027  18.49s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      9     [36m0.70124[0m     0.96672    0.72539      0.50257  18.43s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     10     0.70695     1.14520    0.61731      0.49946  19.04s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     11     [36m0.68429[0m     1.48887    0.45961      0.49797  18.80s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     12     0.68746     1.23273    0.55767      0.50258  18.51s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     13     [36m0.68332[0m     0.92029    0.74250      0.50623  18.46s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     14     [36m0.67182[0m     0.88809    0.75647      0.50571  18.74s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     15     0.67756     0.85009    0.79705      0.51193  18.43s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     16     [36m0.66713[0m     0.76497    0.87210      0.52060  18.58s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     17     [36m0.66190[0m     1.06400    0.62209      0.51043  18.50s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
Early stopping.
Best valid loss was 0.681248 at epoch 7.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d3' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d3' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 128).
Loaded parameters to layer 'conv2d7' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d7' (shape 256).
Loaded parameters to layer 'conv2d9' (shape 512x256x3x3).
Loaded parameters to layer 'conv2d9' (shape 512).
Loaded parameters to layer 'conv2d11' (shape 512x512x3x3).
Loaded parameters to layer 'conv2d11' (shape 512).
Loaded parameters to layer 'conv2d12' (shape 2x512x3x3).
Loaded parameters to layer 'conv2d12' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 1 1 1 0 1 1 0 1 1 1 0 1 0 0 1 0 0 0 1 1 1 1 1 1 1 1 0 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.50022158911
Error rate (%):  49.977841089
[[44171 44524]
 [ 2840  3235]]
(94770,)
(94770,)
roc_auc: 0.54759702657
log_loss: 1.11753952134
roc_auc for the hours: 0.53698630137
log_loss for the hours: 0.737012112155
saving predictions to csv file
hourspatient1_6_net17_10-12-03-33-13.csv
Accuracy validation for the hours:  0.487179487179
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [6]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.079840768
saving predictions to csv file
patient1_6_net17_10-12-03-36-44.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config7.yml', '--no-channels=1', '--target-gpu=gpu1', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_7']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config7.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_7'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu1')
Git reference:  Timestamp: 2016-10-12 03:36:45.249854
Hostname: kat
gpu1
Configuration 'config7.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net17
evaluation:
    online_training: False
    model: net17

end Configuration
['patient1_7']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [7]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.813027328
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 182.900706482 163.150218201
20 446.00692749 416.755505371
30 662.357696533 620.480499268
40 892.956396484 834.12010498
50 1172.0982666 1087.89544678
60 1542.81384277 1420.86425781
70 2076.69821777 1899.79864502
80 2929.02983398 2668.57714844
90 4619.13442383 4199.77285156
100 65353.1796875 57503.8945312
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net17
Model name for the evaluation phase:  net17
Training model...
# Neural Network with 3937026 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          64x96x32
  4          64x96x32
  5          128x48x16
  6          128x48x16
  7          256x24x8
  8          256x24x8
  9          512x12x4
 10          512x12x4
 11          512x6x4
 12          2x6x4
 13          2
 14          2

BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1    [36m27.89444[0m     [32m0.71051[0m   39.25954      0.54087  17.74s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      2     [36m0.77012[0m     0.85639    0.89927      0.51248  17.79s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      3     [36m0.75828[0m     [32m0.66191[0m    1.14560      0.58892  17.83s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      4     [36m0.74545[0m     0.84060    0.88681      0.52440  18.48s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      5     [36m0.71899[0m     0.80839    0.88940      0.54074  18.79s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      6     [36m0.70655[0m     0.75084    0.94101      0.54841  18.52s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      7     0.70939     0.72517    0.97824      0.56250  18.54s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      8     [36m0.70065[0m     0.78819    0.88894      0.54745  18.46s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      9     [36m0.68510[0m     0.77830    0.88025      0.54969  18.41s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     10     [36m0.67362[0m     0.85327    0.78946      0.53726  18.46s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     11     [36m0.67023[0m     0.92744    0.72267      0.53321  18.66s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     12     [36m0.66288[0m     0.81071    0.81765      0.54947  18.53s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     13     [36m0.65669[0m     0.79433    0.82673      0.54710  18.42s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
Early stopping.
Best valid loss was 0.661910 at epoch 3.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d3' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d3' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 128).
Loaded parameters to layer 'conv2d7' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d7' (shape 256).
Loaded parameters to layer 'conv2d9' (shape 512x256x3x3).
Loaded parameters to layer 'conv2d9' (shape 512).
Loaded parameters to layer 'conv2d11' (shape 512x512x3x3).
Loaded parameters to layer 'conv2d11' (shape 512).
Loaded parameters to layer 'conv2d12' (shape 2x512x3x3).
Loaded parameters to layer 'conv2d12' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 0 1 0 0 0 1 0 1 0 0 1 1 0 0 1 0 0 1 1 0 0 0 1 0 0 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.325577714467
Error rate (%):  67.4422285533
[[25225 63470]
 [  445  5630]]
(94770,)
(94770,)
roc_auc: 0.667799332665
log_loss: 1.96446991648
roc_auc for the hours: 0.797260273973
log_loss for the hours: 1.28977167848
saving predictions to csv file
hourspatient1_7_net17_10-12-03-45-32.csv
Accuracy validation for the hours:  0.25641025641
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [7]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.140076544
saving predictions to csv file
patient1_7_net17_10-12-03-48-50.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config7.yml', '--no-channels=1', '--target-gpu=gpu1', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_8']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config7.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_8'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu1')
Git reference:  Timestamp: 2016-10-12 03:48:51.616710
Hostname: kat
gpu1
Configuration 'config7.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net17
evaluation:
    online_training: False
    model: net17

end Configuration
['patient1_8']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [8]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.81328128
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 179.447947693 164.423493958
20 434.278393555 418.093994141
30 634.319030762 613.24385376
40 834.442565918 807.11171875
50 1056.00579834 1020.13357544
60 1321.37426758 1274.3189209
70 1666.15869141 1603.34324951
80 2169.84814453 2082.13676758
90 3113.30068359 2981.24484863
100 59862.1054688 57871.4179688
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net17
Model name for the evaluation phase:  net17
Training model...
# Neural Network with 3937026 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          64x96x32
  4          64x96x32
  5          128x48x16
  6          128x48x16
  7          256x24x8
  8          256x24x8
  9          512x12x4
 10          512x12x4
 11          512x6x4
 12          2x6x4
 13          2
 14          2

BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1    [36m19.56812[0m     [32m0.66360[0m   29.48796      0.57216  17.50s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      2     [36m0.75901[0m     0.81822    0.92763      0.52306  17.54s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      3     [36m0.73880[0m     0.71319    1.03591      0.44767  17.62s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      4     [36m0.71865[0m     0.75815    0.94789      0.45133  18.21s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      5     [36m0.67618[0m     0.69993    0.96607      0.56692  18.62s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      6     0.68102     0.70225    0.96978      0.56903  18.58s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      7     [36m0.67304[0m     0.69112    0.97384      0.46023  18.69s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      8     [36m0.67080[0m     0.83963    0.79892      0.53037  18.60s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      9     0.67855     0.70900    0.95706      0.54265  18.54s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     10     [36m0.66900[0m     0.75314    0.88828      0.47894  18.58s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     11     [36m0.65122[0m     0.72617    0.89678      0.47520  18.66s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
Early stopping.
Best valid loss was 0.663597 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d3' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d3' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 128).
Loaded parameters to layer 'conv2d7' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d7' (shape 256).
Loaded parameters to layer 'conv2d9' (shape 512x256x3x3).
Loaded parameters to layer 'conv2d9' (shape 512).
Loaded parameters to layer 'conv2d11' (shape 512x512x3x3).
Loaded parameters to layer 'conv2d11' (shape 512).
Loaded parameters to layer 'conv2d12' (shape 2x512x3x3).
Loaded parameters to layer 'conv2d12' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 0 1 1 1 1 1 0 0 1 0 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.322074496149
Error rate (%):  67.7925503851
[[25478 63217]
 [ 1030  5045]]
(94770,)
(94770,)
roc_auc: 0.593117032824
log_loss: 1.63442385476
roc_auc for the hours: 0.61095890411
log_loss for the hours: 1.15149764101
saving predictions to csv file
hourspatient1_8_net17_10-12-03-57-09.csv
Accuracy validation for the hours:  0.269230769231
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [8]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.134399488
saving predictions to csv file
patient1_8_net17_10-12-04-00-21.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config7.yml', '--no-channels=1', '--target-gpu=gpu1', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_9']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config7.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_9'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu1')
Git reference:  Timestamp: 2016-10-12 04:00:22.780907
Hostname: kat
gpu1
Configuration 'config7.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net17
evaluation:
    online_training: False
    model: net17

end Configuration
['patient1_9']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [9]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.813531136
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 3.68383948803 3.51945617199
20 8.91916770935 8.73870506287
30 13.5332503319 13.2244482994
40 19.6162849426 18.9431503296
50 42.7269630432 33.8711013794
60 446.623547363 383.009014893
70 778.942749023 709.81932373
80 1201.11340332 1105.85910645
90 1927.03088379 1777.32213135
100 43853.8789062 40357.3945312
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net17
Model name for the evaluation phase:  net17
Training model...
# Neural Network with 3937026 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          64x96x32
  4          64x96x32
  5          128x48x16
  6          128x48x16
  7          256x24x8
  8          256x24x8
  9          512x12x4
 10          512x12x4
 11          512x6x4
 12          2x6x4
 13          2
 14          2

BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1    [36m31.26794[0m     [32m2.24551[0m   13.92468      0.50067  17.58s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      2     [36m0.76685[0m     [32m0.99008[0m    0.77453      0.45307  17.44s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      3     [36m0.70959[0m     [32m0.88938[0m    0.79785      0.44149  17.54s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      4     [36m0.69857[0m     0.94819    0.73674      0.44109  17.98s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      5     [36m0.69189[0m     1.17779    0.58744      0.44576  18.44s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      6     0.69943     1.32695    0.52710      0.44643  18.41s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      7     [36m0.68383[0m     0.95563    0.71558      0.43615  18.26s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      8     0.68434     [32m0.75707[0m    0.90394      0.48753  18.34s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      9     [36m0.67734[0m     0.87279    0.77605      0.39643  18.25s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     10     [36m0.66535[0m     0.81417    0.81722      0.48164  18.35s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     11     0.67033     0.81168    0.82586      0.43182  18.15s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     12     [36m0.66066[0m     0.89530    0.73792      0.38845  18.32s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     13     [36m0.65007[0m     0.97065    0.66973      0.41012  18.49s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     14     [36m0.64363[0m     1.00695    0.63919      0.40316  18.63s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     15     [36m0.64201[0m     1.27901    0.50196      0.44387  18.66s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     16     0.72084     0.81207    0.88766      0.49350  18.53s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     17     0.79532     0.94044    0.84569      0.42405  18.62s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     18     0.68709     0.81964    0.83829      0.45848  18.73s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
Early stopping.
Best valid loss was 0.757067 at epoch 8.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d3' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d3' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 128).
Loaded parameters to layer 'conv2d7' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d7' (shape 256).
Loaded parameters to layer 'conv2d9' (shape 512x256x3x3).
Loaded parameters to layer 'conv2d9' (shape 512).
Loaded parameters to layer 'conv2d11' (shape 512x512x3x3).
Loaded parameters to layer 'conv2d11' (shape 512).
Loaded parameters to layer 'conv2d12' (shape 2x512x3x3).
Loaded parameters to layer 'conv2d12' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 1 0 0 0 0 0 0 0 0 0 0 0 0 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.131697794661
Error rate (%):  86.8302205339
[[ 7146 81549]
 [  740  5335]]
(94770,)
(94770,)
roc_auc: 0.515108147239
log_loss: inf
roc_auc for the hours: 0.487671232877
log_loss for the hours: 1.89778396272
saving predictions to csv file
hourspatient1_9_net17_10-12-04-10-38.csv
Accuracy validation for the hours:  0.115384615385
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [9]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.145925632
saving predictions to csv file
patient1_9_net17_10-12-04-13-52.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config7.yml', '--no-channels=1', '--target-gpu=gpu1', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_10']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config7.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_10'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu1')
Git reference:  Timestamp: 2016-10-12 04:13:53.772467
Hostname: kat
gpu1
Configuration 'config7.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net17
evaluation:
    online_training: False
    model: net17

end Configuration
['patient1_10']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [10]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.812355584
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 181.207902527 167.670619202
20 438.332196045 424.686590576
30 639.719543457 622.390942383
40 839.969042969 817.731738281
50 1060.19781494 1030.7331543
60 1320.43032227 1280.04846191
70 1650.03087158 1595.78609619
80 2111.48989258 2038.48054199
90 2911.55273438 2807.46408691
100 41643.4882812 36225.46875
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net17
Model name for the evaluation phase:  net17
Training model...
# Neural Network with 3937026 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          64x96x32
  4          64x96x32
  5          128x48x16
  6          128x48x16
  7          256x24x8
  8          256x24x8
  9          512x12x4
 10          512x12x4
 11          512x6x4
 12          2x6x4
 13          2
 14          2

BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1    [36m22.48534[0m     [32m2.21101[0m   10.16972      0.48368  17.00s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      2     [36m0.67455[0m     3.31545    0.20346      0.48644  16.96s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      3     [36m0.66311[0m     [32m1.96385[0m    0.33766      0.48157  17.38s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      4     [36m0.65114[0m     [32m0.82097[0m    0.79314      0.46967  18.49s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      5     0.65329     2.75270    0.23733      0.48408  18.42s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      6     [36m0.64975[0m     1.25472    0.51785      0.48088  18.42s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      7     [36m0.63730[0m     1.97065    0.32340      0.48323  18.28s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      8     [36m0.62863[0m     [32m0.77205[0m    0.81423      0.47587  18.29s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      9     [36m0.62495[0m     2.06938    0.30200      0.48226  18.18s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     10     0.62545     1.32695    0.47134      0.48110  18.13s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     11     0.62698     [32m0.69423[0m    0.90314      0.57929  18.22s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     12     [36m0.61280[0m     1.08652    0.56400      0.47520  18.17s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     13     0.61486     0.73813    0.83300      0.47807  18.07s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     14     [36m0.60784[0m     0.77841    0.78087      0.44587  18.17s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     15     [36m0.60236[0m     [32m0.67031[0m    0.89863      0.55830  18.07s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     16     [36m0.59994[0m     [32m0.66344[0m    0.90429      0.55772  18.26s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     17     [36m0.59142[0m     [32m0.66339[0m    0.89151      0.55510  18.38s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     18     [36m0.58544[0m     0.66408    0.88158      0.55721  18.18s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     19     [36m0.58266[0m     0.67389    0.86462      0.53535  18.35s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     20     [36m0.57382[0m     [32m0.66049[0m    0.86877      0.59365  18.50s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     21     [36m0.57148[0m     0.69521    0.82202      0.55072  18.48s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     22     [36m0.56712[0m     0.77171    0.73489      0.45884  18.26s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     23     [36m0.56339[0m     0.73277    0.76886      0.48296  18.33s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     24     [36m0.56164[0m     0.80142    0.70081      0.45654  18.20s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     25     [36m0.55327[0m     0.77912    0.71012      0.47771  18.51s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     26     [36m0.53911[0m     0.74075    0.72778      0.47110  18.43s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     27     [36m0.53482[0m     0.75989    0.70381      0.48185  18.46s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     28     [36m0.53389[0m     0.70943    0.75255      0.51556  18.63s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     29     [36m0.52248[0m     0.74777    0.69872      0.55109  18.39s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     30     [36m0.51121[0m     0.71245    0.71753      0.56250  18.63s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
Early stopping.
Best valid loss was 0.660494 at epoch 20.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d3' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d3' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 128).
Loaded parameters to layer 'conv2d7' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d7' (shape 256).
Loaded parameters to layer 'conv2d9' (shape 512x256x3x3).
Loaded parameters to layer 'conv2d9' (shape 512).
Loaded parameters to layer 'conv2d11' (shape 512x512x3x3).
Loaded parameters to layer 'conv2d11' (shape 512).
Loaded parameters to layer 'conv2d12' (shape 2x512x3x3).
Loaded parameters to layer 'conv2d12' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.481449825894
Error rate (%):  51.8550174106
[[41414 47281]
 [ 1862  4213]]
(94770,)
(94770,)
roc_auc: 0.594927785306
log_loss: inf
roc_auc for the hours: 0.580821917808
log_loss for the hours: 1.34749451845
saving predictions to csv file
hourspatient1_10_net17_10-12-04-27-54.csv
Accuracy validation for the hours:  0.512820512821
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [10]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.079672832
saving predictions to csv file
patient1_10_net17_10-12-04-31-08.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config7.yml', '--no-channels=1', '--target-gpu=gpu1', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_11']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config7.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_11'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu1')
Git reference:  Timestamp: 2016-10-12 04:31:09.892493
Hostname: kat
gpu1
Configuration 'config7.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net17
evaluation:
    online_training: False
    model: net17

end Configuration
['patient1_11']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [11]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.81348608
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 172.641601563 159.5427948
20 417.636303711 403.23772583
30 608.427856445 589.179815674
40 796.191516113 769.670605469
50 999.883514404 964.325683594
60 1236.0432373 1189.17692871
70 1532.10228271 1470.09255371
80 1945.44143066 1860.52646484
90 2669.32939453 2545.69404297
100 34311.5273438 30092.4199219
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net17
Model name for the evaluation phase:  net17
Training model...
# Neural Network with 3937026 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          64x96x32
  4          64x96x32
  5          128x48x16
  6          128x48x16
  7          256x24x8
  8          256x24x8
  9          512x12x4
 10          512x12x4
 11          512x6x4
 12          2x6x4
 13          2
 14          2

BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1    [36m19.07442[0m     [32m1.03733[0m   18.38795      0.48341  17.61s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      2     [36m0.65322[0m     [32m0.70057[0m    0.93240      0.61015  17.79s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      3     [36m0.61323[0m     0.72821    0.84211      0.59645  17.72s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      4     0.61370     0.70389    0.87187      0.64896  18.20s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      5     [36m0.59030[0m     1.03767    0.56887      0.54695  18.32s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      6     [36m0.58743[0m     [32m0.68838[0m    0.85335      0.58042  18.29s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      7     0.58900     1.12676    0.52274      0.54194  18.44s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      8     [36m0.57768[0m     0.70939    0.81433      0.65211  18.34s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      9     [36m0.57373[0m     0.72344    0.79306      0.64094  18.14s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     10     [36m0.57198[0m     0.77992    0.73339      0.45329  18.24s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     11     [36m0.56133[0m     0.73781    0.76081      0.56519  18.32s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     12     0.56256     0.86717    0.64873      0.62076  18.32s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     13     0.56159     1.08464    0.51776      0.56903  18.31s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     14     [36m0.55859[0m     0.75063    0.74416      0.60718  18.19s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     15     [36m0.55012[0m     0.74832    0.73514      0.59951  18.45s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     16     [36m0.54737[0m     0.80402    0.68080      0.62954  18.35s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
Early stopping.
Best valid loss was 0.688375 at epoch 6.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d3' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d3' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 128).
Loaded parameters to layer 'conv2d7' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d7' (shape 256).
Loaded parameters to layer 'conv2d9' (shape 512x256x3x3).
Loaded parameters to layer 'conv2d9' (shape 512).
Loaded parameters to layer 'conv2d11' (shape 512x512x3x3).
Loaded parameters to layer 'conv2d11' (shape 512).
Loaded parameters to layer 'conv2d12' (shape 2x512x3x3).
Loaded parameters to layer 'conv2d12' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 1 1 0 0 0 1 0 0 0 1 0 0 1 1 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.474126833386
Error rate (%):  52.5873166614
[[41164 47531]
 [ 2306  3769]]
(94770,)
(94770,)
roc_auc: 0.5468023144
log_loss: inf
roc_auc for the hours: 0.542465753425
log_loss for the hours: 1.52713197749
saving predictions to csv file
hourspatient1_11_net17_10-12-04-40-58.csv
Accuracy validation for the hours:  0.512820512821
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [11]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.079955456
saving predictions to csv file
patient1_11_net17_10-12-04-44-10.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config7.yml', '--no-channels=1', '--target-gpu=gpu1', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_12']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config7.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_12'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu1')
Git reference:  Timestamp: 2016-10-12 04:44:11.804774
Hostname: kat
gpu1
Configuration 'config7.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net17
evaluation:
    online_training: False
    model: net17

end Configuration
['patient1_12']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [12]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.813760512
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 194.413856506 178.851933289
20 463.675524902 446.537554932
30 666.165478516 644.010736084
40 859.942541504 831.373522949
50 1065.9508667 1029.34899902
60 1304.29125977 1256.71569824
70 1606.91943359 1543.18864746
80 2047.88012695 1958.46350098
90 2871.70686035 2742.33198242
100 68176.640625 59867.6914062
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net17
Model name for the evaluation phase:  net17
Training model...
# Neural Network with 3937026 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          64x96x32
  4          64x96x32
  5          128x48x16
  6          128x48x16
  7          256x24x8
  8          256x24x8
  9          512x12x4
 10          512x12x4
 11          512x6x4
 12          2x6x4
 13          2
 14          2

BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1    [36m18.61861[0m     [32m0.74681[0m   24.93077      0.53790  16.94s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      2     [36m0.68293[0m     0.90858    0.75164      0.50922  17.11s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      3     [36m0.66019[0m     1.11525    0.59196      0.50901  17.35s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      4     [36m0.65322[0m     0.79385    0.82285      0.55648  18.08s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      5     [36m0.63836[0m     0.78711    0.81102      0.55720  18.12s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      6     [36m0.63636[0m     1.02743    0.61938      0.55302  18.27s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      7     [36m0.62095[0m     1.07880    0.57559      0.55628  18.31s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      8     [36m0.61757[0m     1.09411    0.56445      0.55342  18.29s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      9     [36m0.61301[0m     0.85716    0.71517      0.57758  18.14s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     10     [36m0.60922[0m     0.81268    0.74964      0.58396  18.44s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     11     [36m0.59842[0m     0.90202    0.66342      0.57549  18.36s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
Early stopping.
Best valid loss was 0.746812 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d3' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d3' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 128).
Loaded parameters to layer 'conv2d7' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d7' (shape 256).
Loaded parameters to layer 'conv2d9' (shape 512x256x3x3).
Loaded parameters to layer 'conv2d9' (shape 512).
Loaded parameters to layer 'conv2d11' (shape 512x512x3x3).
Loaded parameters to layer 'conv2d11' (shape 512).
Loaded parameters to layer 'conv2d12' (shape 2x512x3x3).
Loaded parameters to layer 'conv2d12' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.14525693785
Error rate (%):  85.474306215
[[ 7694 81001]
 [    3  6072]]
(94770,)
(94770,)
roc_auc: 0.616643503642
log_loss: 5.59195467866
roc_auc for the hours: 0.734246575342
log_loss for the hours: 4.22648159369
saving predictions to csv file
hourspatient1_12_net17_10-12-04-52-21.csv
Accuracy validation for the hours:  0.153846153846
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [12]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.13487872
saving predictions to csv file
patient1_12_net17_10-12-04-55-28.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config7.yml', '--no-channels=1', '--target-gpu=gpu1', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_13']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config7.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_13'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu1')
Git reference:  Timestamp: 2016-10-12 04:55:29.428221
Hostname: kat
gpu1
Configuration 'config7.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net17
evaluation:
    online_training: False
    model: net17

end Configuration
['patient1_13']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [13]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.813121536
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 197.41583252 182.761578369
20 473.741113281 459.648413086
30 683.193365479 665.443499756
40 884.565112305 862.165649414
50 1098.331604 1068.85339355
60 1343.71057129 1304.4578125
70 1651.5090332 1598.25623779
80 2090.38417969 2016.00366211
90 2902.72646484 2791.59272461
100 37327.25 36955.34375
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net17
Model name for the evaluation phase:  net17
Training model...
# Neural Network with 3937026 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          64x96x32
  4          64x96x32
  5          128x48x16
  6          128x48x16
  7          256x24x8
  8          256x24x8
  9          512x12x4
 10          512x12x4
 11          512x6x4
 12          2x6x4
 13          2
 14          2

BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1    [36m20.76555[0m     [32m0.67396[0m   30.81134      0.58754  17.79s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      2     [36m0.65532[0m     1.04710    0.62584      0.48372  17.66s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      3     [36m0.64812[0m     0.85058    0.76198      0.48130  17.57s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      4     [36m0.62504[0m     0.78048    0.80084      0.47937  18.20s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      5     [36m0.62392[0m     0.70182    0.88900      0.55532  18.41s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      6     [36m0.61539[0m     0.69695    0.88299      0.58449  18.47s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      7     [36m0.61124[0m     [32m0.65383[0m    0.93486      0.62229  18.31s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      8     0.61748     [32m0.64056[0m    0.96396      0.63612  18.33s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      9     [36m0.60145[0m     0.64403    0.93389      0.62307  18.42s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     10     [36m0.59859[0m     0.69975    0.85544      0.61420  18.37s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     11     [36m0.59198[0m     0.69583    0.85075      0.62835  18.33s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     12     [36m0.58538[0m     0.69065    0.84759      0.62781  18.35s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     13     0.58621     0.72000    0.81418      0.61505  18.26s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     14     [36m0.57198[0m     0.74380    0.76899      0.63901  17.91s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     15     [36m0.56645[0m     0.70917    0.79875      0.63991  17.94s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     16     0.56925     0.70182    0.81111      0.62168  17.88s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     17     [36m0.56522[0m     0.70430    0.80253      0.64880  17.94s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     18     [36m0.55840[0m     0.69772    0.80033      0.63971  18.22s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
Early stopping.
Best valid loss was 0.640560 at epoch 8.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d3' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d3' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 128).
Loaded parameters to layer 'conv2d7' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d7' (shape 256).
Loaded parameters to layer 'conv2d9' (shape 512x256x3x3).
Loaded parameters to layer 'conv2d9' (shape 512).
Loaded parameters to layer 'conv2d11' (shape 512x512x3x3).
Loaded parameters to layer 'conv2d11' (shape 512).
Loaded parameters to layer 'conv2d12' (shape 2x512x3x3).
Loaded parameters to layer 'conv2d12' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.578474200696
Error rate (%):  42.1525799304
[[50599 38096]
 [ 1852  4223]]
(94770,)
(94770,)
roc_auc: 0.680182523129
log_loss: 1.52520316232
roc_auc for the hours: 0.72602739726
log_loss for the hours: 0.796361426772
saving predictions to csv file
hourspatient1_13_net17_10-12-05-05-37.csv
Accuracy validation for the hours:  0.615384615385
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [13]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.079119872
saving predictions to csv file
patient1_13_net17_10-12-05-08-42.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config7.yml', '--no-channels=1', '--target-gpu=gpu1', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_14']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config7.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_14'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu1')
Git reference:  Timestamp: 2016-10-12 05:08:43.958217
Hostname: kat
gpu1
Configuration 'config7.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net17
evaluation:
    online_training: False
    model: net17

end Configuration
['patient1_14']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [14]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.814149632
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 189.141261292 174.980825806
20 452.630731201 438.836401367
30 649.66987915 632.660009766
40 836.557116699 814.948742676
50 1031.56469727 1003.98742676
60 1251.25163574 1216.06953125
70 1519.30529785 1471.67954102
80 1885.33984375 1820.3204834
90 2516.96833496 2415.86462402
100 43412.1367188 33402.015625
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net17
Model name for the evaluation phase:  net17
Training model...
# Neural Network with 3937026 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          64x96x32
  4          64x96x32
  5          128x48x16
  6          128x48x16
  7          256x24x8
  8          256x24x8
  9          512x12x4
 10          512x12x4
 11          512x6x4
 12          2x6x4
 13          2
 14          2

BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1    [36m20.08184[0m     [32m0.71450[0m   28.10628      0.51821  17.69s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      2     [36m0.69398[0m     0.74826    0.92746      0.51356  17.85s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      3     [36m0.66955[0m     0.92275    0.72560      0.50363  17.83s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      4     [36m0.66661[0m     1.03919    0.64147      0.47425  18.80s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      5     [36m0.64486[0m     [32m0.68613[0m    0.93985      0.49973  18.67s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      6     [36m0.63267[0m     0.73243    0.86380      0.56306  18.68s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      7     [36m0.62064[0m     0.69355    0.89487      0.58009  18.73s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      8     [36m0.62029[0m     [32m0.68048[0m    0.91154      0.58162  18.53s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      9     [36m0.60316[0m     [32m0.66306[0m    0.90967      0.59247  18.35s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     10     [36m0.59889[0m     0.86486    0.69247      0.54887  18.58s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     11     0.59929     0.71053    0.84345      0.59067  18.42s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     12     [36m0.58512[0m     0.73141    0.79999      0.59366  18.60s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     13     [36m0.57939[0m     0.67870    0.85367      0.56470  18.26s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     14     [36m0.57295[0m     0.94405    0.60691      0.48667  18.23s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     15     [36m0.55825[0m     0.70853    0.78789      0.57646  18.23s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     16     0.56331     0.69238    0.81358      0.59458  18.37s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     17     [36m0.54951[0m     0.78129    0.70334      0.59031  18.32s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     18     [36m0.54838[0m     0.74495    0.73613      0.57317  18.23s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     19     [36m0.53896[0m     0.71637    0.75234      0.59903  17.93s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
Early stopping.
Best valid loss was 0.663055 at epoch 9.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d3' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d3' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 128).
Loaded parameters to layer 'conv2d7' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d7' (shape 256).
Loaded parameters to layer 'conv2d9' (shape 512x256x3x3).
Loaded parameters to layer 'conv2d9' (shape 512).
Loaded parameters to layer 'conv2d11' (shape 512x512x3x3).
Loaded parameters to layer 'conv2d11' (shape 512).
Loaded parameters to layer 'conv2d12' (shape 2x512x3x3).
Loaded parameters to layer 'conv2d12' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 0 1 0 0 0 0 0 0 0 1 0 1 0 0 1 1 0 1 0 1 0 1 1 1 0 0 0 1 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.444982589427
Error rate (%):  55.5017410573
[[37928 50767]
 [ 1832  4243]]
(94770,)
(94770,)
roc_auc: 0.613752838193
log_loss: 2.09009609164
roc_auc for the hours: 0.635616438356
log_loss for the hours: 1.23515011578
saving predictions to csv file
hourspatient1_14_net17_10-12-05-19-14.csv
Accuracy validation for the hours:  0.487179487179
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [14]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.13922048
saving predictions to csv file
patient1_14_net17_10-12-05-22-25.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config7.yml', '--no-channels=1', '--target-gpu=gpu1', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_15']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config7.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_15'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu1')
Git reference:  Timestamp: 2016-10-12 05:22:26.496430
Hostname: kat
gpu1
Configuration 'config7.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net17
evaluation:
    online_training: False
    model: net17

end Configuration
['patient1_15']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [15]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.812322816
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 192.412426758 176.768930054
20 459.689099121 442.431689453
30 658.81307373 637.209912109
40 846.730224609 819.873974609
50 1042.01245117 1009.00811768
60 1261.45869141 1219.99689941
70 1528.8362793 1476.44569092
80 1896.24025879 1829.35996094
90 2539.709375 2448.71398926
100 29197.0292969 29615.0136719
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net17
Model name for the evaluation phase:  net17
Training model...
# Neural Network with 3937026 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          64x96x32
  4          64x96x32
  5          128x48x16
  6          128x48x16
  7          256x24x8
  8          256x24x8
  9          512x12x4
 10          512x12x4
 11          512x6x4
 12          2x6x4
 13          2
 14          2

BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1    [36m17.21538[0m     [32m0.67584[0m   25.47251      0.55409  17.66s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      2     [36m0.74184[0m     0.68985    1.07537      0.55806  17.79s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      3     [36m0.67204[0m     0.69634    0.96509      0.57762  17.78s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      4     [36m0.64552[0m     0.71623    0.90128      0.48746  18.28s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      5     [36m0.63556[0m     [32m0.66739[0m    0.95230      0.61387  18.70s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      6     0.64401     0.69290    0.92945      0.60429  18.62s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      7     [36m0.60702[0m     0.69915    0.86823      0.60850  18.48s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      8     [36m0.60034[0m     0.73368    0.81826      0.60331  18.62s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
      9     [36m0.59053[0m     0.74808    0.78939      0.60087  18.47s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     10     [36m0.58178[0m     0.98449    0.59095      0.49271  18.63s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     11     0.59141     0.80024    0.73905      0.61751  18.65s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     12     0.58301     0.70026    0.83256      0.63594  18.68s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     13     [36m0.56771[0m     [32m0.64558[0m    0.87938      0.62019  18.53s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     14     [36m0.56203[0m     0.67078    0.83788      0.65316  18.56s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     15     [36m0.56164[0m     0.65686    0.85504      0.59490  18.60s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     16     [36m0.55855[0m     0.67470    0.82784      0.57642  18.47s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     17     [36m0.55723[0m     0.64897    0.85865      0.62903  18.58s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     18     [36m0.55566[0m     0.73598    0.75499      0.61482  18.55s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     19     [36m0.55518[0m     0.67498    0.82252      0.60146  18.42s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     20     [36m0.54532[0m     0.66617    0.81860      0.60749  18.34s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     21     [36m0.54374[0m     0.67524    0.80525      0.57398  18.55s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     22     [36m0.54045[0m     0.67244    0.80372      0.58788  18.55s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
     23     [36m0.53978[0m     0.64597    0.83562      0.60925  18.43s
BI_train_bal_complete called with len(X) = 2336
BI_test_bal_complete called with len(X) = 584
Early stopping.
Best valid loss was 0.645580 at epoch 13.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d3' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d3' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 128).
Loaded parameters to layer 'conv2d7' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d7' (shape 256).
Loaded parameters to layer 'conv2d9' (shape 512x256x3x3).
Loaded parameters to layer 'conv2d9' (shape 512).
Loaded parameters to layer 'conv2d11' (shape 512x512x3x3).
Loaded parameters to layer 'conv2d11' (shape 512).
Loaded parameters to layer 'conv2d12' (shape 2x512x3x3).
Loaded parameters to layer 'conv2d12' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 1 0 0 1 0 1 0 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.489996834441
Error rate (%):  51.0003165559
[[42047 46648]
 [ 1685  4390]]
(94770,)
(94770,)
roc_auc: 0.667163846511
log_loss: nan
roc_auc for the hours: 0.684931506849
log_loss for the hours: 1.57263589728
saving predictions to csv file
hourspatient1_15_net17_10-12-05-34-12.csv
Accuracy validation for the hours:  0.512820512821
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [15]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.14460672
saving predictions to csv file
patient1_15_net17_10-12-05-37-21.csv
