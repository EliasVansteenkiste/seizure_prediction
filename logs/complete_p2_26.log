['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config2.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_0']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config2.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_0'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-17 00:57:01.517351
Hostname: kat
gpu3
Configuration 'config2.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 128
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net14
evaluation:
    online_training: False
    model: net14

end Configuration
['patient2_0']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 128)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [0]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.831270912
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 110.047416687 116.410202026
20 173.912347412 181.6246521
30 239.352137756 248.869934082
40 320.696630859 333.993286133
50 443.953536987 465.425354004
60 666.14140625 699.936401367
70 1048.83631592 1086.2286377
80 1687.34770508 1700.5378418
90 3011.78098145 2914.97033691
100 63321.7421875 58944.8007812
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net14
Model name for the evaluation phase:  net14
Training model...
# Neural Network with 1577218 learnable parameters

## Layer information

  #    name  size
---  ------  ----------
  0          1x192x128
  1          32x192x128
  2          32x192x128
  3          64x96x64
  4          64x96x64
  5          128x48x32
  6          128x48x32
  7          256x24x16
  8          256x24x16
  9          512x12x8
 10          2x12x8
 11          2
 12          2

BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m1.60280[0m     [32m0.69923[0m    2.29225      0.73449  253.56s
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.53487[0m     0.72355    0.73923      0.70838  253.14s
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.52714[0m     0.76404    0.68993      0.66905  252.48s
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.51848[0m     0.75334    0.68824      0.58409  253.39s
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.51267[0m     0.80232    0.63899      0.67958  253.07s
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.51014[0m     0.78592    0.64911      0.62822  252.83s
BI_test_bal_complete called with len(X) = 1530
      7     0.51668     0.82740    0.62446      0.69019  252.22s
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.49894[0m     0.83139    0.60013      0.67911  253.11s
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.48226[0m     0.87252    0.55272      0.67782  253.07s
BI_test_bal_complete called with len(X) = 1530
     10     0.49136     0.96791    0.50765      0.67809  252.59s
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.46412[0m     0.85374    0.54363      0.67234  253.35s
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.699226 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d3' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d3' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 128).
Loaded parameters to layer 'conv2d7' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d7' (shape 256).
Loaded parameters to layer 'conv2d9' (shape 512x256x3x3).
Loaded parameters to layer 'conv2d9' (shape 512).
Loaded parameters to layer 'conv2d10' (shape 2x512x3x3).
Loaded parameters to layer 'conv2d10' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 128)
magnitudes_seizure_val.shape (5, 1, 1406, 128)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.768150062207
Error rate (%):  23.1849937793
[[35942 10228]
 [ 1885  4190]]
(52245,)
(52245,)
roc_auc: 0.733972108802
log_loss: nan
roc_auc for the hours: 0.752631578947
log_loss for the hours: 1.30626971735
saving predictions to csv file
hourspatient2_0_net14_10-17-01-56-30.csv
Accuracy validation for the hours:  0.767441860465
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 128)
(2286, 1, 234, 128)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [0]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.257426944
saving predictions to csv file
patient2_0_net14_10-17-02-03-51.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config2.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_1']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config2.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_1'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-17 02:03:52.801172
Hostname: kat
gpu3
Configuration 'config2.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 128
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net14
evaluation:
    online_training: False
    model: net14

end Configuration
['patient2_1']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 128)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [1]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.831557632
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 71.8910812378 76.1505523682
20 113.920155334 119.494290161
30 157.786941528 165.541716003
40 214.276712036 225.896340942
50 303.955413818 322.552307129
60 467.813372803 492.567340088
70 747.235864258 765.384222412
80 1231.07773438 1215.29257813
90 2395.22480469 2220.69262695
100 56617.8046875 55581.1640625
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net14
Model name for the evaluation phase:  net14
Training model...
# Neural Network with 1577218 learnable parameters

## Layer information

  #    name  size
---  ------  ----------
  0          1x192x128
  1          32x192x128
  2          32x192x128
  3          64x96x64
  4          64x96x64
  5          128x48x32
  6          128x48x32
  7          256x24x16
  8          256x24x16
  9          512x12x8
 10          2x12x8
 11          2
 12          2

BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m1.37994[0m     [32m0.89187[0m    1.54724      0.61570  89.42s
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.54466[0m     [32m0.88019[0m    0.61880      0.58066  180.43s
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.53706[0m     0.99025    0.54235      0.62313  215.96s
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.52274[0m     0.97659    0.53527      0.62541  252.76s
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.51721[0m     0.96311    0.53703      0.60818  252.21s
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.50955[0m     0.94995    0.53640      0.58421  252.45s
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.49981[0m     0.90643    0.55140      0.58481  252.75s
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.49171[0m     1.00578    0.48888      0.58852  253.10s
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.47700[0m     0.95569    0.49911      0.56454  253.05s
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.45702[0m     1.16035    0.39386      0.56969  252.22s
BI_test_bal_complete called with len(X) = 1530
     11    67.23440   192.96395    0.34843      0.50077  252.74s
BI_test_bal_complete called with len(X) = 1530
     12     5.80465     1.61452    3.59527      0.52190  252.24s
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.880189 at epoch 2.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d3' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d3' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 128).
Loaded parameters to layer 'conv2d7' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d7' (shape 256).
Loaded parameters to layer 'conv2d9' (shape 512x256x3x3).
Loaded parameters to layer 'conv2d9' (shape 512).
Loaded parameters to layer 'conv2d10' (shape 2x512x3x3).
Loaded parameters to layer 'conv2d10' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 128)
magnitudes_seizure_val.shape (5, 1, 1406, 128)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.608651545602
Error rate (%):  39.1348454398
[[28257 17913]
 [ 2533  3542]]
(52245,)
(52245,)
roc_auc: 0.605269780405
log_loss: 2.35757978413
roc_auc for the hours: 0.621052631579
log_loss for the hours: 1.47435462876
saving predictions to csv file
hourspatient2_1_net14_10-17-03-15-45.csv
Accuracy validation for the hours:  0.651162790698
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 128)
(2286, 1, 234, 128)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [1]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.265995776
saving predictions to csv file
patient2_1_net14_10-17-03-23-51.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config2.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_2']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config2.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_2'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-17 03:23:52.462217
Hostname: kat
gpu3
Configuration 'config2.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 128
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net14
evaluation:
    online_training: False
    model: net14

end Configuration
['patient2_2']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 128)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [2]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.831627264
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 62.0641353607 67.2156799316
20 98.3868301392 105.454284668
30 136.338194275 146.10619812
40 185.221517944 198.848248291
50 259.774627686 278.028717041
60 382.812481689 402.986676025
70 581.88293457 595.879772949
80 922.39317627 913.234753418
90 1700.95675049 1611.40509033
100 58473.7617188 75930.625
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net14
Model name for the evaluation phase:  net14
Training model...
# Neural Network with 1577218 learnable parameters

## Layer information

  #    name  size
---  ------  ----------
  0          1x192x128
  1          32x192x128
  2          32x192x128
  3          64x96x64
  4          64x96x64
  5          128x48x32
  6          128x48x32
  7          256x24x16
  8          256x24x16
  9          512x12x8
 10          2x12x8
 11          2
 12          2

BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m1.39800[0m     [32m1.10529[0m    1.26482      0.52565  86.05s
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.50597[0m     1.66079    0.30466      0.54355  107.16s
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.49286[0m     2.01706    0.24434      0.54649  175.77s
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.48244[0m     2.21094    0.21821      0.56901  90.30s
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.47636[0m     2.52149    0.18892      0.55166  91.58s
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.46803[0m     2.61177    0.17920      0.55741  91.12s
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.45736[0m     2.62121    0.17449      0.56643  91.19s
BI_test_bal_complete called with len(X) = 1530
      8     0.46133     2.88134    0.16011      0.55522  91.32s
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.43959[0m     2.85135    0.15417      0.55432  90.96s
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.43309[0m     3.06289    0.14140      0.56205  154.40s
BI_test_bal_complete called with len(X) = 1530
     11     9.76641   927.24669    0.01053      0.49923  253.05s
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 1.105291 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d3' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d3' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 128).
Loaded parameters to layer 'conv2d7' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d7' (shape 256).
Loaded parameters to layer 'conv2d9' (shape 512x256x3x3).
Loaded parameters to layer 'conv2d9' (shape 512).
Loaded parameters to layer 'conv2d10' (shape 2x512x3x3).
Loaded parameters to layer 'conv2d10' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 128)
magnitudes_seizure_val.shape (5, 1, 1406, 128)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.392152359077
Error rate (%):  60.7847640923
[[16222 29948]
 [ 1809  4266]]
(52245,)
(52245,)
roc_auc: 0.617705923092
log_loss: nan
roc_auc for the hours: 0.623684210526
log_loss for the hours: inf
saving predictions to csv file
hourspatient2_2_net14_10-17-04-12-46.csv
Accuracy validation for the hours:  0.395348837209
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 128)
(2286, 1, 234, 128)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [2]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.265401856
saving predictions to csv file
patient2_2_net14_10-17-04-20-45.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config2.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_3']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config2.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_3'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-17 04:20:46.880436
Hostname: kat
gpu3
Configuration 'config2.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 128
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net14
evaluation:
    online_training: False
    model: net14

end Configuration
['patient2_3']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 128)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [3]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.831496192
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 73.9478393555 79.1077156067
20 117.178620911 124.020770264
30 161.910168457 171.346644592
40 217.843582153 231.021990967
50 300.129226685 318.433929443
60 433.378326416 454.739331055
70 649.476623535 666.963128662
80 1045.27531738 1044.89404297
90 2109.42922363 2037.78978271
100 147926.25 114985.820312
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net14
Model name for the evaluation phase:  net14
Training model...
# Neural Network with 1577218 learnable parameters

## Layer information

  #    name  size
---  ------  ----------
  0          1x192x128
  1          32x192x128
  2          32x192x128
  3          64x96x64
  4          64x96x64
  5          128x48x32
  6          128x48x32
  7          256x24x16
  8          256x24x16
  9          512x12x8
 10          2x12x8
 11          2
 12          2

BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m1.59619[0m     [32m0.97659[0m    1.63444      0.59025  253.24s
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.50667[0m     1.26722    0.39983      0.61550  252.34s
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.49019[0m     1.31162    0.37372      0.60792  255.25s
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.48336[0m     1.37391    0.35182      0.60857  172.12s
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.47581[0m     1.49241    0.31882      0.58793  164.58s
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.47029[0m     1.57183    0.29920      0.59070  162.37s
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.45774[0m     1.67428    0.27339      0.58264  212.91s
BI_test_bal_complete called with len(X) = 1530
      8     0.46432     1.47300    0.31522      0.60558  163.72s
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.44477[0m     1.47242    0.30206      0.58901  160.19s
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.42773[0m     1.76946    0.24173      0.60262  103.28s
BI_test_bal_complete called with len(X) = 1530
     11     0.50274     1.64819    0.30503      0.59744  90.06s
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.976593 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d3' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d3' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 128).
Loaded parameters to layer 'conv2d7' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d7' (shape 256).
Loaded parameters to layer 'conv2d9' (shape 512x256x3x3).
Loaded parameters to layer 'conv2d9' (shape 512).
Loaded parameters to layer 'conv2d10' (shape 2x512x3x3).
Loaded parameters to layer 'conv2d10' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 128)
magnitudes_seizure_val.shape (5, 1, 1406, 128)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.49160685233
Error rate (%):  50.839314767
[[21120 25050]
 [ 1511  4564]]
(52245,)
(52245,)
roc_auc: 0.675844216801
log_loss: 2.78296245627
roc_auc for the hours: 0.631578947368
log_loss for the hours: 2.08905788783
saving predictions to csv file
hourspatient2_3_net14_10-17-05-15-14.csv
Accuracy validation for the hours:  0.511627906977
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 128)
(2286, 1, 234, 128)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [3]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.26048256
saving predictions to csv file
patient2_3_net14_10-17-05-21-35.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config2.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_4']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config2.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_4'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-17 05:21:36.848540
Hostname: kat
gpu3
Configuration 'config2.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 128
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net14
evaluation:
    online_training: False
    model: net14

end Configuration
['patient2_4']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 128)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [4]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.831967232
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 53.8905250549 56.9593887329
20 84.9393295288 88.6568161011
30 116.538398743 121.281142426
40 155.554019165 161.72270813
50 212.511123657 220.824333191
60 307.18536377 317.849816895
70 472.61652832 482.689349365
80 798.557971191 796.435998535
90 1650.6019043 1580.72166748
100 44210.6640625 39898.75
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net14
Model name for the evaluation phase:  net14
Training model...
# Neural Network with 1577218 learnable parameters

## Layer information

  #    name  size
---  ------  ----------
  0          1x192x128
  1          32x192x128
  2          32x192x128
  3          64x96x64
  4          64x96x64
  5          128x48x32
  6          128x48x32
  7          256x24x16
  8          256x24x16
  9          512x12x8
 10          2x12x8
 11          2
 12          2

BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m1.05050[0m     [32m0.71642[0m    1.46632      0.62693  253.25s
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.50207[0m     0.72986    0.68790      0.60602  252.51s
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.49577[0m     [32m0.71542[0m    0.69298      0.60885  252.69s
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.48764[0m     0.74626    0.65344      0.63915  251.80s
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.47652[0m     0.75374    0.63221      0.63619  253.44s
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.46072[0m     0.82607    0.55772      0.63203  252.83s
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.45423[0m     0.79563    0.57091      0.64979  203.78s
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.42761[0m     0.93635    0.45667      0.59969  163.56s
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.41945[0m     0.88707    0.47285      0.63083  162.45s
BI_test_bal_complete called with len(X) = 1530
     10     0.43157     0.93477    0.46169      0.63618  188.66s
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.37706[0m     0.97248    0.38773      0.62973  188.25s
BI_test_bal_complete called with len(X) = 1530
     12    23.76203     2.05311   11.57367      0.51023  164.57s
BI_test_bal_complete called with len(X) = 1530
     13     0.53674     0.95729    0.56068      0.58048  163.07s
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.715420 at epoch 3.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d3' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d3' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 128).
Loaded parameters to layer 'conv2d7' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d7' (shape 256).
Loaded parameters to layer 'conv2d9' (shape 512x256x3x3).
Loaded parameters to layer 'conv2d9' (shape 512).
Loaded parameters to layer 'conv2d10' (shape 2x512x3x3).
Loaded parameters to layer 'conv2d10' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 128)
magnitudes_seizure_val.shape (5, 1, 1406, 128)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.627887836157
Error rate (%):  37.2112163843
[[28677 17493]
 [ 1948  4127]]
(52245,)
(52245,)
roc_auc: 0.723926400108
log_loss: nan
roc_auc for the hours: 0.734210526316
log_loss for the hours: nan
saving predictions to csv file
hourspatient2_4_net14_10-17-06-22-17.csv
Accuracy validation for the hours:  0.604651162791
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 128)
(2286, 1, 234, 128)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [4]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.261408256
saving predictions to csv file
patient2_4_net14_10-17-06-29-02.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config2.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_5']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config2.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_5'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-17 06:29:03.664579
Hostname: kat
gpu3
Configuration 'config2.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 128
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net14
evaluation:
    online_training: False
    model: net14

end Configuration
['patient2_5']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 128)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [5]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.831565824
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 50.5105106354 53.4206394196
20 80.372026062 84.0672409058
30 112.33338623 117.278144073
40 155.104562378 162.169955444
50 224.686065674 234.636299133
60 346.247644043 357.99128418
70 561.835333252 571.003186035
80 1013.07503662 999.474804688
90 2254.33178711 2109.65454102
100 67580.4921875 68869.3984375
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net14
Model name for the evaluation phase:  net14
Training model...
# Neural Network with 1577218 learnable parameters

## Layer information

  #    name  size
---  ------  ----------
  0          1x192x128
  1          32x192x128
  2          32x192x128
  3          64x96x64
  4          64x96x64
  5          128x48x32
  6          128x48x32
  7          256x24x16
  8          256x24x16
  9          512x12x8
 10          2x12x8
 11          2
 12          2

BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m1.60539[0m     [32m0.80397[0m    1.99685      0.56645  205.79s
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.54700[0m     0.83502    0.65508      0.58355  178.93s
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.53236[0m     0.88499    0.60154      0.56180  178.65s
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.51694[0m     0.98466    0.52499      0.58977  178.22s
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.50354[0m     1.02844    0.48961      0.57729  193.96s
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.49886[0m     1.21227    0.41151      0.58009  252.00s
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.48657[0m     1.31453    0.37014      0.57903  253.28s
BI_test_bal_complete called with len(X) = 1530
      8     0.49508     1.23395    0.40122      0.58718  253.77s
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.46371[0m     1.36113    0.34068      0.57538  252.24s
BI_test_bal_complete called with len(X) = 1530
     10    71.26363    31.82082    2.23953      0.49680  253.07s
BI_test_bal_complete called with len(X) = 1530
     11     1.44542     1.05198    1.37401      0.58114  252.26s
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.803965 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d3' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d3' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 128).
Loaded parameters to layer 'conv2d7' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d7' (shape 256).
Loaded parameters to layer 'conv2d9' (shape 512x256x3x3).
Loaded parameters to layer 'conv2d9' (shape 512).
Loaded parameters to layer 'conv2d10' (shape 2x512x3x3).
Loaded parameters to layer 'conv2d10' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 128)
magnitudes_seizure_val.shape (5, 1, 1406, 128)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 0 0 0 0 0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.462915111494
Error rate (%):  53.7084888506
[[19832 26338]
 [ 1722  4353]]
(52245,)
(52245,)
roc_auc: 0.623840455429
log_loss: nan
roc_auc for the hours: 0.626315789474
log_loss for the hours: inf
saving predictions to csv file
hourspatient2_5_net14_10-17-07-24-30.csv
Accuracy validation for the hours:  0.488372093023
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 128)
(2286, 1, 234, 128)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [5]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.263751168
saving predictions to csv file
patient2_5_net14_10-17-07-45-25.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config2.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_6']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config2.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_6'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-17 07:45:26.908252
Hostname: kat
gpu3
Configuration 'config2.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 128
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net14
evaluation:
    online_training: False
    model: net14

end Configuration
['patient2_6']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 128)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [6]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.831746048
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 46.6835540771 50.6291244507
20 74.3059432983 79.6663635254
30 103.653249359 111.086800385
40 142.246871948 152.755804443
50 202.532264709 217.227218628
60 304.935296631 323.272631836
70 485.70319519 504.457736206
80 866.502282715 875.242419434
90 1957.78283691 1904.25319824
100 47858.3515625 52179.953125
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net14
Model name for the evaluation phase:  net14
Training model...
# Neural Network with 1577218 learnable parameters

## Layer information

  #    name  size
---  ------  ----------
  0          1x192x128
  1          32x192x128
  2          32x192x128
  3          64x96x64
  4          64x96x64
  5          128x48x32
  6          128x48x32
  7          256x24x16
  8          256x24x16
  9          512x12x8
 10          2x12x8
 11          2
 12          2

BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m1.12887[0m     [32m0.78645[0m    1.43541      0.70225  205.19s
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.52961[0m     0.81549    0.64943      0.65663  252.94s
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.51493[0m     0.84127    0.61209      0.64091  251.75s
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.50251[0m     0.79554    0.63166      0.68533  252.37s
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.48313[0m     [32m0.78000[0m    0.61940      0.65148  252.92s
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.46029[0m     1.00311    0.45886      0.63863  252.35s
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.43350[0m     1.16744    0.37132      0.66105  252.93s
BI_test_bal_complete called with len(X) = 1530
      8     0.43494     0.95531    0.45529      0.67404  252.45s
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.40817[0m     1.12752    0.36201      0.67173  252.50s
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.40478[0m     1.06423    0.38035      0.64444  252.30s
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.38522[0m     1.15339    0.33399      0.69308  253.10s
BI_test_bal_complete called with len(X) = 1530
     12    40.99507     1.43109   28.64602      0.61043  253.55s
BI_test_bal_complete called with len(X) = 1530
     13     0.57616     1.12795    0.51080      0.67146  252.43s
BI_test_bal_complete called with len(X) = 1530
     14     0.51695     1.17841    0.43869      0.63371  253.14s
BI_test_bal_complete called with len(X) = 1530
     15     0.47862     1.22179    0.39173      0.62738  241.34s
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.780003 at epoch 5.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d3' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d3' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 128).
Loaded parameters to layer 'conv2d7' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d7' (shape 256).
Loaded parameters to layer 'conv2d9' (shape 512x256x3x3).
Loaded parameters to layer 'conv2d9' (shape 512).
Loaded parameters to layer 'conv2d10' (shape 2x512x3x3).
Loaded parameters to layer 'conv2d10' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 128)
magnitudes_seizure_val.shape (5, 1, 1406, 128)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 0 1 0 0 0 0 0 1 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.801378122308
Error rate (%):  19.8621877692
[[38406  7764]
 [ 2613  3462]]
(52245,)
(52245,)
roc_auc: 0.732569058168
log_loss: nan
roc_auc for the hours: 0.763157894737
log_loss for the hours: 0.385568495909
saving predictions to csv file
hourspatient2_6_net14_10-17-09-09-24.csv
Accuracy validation for the hours:  0.860465116279
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 128)
(2286, 1, 234, 128)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [6]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.267253248
saving predictions to csv file
patient2_6_net14_10-17-09-20-06.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config2.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_7']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config2.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_7'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-17 09:20:07.993497
Hostname: kat
gpu3
Configuration 'config2.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 128
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net14
evaluation:
    online_training: False
    model: net14

end Configuration
['patient2_7']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 128)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [7]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.831803392
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 53.8414676666 60.5651233673
20 86.1627044678 95.7824203491
30 120.7190979 133.906341553
40 165.665075684 183.587518311
50 233.541290283 258.120880127
60 349.041833496 382.42421875
70 562.258630371 605.826538086
80 994.395043945 1046.11157227
90 1996.38640137 2035.67653809
100 70629.9609375 92128.8515625
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net14
Model name for the evaluation phase:  net14
Training model...
# Neural Network with 1577218 learnable parameters

## Layer information

  #    name  size
---  ------  ----------
  0          1x192x128
  1          32x192x128
  2          32x192x128
  3          64x96x64
  4          64x96x64
  5          128x48x32
  6          128x48x32
  7          256x24x16
  8          256x24x16
  9          512x12x8
 10          2x12x8
 11          2
 12          2

BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m1.19857[0m     [32m0.92365[0m    1.29765      0.65547  251.39s
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.51423[0m     1.09847    0.46813      0.67694  252.30s
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.50383[0m     1.04308    0.48302      0.67111  252.55s
BI_test_bal_complete called with len(X) = 1530
      4     0.52378     1.10364    0.47460      0.64959  252.19s
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.47487[0m     1.09134    0.43512      0.63061  252.99s
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.47019[0m     1.25609    0.37433      0.66522  252.45s
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.44773[0m     1.62299    0.27587      0.62293  252.23s
BI_test_bal_complete called with len(X) = 1530
      8     0.44961     1.62097    0.27737      0.62306  252.27s
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.44651[0m     1.61064    0.27722      0.62164  252.02s
BI_test_bal_complete called with len(X) = 1530
     10   167.95520     3.45646   48.59164      0.65177  252.53s
BI_test_bal_complete called with len(X) = 1530
     11     0.92783     2.26378    0.40986      0.58186  252.57s
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.923649 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d3' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d3' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 128).
Loaded parameters to layer 'conv2d7' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d7' (shape 256).
Loaded parameters to layer 'conv2d9' (shape 512x256x3x3).
Loaded parameters to layer 'conv2d9' (shape 512).
Loaded parameters to layer 'conv2d10' (shape 2x512x3x3).
Loaded parameters to layer 'conv2d10' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 128)
magnitudes_seizure_val.shape (5, 1, 1406, 128)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 0 1 1 1 1 0 1 1 0 1 1 1 1 0 1 0 0 0 0 0 0 0 1 1 0 1 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.855545985262
Error rate (%):  14.4454014738
[[42397  3773]
 [ 3774  2301]]
(52245,)
(52245,)
roc_auc: 0.712486220632
log_loss: 1.17562636034
roc_auc for the hours: 0.707894736842
log_loss for the hours: 0.96087243925
saving predictions to csv file
hourspatient2_7_net14_10-17-10-33-31.csv
Accuracy validation for the hours:  0.883720930233
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 128)
(2286, 1, 234, 128)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [7]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.256906752
saving predictions to csv file
patient2_7_net14_10-17-10-49-45.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config2.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_8']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config2.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_8'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-17 10:49:46.903509
Hostname: kat
gpu3
Configuration 'config2.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 128
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net14
evaluation:
    online_training: False
    model: net14

end Configuration
['patient2_8']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 128)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [8]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.832229376
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 104.470341492 110.22405014
20 164.765213013 172.322763062
30 226.427732849 237.032591248
40 302.335968018 318.307458496
50 412.145629883 437.922180176
60 595.195361328 636.005432129
70 917.606878662 969.877587891
80 1503.48999023 1549.83896484
90 2757.03051758 2757.31674805
100 105201.65625 53464.578125
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net14
Model name for the evaluation phase:  net14
Training model...
# Neural Network with 1577218 learnable parameters

## Layer information

  #    name  size
---  ------  ----------
  0          1x192x128
  1          32x192x128
  2          32x192x128
  3          64x96x64
  4          64x96x64
  5          128x48x32
  6          128x48x32
  7          256x24x16
  8          256x24x16
  9          512x12x8
 10          2x12x8
 11          2
 12          2

BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m1.61615[0m     [32m1.12012[0m    1.44284      0.62776  251.04s
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.49376[0m     1.20453    0.40992      0.65808  252.12s
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.47243[0m     1.19050    0.39683      0.65581  252.40s
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.46059[0m     1.38016    0.33372      0.63719  252.37s
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.45449[0m     1.29099    0.35205      0.64848  253.20s
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.44290[0m     1.29487    0.34204      0.66316  252.74s
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.44071[0m     1.36103    0.32380      0.65702  252.11s
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.42813[0m     1.28925    0.33208      0.65522  253.35s
BI_test_bal_complete called with len(X) = 1530
      9   191.89391    60.84495    3.15382      0.66047  252.11s
BI_test_bal_complete called with len(X) = 1530
     10     5.12508     2.62402    1.95314      0.62038  252.15s
BI_test_bal_complete called with len(X) = 1530
     11     0.87214     1.71838    0.50754      0.63685  252.08s
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 1.120118 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d3' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d3' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 128).
Loaded parameters to layer 'conv2d7' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d7' (shape 256).
Loaded parameters to layer 'conv2d9' (shape 512x256x3x3).
Loaded parameters to layer 'conv2d9' (shape 512).
Loaded parameters to layer 'conv2d10' (shape 2x512x3x3).
Loaded parameters to layer 'conv2d10' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 128)
magnitudes_seizure_val.shape (5, 1, 1406, 128)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.775863719016
Error rate (%):  22.4136280984
[[38313  7857]
 [ 3853  2222]]
(52245,)
(52245,)
roc_auc: 0.6633394674
log_loss: nan
roc_auc for the hours: 0.676315789474
log_loss for the hours: 1.63508162158
saving predictions to csv file
hourspatient2_8_net14_10-17-11-59-33.csv
Accuracy validation for the hours:  0.813953488372
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 128)
(2286, 1, 234, 128)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [8]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.261522944
saving predictions to csv file
patient2_8_net14_10-17-12-06-02.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config2.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_9']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config2.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_9'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-17 12:06:03.562746
Hostname: kat
gpu3
Configuration 'config2.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 128
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net14
evaluation:
    online_training: False
    model: net14

end Configuration
['patient2_9']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 128)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [9]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.831721472
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 94.5260414124 98.892640686
20 150.055514526 155.312359619
30 207.87568512 215.035281372
40 280.099859619 291.699835205
50 384.897079468 405.983901978
60 557.11730957 594.299853516
70 855.337890625 905.796209717
80 1391.65874023 1438.71696777
90 2593.73186035 2592.05053711
100 81443.234375 46753.0546875
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net14
Model name for the evaluation phase:  net14
Training model...
# Neural Network with 1577218 learnable parameters

## Layer information

  #    name  size
---  ------  ----------
  0          1x192x128
  1          32x192x128
  2          32x192x128
  3          64x96x64
  4          64x96x64
  5          128x48x32
  6          128x48x32
  7          256x24x16
  8          256x24x16
  9          512x12x8
 10          2x12x8
 11          2
 12          2

BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m1.42479[0m     [32m0.70932[0m    2.00866      0.52730  134.03s
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.52339[0m     0.90547    0.57803      0.58582  91.45s
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.49816[0m     0.99521    0.50056      0.60647  95.25s
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.47972[0m     1.05471    0.45484      0.62066  140.57s
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.46417[0m     1.02573    0.45253      0.62782  90.87s
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.44761[0m     1.02588    0.43632      0.62915  90.30s
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.43430[0m     1.10283    0.39381      0.61302  145.42s
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.42217[0m     1.02619    0.41139      0.59866  179.86s
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.40937[0m     1.02343    0.40000      0.56154  179.08s
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.40655[0m     1.07347    0.37872      0.55936  179.60s
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.39915[0m     1.04571    0.38170      0.61385  248.33s
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.709322 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d3' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d3' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 128).
Loaded parameters to layer 'conv2d7' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d7' (shape 256).
Loaded parameters to layer 'conv2d9' (shape 512x256x3x3).
Loaded parameters to layer 'conv2d9' (shape 512).
Loaded parameters to layer 'conv2d10' (shape 2x512x3x3).
Loaded parameters to layer 'conv2d10' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 128)
magnitudes_seizure_val.shape (5, 1, 1406, 128)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.581816441765
Error rate (%):  41.8183558235
[[27589 18581]
 [ 3267  2808]]
(52245,)
(52245,)
roc_auc: 0.607916085749
log_loss: nan
roc_auc for the hours: 0.610526315789
log_loss for the hours: 1.17332667862
saving predictions to csv file
hourspatient2_9_net14_10-17-12-48-05.csv
Accuracy validation for the hours:  0.581395348837
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 128)
(2286, 1, 234, 128)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [9]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.261027328
saving predictions to csv file
patient2_9_net14_10-17-12-55-03.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config2.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_10']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config2.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_10'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-17 12:55:04.461504
Hostname: kat
gpu3
Configuration 'config2.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 128
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net14
evaluation:
    online_training: False
    model: net14

end Configuration
['patient2_10']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 128)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [10]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.831299584
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 75.3332519531 81.2151573181
20 118.700306702 126.569920349
30 162.818817139 173.227828979
40 217.206225586 231.249078369
50 296.888366699 316.835205078
60 433.298852539 463.048217773
70 680.237921143 719.890802002
80 1130.87597656 1166.13664551
90 2081.78127441 2081.23837891
100 33467.8828125 31567.0722656
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net14
Model name for the evaluation phase:  net14
Training model...
# Neural Network with 1577218 learnable parameters

## Layer information

  #    name  size
---  ------  ----------
  0          1x192x128
  1          32x192x128
  2          32x192x128
  3          64x96x64
  4          64x96x64
  5          128x48x32
  6          128x48x32
  7          256x24x16
  8          256x24x16
  9          512x12x8
 10          2x12x8
 11          2
 12          2

BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m1.18764[0m     [32m0.84675[0m    1.40258      0.67154  252.30s
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.52783[0m     1.00506    0.52517      0.67519  254.00s
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.51915[0m     1.07148    0.48452      0.67380  181.28s
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.51152[0m     1.26290    0.40504      0.66663  162.91s
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.49626[0m     1.32491    0.37456      0.66873  161.22s
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.47940[0m     1.23034    0.38965      0.67161  199.10s
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.46644[0m     1.21493    0.38393      0.65754  176.44s
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.44326[0m     1.53070    0.28958      0.64623  162.90s
BI_test_bal_complete called with len(X) = 1530
      9     0.45150     1.44016    0.31350      0.64199  120.39s
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.41055[0m     1.42222    0.28867      0.64722  89.41s
BI_test_bal_complete called with len(X) = 1530
     11    49.47280     2.59429   19.06986      0.53791  89.50s
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.846754 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d3' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d3' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 128).
Loaded parameters to layer 'conv2d7' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d7' (shape 256).
Loaded parameters to layer 'conv2d9' (shape 512x256x3x3).
Loaded parameters to layer 'conv2d9' (shape 512).
Loaded parameters to layer 'conv2d10' (shape 2x512x3x3).
Loaded parameters to layer 'conv2d10' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 128)
magnitudes_seizure_val.shape (5, 1, 1406, 128)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.740951287205
Error rate (%):  25.9048712795
[[35218 10952]
 [ 2582  3493]]
(52245,)
(52245,)
roc_auc: 0.687482946812
log_loss: 1.38565368532
roc_auc for the hours: 0.726315789474
log_loss for the hours: 0.801965496646
saving predictions to csv file
hourspatient2_10_net14_10-17-13-52-16.csv
Accuracy validation for the hours:  0.790697674419
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 128)
(2286, 1, 234, 128)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [10]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.2604416
saving predictions to csv file
patient2_10_net14_10-17-13-56-37.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config2.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_11']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config2.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_11'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-17 13:56:38.476191
Hostname: kat
gpu3
Configuration 'config2.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 128
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net14
evaluation:
    online_training: False
    model: net14

end Configuration
['patient2_11']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 128)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [11]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.831991808
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 51.3054489136 55.6420204163
20 81.3750518799 87.2395858765
30 113.01083374 121.061680603
40 154.141616821 165.550292969
50 219.592033386 237.284538269
60 341.341577148 370.306280518
70 574.601940918 617.466394043
80 1030.67565918 1081.14748535
90 2039.71998291 2086.87280273
100 47304.0664062 104914.585938
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net14
Model name for the evaluation phase:  net14
Training model...
# Neural Network with 1577218 learnable parameters

## Layer information

  #    name  size
---  ------  ----------
  0          1x192x128
  1          32x192x128
  2          32x192x128
  3          64x96x64
  4          64x96x64
  5          128x48x32
  6          128x48x32
  7          256x24x16
  8          256x24x16
  9          512x12x8
 10          2x12x8
 11          2
 12          2

BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m1.22490[0m     [32m0.76447[0m    1.60228      0.70400  252.59s
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.49713[0m     1.39189    0.35716      0.59994  251.43s
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.47865[0m     1.32892    0.36018      0.72158  252.50s
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.45804[0m     1.38335    0.33111      0.69959  251.40s
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.44603[0m     1.52278    0.29291      0.70707  252.47s
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.43857[0m     1.40770    0.31155      0.72428  251.92s
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.41827[0m     1.53922    0.27174      0.71798  252.59s
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.40540[0m     1.61029    0.25176      0.67342  252.17s
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.38942[0m     1.79108    0.21742      0.65293  252.58s
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.37807[0m     2.02687    0.18653      0.64960  252.44s
BI_test_bal_complete called with len(X) = 1530
     11    43.70057     3.37041   12.96595      0.63045  251.59s
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.764473 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d3' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d3' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 128).
Loaded parameters to layer 'conv2d7' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d7' (shape 256).
Loaded parameters to layer 'conv2d9' (shape 512x256x3x3).
Loaded parameters to layer 'conv2d9' (shape 512).
Loaded parameters to layer 'conv2d10' (shape 2x512x3x3).
Loaded parameters to layer 'conv2d10' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 128)
magnitudes_seizure_val.shape (5, 1, 1406, 128)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.761565700067
Error rate (%):  23.8434299933
[[36083 10087]
 [ 2370  3705]]
(52245,)
(52245,)
roc_auc: 0.729347139886
log_loss: inf
roc_auc for the hours: 0.742105263158
log_loss for the hours: 0.934726041449
saving predictions to csv file
hourspatient2_11_net14_10-17-15-00-23.csv
Accuracy validation for the hours:  0.744186046512
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 128)
(2286, 1, 234, 128)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [11]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.261203456
saving predictions to csv file
patient2_11_net14_10-17-15-05-38.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config2.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_12']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config2.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_12'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-17 15:05:39.573752
Hostname: kat
gpu3
Configuration 'config2.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 128
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net14
evaluation:
    online_training: False
    model: net14

end Configuration
['patient2_12']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 128)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [12]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.832724992
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 89.815070343 92.5190704346
20 142.1743927 144.644512939
30 195.679580688 198.371836853
40 260.39630127 263.595031738
50 349.26234436 354.147033691
60 485.930328369 495.282232666
70 719.659552002 736.545507812
80 1174.4005127 1193.86479492
90 2252.10444336 2238.52558594
100 68512.453125 43195.7773438
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net14
Model name for the evaluation phase:  net14
Training model...
# Neural Network with 1577218 learnable parameters

## Layer information

  #    name  size
---  ------  ----------
  0          1x192x128
  1          32x192x128
  2          32x192x128
  3          64x96x64
  4          64x96x64
  5          128x48x32
  6          128x48x32
  7          256x24x16
  8          256x24x16
  9          512x12x8
 10          2x12x8
 11          2
 12          2

BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m1.34058[0m     [32m0.82373[0m    1.62744      0.70657  180.01s
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.52425[0m     0.89031    0.58884      0.62695  178.61s
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.50942[0m     0.86258    0.59058      0.62871  206.73s
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.49030[0m     0.84171    0.58251      0.57056  251.62s
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.48104[0m     1.00725    0.47758      0.65778  251.80s
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.46764[0m     0.98503    0.47475      0.61802  251.76s
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.45271[0m     1.22900    0.36836      0.58523  251.91s
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.44033[0m     1.13288    0.38868      0.61251  252.10s
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.43459[0m     1.22640    0.35436      0.62980  251.98s
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.42347[0m     1.10647    0.38272      0.62193  251.86s
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.40640[0m     1.38911    0.29256      0.60827  251.88s
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.823733 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d3' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d3' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 128).
Loaded parameters to layer 'conv2d7' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d7' (shape 256).
Loaded parameters to layer 'conv2d9' (shape 512x256x3x3).
Loaded parameters to layer 'conv2d9' (shape 512).
Loaded parameters to layer 'conv2d10' (shape 2x512x3x3).
Loaded parameters to layer 'conv2d10' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 128)
magnitudes_seizure_val.shape (5, 1, 1406, 128)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 0 1 1 1 1 1 0 1 1 1 1 1 0 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.827026509714
Error rate (%):  17.2973490286
[[40023  6147]
 [ 2890  3185]]
(52245,)
(52245,)
roc_auc: 0.660109889111
log_loss: 1.41117692043
roc_auc for the hours: 0.652631578947
log_loss for the hours: 0.998492436484
saving predictions to csv file
hourspatient2_12_net14_10-17-16-04-22.csv
Accuracy validation for the hours:  0.837209302326
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 128)
(2286, 1, 234, 128)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [12]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.265299456
saving predictions to csv file
patient2_12_net14_10-17-16-09-11.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config2.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_13']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config2.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_13'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-17 16:09:12.839445
Hostname: kat
gpu3
Configuration 'config2.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 128
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net14
evaluation:
    online_training: False
    model: net14

end Configuration
['patient2_13']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 128)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [13]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.833875968
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 91.4584144592 97.6828987122
20 145.273550415 153.626324463
30 201.694824219 213.289866638
40 274.344024658 291.33807373
50 385.909240723 411.417098999
60 578.377355957 617.363317871
70 917.856787109 974.183734131
80 1523.24248047 1585.01259766
90 2789.69897461 2824.19604492
100 35079.8945312 31263.9492188
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net14
Model name for the evaluation phase:  net14
Training model...
# Neural Network with 1577218 learnable parameters

## Layer information

  #    name  size
---  ------  ----------
  0          1x192x128
  1          32x192x128
  2          32x192x128
  3          64x96x64
  4          64x96x64
  5          128x48x32
  6          128x48x32
  7          256x24x16
  8          256x24x16
  9          512x12x8
 10          2x12x8
 11          2
 12          2

BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m1.64334[0m     [32m0.96151[0m    1.70913      0.56110  159.85s
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.51313[0m     1.30997    0.39172      0.49624  202.97s
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.50416[0m     1.08560    0.46440      0.66294  204.98s
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.49383[0m     1.09139    0.45248      0.68182  195.80s
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.48690[0m     1.17700    0.41368      0.71037  216.92s
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.48181[0m     1.06224    0.45358      0.71758  178.35s
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.46375[0m     1.19766    0.38722      0.68409  178.33s
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.46041[0m     1.24116    0.37095      0.70951  178.73s
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.43832[0m     1.21054    0.36208      0.69754  197.38s
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.43538[0m     1.14218    0.38118      0.70803  252.23s
BI_test_bal_complete called with len(X) = 1530
     11     0.45487     1.36526    0.33318      0.67987  251.82s
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.961507 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d3' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d3' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 128).
Loaded parameters to layer 'conv2d7' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d7' (shape 256).
Loaded parameters to layer 'conv2d9' (shape 512x256x3x3).
Loaded parameters to layer 'conv2d9' (shape 512).
Loaded parameters to layer 'conv2d10' (shape 2x512x3x3).
Loaded parameters to layer 'conv2d10' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 128)
magnitudes_seizure_val.shape (5, 1, 1406, 128)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 0 0 0 1 0 1 0 0 0 0 0 1 0 0 0 0 0 0 0 1 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.819255431142
Error rate (%):  18.0744568858
[[42051  4119]
 [ 5324   751]]
(52245,)
(52245,)
roc_auc: 0.676443173422
log_loss: 1.55719814919
roc_auc for the hours: 0.710526315789
log_loss for the hours: 0.720316400604
saving predictions to csv file
hourspatient2_13_net14_10-17-17-02-39.csv
Accuracy validation for the hours:  0.813953488372
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 128)
(2286, 1, 234, 128)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [13]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.269489664
saving predictions to csv file
patient2_13_net14_10-17-17-08-26.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config2.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_14']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config2.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_14'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-17 17:08:28.034179
Hostname: kat
gpu3
Configuration 'config2.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 128
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net14
evaluation:
    online_training: False
    model: net14

end Configuration
['patient2_14']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 128)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [14]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.83427328
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 95.0334648132 99.0529815674
20 148.691171265 153.459811401
30 201.868222046 207.944515991
40 264.841339111 273.128967285
50 352.361907959 364.751953125
60 495.659649658 515.305407715
70 750.989569092 778.9637146
80 1213.7592041 1241.92399902
90 2236.88664551 2222.971875
100 38412.0351562 39300.5585938
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net14
Model name for the evaluation phase:  net14
Training model...
# Neural Network with 1577218 learnable parameters

## Layer information

  #    name  size
---  ------  ----------
  0          1x192x128
  1          32x192x128
  2          32x192x128
  3          64x96x64
  4          64x96x64
  5          128x48x32
  6          128x48x32
  7          256x24x16
  8          256x24x16
  9          512x12x8
 10          2x12x8
 11          2
 12          2

BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m1.27963[0m     [32m1.07720[0m    1.18792      0.54204  222.84s
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.54227[0m     1.33603    0.40588      0.56035  179.81s
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.53660[0m     1.35551    0.39586      0.54887  191.44s
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.52980[0m     1.34426    0.39412      0.54659  161.14s
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.51686[0m     1.46059    0.35387      0.53296  159.90s
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.50926[0m     1.33712    0.38087      0.51680  180.24s
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.49183[0m     1.37952    0.35652      0.50527  252.75s
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.46367[0m     1.53308    0.30244      0.50103  253.16s
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.44897[0m     1.67537    0.26798      0.49566  251.29s
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.42847[0m     1.87808    0.22814      0.50206  251.87s
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.40467[0m     1.81883    0.22249      0.50985  251.92s
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 1.077202 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d3' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d3' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 128).
Loaded parameters to layer 'conv2d7' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d7' (shape 256).
Loaded parameters to layer 'conv2d9' (shape 512x256x3x3).
Loaded parameters to layer 'conv2d9' (shape 512).
Loaded parameters to layer 'conv2d10' (shape 2x512x3x3).
Loaded parameters to layer 'conv2d10' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 128)
magnitudes_seizure_val.shape (5, 1, 1406, 128)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.700947459087
Error rate (%):  29.9052540913
[[34194 11976]
 [ 3648  2427]]
(52245,)
(52245,)
roc_auc: 0.515318874334
log_loss: 2.11005389026
roc_auc for the hours: 0.473684210526
log_loss for the hours: 1.28697720822
saving predictions to csv file
hourspatient2_14_net14_10-17-18-04-15.csv
Accuracy validation for the hours:  0.697674418605
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 128)
(2286, 1, 234, 128)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [14]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.268281344
saving predictions to csv file
patient2_14_net14_10-17-18-10-26.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config2.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_15']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config2.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_15'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-17 18:10:27.353195
Hostname: kat
gpu3
Configuration 'config2.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 128
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net14
evaluation:
    online_training: False
    model: net14

end Configuration
['patient2_15']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 128)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [15]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.84291584
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 64.7141815186 68.8046936035
20 101.843006897 107.078210449
30 139.665863037 146.749235535
40 186.513168335 196.51133728
50 256.336532593 271.545135498
60 380.0765625 405.372619629
70 616.042376709 655.514916992
80 1065.70874023 1113.07155762
90 2028.25013428 2052.23513184
100 28167.1855469 26524.03125
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net14
Model name for the evaluation phase:  net14
Training model...
# Neural Network with 1577218 learnable parameters

## Layer information

  #    name  size
---  ------  ----------
  0          1x192x128
  1          32x192x128
  2          32x192x128
  3          64x96x64
  4          64x96x64
  5          128x48x32
  6          128x48x32
  7          256x24x16
  8          256x24x16
  9          512x12x8
 10          2x12x8
 11          2
 12          2

