['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run4.pickle', '--config-filename=config7.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_0']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config7.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run4.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient2_0'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-03 10:51:15.567662
Hostname: kat
gpu2
Configuration 'config7.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net16
evaluation:
    online_training: False
    model: net16

end Configuration
['patient2_0']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [0]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.744329216
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 367.479559326 395.117904663
20 582.979382324 615.201062012
30 795.170080566 830.338665771
40 1032.00554199 1067.2041748
50 1317.6385498 1346.52661133
60 1685.20253906 1697.71447754
70 2197.84929199 2175.63908691
80 3011.64487305 2914.53989258
90 4710.7300293 4431.95449219
100 63321.7421875 58944.8007812
no_normal 191
no_seizure 25
no_samples_normal_ph 25
no_samples_seizure_ph 191
size 9550
no_normal 191
no_seizure 25
no_samples_normal_ph 25
no_samples_seizure_ph 191
Histogram:
[4775 4775]
magnitudes.shape (9550,)
labels.shape (9550,)
Ratio validation: 0.2
xVal.shape (1910,)
yVal.shape (1910,)
xTrain.shape (7640,)
yTrain.shape (7640,)
xVal.shape (1910, 2)
yVal.shape (1910,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net16
Model name for the evaluation phase:  net16
Training model...
# Neural Network with 459778 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x129x64
  2          32x129x64
  3          32x195x67
  4          32x195x67
  5          64x98x34
  6          64x98x34
  7          128x49x17
  8          128x49x17
  9          256x25x9
 10          256x25x9
 11          2x25x9
 12          2
 13          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m4.67665[0m     [32m0.64290[0m    7.27435      0.60864  20.80s
      2     [36m0.57179[0m     [32m0.64124[0m    0.89169      0.59424  20.86s
      3     [36m0.55422[0m     [32m0.61732[0m    0.89777      0.61846  21.03s
      4     [36m0.54146[0m     0.63099    0.85812      0.61518  21.19s
      5     0.54546     [32m0.61053[0m    0.89343      0.66885  21.81s
      6     [36m0.52348[0m     0.63473    0.82472      0.68586  22.63s
      7     0.52813     0.66208    0.79768      0.68652  22.92s
      8     [36m0.52194[0m     0.64510    0.80909      0.66230  22.93s
      9     [36m0.51941[0m     0.66974    0.77553      0.68521  23.12s
     10     [36m0.51263[0m     0.65531    0.78228      0.65510  23.35s
     11     [36m0.50466[0m     0.68592    0.73573      0.65969  23.07s
     12     [36m0.50167[0m     0.76598    0.65493      0.66427  23.10s
     13     [36m0.48949[0m     0.77327    0.63301      0.65510  23.35s
     14     [36m0.47904[0m     0.74218    0.64545      0.64005  23.25s
     15     [36m0.46010[0m     0.74985    0.61359      0.60929  23.19s
Early stopping.
Best valid loss was 0.610526 at epoch 5.
Loaded parameters to layer 'conv2d1' (shape 32x1x64x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d3' (shape 32x32x1x64).
Loaded parameters to layer 'conv2d3' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d7' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d7' (shape 128).
Loaded parameters to layer 'conv2d9' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d9' (shape 256).
Loaded parameters to layer 'conv2d11' (shape 2x256x3x3).
Loaded parameters to layer 'conv2d11' (shape 2).
Saving model...
Validating...
probabilities.shape (1910, 2)
Showing last 30 test samples..
Predictions:
[1 0 1 1 1 0 1 1 1 0 0 0 1 1 0 0 1 0 1 1 1 1 0 0 1 1 1 0 1 1]
Ground Truth:
[1 0 0 0 0 1 0 1 1 0 1 0 0 1 0 1 0 1 1 1 0 1 1 0 1 1 0 0 1 1]
Performance on relevant data
Accuracy validation:  0.652879581152
Error rate (%):  34.7120418848
yVal [1 0 1 ..., 0 1 1]
[[574 406]
 [257 673]]
roc_auc: 0.722609172701
log_loss 0.637583241353
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[ 0.99463832  0.00536297]
[ 0.1881579   0.81184179]
[ 0.47734606  0.52265412]
[  7.80321670e-07   9.99999523e-01]
[ 0.06021213  0.93978959]
roc_auc for the hours: 0.742105263158
log_loss for the hours 1.3022806906
saving predictions to csv file
hourspatient2_0_net16_10-03-11-02-15.csv
Accuracy validation for the hours:  0.720930232558
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [0]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.034469376
saving predictions to csv file
patient2_0_net16_10-03-11-06-46.csv
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run4.pickle', '--config-filename=config7.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_1']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config7.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run4.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient2_1'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-03 11:06:47.829774
Hostname: kat
gpu2
Configuration 'config7.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net16
evaluation:
    online_training: False
    model: net16

end Configuration
['patient2_1']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [1]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.743911424
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 263.661355591 284.954690552
20 416.892218018 440.678961182
30 568.269549561 590.942108154
40 738.6140625 756.022766113
50 948.0390625 954.364257812
60 1230.36213379 1214.27253418
70 1653.89840088 1589.50096436
80 2395.20083008 2220.65932617
90 4170.49838867 3672.37075195
100 56617.8046875 55581.1640625
no_normal 191
no_seizure 25
no_samples_normal_ph 25
no_samples_seizure_ph 191
size 9550
no_normal 191
no_seizure 25
no_samples_normal_ph 25
no_samples_seizure_ph 191
Histogram:
[4775 4775]
magnitudes.shape (9550,)
labels.shape (9550,)
Ratio validation: 0.2
xVal.shape (1910,)
yVal.shape (1910,)
xTrain.shape (7640,)
yTrain.shape (7640,)
xVal.shape (1910, 2)
yVal.shape (1910,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net16
Model name for the evaluation phase:  net16
Training model...
# Neural Network with 459778 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x129x64
  2          32x129x64
  3          32x195x67
  4          32x195x67
  5          64x98x34
  6          64x98x34
  7          128x49x17
  8          128x49x17
  9          256x25x9
 10          256x25x9
 11          2x25x9
 12          2
 13          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m2.75963[0m     [32m0.69444[0m    3.97390      0.58573  21.27s
      2     [36m0.54664[0m     0.75927    0.71995      0.57723  21.64s
      3     [36m0.54652[0m     0.81076    0.67409      0.53534  22.55s
      4     [36m0.53041[0m     0.85269    0.62204      0.51505  23.39s
      5     0.53967     0.80718    0.66858      0.54908  23.44s
      6     [36m0.52076[0m     0.80823    0.64432      0.58835  23.23s
      7     [36m0.51323[0m     0.89361    0.57433      0.53076  23.34s
      8     [36m0.51230[0m     0.82762    0.61901      0.58312  23.27s
      9     0.51290     0.89122    0.57550      0.57592  23.11s
     10     [36m0.50411[0m     0.81345    0.61972      0.59555  22.97s
     11     [36m0.48678[0m     0.86718    0.56134      0.59097  23.21s
Early stopping.
Best valid loss was 0.694438 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x64x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d3' (shape 32x32x1x64).
Loaded parameters to layer 'conv2d3' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d7' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d7' (shape 128).
Loaded parameters to layer 'conv2d9' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d9' (shape 256).
Loaded parameters to layer 'conv2d11' (shape 2x256x3x3).
Loaded parameters to layer 'conv2d11' (shape 2).
Saving model...
Validating...
probabilities.shape (1910, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 0 1 1 1 1 0 0 0 1 1 0 0 1 0 1 1 1 1 0 0 1 1 1 0 1 1]
Ground Truth:
[1 0 0 0 0 1 0 1 1 0 1 0 0 1 0 1 0 1 1 1 0 1 1 0 1 1 0 0 1 1]
Performance on relevant data
Accuracy validation:  0.583769633508
Error rate (%):  41.6230366492
yVal [1 0 1 ..., 0 1 1]
[[453 527]
 [268 662]]
roc_auc: 0.606381391266
log_loss 0.694634252412
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[ 0.80886775  0.19113338]
[ 0.11727186  0.88272828]
[ 0.46628127  0.53371871]
[ 0.06775209  0.93224698]
[ 0.33362404  0.66637558]
roc_auc for the hours: 0.610526315789
log_loss for the hours 1.07792519402
saving predictions to csv file
hourspatient2_1_net16_10-03-11-15-26.csv
Accuracy validation for the hours:  0.488372093023
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [1]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.03868416
saving predictions to csv file
patient2_1_net16_10-03-11-20-14.csv
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run4.pickle', '--config-filename=config7.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_2']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config7.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run4.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient2_2'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-03 11:20:15.310542
Hostname: kat
gpu2
Configuration 'config7.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net16
evaluation:
    online_training: False
    model: net16

end Configuration
['patient2_2']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [2]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.745304064
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 209.986540222 225.906962585
20 329.095306396 346.162701416
30 444.230593872 460.11050415
40 570.524414062 582.58815918
50 722.16116333 726.961212158
60 921.348901367 911.623071289
70 1211.68074951 1175.55042725
80 1700.91003418 1611.25981445
90 2771.39865723 2552.46484375
100 58473.7617188 75930.625
no_normal 191
no_seizure 25
no_samples_normal_ph 25
no_samples_seizure_ph 191
size 9550
no_normal 191
no_seizure 25
no_samples_normal_ph 25
no_samples_seizure_ph 191
Histogram:
[4775 4775]
magnitudes.shape (9550,)
labels.shape (9550,)
Ratio validation: 0.2
xVal.shape (1910,)
yVal.shape (1910,)
xTrain.shape (7640,)
yTrain.shape (7640,)
xVal.shape (1910, 2)
yVal.shape (1910,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net16
Model name for the evaluation phase:  net16
Training model...
# Neural Network with 459778 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x129x64
  2          32x129x64
  3          32x195x67
  4          32x195x67
  5          64x98x34
  6          64x98x34
  7          128x49x17
  8          128x49x17
  9          256x25x9
 10          256x25x9
 11          2x25x9
 12          2
 13          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m2.62544[0m     [32m0.66366[0m    3.95601      0.59817  21.45s
      2     [36m0.53795[0m     0.74535    0.72174      0.55694  21.72s
      3     [36m0.52357[0m     0.73633    0.71106      0.63089  22.85s
      4     [36m0.50916[0m     0.79750    0.63844      0.61453  23.45s
      5     0.51918     0.77447    0.67037      0.60013  23.24s
      6     [36m0.49121[0m     0.79128    0.62078      0.58050  23.48s
      7     [36m0.48901[0m     0.84934    0.57575      0.56806  23.27s
      8     [36m0.47928[0m     0.91777    0.52222      0.57723  23.31s
      9     [36m0.47546[0m     0.93624    0.50785      0.55825  23.08s
     10     [36m0.46086[0m     0.88880    0.51851      0.55563  23.07s
     11     [36m0.45499[0m     0.97255    0.46783      0.58442  23.15s
Early stopping.
Best valid loss was 0.663660 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x64x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d3' (shape 32x32x1x64).
Loaded parameters to layer 'conv2d3' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d7' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d7' (shape 128).
Loaded parameters to layer 'conv2d9' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d9' (shape 256).
Loaded parameters to layer 'conv2d11' (shape 2x256x3x3).
Loaded parameters to layer 'conv2d11' (shape 2).
Saving model...
Validating...
probabilities.shape (1910, 2)
Showing last 30 test samples..
Predictions:
[1 0 0 0 0 0 1 1 1 0 0 0 0 1 0 0 0 0 1 1 1 1 0 0 1 1 1 0 1 1]
Ground Truth:
[1 0 0 0 0 1 0 1 1 0 1 0 0 1 0 1 0 1 1 1 0 1 1 0 1 1 0 0 1 1]
Performance on relevant data
Accuracy validation:  0.594240837696
Error rate (%):  40.5759162304
yVal [1 0 1 ..., 0 1 1]
[[579 401]
 [374 556]]
roc_auc: 0.623107856046
log_loss 0.671941579933
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[ 0.98556304  0.01443744]
[ 0.02447033  0.97552967]
[ 0.85677075  0.1432295 ]
[ 0.03989     0.96011025]
[ 0.00268468  0.99731576]
roc_auc for the hours: 0.642105263158
log_loss for the hours 1.2178292917
saving predictions to csv file
hourspatient2_2_net16_10-03-11-28-08.csv
Accuracy validation for the hours:  0.604651162791
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [2]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.040781312
saving predictions to csv file
patient2_2_net16_10-03-11-32-36.csv
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run4.pickle', '--config-filename=config7.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_3']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config7.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run4.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient2_3'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-03 11:32:37.584449
Hostname: kat
gpu2
Configuration 'config7.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net16
evaluation:
    online_training: False
    model: net16

end Configuration
['patient2_3']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [3]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.744845312
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 232.146871948 248.098060608
20 362.633648682 379.823339844
30 488.15196228 505.159686279
40 627.292626953 642.350366211
50 799.678375244 809.175415039
60 1039.14638672 1037.57441406
70 1420.94019775 1395.75299072
80 2108.71582031 2036.62312012
90 3569.3847168 3399.96303711
100 147926.25 114985.820312
no_normal 191
no_seizure 25
no_samples_normal_ph 25
no_samples_seizure_ph 191
size 9550
no_normal 191
no_seizure 25
no_samples_normal_ph 25
no_samples_seizure_ph 191
Histogram:
[4775 4775]
magnitudes.shape (9550,)
labels.shape (9550,)
Ratio validation: 0.2
xVal.shape (1910,)
yVal.shape (1910,)
xTrain.shape (7640,)
yTrain.shape (7640,)
xVal.shape (1910, 2)
yVal.shape (1910,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net16
Model name for the evaluation phase:  net16
Training model...
# Neural Network with 459778 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x129x64
  2          32x129x64
  3          32x195x67
  4          32x195x67
  5          64x98x34
  6          64x98x34
  7          128x49x17
  8          128x49x17
  9          256x25x9
 10          256x25x9
 11          2x25x9
 12          2
 13          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m2.50486[0m     [32m0.72365[0m    3.46142      0.46401  21.60s
      2     [36m0.56810[0m     0.80649    0.70440      0.55497  21.51s
      3     [36m0.54223[0m     0.81803    0.66285      0.56806  22.50s
      4     [36m0.52247[0m     0.79593    0.65643      0.56741  22.98s
      5     [36m0.51091[0m     0.83211    0.61400      0.60602  23.13s
      6     [36m0.50135[0m     0.87984    0.56981      0.58508  23.32s
      7     [36m0.48480[0m     0.95563    0.50731      0.61060  23.20s
      8     [36m0.47098[0m     1.02898    0.45772      0.60668  23.16s
      9     0.47678     0.94386    0.50514      0.57919  23.30s
     10     [36m0.45072[0m     0.90784    0.49648      0.56021  23.11s
     11     0.46198     1.00241    0.46086      0.58442  23.36s
Early stopping.
Best valid loss was 0.723652 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x64x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d3' (shape 32x32x1x64).
Loaded parameters to layer 'conv2d3' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d7' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d7' (shape 128).
Loaded parameters to layer 'conv2d9' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d9' (shape 256).
Loaded parameters to layer 'conv2d11' (shape 2x256x3x3).
Loaded parameters to layer 'conv2d11' (shape 2).
Saving model...
Validating...
probabilities.shape (1910, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 0 0 0 1 0 0 0 0 0 0 1 0 0 1 0 1 1 1 0 0 1 0 1 0 0 1 1]
Ground Truth:
[1 0 0 0 0 1 0 1 1 0 1 0 0 1 0 1 0 1 1 1 0 1 1 0 1 1 0 0 1 1]
Performance on relevant data
Accuracy validation:  0.460732984293
Error rate (%):  53.9267015707
yVal [1 0 1 ..., 0 1 1]
[[555 425]
 [605 325]]
roc_auc: 0.524122229537
log_loss 0.72034433344
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[  9.99553621e-01   4.48569510e-04]
[  5.50500816e-04   9.99449849e-01]
[ 0.81174088  0.18825972]
[ 0.51365739  0.48634264]
[ 0.81516105  0.1848387 ]
roc_auc for the hours: 0.526315789474
log_loss for the hours 1.01455967351
saving predictions to csv file
hourspatient2_3_net16_10-03-11-40-47.csv
Accuracy validation for the hours:  0.53488372093
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [3]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.040351232
saving predictions to csv file
patient2_3_net16_10-03-11-45-20.csv
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run4.pickle', '--config-filename=config7.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_4']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config7.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run4.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient2_4'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-03 11:45:21.653481
Hostname: kat
gpu2
Configuration 'config7.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net16
evaluation:
    online_training: False
    model: net16

end Configuration
['patient2_4']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [4]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.744587264
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 165.436743164 175.107310486
20 259.898529053 270.363952637
30 352.872415161 363.763861084
40 459.585931396 469.051629639
50 596.801239014 602.84375
60 794.120068359 791.004992676
70 1106.86796875 1082.3704834
80 1648.70195313 1577.21459961
90 2803.05773926 2610.05686035
100 44210.6640625 39898.75
no_normal 191
no_seizure 25
no_samples_normal_ph 25
no_samples_seizure_ph 191
size 9550
no_normal 191
no_seizure 25
no_samples_normal_ph 25
no_samples_seizure_ph 191
Histogram:
[4775 4775]
magnitudes.shape (9550,)
labels.shape (9550,)
Ratio validation: 0.2
xVal.shape (1910,)
yVal.shape (1910,)
xTrain.shape (7640,)
yTrain.shape (7640,)
xVal.shape (1910, 2)
yVal.shape (1910,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net16
Model name for the evaluation phase:  net16
Training model...
# Neural Network with 459778 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x129x64
  2          32x129x64
  3          32x195x67
  4          32x195x67
  5          64x98x34
  6          64x98x34
  7          128x49x17
  8          128x49x17
  9          256x25x9
 10          256x25x9
 11          2x25x9
 12          2
 13          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m2.55824[0m     [32m0.68107[0m    3.75621      0.49476  21.42s
      2     [36m0.58988[0m     [32m0.67862[0m    0.86924      0.59948  21.58s
      3     [36m0.54599[0m     [32m0.63753[0m    0.85642      0.64202  22.98s
      4     [36m0.51421[0m     0.67016    0.76729      0.64791  23.27s
      5     [36m0.51021[0m     0.66017    0.77285      0.68128  23.10s
      6     [36m0.47536[0m     0.75674    0.62817      0.71990  23.08s
      7     [36m0.46077[0m     0.81096    0.56819      0.72317  23.05s
      8     0.46421     0.73372    0.63268      0.69961  23.25s
      9     0.46750     0.73898    0.63264      0.69568  23.26s
     10     [36m0.44475[0m     0.71930    0.61831      0.68521  23.21s
     11     [36m0.43724[0m     0.90035    0.48564      0.67670  23.27s
     12     [36m0.41440[0m     0.91762    0.45161      0.69110  23.22s
     13     [36m0.39156[0m     0.98079    0.39923      0.68128  23.24s
Early stopping.
Best valid loss was 0.637529 at epoch 3.
Loaded parameters to layer 'conv2d1' (shape 32x1x64x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d3' (shape 32x32x1x64).
Loaded parameters to layer 'conv2d3' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d7' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d7' (shape 128).
Loaded parameters to layer 'conv2d9' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d9' (shape 256).
Loaded parameters to layer 'conv2d11' (shape 2x256x3x3).
Loaded parameters to layer 'conv2d11' (shape 2).
Saving model...
Validating...
probabilities.shape (1910, 2)
Showing last 30 test samples..
Predictions:
[1 0 1 1 0 0 0 1 0 0 0 0 1 1 0 0 0 0 0 1 0 0 0 0 1 1 1 0 1 1]
Ground Truth:
[1 0 0 0 0 1 0 1 1 0 1 0 0 1 0 1 0 1 1 1 0 1 1 0 1 1 0 0 1 1]
Performance on relevant data
Accuracy validation:  0.635078534031
Error rate (%):  36.4921465969
yVal [1 0 1 ..., 0 1 1]
[[674 306]
 [391 539]]
roc_auc: 0.708373930217
log_loss 0.636583712388
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[ 0.97670507  0.02329528]
[ 0.1262235   0.87377566]
[ 0.91324139  0.0867587 ]
[ 0.14769404  0.85230607]
[ 0.34285387  0.65714568]
roc_auc for the hours: 0.757894736842
log_loss for the hours 0.494764858886
saving predictions to csv file
hourspatient2_4_net16_10-03-11-54-11.csv
Accuracy validation for the hours:  0.744186046512
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [4]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.043603456
saving predictions to csv file
patient2_4_net16_10-03-11-58-41.csv
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run4.pickle', '--config-filename=config7.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_5']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config7.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run4.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient2_5'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-03 11:58:42.381010
Hostname: kat
gpu2
Configuration 'config7.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net16
evaluation:
    online_training: False
    model: net16

end Configuration
['patient2_5']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [5]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.744554496
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 185.196789551 197.613002014
20 294.801989746 307.815057373
30 407.290542603 420.04319458
40 542.552478027 552.726599121
50 726.239715576 729.61151123
60 1003.9644165 990.04107666
70 1455.43812256 1400.85588379
80 2251.58901367 2106.12675781
90 4066.22578125 3684.91796875
100 67580.4921875 68869.3984375
no_normal 191
no_seizure 25
no_samples_normal_ph 25
no_samples_seizure_ph 191
size 9550
no_normal 191
no_seizure 25
no_samples_normal_ph 25
no_samples_seizure_ph 191
Histogram:
[4775 4775]
magnitudes.shape (9550,)
labels.shape (9550,)
Ratio validation: 0.2
xVal.shape (1910,)
yVal.shape (1910,)
xTrain.shape (7640,)
yTrain.shape (7640,)
xVal.shape (1910, 2)
yVal.shape (1910,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net16
Model name for the evaluation phase:  net16
Training model...
# Neural Network with 459778 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x129x64
  2          32x129x64
  3          32x195x67
  4          32x195x67
  5          64x98x34
  6          64x98x34
  7          128x49x17
  8          128x49x17
  9          256x25x9
 10          256x25x9
 11          2x25x9
 12          2
 13          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m3.28735[0m     [32m0.65713[0m    5.00259      0.62304  20.98s
      2     [36m0.57286[0m     0.66349    0.86341      0.62173  21.18s
      3     [36m0.54154[0m     0.66382    0.81578      0.61453  22.00s
      4     [36m0.53120[0m     0.69599    0.76322      0.59293  22.73s
      5     [36m0.53054[0m     0.66811    0.79409      0.61911  22.96s
      6     [36m0.51443[0m     0.66827    0.76979      0.62107  22.97s
      7     [36m0.50603[0m     0.71801    0.70477      0.58442  23.06s
      8     [36m0.50166[0m     0.70059    0.71606      0.61126  23.08s
      9     0.50224     0.77380    0.64906      0.60471  22.96s
     10     [36m0.48422[0m     0.76243    0.63510      0.60668  23.00s
     11     [36m0.47218[0m     0.83697    0.56415      0.59948  23.14s
Early stopping.
Best valid loss was 0.657129 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x64x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d3' (shape 32x32x1x64).
Loaded parameters to layer 'conv2d3' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d7' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d7' (shape 128).
Loaded parameters to layer 'conv2d9' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d9' (shape 256).
Loaded parameters to layer 'conv2d11' (shape 2x256x3x3).
Loaded parameters to layer 'conv2d11' (shape 2).
Saving model...
Validating...
probabilities.shape (1910, 2)
Showing last 30 test samples..
Predictions:
[0 1 0 1 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 1 0 0 0 1 0]
Ground Truth:
[1 0 0 0 0 1 0 1 1 0 1 0 0 1 0 1 0 1 1 1 0 1 1 0 1 1 0 0 1 1]
Performance on relevant data
Accuracy validation:  0.61780104712
Error rate (%):  38.219895288
yVal [1 0 1 ..., 0 1 1]
[[738 242]
 [488 442]]
roc_auc: 0.649681808207
log_loss 0.660442058414
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[ 0.89089495  0.10910507]
[ 0.56243908  0.43756074]
[ 0.4507395   0.54926074]
[ 0.40149269  0.59850705]
[ 0.62136614  0.37863341]
roc_auc for the hours: 0.694736842105
log_loss for the hours 0.491766725248
saving predictions to csv file
hourspatient2_5_net16_10-03-12-07-08.csv
Accuracy validation for the hours:  0.744186046512
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [5]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.0395648
saving predictions to csv file
patient2_5_net16_10-03-12-11-35.csv
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run4.pickle', '--config-filename=config7.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_6']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config7.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run4.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient2_6'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-03 12:11:36.256716
Hostname: kat
gpu2
Configuration 'config7.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net16
evaluation:
    online_training: False
    model: net16

end Configuration
['patient2_6']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [6]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.74401792
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 163.101298523 175.881399536
20 258.470428467 274.155731201
30 355.682626343 373.270678711
40 471.085089111 488.984100342
50 626.310150146 642.409729004
60 861.122949219 869.392102051
70 1253.91723633 1241.61234131
80 1956.83286133 1902.809375
90 3422.80100098 3262.08793945
100 47858.3515625 52179.953125
no_normal 191
no_seizure 25
no_samples_normal_ph 25
no_samples_seizure_ph 191
size 9550
no_normal 191
no_seizure 25
no_samples_normal_ph 25
no_samples_seizure_ph 191
Histogram:
[4775 4775]
magnitudes.shape (9550,)
labels.shape (9550,)
Ratio validation: 0.2
xVal.shape (1910,)
yVal.shape (1910,)
xTrain.shape (7640,)
yTrain.shape (7640,)
xVal.shape (1910, 2)
yVal.shape (1910,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net16
Model name for the evaluation phase:  net16
Training model...
# Neural Network with 459778 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x129x64
  2          32x129x64
  3          32x195x67
  4          32x195x67
  5          64x98x34
  6          64x98x34
  7          128x49x17
  8          128x49x17
  9          256x25x9
 10          256x25x9
 11          2x25x9
 12          2
 13          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m2.85001[0m     [32m0.66002[0m    4.31810      0.60602  21.26s
      2     [36m0.59482[0m     0.69815    0.85199      0.53730  21.74s
      3     [36m0.55900[0m     [32m0.63530[0m    0.87990      0.71466  22.52s
      4     [36m0.53022[0m     0.64626    0.82044      0.61649  23.18s
      5     0.54067     [32m0.63342[0m    0.85358      0.61715  23.15s
      6     [36m0.51750[0m     0.65544    0.78954      0.69306  23.30s
      7     [36m0.49778[0m     0.70734    0.70373      0.69764  23.11s
      8     [36m0.49711[0m     0.66159    0.75138      0.67539  23.21s
      9     [36m0.48890[0m     0.68744    0.71119      0.64398  23.16s
     10     0.49408     0.67335    0.73376      0.70419  23.19s
     11     [36m0.46043[0m     0.72024    0.63928      0.68063  23.31s
     12     [36m0.45222[0m     0.80808    0.55963      0.71073  23.29s
     13     [36m0.45076[0m     0.77966    0.57815      0.68128  23.20s
     14     [36m0.39252[0m     0.73262    0.53577      0.67997  23.28s
     15     0.39588     0.81716    0.48446      0.65903  23.25s
Early stopping.
Best valid loss was 0.633419 at epoch 5.
Loaded parameters to layer 'conv2d1' (shape 32x1x64x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d3' (shape 32x32x1x64).
Loaded parameters to layer 'conv2d3' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d7' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d7' (shape 128).
Loaded parameters to layer 'conv2d9' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d9' (shape 256).
Loaded parameters to layer 'conv2d11' (shape 2x256x3x3).
Loaded parameters to layer 'conv2d11' (shape 2).
Saving model...
Validating...
probabilities.shape (1910, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 0 1 1 1 0 0 0 0 1 0 0 1 0 1 1 1 1 0 0 1 1 1 0 1 1]
Ground Truth:
[1 0 0 0 0 1 0 1 1 0 1 0 0 1 0 1 0 1 1 1 0 1 1 0 1 1 0 0 1 1]
Performance on relevant data
Accuracy validation:  0.601047120419
Error rate (%):  39.8952879581
yVal [1 0 1 ..., 0 1 1]
[[417 563]
 [199 731]]
roc_auc: 0.729156243142
log_loss 0.656351205957
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[ 0.98849565  0.01150583]
[ 0.07275555  0.9272449 ]
[ 0.11810711  0.88189411]
[ 0.00888731  0.99111331]
[ 0.01375838  0.98624223]
roc_auc for the hours: 0.784210526316
log_loss for the hours 0.994264209825
saving predictions to csv file
hourspatient2_6_net16_10-03-12-21-18.csv
Accuracy validation for the hours:  0.581395348837
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [6]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.035472896
saving predictions to csv file
patient2_6_net16_10-03-12-26-16.csv
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run4.pickle', '--config-filename=config7.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_7']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config7.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run4.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient2_7'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-03 12:26:17.191906
Hostname: kat
gpu2
Configuration 'config7.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net16
evaluation:
    online_training: False
    model: net16

end Configuration
['patient2_7']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [7]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.745058304
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 177.49072113 198.887155151
20 286.226177979 314.740679932
30 400.515246582 436.170880127
40 540.098596191 582.037194824
50 725.995513916 773.688720703
60 988.882971191 1040.23283691
70 1379.6152832 1428.96156006
80 1995.99584961 2035.20236816
90 3121.08054199 3130.02658691
100 70629.9609375 92128.8515625
no_normal 191
no_seizure 25
no_samples_normal_ph 25
no_samples_seizure_ph 191
size 9550
no_normal 191
no_seizure 25
no_samples_normal_ph 25
no_samples_seizure_ph 191
Histogram:
[4775 4775]
magnitudes.shape (9550,)
labels.shape (9550,)
Ratio validation: 0.2
xVal.shape (1910,)
yVal.shape (1910,)
xTrain.shape (7640,)
yTrain.shape (7640,)
xVal.shape (1910, 2)
yVal.shape (1910,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net16
Model name for the evaluation phase:  net16
Training model...
# Neural Network with 459778 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x129x64
  2          32x129x64
  3          32x195x67
  4          32x195x67
  5          64x98x34
  6          64x98x34
  7          128x49x17
  8          128x49x17
  9          256x25x9
 10          256x25x9
 11          2x25x9
 12          2
 13          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m3.05257[0m     [32m0.68235[0m    4.47362      0.54188  23.58s
      2     [36m0.57235[0m     0.71705    0.79820      0.56610  23.46s
      3     0.57328     [32m0.67262[0m    0.85232      0.65510  23.67s
      4     [36m0.53100[0m     0.71405    0.74364      0.62435  23.58s
      5     [36m0.52574[0m     0.67876    0.77457      0.64856  23.67s
      6     [36m0.52092[0m     [32m0.67125[0m    0.77606      0.64791  23.71s
      7     [36m0.49784[0m     0.73438    0.67791      0.65772  23.44s
      8     [36m0.49748[0m     0.74647    0.66644      0.67212  23.55s
      9     [36m0.47634[0m     0.77037    0.61832      0.61126  23.25s
     10     0.48652     0.73677    0.66034      0.65052  23.30s
     11     [36m0.45742[0m     0.76495    0.59797      0.62173  23.26s
     12     [36m0.45335[0m     0.81024    0.55953      0.60275  23.16s
     13     0.46900     0.94363    0.49701      0.60471  23.43s
     14     [36m0.41968[0m     0.85629    0.49012      0.62369  23.19s
     15     [36m0.40459[0m     0.93276    0.43375      0.60602  23.30s
     16     [36m0.37569[0m     0.89505    0.41974      0.60798  23.13s
Early stopping.
Best valid loss was 0.671245 at epoch 6.
Loaded parameters to layer 'conv2d1' (shape 32x1x64x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d3' (shape 32x32x1x64).
Loaded parameters to layer 'conv2d3' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d7' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d7' (shape 128).
Loaded parameters to layer 'conv2d9' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d9' (shape 256).
Loaded parameters to layer 'conv2d11' (shape 2x256x3x3).
Loaded parameters to layer 'conv2d11' (shape 2).
Saving model...
Validating...
probabilities.shape (1910, 2)
Showing last 30 test samples..
Predictions:
[1 0 1 1 0 0 1 1 1 0 0 0 0 1 0 0 0 0 1 1 0 1 0 0 1 1 1 0 1 1]
Ground Truth:
[1 0 0 0 0 1 0 1 1 0 1 0 0 1 0 1 0 1 1 1 0 1 1 0 1 1 0 0 1 1]
Performance on relevant data
Accuracy validation:  0.632460732984
Error rate (%):  36.7539267016
yVal [1 0 1 ..., 0 1 1]
[[581 399]
 [303 627]]
roc_auc: 0.687825323678
log_loss 0.679253402709
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[  9.99979496e-01   2.23735951e-05]
[ 0.25214025  0.74785912]
[ 0.54114079  0.45885918]
[ 0.02982946  0.97017062]
[ 0.02585165  0.97414881]
roc_auc for the hours: 0.731578947368
log_loss for the hours 0.899516223885
saving predictions to csv file
hourspatient2_7_net16_10-03-12-38-41.csv
Accuracy validation for the hours:  0.627906976744
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [7]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.035108352
saving predictions to csv file
patient2_7_net16_10-03-12-43-20.csv
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run4.pickle', '--config-filename=config7.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_8']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config7.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run4.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient2_8'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-03 12:43:21.204553
Hostname: kat
gpu2
Configuration 'config7.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net16
evaluation:
    online_training: False
    model: net16

end Configuration
['patient2_8']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [8]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.745459712
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 304.582891846 331.561761475
20 484.435198975 519.064501953
30 665.606323242 707.089782715
40 874.991894531 920.50123291
50 1137.25024414 1183.24688721
60 1487.04992676 1528.72434082
70 1983.92612305 2011.19562988
80 2754.95263672 2754.76303711
90 4202.81694336 4159.4034668
100 105201.65625 53464.578125
no_normal 191
no_seizure 25
no_samples_normal_ph 25
no_samples_seizure_ph 191
size 9550
no_normal 191
no_seizure 25
no_samples_normal_ph 25
no_samples_seizure_ph 191
Histogram:
[4775 4775]
magnitudes.shape (9550,)
labels.shape (9550,)
Ratio validation: 0.2
xVal.shape (1910,)
yVal.shape (1910,)
xTrain.shape (7640,)
yTrain.shape (7640,)
xVal.shape (1910, 2)
yVal.shape (1910,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net16
Model name for the evaluation phase:  net16
Training model...
# Neural Network with 459778 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x129x64
  2          32x129x64
  3          32x195x67
  4          32x195x67
  5          64x98x34
  6          64x98x34
  7          128x49x17
  8          128x49x17
  9          256x25x9
 10          256x25x9
 11          2x25x9
 12          2
 13          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m4.04319[0m     [32m0.67218[0m    6.01505      0.57526  23.07s
      2     [36m0.59813[0m     0.73648    0.81215      0.56545  23.09s
      3     [36m0.56413[0m     [32m0.66093[0m    0.85354      0.60340  23.07s
      4     [36m0.52463[0m     0.69323    0.75679      0.64136  23.21s
      5     [36m0.52314[0m     0.71319    0.73352      0.64267  23.38s
      6     [36m0.49578[0m     0.80218    0.61804      0.61715  22.94s
      7     [36m0.48599[0m     0.93016    0.52248      0.59817  23.14s
      8     [36m0.47783[0m     0.92761    0.51512      0.59751  23.11s
      9     [36m0.46351[0m     0.95776    0.48395      0.59293  23.08s
     10     0.47095     0.86900    0.54194      0.56283  23.04s
     11     [36m0.45668[0m     0.98597    0.46317      0.58050  22.92s
     12     [36m0.43658[0m     1.25187    0.34875      0.54058  22.93s
     13     [36m0.40511[0m     1.27645    0.31737      0.60079  22.88s
Early stopping.
Best valid loss was 0.660928 at epoch 3.
Loaded parameters to layer 'conv2d1' (shape 32x1x64x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d3' (shape 32x32x1x64).
Loaded parameters to layer 'conv2d3' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d7' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d7' (shape 128).
Loaded parameters to layer 'conv2d9' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d9' (shape 256).
Loaded parameters to layer 'conv2d11' (shape 2x256x3x3).
Loaded parameters to layer 'conv2d11' (shape 2).
Saving model...
Validating...
probabilities.shape (1910, 2)
Showing last 30 test samples..
Predictions:
[1 0 1 1 0 0 0 1 1 0 0 0 1 1 0 0 0 1 1 1 0 1 0 0 1 1 0 0 1 1]
Ground Truth:
[1 0 0 0 0 1 0 1 1 0 1 0 0 1 0 1 0 1 1 1 0 1 1 0 1 1 0 0 1 1]
Performance on relevant data
Accuracy validation:  0.601047120419
Error rate (%):  39.8952879581
yVal [1 0 1 ..., 0 1 1]
[[595 385]
 [377 553]]
roc_auc: 0.664501865262
log_loss 0.67094512263
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[ 0.93540162  0.06459865]
[ 0.1487132   0.85128713]
[ 0.97006494  0.02993411]
[  9.04439548e-06   9.99993384e-01]
[ 0.03121977  0.96878123]
roc_auc for the hours: 0.7
log_loss for the hours inf
saving predictions to csv file
hourspatient2_8_net16_10-03-12-52-01.csv
Accuracy validation for the hours:  0.627906976744
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [8]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.0354688
saving predictions to csv file
patient2_8_net16_10-03-12-56-40.csv
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run4.pickle', '--config-filename=config7.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_9']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config7.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run4.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient2_9'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-03 12:56:41.831167
Hostname: kat
gpu2
Configuration 'config7.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net16
evaluation:
    online_training: False
    model: net16

end Configuration
['patient2_9']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [9]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.744013824
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 283.37227478 306.047775269
20 448.091705322 476.795318604
30 612.117547607 646.27376709
40 800.063977051 838.327783203
50 1035.82800293 1076.41149902
60 1355.32043457 1393.14555664
70 1821.88786621 1848.28326416
80 2583.80039063 2579.61362305
90 4184.19125977 4103.89086914
100 81443.234375 46753.0546875
no_normal 191
no_seizure 25
no_samples_normal_ph 25
no_samples_seizure_ph 191
size 9550
no_normal 191
no_seizure 25
no_samples_normal_ph 25
no_samples_seizure_ph 191
Histogram:
[4775 4775]
magnitudes.shape (9550,)
labels.shape (9550,)
Ratio validation: 0.2
xVal.shape (1910,)
yVal.shape (1910,)
xTrain.shape (7640,)
yTrain.shape (7640,)
xVal.shape (1910, 2)
yVal.shape (1910,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net16
Model name for the evaluation phase:  net16
Training model...
# Neural Network with 459778 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x129x64
  2          32x129x64
  3          32x195x67
  4          32x195x67
  5          64x98x34
  6          64x98x34
  7          128x49x17
  8          128x49x17
  9          256x25x9
 10          256x25x9
 11          2x25x9
 12          2
 13          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m3.97174[0m     [32m0.68268[0m    5.81784      0.55955  23.06s
      2     [36m0.59028[0m     0.68814    0.85779      0.56937  22.94s
      3     [36m0.57259[0m     [32m0.68035[0m    0.84160      0.57068  23.42s
      4     [36m0.55857[0m     0.69873    0.79940      0.55170  23.37s
      5     0.56831     0.68596    0.82849      0.57526  23.30s
      6     [36m0.54986[0m     0.70183    0.78346      0.57657  23.29s
      7     [36m0.52760[0m     0.78967    0.66812      0.58639  23.23s
      8     [36m0.51085[0m     0.78449    0.65119      0.56872  23.34s
      9     [36m0.48863[0m     0.86729    0.56340      0.58835  23.19s
     10     0.49467     0.83973    0.58909      0.58312  23.35s
     11     [36m0.44632[0m     0.91583    0.48734      0.60929  23.28s
     12     0.44778     0.92075    0.48632      0.57395  23.35s
     13     [36m0.41442[0m     0.98033    0.42274      0.61518  23.28s
Early stopping.
Best valid loss was 0.680350 at epoch 3.
Loaded parameters to layer 'conv2d1' (shape 32x1x64x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d3' (shape 32x32x1x64).
Loaded parameters to layer 'conv2d3' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d7' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d7' (shape 128).
Loaded parameters to layer 'conv2d9' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d9' (shape 256).
Loaded parameters to layer 'conv2d11' (shape 2x256x3x3).
Loaded parameters to layer 'conv2d11' (shape 2).
Saving model...
Validating...
probabilities.shape (1910, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 0 0 0 1 0 0 0 0 1 1 0 0 1 1 0 1 1 0 1 0 1 1 1 0 1 1]
Ground Truth:
[1 0 0 0 0 1 0 1 1 0 1 0 0 1 0 1 0 1 1 1 0 1 1 0 1 1 0 0 1 1]
Performance on relevant data
Accuracy validation:  0.561780104712
Error rate (%):  43.8219895288
yVal [1 0 1 ..., 0 1 1]
[[560 420]
 [417 513]]
roc_auc: 0.609767390827
log_loss 0.67519875321
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[ 0.85253203  0.1474677 ]
[ 0.03162913  0.96837056]
[ 0.99543053  0.00456965]
[ 0.10781976  0.89218098]
[ 0.54145998  0.45854005]
roc_auc for the hours: 0.610526315789
log_loss for the hours 1.02202423684
saving predictions to csv file
hourspatient2_9_net16_10-03-13-05-25.csv
Accuracy validation for the hours:  0.558139534884
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [9]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.034067968
saving predictions to csv file
patient2_9_net16_10-03-13-09-54.csv
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run4.pickle', '--config-filename=config7.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_10']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config7.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run4.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient2_10'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-03 13:09:56.055153
Hostname: kat
gpu2
Configuration 'config7.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net16
evaluation:
    online_training: False
    model: net16

end Configuration
['patient2_10']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [10]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.744513536
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 235.353125 259.209658813
20 373.425970459 404.270147705
30 511.624740601 548.895672607
40 670.266955566 710.672009277
50 867.946899414 908.465515137
60 1130.38996582 1165.67106934
70 1502.52767334 1525.50710449
80 2081.78022461 2081.2378418
90 3192.88137207 3135.13125
100 33467.8828125 31567.0722656
no_normal 191
no_seizure 25
no_samples_normal_ph 25
no_samples_seizure_ph 191
size 9550
no_normal 191
no_seizure 25
no_samples_normal_ph 25
no_samples_seizure_ph 191
Histogram:
[4775 4775]
magnitudes.shape (9550,)
labels.shape (9550,)
Ratio validation: 0.2
xVal.shape (1910,)
yVal.shape (1910,)
xTrain.shape (7640,)
yTrain.shape (7640,)
xVal.shape (1910, 2)
yVal.shape (1910,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net16
Model name for the evaluation phase:  net16
Training model...
# Neural Network with 459778 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x129x64
  2          32x129x64
  3          32x195x67
  4          32x195x67
  5          64x98x34
  6          64x98x34
  7          128x49x17
  8          128x49x17
  9          256x25x9
 10          256x25x9
 11          2x25x9
 12          2
 13          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m3.38590[0m     [32m0.69384[0m    4.87991      0.57003  23.24s
      2     [36m0.58850[0m     [32m0.66686[0m    0.88250      0.59555  23.15s
      3     [36m0.57336[0m     [32m0.66233[0m    0.86568      0.57003  23.11s
      4     [36m0.55374[0m     0.69622    0.79535      0.54908  23.44s
      5     [36m0.55084[0m     0.69804    0.78913      0.63613  23.04s
      6     [36m0.52744[0m     0.75187    0.70151      0.69895  23.05s
      7     [36m0.50738[0m     0.86725    0.58504      0.65641  23.05s
      8     [36m0.48838[0m     0.92202    0.52969      0.66165  23.05s
      9     [36m0.48577[0m     0.92343    0.52604      0.55825  22.99s
     10     0.48692     0.87213    0.55832      0.62238  22.88s
     11     [36m0.45851[0m     0.94349    0.48597      0.64463  22.85s
     12     0.47002     0.87419    0.53766      0.61846  22.86s
     13     [36m0.43400[0m     1.07134    0.40510      0.63613  22.90s
Early stopping.
Best valid loss was 0.662325 at epoch 3.
Loaded parameters to layer 'conv2d1' (shape 32x1x64x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d3' (shape 32x32x1x64).
Loaded parameters to layer 'conv2d3' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d7' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d7' (shape 128).
Loaded parameters to layer 'conv2d9' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d9' (shape 256).
Loaded parameters to layer 'conv2d11' (shape 2x256x3x3).
Loaded parameters to layer 'conv2d11' (shape 2).
Saving model...
Validating...
probabilities.shape (1910, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 0 0 0 1 0 0 0 0 1 1 0 0 1 0 0 1 1 0 0 0 1 1 1 0 1 1]
Ground Truth:
[1 0 0 0 0 1 0 1 1 0 1 0 0 1 0 1 0 1 1 1 0 1 1 0 1 1 0 0 1 1]
Performance on relevant data
Accuracy validation:  0.557068062827
Error rate (%):  44.2931937173
yVal [1 0 1 ..., 0 1 1]
[[504 476]
 [370 560]]
roc_auc: 0.646628264209
log_loss 0.665262724522
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[ 0.96943271  0.03056761]
[ 0.00650801  0.99349207]
[ 0.72021288  0.27978772]
[ 0.01952229  0.98047751]
[ 0.29239196  0.70760804]
roc_auc for the hours: 0.657894736842
log_loss for the hours 1.22191090403
saving predictions to csv file
hourspatient2_10_net16_10-03-13-18-54.csv
Accuracy validation for the hours:  0.581395348837
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [10]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.0381312
saving predictions to csv file
patient2_10_net16_10-03-13-23-28.csv
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run4.pickle', '--config-filename=config7.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_11']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config7.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run4.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient2_11'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-03 13:23:29.524418
Hostname: kat
gpu2
Configuration 'config7.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net16
evaluation:
    online_training: False
    model: net16

end Configuration
['patient2_11']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [11]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.745639936
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 185.314794922 208.111297607
20 299.770111084 330.638024902
30 420.835580444 458.932080078
40 567.582995605 611.673339844
50 760.888244629 809.9090271
60 1030.30930176 1080.86318359
70 1423.52952881 1473.30863037
80 2039.71828613 2086.87138672
90 3209.50048828 3264.72282715
100 47304.0664062 104914.585938
no_normal 191
no_seizure 25
no_samples_normal_ph 25
no_samples_seizure_ph 191
size 9550
no_normal 191
no_seizure 25
no_samples_normal_ph 25
no_samples_seizure_ph 191
Histogram:
[4775 4775]
magnitudes.shape (9550,)
labels.shape (9550,)
Ratio validation: 0.2
xVal.shape (1910,)
yVal.shape (1910,)
xTrain.shape (7640,)
yTrain.shape (7640,)
xVal.shape (1910, 2)
yVal.shape (1910,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net16
Model name for the evaluation phase:  net16
Training model...
# Neural Network with 459778 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x129x64
  2          32x129x64
  3          32x195x67
  4          32x195x67
  5          64x98x34
  6          64x98x34
  7          128x49x17
  8          128x49x17
  9          256x25x9
 10          256x25x9
 11          2x25x9
 12          2
 13          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m2.77778[0m     [32m0.68971[0m    4.02744      0.50393  23.40s
      2     [36m0.57882[0m     [32m0.62328[0m    0.92867      0.66034  23.23s
      3     [36m0.54093[0m     [32m0.61517[0m    0.87932      0.75851  23.24s
      4     [36m0.51523[0m     0.62823    0.82013      0.73102  23.56s
      5     0.52070     0.62525    0.83280      0.76636  23.47s
      6     [36m0.48759[0m     0.67735    0.71984      0.70615  23.48s
      7     [36m0.47205[0m     0.81977    0.57583      0.64529  23.40s
      8     0.47296     0.66279    0.71358      0.68652  23.31s
      9     [36m0.44152[0m     0.80328    0.54964      0.64987  23.13s
     10     [36m0.42921[0m     0.88900    0.48280      0.65314  23.30s
     11     [36m0.41849[0m     1.06915    0.39142      0.63678  23.29s
     12     [36m0.40969[0m     1.18289    0.34635      0.62893  23.23s
     13     [36m0.39653[0m     1.21877    0.32535      0.62565  23.04s
Early stopping.
Best valid loss was 0.615169 at epoch 3.
Loaded parameters to layer 'conv2d1' (shape 32x1x64x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d3' (shape 32x32x1x64).
Loaded parameters to layer 'conv2d3' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d7' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d7' (shape 128).
Loaded parameters to layer 'conv2d9' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d9' (shape 256).
Loaded parameters to layer 'conv2d11' (shape 2x256x3x3).
Loaded parameters to layer 'conv2d11' (shape 2).
Saving model...
Validating...
probabilities.shape (1910, 2)
Showing last 30 test samples..
Predictions:
[0 0 1 1 0 0 0 1 1 0 0 0 1 1 0 0 0 0 1 1 0 1 0 0 1 1 0 0 1 1]
Ground Truth:
[1 0 0 0 0 1 0 1 1 0 1 0 0 1 0 1 0 1 1 1 0 1 1 0 1 1 0 0 1 1]
Performance on relevant data
Accuracy validation:  0.74502617801
Error rate (%):  25.497382199
yVal [1 0 1 ..., 0 1 1]
[[723 257]
 [230 700]]
roc_auc: 0.758400263331
log_loss 0.609982142361
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[ 0.99898779  0.00101588]
[ 0.28917453  0.71082574]
[ 0.05778233  0.94221854]
[ 0.01779091  0.9822095 ]
[ 0.11552085  0.8844797 ]
roc_auc for the hours: 0.8
log_loss for the hours 0.692070578662
saving predictions to csv file
hourspatient2_11_net16_10-03-13-32-12.csv
Accuracy validation for the hours:  0.744186046512
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [11]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.036873728
saving predictions to csv file
patient2_11_net16_10-03-13-36-45.csv
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run4.pickle', '--config-filename=config7.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_12']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config7.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run4.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient2_12'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-03 13:36:46.979329
Hostname: kat
gpu2
Configuration 'config7.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net16
evaluation:
    online_training: False
    model: net16

end Configuration
['patient2_12']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [12]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.74774528
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 246.400856018 260.383670044
20 388.318774414 405.029217529
30 528.878991699 548.355413818
40 689.669812012 711.362548828
50 892.074920654 915.121887207
60 1170.23933105 1190.96369629
70 1584.49351807 1593.89857178
80 2252.05878906 2238.45820313
90 3510.49829102 3446.85510254
100 68512.453125 43195.7773438
no_normal 191
no_seizure 25
no_samples_normal_ph 25
no_samples_seizure_ph 191
size 9550
no_normal 191
no_seizure 25
no_samples_normal_ph 25
no_samples_seizure_ph 191
Histogram:
[4775 4775]
magnitudes.shape (9550,)
labels.shape (9550,)
Ratio validation: 0.2
xVal.shape (1910,)
yVal.shape (1910,)
xTrain.shape (7640,)
yTrain.shape (7640,)
xVal.shape (1910, 2)
yVal.shape (1910,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net16
Model name for the evaluation phase:  net16
Training model...
# Neural Network with 459778 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x129x64
  2          32x129x64
  3          32x195x67
  4          32x195x67
  5          64x98x34
  6          64x98x34
  7          128x49x17
  8          128x49x17
  9          256x25x9
 10          256x25x9
 11          2x25x9
 12          2
 13          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m3.34138[0m     [32m0.69962[0m    4.77602      0.50654  23.41s
      2     [36m0.63612[0m     [32m0.65367[0m    0.97315      0.56479  23.39s
      3     [36m0.58071[0m     0.66075    0.87886      0.62827  23.43s
      4     [36m0.54355[0m     0.66354    0.81917      0.65183  23.33s
      5     [36m0.52462[0m     0.74804    0.70132      0.59817  23.41s
      6     [36m0.48897[0m     0.75673    0.64616      0.64071  23.48s
      7     [36m0.48210[0m     0.87932    0.54827      0.63154  23.13s
      8     [36m0.47275[0m     1.03380    0.45729      0.61584  23.07s
      9     [36m0.42508[0m     0.82275    0.51666      0.58901  23.05s
     10     [36m0.40656[0m     0.86492    0.47005      0.60471  23.04s
     11     [36m0.38266[0m     0.98427    0.38877      0.65249  23.04s
     12     0.40064     1.00401    0.39903      0.59031  23.19s
Early stopping.
Best valid loss was 0.653674 at epoch 2.
Loaded parameters to layer 'conv2d1' (shape 32x1x64x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d3' (shape 32x32x1x64).
Loaded parameters to layer 'conv2d3' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d7' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d7' (shape 128).
Loaded parameters to layer 'conv2d9' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d9' (shape 256).
Loaded parameters to layer 'conv2d11' (shape 2x256x3x3).
Loaded parameters to layer 'conv2d11' (shape 2).
Saving model...
Validating...
probabilities.shape (1910, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 0 0 1 1 1 0 0 0 1 1 1 0 1 0 1 1 1 1 0 1 1 1 1 0 1 1]
Ground Truth:
[1 0 0 0 0 1 0 1 1 0 1 0 0 1 0 1 0 1 1 1 0 1 1 0 1 1 0 0 1 1]
Performance on relevant data
Accuracy validation:  0.53612565445
Error rate (%):  46.387434555
yVal [1 0 1 ..., 0 1 1]
[[330 650]
 [236 694]]
roc_auc: 0.645740618828
log_loss 0.670479092829
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[ 0.81436819  0.18563184]
[ 0.04325448  0.9567461 ]
[ 0.51666969  0.48333022]
[ 0.00144896  0.99855065]
[ 0.02287869  0.97712183]
roc_auc for the hours: 0.657894736842
log_loss for the hours 1.43262453254
saving predictions to csv file
hourspatient2_12_net16_10-03-13-45-06.csv
Accuracy validation for the hours:  0.418604651163
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [12]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.049034752
saving predictions to csv file
patient2_12_net16_10-03-13-49-37.csv
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run4.pickle', '--config-filename=config7.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_13']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config7.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run4.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient2_13'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-03 13:49:38.247242
Hostname: kat
gpu2
Configuration 'config7.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net16
evaluation:
    online_training: False
    model: net16

end Configuration
['patient2_13']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [13]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.744910848
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 310.902963257 337.861572266
20 495.955010986 532.738879395
30 683.185546875 729.780834961
40 898.82401123 954.485388184
50 1167.24829102 1228.47143555
60 1520.5864502 1581.93601074
70 2018.97246094 2072.08920898
80 2789.6487793 2824.08540039
90 4233.0871582 4224.4074707
100 35079.8945312 31263.9492188
no_normal 191
no_seizure 25
no_samples_normal_ph 25
no_samples_seizure_ph 191
size 9550
no_normal 191
no_seizure 25
no_samples_normal_ph 25
no_samples_seizure_ph 191
Histogram:
[4775 4775]
magnitudes.shape (9550,)
labels.shape (9550,)
Ratio validation: 0.2
xVal.shape (1910,)
yVal.shape (1910,)
xTrain.shape (7640,)
yTrain.shape (7640,)
xVal.shape (1910, 2)
yVal.shape (1910,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net16
Model name for the evaluation phase:  net16
Training model...
# Neural Network with 459778 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x129x64
  2          32x129x64
  3          32x195x67
  4          32x195x67
  5          64x98x34
  6          64x98x34
  7          128x49x17
  8          128x49x17
  9          256x25x9
 10          256x25x9
 11          2x25x9
 12          2
 13          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m4.48396[0m     [32m0.73567[0m    6.09508      0.52291  23.30s
      2     [36m0.59330[0m     [32m0.72426[0m    0.81919      0.55236  23.37s
      3     [36m0.57189[0m     [32m0.72367[0m    0.79027      0.54777  23.47s
      4     [36m0.56037[0m     0.76289    0.73454      0.52160  23.63s
      5     [36m0.55532[0m     0.78114    0.71090      0.53796  23.49s
      6     [36m0.54089[0m     0.83986    0.64402      0.54974  23.56s
      7     [36m0.52497[0m     0.99572    0.52723      0.54843  23.54s
      8     [36m0.51278[0m     0.95941    0.53448      0.56021  23.48s
      9     [36m0.50025[0m     1.16095    0.43090      0.56086  23.43s
     10     [36m0.49728[0m     1.07704    0.46170      0.56610  23.42s
     11     [36m0.48105[0m     0.98164    0.49005      0.58508  23.23s
     12     [36m0.47902[0m     1.32719    0.36093      0.55694  23.21s
     13     [36m0.46809[0m     1.24877    0.37484      0.55497  23.36s
Early stopping.
Best valid loss was 0.723666 at epoch 3.
Loaded parameters to layer 'conv2d1' (shape 32x1x64x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d3' (shape 32x32x1x64).
Loaded parameters to layer 'conv2d3' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d7' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d7' (shape 128).
Loaded parameters to layer 'conv2d9' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d9' (shape 256).
Loaded parameters to layer 'conv2d11' (shape 2x256x3x3).
Loaded parameters to layer 'conv2d11' (shape 2).
Saving model...
Validating...
probabilities.shape (1910, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 0 0 0 1 1 0 0 0 1 1 0 0 1 1 0 1 1 0 1 0 1 1 1 0 1 1]
Ground Truth:
[1 0 0 0 0 1 0 1 1 0 1 0 0 1 0 1 0 1 1 1 0 1 1 0 1 1 0 0 1 1]
Performance on relevant data
Accuracy validation:  0.535078534031
Error rate (%):  46.4921465969
yVal [1 0 1 ..., 0 1 1]
[[536 444]
 [444 486]]
roc_auc: 0.573664691683
log_loss 0.721826053321
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[ 0.880714    0.11928673]
[ 0.00566105  0.99433935]
[ 0.94043559  0.05956488]
[ 0.01467087  0.98532897]
[ 0.60085762  0.39914241]
roc_auc for the hours: 0.605263157895
log_loss for the hours 1.67358323225
saving predictions to csv file
hourspatient2_13_net16_10-03-13-58-21.csv
Accuracy validation for the hours:  0.558139534884
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [13]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.043480576
saving predictions to csv file
patient2_13_net16_10-03-14-02-51.csv
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run4.pickle', '--config-filename=config7.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_14']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config7.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run4.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient2_14'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-03 14:02:52.679344
Hostname: kat
gpu2
Configuration 'config7.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net16
evaluation:
    online_training: False
    model: net16

end Configuration
['patient2_14']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [14]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.745291776
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 266.172717285 282.912625122
20 417.956640625 438.4277771
30 566.452648926 591.266082764
40 733.547790527 761.89486084
50 939.345672607 969.588409424
60 1211.49157715 1239.79914551
70 1602.63823242 1619.38890381
80 2236.86499023 2222.94345703
90 3516.40424805 3422.74516602
100 38412.0351562 39300.5585938
no_normal 191
no_seizure 25
no_samples_normal_ph 25
no_samples_seizure_ph 191
size 9550
no_normal 191
no_seizure 25
no_samples_normal_ph 25
no_samples_seizure_ph 191
Histogram:
[4775 4775]
magnitudes.shape (9550,)
labels.shape (9550,)
Ratio validation: 0.2
xVal.shape (1910,)
yVal.shape (1910,)
xTrain.shape (7640,)
yTrain.shape (7640,)
xVal.shape (1910, 2)
yVal.shape (1910,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net16
Model name for the evaluation phase:  net16
Training model...
# Neural Network with 459778 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x129x64
  2          32x129x64
  3          32x195x67
  4          32x195x67
  5          64x98x34
  6          64x98x34
  7          128x49x17
  8          128x49x17
  9          256x25x9
 10          256x25x9
 11          2x25x9
 12          2
 13          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m3.55236[0m     [32m0.70468[0m    5.04108      0.54319  23.38s
      2     [36m0.59891[0m     0.71607    0.83638      0.58639  23.27s
      3     [36m0.57096[0m     0.73039    0.78171      0.51702  23.28s
      4     [36m0.55398[0m     0.77566    0.71421      0.49084  23.34s
      5     0.55670     0.78238    0.71155      0.47840  23.49s
      6     [36m0.53117[0m     0.93479    0.56822      0.57461  23.45s
      7     [36m0.52228[0m     1.02865    0.50773      0.55694  23.35s
      8     [36m0.51385[0m     1.01316    0.50718      0.55039  23.05s
      9     [36m0.51339[0m     1.13959    0.45050      0.56348  22.92s
     10     [36m0.50924[0m     1.12571    0.45237      0.55105  23.01s
     11     [36m0.49332[0m     1.08569    0.45438      0.52421  23.23s
Early stopping.
Best valid loss was 0.704683 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x64x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d3' (shape 32x32x1x64).
Loaded parameters to layer 'conv2d3' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d7' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d7' (shape 128).
Loaded parameters to layer 'conv2d9' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d9' (shape 256).
Loaded parameters to layer 'conv2d11' (shape 2x256x3x3).
Loaded parameters to layer 'conv2d11' (shape 2).
Saving model...
Validating...
probabilities.shape (1910, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 0 1 1]
Ground Truth:
[1 0 0 0 0 1 0 1 1 0 1 0 0 1 0 1 0 1 1 1 0 1 1 0 1 1 0 0 1 1]
Performance on relevant data
Accuracy validation:  0.525654450262
Error rate (%):  47.4345549738
yVal [1 0 1 ..., 0 1 1]
[[ 97 883]
 [ 23 907]]
roc_auc: 0.516870748299
log_loss 0.710377502239
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[ 0.27820247  0.72179776]
[ 0.02625144  0.97374797]
[ 0.16223329  0.837767  ]
[ 0.03633375  0.96366543]
[ 0.10586273  0.89413762]
roc_auc for the hours: 0.542105263158
log_loss for the hours 2.0679203699
saving predictions to csv file
hourspatient2_14_net16_10-03-14-11-45.csv
Accuracy validation for the hours:  0.209302325581
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [14]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.036812288
saving predictions to csv file
patient2_14_net16_10-03-14-16-15.csv
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run4.pickle', '--config-filename=config7.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_15']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config7.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run4.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient2_15'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-03 14:16:16.450126
Hostname: kat
gpu2
Configuration 'config7.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net16
evaluation:
    online_training: False
    model: net16

end Configuration
['patient2_15']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [15]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.745271296
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 207.538546753 227.35309906
20 331.033721924 357.463000488
30 457.867379761 491.204870605
40 608.373034668 648.207519531
50 801.816497803 847.310424805
60 1065.05288086 1112.36008301
70 1442.92700195 1484.37923584
80 2028.23110352 2052.16914063
90 3108.79804688 3089.25849609
100 28167.1855469 26524.03125
no_normal 191
no_seizure 25
no_samples_normal_ph 25
no_samples_seizure_ph 191
size 9550
no_normal 191
no_seizure 25
no_samples_normal_ph 25
no_samples_seizure_ph 191
Histogram:
[4775 4775]
magnitudes.shape (9550,)
labels.shape (9550,)
Ratio validation: 0.2
xVal.shape (1910,)
yVal.shape (1910,)
xTrain.shape (7640,)
yTrain.shape (7640,)
xVal.shape (1910, 2)
yVal.shape (1910,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net16
Model name for the evaluation phase:  net16
Training model...
# Neural Network with 459778 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x129x64
  2          32x129x64
  3          32x195x67
  4          32x195x67
  5          64x98x34
  6          64x98x34
  7          128x49x17
  8          128x49x17
  9          256x25x9
 10          256x25x9
 11          2x25x9
 12          2
 13          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m3.15316[0m     [32m0.68803[0m    4.58285      0.56152  23.46s
      2     [36m0.60158[0m     [32m0.65558[0m    0.91763      0.56217  23.36s
      3     [36m0.57679[0m     [32m0.65498[0m    0.88061      0.59555  23.42s
      4     [36m0.54567[0m     [32m0.65324[0m    0.83534      0.59162  23.30s
      5     [36m0.53591[0m     [32m0.65247[0m    0.82136      0.66950  23.40s
      6     [36m0.50805[0m     0.68049    0.74659      0.68717  23.16s
      7     [36m0.50340[0m     0.73864    0.68153      0.69306  22.82s
      8     [36m0.50329[0m     0.75466    0.66690      0.68783  22.80s
      9     [36m0.49599[0m     0.75549    0.65651      0.58835  22.80s
     10     [36m0.49588[0m     0.68349    0.72552      0.69568  22.80s
     11     [36m0.48383[0m     0.73691    0.65656      0.60929  22.79s
     12     [36m0.48103[0m     0.73599    0.65359      0.66754  22.80s
     13     [36m0.46387[0m     0.71292    0.65066      0.68586  23.13s
     14     [36m0.43077[0m     0.71277    0.60436      0.72513  22.84s
     15     0.43924     0.68755    0.63885      0.70812  23.28s
Early stopping.
Best valid loss was 0.652471 at epoch 5.
Loaded parameters to layer 'conv2d1' (shape 32x1x64x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d3' (shape 32x32x1x64).
Loaded parameters to layer 'conv2d3' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d7' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d7' (shape 128).
Loaded parameters to layer 'conv2d9' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d9' (shape 256).
Loaded parameters to layer 'conv2d11' (shape 2x256x3x3).
Loaded parameters to layer 'conv2d11' (shape 2).
Saving model...
Validating...
probabilities.shape (1910, 2)
Showing last 30 test samples..
Predictions:
[1 0 0 1 0 0 0 1 0 0 0 0 1 1 0 0 0 0 1 1 0 1 0 0 1 1 0 0 1 1]
Ground Truth:
[1 0 0 0 0 1 0 1 1 0 1 0 0 1 0 1 0 1 1 1 0 1 1 0 1 1 0 0 1 1]
Performance on relevant data
Accuracy validation:  0.666492146597
Error rate (%):  33.3507853403
yVal [1 0 1 ..., 0 1 1]
[[741 239]
 [398 532]]
roc_auc: 0.681048935703
log_loss 0.67333791782
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[ 0.99663013  0.0033719 ]
[ 0.03277548  0.96722466]
[ 0.94057316  0.05942799]
[ 0.00353398  0.99646652]
[ 0.30790579  0.69209474]
roc_auc for the hours: 0.742105263158
log_loss for the hours 0.523379226218
saving predictions to csv file
hourspatient2_15_net16_10-03-14-25-42.csv
Accuracy validation for the hours:  0.790697674419
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [15]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.036562432
saving predictions to csv file
patient2_15_net16_10-03-14-30-15.csv
