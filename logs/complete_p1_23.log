['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu1', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_0']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_0'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu1')
Git reference:  Timestamp: 2016-10-17 00:49:49.424719
Hostname: kat
gpu1
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 128
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net11
evaluation:
    online_training: False
    model: net11

end Configuration
['patient1_0']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 128)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [0]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.90257408
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 65.6255264282 62.3632049561
20 155.769760132 154.562921143
30 232.106933594 231.284588623
40 319.552825928 318.450469971
50 442.051696777 438.571899414
60 645.882446289 634.566577148
70 1007.1973877 975.443988037
80 1649.53430176 1574.69299316
90 2997.44116211 2843.09477539
100 101397.328125 96893.890625
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net11
Model name for the evaluation phase:  net11
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ----------
  0          1x192x128
  1          32x192x128
  2          32x192x128
  3          32x192x128
  4          32x96x64
  5          32x96x64
  6          32x96x64
  7          32x48x32
  8          2x48x32
  9          2
 10          2

BI_test_bal_complete called with len(X) = 584
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m1.73342[0m     [32m0.70131[0m    2.47167      0.46083  62.44s
BI_test_bal_complete called with len(X) = 584
      2     [36m0.69926[0m     [32m0.69423[0m    1.00725      0.46974  61.58s
BI_test_bal_complete called with len(X) = 584
      3     [36m0.68974[0m     [32m0.68586[0m    1.00566      0.49824  62.18s
BI_test_bal_complete called with len(X) = 584
      4     [36m0.68234[0m     0.71050    0.96036      0.48850  62.20s
BI_test_bal_complete called with len(X) = 584
      5     [36m0.67335[0m     0.69237    0.97253      0.49703  61.67s
BI_test_bal_complete called with len(X) = 584
      6     [36m0.66356[0m     0.69943    0.94872      0.48220  62.36s
BI_test_bal_complete called with len(X) = 584
      7     [36m0.65575[0m     0.72749    0.90138      0.47363  61.71s
BI_test_bal_complete called with len(X) = 584
      8     0.65622     0.73609    0.89149      0.47228  62.32s
BI_test_bal_complete called with len(X) = 584
      9     [36m0.64402[0m     0.72626    0.88676      0.47243  61.47s
BI_test_bal_complete called with len(X) = 584
     10     [36m0.64199[0m     0.74035    0.86714      0.45893  62.21s
BI_test_bal_complete called with len(X) = 584
     11     [36m0.63703[0m     0.73283    0.86928      0.47547  61.35s
BI_test_bal_complete called with len(X) = 584
     12     [36m0.63661[0m     0.75162    0.84699      0.44706  62.19s
BI_test_bal_complete called with len(X) = 584
     13     [36m0.63353[0m     0.76144    0.83201      0.35649  62.32s
BI_test_bal_complete called with len(X) = 584
Early stopping.
Best valid loss was 0.685859 at epoch 3.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 128)
magnitudes_seizure_val.shape (5, 1, 1406, 128)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.481291547958
Error rate (%):  51.8708452042
[[42644 46051]
 [ 3107  2968]]
(94770,)
(94770,)
roc_auc: 0.529863445195
log_loss: 1.32177478199
roc_auc for the hours: 0.520547945205
log_loss for the hours: 1.18039100347
saving predictions to csv file
hourspatient1_0_net11_10-17-01-17-24.csv
Accuracy validation for the hours:  0.512820512821
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 128)
(2256, 1, 234, 128)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [0]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.386848256
saving predictions to csv file
patient1_0_net11_10-17-01-21-41.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu1', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_1']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_1'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu1')
Git reference:  Timestamp: 2016-10-17 01:21:42.843699
Hostname: kat
gpu1
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 128
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net11
evaluation:
    online_training: False
    model: net11

end Configuration
['patient1_1']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 128)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [1]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.96718848
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 68.8559188843 64.9255805969
20 164.480499268 162.515332031
30 245.226325989 243.415252686
40 337.192626953 335.093115234
50 464.971282959 460.983596802
60 674.635375977 664.547143555
70 1025.45843506 1002.46117554
80 1589.99389648 1546.05471191
90 2670.43212891 2579.92746582
100 71591.0625 60304.03125
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net11
Model name for the evaluation phase:  net11
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ----------
  0          1x192x128
  1          32x192x128
  2          32x192x128
  3          32x192x128
  4          32x96x64
  5          32x96x64
  6          32x96x64
  7          32x48x32
  8          2x48x32
  9          2
 10          2

BI_test_bal_complete called with len(X) = 584
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m1.71210[0m     [32m0.69522[0m    2.46266      0.51115  60.72s
BI_test_bal_complete called with len(X) = 584
      2     [36m0.70195[0m     [32m0.69001[0m    1.01731      0.47083  61.91s
BI_test_bal_complete called with len(X) = 584
      3     [36m0.69065[0m     0.69096    0.99956      0.43738  61.13s
BI_test_bal_complete called with len(X) = 584
      4     [36m0.68601[0m     [32m0.68666[0m    0.99904      0.43332  62.17s
BI_test_bal_complete called with len(X) = 584
      5     [36m0.68148[0m     0.69140    0.98565      0.41527  61.34s
BI_test_bal_complete called with len(X) = 584
      6     0.68316     0.69142    0.98805      0.41343  62.41s
BI_test_bal_complete called with len(X) = 584
      7     [36m0.67614[0m     0.69109    0.97837      0.57939  61.99s
BI_test_bal_complete called with len(X) = 584
      8     0.68066     0.71539    0.95146      0.50543  62.04s
BI_test_bal_complete called with len(X) = 584
      9     0.67924     0.69101    0.98296      0.41973  62.54s
BI_test_bal_complete called with len(X) = 584
     10     [36m0.67154[0m     0.68729    0.97708      0.44917  61.57s
BI_test_bal_complete called with len(X) = 584
     11     0.67599     [32m0.68509[0m    0.98672      0.44375  62.35s
BI_test_bal_complete called with len(X) = 584
     12     [36m0.67145[0m     0.68806    0.97585      0.43949  61.54s
BI_test_bal_complete called with len(X) = 584
     13     [36m0.66864[0m     0.68679    0.97357      0.45162  62.41s
BI_test_bal_complete called with len(X) = 584
     14     [36m0.66510[0m     [32m0.67784[0m    0.98120      0.48714  61.60s
BI_test_bal_complete called with len(X) = 584
     15     0.66518     [32m0.67143[0m    0.99068      0.54953  62.27s
BI_test_bal_complete called with len(X) = 584
     16     [36m0.65923[0m     0.67393    0.97819      0.51092  61.54s
BI_test_bal_complete called with len(X) = 584
     17     0.66198     [32m0.66234[0m    0.99946      0.56279  62.34s
BI_test_bal_complete called with len(X) = 584
     18     0.66180     0.66342    0.99755      0.56922  61.98s
BI_test_bal_complete called with len(X) = 584
     19     [36m0.65562[0m     [32m0.65642[0m    0.99877      0.60178  61.48s
BI_test_bal_complete called with len(X) = 584
     20     0.66329     0.66086    1.00368      0.60140  62.38s
BI_test_bal_complete called with len(X) = 584
     21     [36m0.65215[0m     0.66422    0.98183      0.61541  61.47s
BI_test_bal_complete called with len(X) = 584
     22     [36m0.64864[0m     [32m0.65518[0m    0.99003      0.61812  62.42s
BI_test_bal_complete called with len(X) = 584
     23     0.65027     [32m0.65158[0m    0.99799      0.61814  61.46s
BI_test_bal_complete called with len(X) = 584
     24     0.64872     0.66435    0.97647      0.61156  62.29s
BI_test_bal_complete called with len(X) = 584
     25     [36m0.63526[0m     0.67473    0.94149      0.60303  61.88s
BI_test_bal_complete called with len(X) = 584
     26     [36m0.63156[0m     0.66083    0.95571      0.62060  62.16s
BI_test_bal_complete called with len(X) = 584
     27     [36m0.62329[0m     [32m0.64806[0m    0.96177      0.63575  62.53s
BI_test_bal_complete called with len(X) = 584
     28     [36m0.61043[0m     0.66529    0.91754      0.63155  53.81s
BI_test_bal_complete called with len(X) = 584
     29     [36m0.60891[0m     0.67507    0.90200      0.53228  34.54s
BI_test_bal_complete called with len(X) = 584
     30     [36m0.58726[0m     0.68827    0.85325      0.53579  34.51s
BI_test_bal_complete called with len(X) = 584
     31     [36m0.57818[0m     0.66554    0.86873      0.56622  34.58s
BI_test_bal_complete called with len(X) = 584
     32     [36m0.56071[0m     0.68468    0.81894      0.53673  34.76s
BI_test_bal_complete called with len(X) = 584
     33     [36m0.54983[0m     0.71604    0.76788      0.51501  46.99s
BI_test_bal_complete called with len(X) = 584
     34     [36m0.53039[0m     0.72429    0.73230      0.51274  43.71s
BI_test_bal_complete called with len(X) = 584
     35     [36m0.51835[0m     0.70979    0.73028      0.55116  34.58s
BI_test_bal_complete called with len(X) = 584
     36     [36m0.50764[0m     0.70743    0.71758      0.57554  34.54s
BI_test_bal_complete called with len(X) = 584
     37     [36m0.48919[0m     0.82070    0.59606      0.45604  34.76s
BI_test_bal_complete called with len(X) = 584
Early stopping.
Best valid loss was 0.648064 at epoch 27.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 128)
magnitudes_seizure_val.shape (5, 1, 1406, 128)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.5740107629
Error rate (%):  42.59892371
[[51027 37668]
 [ 2703  3372]]
(94770,)
(94770,)
roc_auc: 0.607116998954
log_loss: 1.20101425524
roc_auc for the hours: 0.687671232877
log_loss for the hours: 0.635756805014
saving predictions to csv file
hourspatient1_1_net11_10-17-02-11-53.csv
Accuracy validation for the hours:  0.615384615385
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 128)
(2256, 1, 234, 128)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [1]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.338765312
saving predictions to csv file
patient1_1_net11_10-17-02-16-23.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu1', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_2']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_2'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu1')
Git reference:  Timestamp: 2016-10-17 02:16:24.983145
Hostname: kat
gpu1
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 128
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net11
evaluation:
    online_training: False
    model: net11

end Configuration
['patient1_2']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 128)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [2]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.967204864
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 75.2562866211 71.0830612183
20 179.932388306 178.039385986
30 267.563446045 266.451123047
40 366.15145874 364.745513916
50 498.727294922 496.58934021
60 704.215148926 699.330737305
70 1031.46472168 1019.19556274
80 1545.03320312 1518.43608398
90 2489.80944824 2436.73503418
100 119907.929688 146484.890625
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net11
Model name for the evaluation phase:  net11
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ----------
  0          1x192x128
  1          32x192x128
  2          32x192x128
  3          32x192x128
  4          32x96x64
  5          32x96x64
  6          32x96x64
  7          32x48x32
  8          2x48x32
  9          2
 10          2

BI_test_bal_complete called with len(X) = 584
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m1.65108[0m     [32m0.70194[0m    2.35217      0.51115  33.42s
BI_test_bal_complete called with len(X) = 584
      2     [36m0.70426[0m     [32m0.69588[0m    1.01205      0.48928  34.07s
BI_test_bal_complete called with len(X) = 584
      3     [36m0.69614[0m     [32m0.69528[0m    1.00122      0.52448  34.09s
BI_test_bal_complete called with len(X) = 584
      4     [36m0.69269[0m     [32m0.69063[0m    1.00298      0.51934  44.83s
BI_test_bal_complete called with len(X) = 584
      5     [36m0.68890[0m     0.69735    0.98787      0.53481  44.75s
BI_test_bal_complete called with len(X) = 584
      6     [36m0.68883[0m     0.69762    0.98740      0.55341  34.12s
BI_test_bal_complete called with len(X) = 584
      7     [36m0.68410[0m     0.69073    0.99040      0.51745  34.11s
BI_test_bal_complete called with len(X) = 584
      8     [36m0.68116[0m     0.69340    0.98235      0.51576  34.05s
BI_test_bal_complete called with len(X) = 584
      9     0.68306     0.69201    0.98707      0.51838  34.00s
BI_test_bal_complete called with len(X) = 584
     10     [36m0.67929[0m     0.69277    0.98054      0.51559  34.28s
BI_test_bal_complete called with len(X) = 584
     11     [36m0.67489[0m     0.70300    0.96001      0.52291  34.48s
BI_test_bal_complete called with len(X) = 584
     12     0.68620     0.70318    0.97586      0.56726  34.29s
BI_test_bal_complete called with len(X) = 584
     13     [36m0.67486[0m     0.70552    0.95655      0.52189  34.40s
BI_test_bal_complete called with len(X) = 584
     14     0.67703     0.70473    0.96070      0.53994  34.45s
BI_test_bal_complete called with len(X) = 584
Early stopping.
Best valid loss was 0.690629 at epoch 4.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 128)
magnitudes_seizure_val.shape (5, 1, 1406, 128)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.383423024164
Error rate (%):  61.6576975836
[[32409 56286]
 [ 2147  3928]]
(94770,)
(94770,)
roc_auc: 0.491951221379
log_loss: 1.56452552222
roc_auc for the hours: 0.490410958904
log_loss for the hours: 1.4473674132
saving predictions to csv file
hourspatient1_2_net11_10-17-02-44-28.csv
Accuracy validation for the hours:  0.384615384615
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 128)
(2256, 1, 234, 128)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [2]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.338519552
saving predictions to csv file
patient1_2_net11_10-17-02-48-52.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu1', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_3']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_3'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu1')
Git reference:  Timestamp: 2016-10-17 02:48:53.895034
Hostname: kat
gpu1
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 128
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net11
evaluation:
    online_training: False
    model: net11

end Configuration
['patient1_3']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 128)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [3]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.9675776
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 16.8907413483 13.9652649879
20 75.4451828003 76.3343780518
30 185.736076355 188.53994751
40 297.110656738 298.831182861
50 421.831558228 422.921676636
60 593.512878418 593.259326172
70 865.478912354 859.846130371
80 1308.9901123 1288.80061035
90 2114.36303711 2062.91472168
100 141686.875 89649.6484375
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net11
Model name for the evaluation phase:  net11
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ----------
  0          1x192x128
  1          32x192x128
  2          32x192x128
  3          32x192x128
  4          32x96x64
  5          32x96x64
  6          32x96x64
  7          32x48x32
  8          2x48x32
  9          2
 10          2

BI_test_bal_complete called with len(X) = 584
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m1.40888[0m     [32m0.71797[0m    1.96231      0.38901  32.97s
BI_test_bal_complete called with len(X) = 584
      2     [36m0.68480[0m     0.73458    0.93224      0.38128  34.05s
BI_test_bal_complete called with len(X) = 584
      3     [36m0.67381[0m     0.73771    0.91338      0.37787  34.63s
BI_test_bal_complete called with len(X) = 584
      4     [36m0.66802[0m     0.73578    0.90791      0.39329  34.72s
BI_test_bal_complete called with len(X) = 584
      5     [36m0.66236[0m     0.73256    0.90417      0.39962  34.63s
BI_test_bal_complete called with len(X) = 584
      6     [36m0.66207[0m     0.72565    0.91238      0.48247  34.70s
BI_test_bal_complete called with len(X) = 584
      7     [36m0.65809[0m     0.76367    0.86174      0.38842  34.53s
BI_test_bal_complete called with len(X) = 584
      8     [36m0.65037[0m     0.73509    0.88475      0.45027  34.63s
BI_test_bal_complete called with len(X) = 584
      9     [36m0.64844[0m     0.79634    0.81427      0.38270  34.76s
BI_test_bal_complete called with len(X) = 584
     10     [36m0.64554[0m     0.75861    0.85095      0.44511  34.58s
BI_test_bal_complete called with len(X) = 584
     11     0.64619     0.76756    0.84187      0.44104  34.74s
BI_test_bal_complete called with len(X) = 584
Early stopping.
Best valid loss was 0.717967 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 128)
magnitudes_seizure_val.shape (5, 1, 1406, 128)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.771668249446
Error rate (%):  22.8331750554
[[73131 15564]
 [ 6075     0]]
(94770,)
(94770,)
roc_auc: 0.345089638812
log_loss: 0.417213630157
roc_auc for the hours: 0.276712328767
log_loss for the hours: 0.398094354484
saving predictions to csv file
hourspatient1_3_net11_10-17-03-19-57.csv
Accuracy validation for the hours:  0.807692307692
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 128)
(2256, 1, 234, 128)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [3]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.396912128
saving predictions to csv file
patient1_3_net11_10-17-03-24-53.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu1', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_4']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_4'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu1')
Git reference:  Timestamp: 2016-10-17 03:24:55.254335
Hostname: kat
gpu1
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 128
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net11
evaluation:
    online_training: False
    model: net11

end Configuration
['patient1_4']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 128)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [4]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.967913472
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 119.406757355 114.951146698
20 293.056610107 293.751751709
30 436.134567261 437.45897522
40 585.489135742 585.151318359
50 759.698059082 755.959014893
60 984.792785645 974.268481445
70 1316.13116455 1293.09414062
80 1909.79797363 1860.74743652
90 3307.32580566 3185.36491699
100 52009.53125 38008.9335938
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net11
Model name for the evaluation phase:  net11
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ----------
  0          1x192x128
  1          32x192x128
  2          32x192x128
  3          32x192x128
  4          32x96x64
  5          32x96x64
  6          32x96x64
  7          32x48x32
  8          2x48x32
  9          2
 10          2

BI_test_bal_complete called with len(X) = 584
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m2.04195[0m     [32m0.69679[0m    2.93051      0.49782  32.46s
BI_test_bal_complete called with len(X) = 584
      2     [36m0.70582[0m     [32m0.69539[0m    1.01500      0.51180  32.98s
BI_test_bal_complete called with len(X) = 584
      3     [36m0.69931[0m     0.69748    1.00262      0.51258  60.39s
BI_test_bal_complete called with len(X) = 584
      4     [36m0.69637[0m     0.69969    0.99526      0.52745  62.37s
BI_test_bal_complete called with len(X) = 584
      5     [36m0.69526[0m     0.71230    0.97608      0.49946  61.46s
BI_test_bal_complete called with len(X) = 584
      6     0.69713     0.70506    0.98876      0.52650  62.29s
BI_test_bal_complete called with len(X) = 584
      7     [36m0.69166[0m     0.71133    0.97235      0.54531  61.49s
BI_test_bal_complete called with len(X) = 584
      8     0.69370     0.70949    0.97774      0.54348  62.13s
BI_test_bal_complete called with len(X) = 584
      9     [36m0.68797[0m     0.71113    0.96744      0.54378  61.48s
BI_test_bal_complete called with len(X) = 584
     10     0.68832     0.71401    0.96402      0.47167  62.18s
BI_test_bal_complete called with len(X) = 584
     11     [36m0.68716[0m     0.71425    0.96208      0.48902  61.47s
BI_test_bal_complete called with len(X) = 584
     12     [36m0.68458[0m     0.71624    0.95579      0.48730  62.16s
BI_test_bal_complete called with len(X) = 584
Early stopping.
Best valid loss was 0.695390 at epoch 2.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 128)
magnitudes_seizure_val.shape (5, 1, 1406, 128)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.137068692624
Error rate (%):  86.2931307376
[[ 7104 81591]
 [  189  5886]]
(94770,)
(94770,)
roc_auc: 0.53656118334
log_loss: 1.18759516156
roc_auc for the hours: 0.523287671233
log_loss for the hours: 1.12639698081
saving predictions to csv file
hourspatient1_4_net11_10-17-04-02-49.csv
Accuracy validation for the hours:  0.0641025641026
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 128)
(2256, 1, 234, 128)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [4]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.389641728
saving predictions to csv file
patient1_4_net11_10-17-04-18-42.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu1', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_5']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_5'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu1')
Git reference:  Timestamp: 2016-10-17 04:18:44.164969
Hostname: kat
gpu1
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 128
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net11
evaluation:
    online_training: False
    model: net11

end Configuration
['patient1_5']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 128)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [5]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.967348224
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 115.301078796 108.219135284
20 281.384796143 275.949633789
30 417.026611328 409.837332153
40 559.338623047 548.382446289
50 728.301574707 710.768920898
60 952.673706055 922.94543457
70 1292.29608154 1239.77844238
80 1907.0904541 1808.08029785
90 3310.55725098 3106.97043457
100 55591.203125 52662.2460938
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net11
Model name for the evaluation phase:  net11
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ----------
  0          1x192x128
  1          32x192x128
  2          32x192x128
  3          32x192x128
  4          32x96x64
  5          32x96x64
  6          32x96x64
  7          32x48x32
  8          2x48x32
  9          2
 10          2

BI_test_bal_complete called with len(X) = 584
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m1.94429[0m     [32m0.72355[0m    2.68715      0.49864  33.13s
BI_test_bal_complete called with len(X) = 584
      2     [36m0.70527[0m     [32m0.70018[0m    1.00727      0.50122  34.23s
BI_test_bal_complete called with len(X) = 584
      3     [36m0.69521[0m     [32m0.69214[0m    1.00443      0.51123  34.78s
BI_test_bal_complete called with len(X) = 584
      4     [36m0.69163[0m     [32m0.68662[0m    1.00729      0.52150  34.67s
BI_test_bal_complete called with len(X) = 584
      5     [36m0.69059[0m     [32m0.67784[0m    1.01881      0.54263  34.69s
BI_test_bal_complete called with len(X) = 584
      6     [36m0.68584[0m     0.68320    1.00387      0.53357  34.75s
BI_test_bal_complete called with len(X) = 584
      7     [36m0.68583[0m     [32m0.67096[0m    1.02216      0.56018  34.65s
BI_test_bal_complete called with len(X) = 584
      8     [36m0.68270[0m     0.67149    1.01669      0.57690  34.64s
BI_test_bal_complete called with len(X) = 584
      9     0.68475     [32m0.66455[0m    1.03039      0.58405  34.70s
BI_test_bal_complete called with len(X) = 584
     10     [36m0.67802[0m     0.66794    1.01509      0.60043  34.61s
BI_test_bal_complete called with len(X) = 584
     11     0.67985     0.67119    1.01291      0.57793  34.76s
BI_test_bal_complete called with len(X) = 584
     12     [36m0.67337[0m     0.66947    1.00583      0.56483  34.93s
BI_test_bal_complete called with len(X) = 584
     13     [36m0.66914[0m     0.67515    0.99111      0.54568  35.00s
BI_test_bal_complete called with len(X) = 584
     14     [36m0.66644[0m     0.66544    1.00150      0.57216  34.78s
BI_test_bal_complete called with len(X) = 584
     15     [36m0.66476[0m     0.67780    0.98076      0.54521  34.86s
BI_test_bal_complete called with len(X) = 584
     16     0.66887     0.67515    0.99070      0.55621  45.61s
BI_test_bal_complete called with len(X) = 584
     17     [36m0.65772[0m     0.67262    0.97786      0.55928  62.11s
BI_test_bal_complete called with len(X) = 584
     18     [36m0.65535[0m     0.68455    0.95734      0.54153  61.23s
BI_test_bal_complete called with len(X) = 584
     19     0.65711     0.68050    0.96563      0.53672  62.31s
BI_test_bal_complete called with len(X) = 584
Early stopping.
Best valid loss was 0.664554 at epoch 9.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 128)
magnitudes_seizure_val.shape (5, 1, 1406, 128)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.696053603461
Error rate (%):  30.3946396539
[[62514 26181]
 [ 2624  3451]]
(94770,)
(94770,)
roc_auc: 0.668464061308
log_loss: 0.540679569562
roc_auc for the hours: 0.72602739726
log_loss for the hours: 0.438545244683
saving predictions to csv file
hourspatient1_5_net11_10-17-05-04-18.csv
Accuracy validation for the hours:  0.794871794872
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 128)
(2256, 1, 234, 128)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [5]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.388838912
saving predictions to csv file
patient1_5_net11_10-17-05-22-53.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu1', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_6']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_6'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu1')
Git reference:  Timestamp: 2016-10-17 05:22:55.153254
Hostname: kat
gpu1
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 128
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net11
evaluation:
    online_training: False
    model: net11

end Configuration
['patient1_6']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 128)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [6]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.967512064
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 100.535629272 92.2065124512
20 241.434768677 232.338137817
30 355.215087891 343.026751709
40 474.378936768 457.111486816
50 617.317993164 592.148742676
60 812.821716309 773.218786621
70 1123.68908691 1054.90100098
80 1711.14892578 1579.50852051
90 3041.21533203 2772.53442383
100 66751.359375 59361.5703125
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net11
Model name for the evaluation phase:  net11
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ----------
  0          1x192x128
  1          32x192x128
  2          32x192x128
  3          32x192x128
  4          32x96x64
  5          32x96x64
  6          32x96x64
  7          32x48x32
  8          2x48x32
  9          2
 10          2

BI_test_bal_complete called with len(X) = 584
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m1.80324[0m     [32m0.71607[0m    2.51825      0.49837  34.72s
BI_test_bal_complete called with len(X) = 584
      2     [36m0.70540[0m     [32m0.69043[0m    1.02168      0.51452  34.74s
BI_test_bal_complete called with len(X) = 584
      3     [36m0.69723[0m     [32m0.68242[0m    1.02170      0.55694  34.23s
BI_test_bal_complete called with len(X) = 584
      4     [36m0.69144[0m     [32m0.68100[0m    1.01534      0.55613  34.25s
BI_test_bal_complete called with len(X) = 584
      5     0.69207     0.68115    1.01602      0.56314  34.18s
BI_test_bal_complete called with len(X) = 584
      6     [36m0.69014[0m     [32m0.67400[0m    1.02395      0.59310  34.16s
BI_test_bal_complete called with len(X) = 584
      7     [36m0.68135[0m     [32m0.66564[0m    1.02360      0.63349  34.20s
BI_test_bal_complete called with len(X) = 584
      8     0.68181     [32m0.65991[0m    1.03319      0.66304  34.23s
BI_test_bal_complete called with len(X) = 584
      9     [36m0.67441[0m     0.66034    1.02132      0.66297  34.25s
BI_test_bal_complete called with len(X) = 584
     10     [36m0.67254[0m     [32m0.65816[0m    1.02185      0.63784  34.15s
BI_test_bal_complete called with len(X) = 584
     11     [36m0.67083[0m     [32m0.65502[0m    1.02413      0.64353  34.15s
BI_test_bal_complete called with len(X) = 584
     12     [36m0.67080[0m     [32m0.64980[0m    1.03233      0.65667  34.20s
BI_test_bal_complete called with len(X) = 584
     13     [36m0.66814[0m     0.65222    1.02440      0.64270  40.67s
BI_test_bal_complete called with len(X) = 584
     14     [36m0.66222[0m     0.65003    1.01876      0.63851  62.18s
BI_test_bal_complete called with len(X) = 584
     15     [36m0.66034[0m     0.65473    1.00857      0.62105  61.37s
BI_test_bal_complete called with len(X) = 584
     16     [36m0.65653[0m     [32m0.64654[0m    1.01545      0.65274  61.97s
BI_test_bal_complete called with len(X) = 584
     17     0.66382     0.65723    1.01002      0.62814  62.12s
BI_test_bal_complete called with len(X) = 584
     18     0.66010     0.64755    1.01939      0.63681  61.39s
BI_test_bal_complete called with len(X) = 584
     19     [36m0.64407[0m     0.65481    0.98359      0.63418  62.11s
BI_test_bal_complete called with len(X) = 584
     20     0.65154     0.67412    0.96650      0.59951  61.41s
BI_test_bal_complete called with len(X) = 584
     21     [36m0.63815[0m     0.66079    0.96573      0.61812  62.13s
BI_test_bal_complete called with len(X) = 584
     22     [36m0.63352[0m     0.66010    0.95974      0.61324  61.14s
BI_test_bal_complete called with len(X) = 584
     23     0.63561     0.66844    0.95088      0.60402  62.28s
BI_test_bal_complete called with len(X) = 584
     24     [36m0.63246[0m     0.65352    0.96778      0.62378  61.77s
BI_test_bal_complete called with len(X) = 584
     25     [36m0.61969[0m     [32m0.64620[0m    0.95898      0.63332  62.22s
BI_test_bal_complete called with len(X) = 584
     26     [36m0.61150[0m     0.65434    0.93453      0.62737  62.31s
BI_test_bal_complete called with len(X) = 584
     27     [36m0.60899[0m     0.68008    0.89547      0.61834  61.39s
BI_test_bal_complete called with len(X) = 584
     28     [36m0.59788[0m     0.68691    0.87040      0.61696  61.89s
BI_test_bal_complete called with len(X) = 584
     29     [36m0.58860[0m     0.67439    0.87278      0.62724  61.25s
BI_test_bal_complete called with len(X) = 584
     30     [36m0.57442[0m     0.66263    0.86687      0.59572  62.08s
BI_test_bal_complete called with len(X) = 584
     31     [36m0.56673[0m     0.65780    0.86155      0.60892  61.30s
BI_test_bal_complete called with len(X) = 584
     32     [36m0.54916[0m     0.67845    0.80943      0.60287  61.92s
BI_test_bal_complete called with len(X) = 584
     33     [36m0.53143[0m     0.69397    0.76578      0.59724  61.36s
BI_test_bal_complete called with len(X) = 584
     34     0.53324     0.68473    0.77875      0.59138  62.16s
BI_test_bal_complete called with len(X) = 584
     35     0.53623     0.68487    0.78297      0.60528  62.12s
BI_test_bal_complete called with len(X) = 584
Early stopping.
Best valid loss was 0.646200 at epoch 25.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 128)
magnitudes_seizure_val.shape (5, 1, 1406, 128)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.80215257993
Error rate (%):  19.784742007
[[74902 13793]
 [ 4957  1118]]
(94770,)
(94770,)
roc_auc: 0.644838261792
log_loss: 0.478479424895
roc_auc for the hours: 0.704109589041
log_loss for the hours: 0.291215714202
saving predictions to csv file
hourspatient1_6_net11_10-17-06-29-46.csv
Accuracy validation for the hours:  0.910256410256
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 128)
(2256, 1, 234, 128)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [6]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.338937344
saving predictions to csv file
patient1_6_net11_10-17-06-34-50.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu1', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_7']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_7'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu1')
Git reference:  Timestamp: 2016-10-17 06:34:51.285977
Hostname: kat
gpu1
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 128
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net11
evaluation:
    online_training: False
    model: net11

end Configuration
['patient1_7']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 128)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [7]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.967364608
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 81.582244873 74.4028320313
20 196.584609985 187.999407959
30 292.416870117 280.539077759
40 397.159698486 380.292034912
50 529.534667969 504.321762085
60 719.643737793 680.063110352
70 1030.46270752 963.365631104
80 1615.28991699 1489.2545166
90 2958.73974609 2699.97087402
100 65353.1796875 57503.8945312
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net11
Model name for the evaluation phase:  net11
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ----------
  0          1x192x128
  1          32x192x128
  2          32x192x128
  3          32x192x128
  4          32x96x64
  5          32x96x64
  6          32x96x64
  7          32x48x32
  8          2x48x32
  9          2
 10          2

BI_test_bal_complete called with len(X) = 584
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m1.73012[0m     [32m0.70745[0m    2.44558      0.49946  62.49s
BI_test_bal_complete called with len(X) = 584
      2     [36m0.70366[0m     [32m0.68687[0m    1.02445      0.52972  61.39s
BI_test_bal_complete called with len(X) = 584
      3     [36m0.69112[0m     [32m0.67673[0m    1.02127      0.57371  62.33s
BI_test_bal_complete called with len(X) = 584
      4     [36m0.68047[0m     [32m0.65598[0m    1.03733      0.62483  61.39s
BI_test_bal_complete called with len(X) = 584
      5     [36m0.66721[0m     [32m0.63835[0m    1.04521      0.61387  62.15s
BI_test_bal_complete called with len(X) = 584
      6     0.68699     0.64990    1.05708      0.64175  61.63s
BI_test_bal_complete called with len(X) = 584
      7     [36m0.65588[0m     0.64140    1.02257      0.64322  62.24s
BI_test_bal_complete called with len(X) = 584
      8     [36m0.65018[0m     0.64084    1.01458      0.64592  62.31s
BI_test_bal_complete called with len(X) = 584
      9     [36m0.64164[0m     [32m0.63407[0m    1.01195      0.65541  61.44s
BI_test_bal_complete called with len(X) = 584
     10     [36m0.64152[0m     [32m0.63154[0m    1.01580      0.63649  62.10s
BI_test_bal_complete called with len(X) = 584
     11     [36m0.63723[0m     [32m0.62487[0m    1.01979      0.64516  61.63s
BI_test_bal_complete called with len(X) = 584
     12     0.63758     0.63064    1.01100      0.63830  62.34s
BI_test_bal_complete called with len(X) = 584
     13     [36m0.62887[0m     0.63516    0.99010      0.63973  61.52s
BI_test_bal_complete called with len(X) = 584
     14     [36m0.62446[0m     [32m0.61827[0m    1.01002      0.63796  62.22s
BI_test_bal_complete called with len(X) = 584
     15     0.62478     0.62531    0.99916      0.64291  59.65s
BI_test_bal_complete called with len(X) = 584
     16     [36m0.61953[0m     0.62178    0.99638      0.64977  48.04s
BI_test_bal_complete called with len(X) = 584
     17     [36m0.61259[0m     0.62045    0.98734      0.63462  34.67s
BI_test_bal_complete called with len(X) = 584
     18     0.61566     0.62410    0.98648      0.64712  34.63s
BI_test_bal_complete called with len(X) = 584
     19     [36m0.61251[0m     0.62919    0.97349      0.59584  34.79s
BI_test_bal_complete called with len(X) = 584
     20     0.61425     0.62300    0.98595      0.64191  44.31s
BI_test_bal_complete called with len(X) = 584
     21     [36m0.60773[0m     0.62046    0.97949      0.64578  46.62s
BI_test_bal_complete called with len(X) = 584
     22     [36m0.60709[0m     [32m0.61081[0m    0.99392      0.67643  35.34s
BI_test_bal_complete called with len(X) = 584
     23     0.61805     0.63481    0.97360      0.64313  35.27s
BI_test_bal_complete called with len(X) = 584
     24     [36m0.60678[0m     0.63266    0.95910      0.63979  35.19s
BI_test_bal_complete called with len(X) = 584
     25     [36m0.60064[0m     0.62700    0.95797      0.64332  35.43s
BI_test_bal_complete called with len(X) = 584
     26     [36m0.59844[0m     0.62883    0.95169      0.60759  35.06s
BI_test_bal_complete called with len(X) = 584
     27     [36m0.58868[0m     0.61491    0.95735      0.64255  35.09s
BI_test_bal_complete called with len(X) = 584
     28     [36m0.58407[0m     [32m0.60299[0m    0.96863      0.67693  35.06s
BI_test_bal_complete called with len(X) = 584
     29     [36m0.57811[0m     0.61072    0.94660      0.66630  35.16s
BI_test_bal_complete called with len(X) = 584
     30     [36m0.57347[0m     0.60564    0.94689      0.66405  35.28s
BI_test_bal_complete called with len(X) = 584
     31     [36m0.55705[0m     0.60375    0.92265      0.64541  35.23s
BI_test_bal_complete called with len(X) = 584
     32     [36m0.55032[0m     [32m0.59228[0m    0.92914      0.67606  35.18s
BI_test_bal_complete called with len(X) = 584
     33     [36m0.53358[0m     0.60762    0.87814      0.65945  35.20s
BI_test_bal_complete called with len(X) = 584
     34     [36m0.52428[0m     [32m0.59095[0m    0.88719      0.66459  35.16s
BI_test_bal_complete called with len(X) = 584
     35     [36m0.50499[0m     0.60833    0.83012      0.66640  35.00s
BI_test_bal_complete called with len(X) = 584
     36     [36m0.50038[0m     0.59941    0.83479      0.67473  34.91s
BI_test_bal_complete called with len(X) = 584
     37     [36m0.49489[0m     0.62722    0.78902      0.63862  34.81s
BI_test_bal_complete called with len(X) = 584
     38     [36m0.48523[0m     0.62505    0.77632      0.66865  35.03s
BI_test_bal_complete called with len(X) = 584
     39     [36m0.46922[0m     0.64788    0.72423      0.66450  34.91s
BI_test_bal_complete called with len(X) = 584
     40     [36m0.44534[0m     0.65712    0.67772      0.66631  34.85s
BI_test_bal_complete called with len(X) = 584
     41     [36m0.43874[0m     0.65286    0.67202      0.63498  34.65s
BI_test_bal_complete called with len(X) = 584
     42     [36m0.41731[0m     0.65667    0.63549      0.66350  34.85s
BI_test_bal_complete called with len(X) = 584
     43     [36m0.41547[0m     0.67677    0.61390      0.64648  34.73s
BI_test_bal_complete called with len(X) = 584
     44     [36m0.38845[0m     0.72474    0.53598      0.63856  34.74s
BI_test_bal_complete called with len(X) = 584
Early stopping.
Best valid loss was 0.590950 at epoch 34.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 128)
magnitudes_seizure_val.shape (5, 1, 1406, 128)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.813295346629
Error rate (%):  18.6704653371
[[75072 13623]
 [ 4071  2004]]
(94770,)
(94770,)
roc_auc: 0.705839950429
log_loss: inf
roc_auc for the hours: 0.780821917808
log_loss for the hours: 0.256667508189
saving predictions to csv file
hourspatient1_7_net11_10-17-07-36-30.csv
Accuracy validation for the hours:  0.923076923077
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 128)
(2256, 1, 234, 128)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [7]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.389121536
saving predictions to csv file
patient1_7_net11_10-17-07-41-27.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu1', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_8']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_8'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu1')
Git reference:  Timestamp: 2016-10-17 07:41:29.029767
Hostname: kat
gpu1
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 128
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net11
evaluation:
    online_training: False
    model: net11

end Configuration
['patient1_8']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 128)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [8]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.96792576
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 59.6844711304 56.1110534668
20 142.626998901 140.553536987
30 212.867408752 211.097918701
40 292.92855835 290.821942139
50 402.901031494 398.509048462
60 578.853942871 567.854541016
70 867.531066895 843.190081787
80 1325.63452148 1279.49455566
90 2169.99145508 2082.35715332
100 59862.1054688 57871.4179688
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net11
Model name for the evaluation phase:  net11
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ----------
  0          1x192x128
  1          32x192x128
  2          32x192x128
  3          32x192x128
  4          32x96x64
  5          32x96x64
  6          32x96x64
  7          32x48x32
  8          2x48x32
  9          2
 10          2

BI_test_bal_complete called with len(X) = 584
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m1.48839[0m     [32m0.68222[0m    2.18168      0.54244  62.56s
BI_test_bal_complete called with len(X) = 584
      2     [36m0.68180[0m     [32m0.67452[0m    1.01080      0.49308  61.35s
BI_test_bal_complete called with len(X) = 584
      3     [36m0.66899[0m     0.68371    0.97846      0.44306  62.14s
BI_test_bal_complete called with len(X) = 584
      4     [36m0.66528[0m     0.68032    0.97790      0.45550  61.79s
BI_test_bal_complete called with len(X) = 584
      5     [36m0.66263[0m     0.67707    0.97866      0.47518  62.48s
BI_test_bal_complete called with len(X) = 584
      6     0.66458     0.67671    0.98208      0.48736  59.91s
BI_test_bal_complete called with len(X) = 584
      7     [36m0.65502[0m     0.67548    0.96971      0.48174  46.23s
BI_test_bal_complete called with len(X) = 584
      8     [36m0.65142[0m     0.67677    0.96254      0.47418  34.75s
BI_test_bal_complete called with len(X) = 584
      9     [36m0.65014[0m     [32m0.67403[0m    0.96454      0.49784  34.74s
BI_test_bal_complete called with len(X) = 584
     10     0.65245     [32m0.66832[0m    0.97626      0.53375  34.74s
BI_test_bal_complete called with len(X) = 584
     11     [36m0.64762[0m     [32m0.66734[0m    0.97046      0.51803  34.65s
BI_test_bal_complete called with len(X) = 584
     12     [36m0.64154[0m     0.66878    0.95928      0.52080  47.31s
BI_test_bal_complete called with len(X) = 584
     13     [36m0.63904[0m     [32m0.66551[0m    0.96023      0.56216  43.53s
BI_test_bal_complete called with len(X) = 584
     14     0.63952     0.66617    0.95999      0.57325  34.54s
BI_test_bal_complete called with len(X) = 584
     15     [36m0.63724[0m     [32m0.66089[0m    0.96421      0.55574  34.63s
BI_test_bal_complete called with len(X) = 584
     16     [36m0.63200[0m     0.66879    0.94499      0.55109  34.52s
BI_test_bal_complete called with len(X) = 584
     17     0.63485     0.66964    0.94806      0.54064  34.73s
BI_test_bal_complete called with len(X) = 584
     18     [36m0.62492[0m     0.67099    0.93135      0.54289  34.58s
BI_test_bal_complete called with len(X) = 584
     19     [36m0.62000[0m     0.67665    0.91628      0.54239  34.37s
BI_test_bal_complete called with len(X) = 584
     20     0.62065     0.67556    0.91871      0.54172  34.47s
BI_test_bal_complete called with len(X) = 584
     21     [36m0.61199[0m     0.67199    0.91071      0.54597  34.20s
BI_test_bal_complete called with len(X) = 584
     22     [36m0.61143[0m     0.67664    0.90362      0.56062  34.33s
BI_test_bal_complete called with len(X) = 584
     23     [36m0.60495[0m     0.68334    0.88528      0.54563  34.39s
BI_test_bal_complete called with len(X) = 584
     24     [36m0.59449[0m     0.67944    0.87497      0.58442  34.68s
BI_test_bal_complete called with len(X) = 584
     25     0.59983     0.67534    0.88819      0.57112  34.65s
BI_test_bal_complete called with len(X) = 584
Early stopping.
Best valid loss was 0.660894 at epoch 15.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 128)
magnitudes_seizure_val.shape (5, 1, 1406, 128)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.563965389891
Error rate (%):  43.6034610109
[[51026 37669]
 [ 3654  2421]]
(94770,)
(94770,)
roc_auc: 0.531738599264
log_loss: 0.783368901098
roc_auc for the hours: 0.520547945205
log_loss for the hours: 0.620216466842
saving predictions to csv file
hourspatient1_8_net11_10-17-08-16-48.csv
Accuracy validation for the hours:  0.628205128205
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 128)
(2256, 1, 234, 128)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [8]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.389584384
saving predictions to csv file
patient1_8_net11_10-17-08-23-48.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu1', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_9']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_9'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu1')
Git reference:  Timestamp: 2016-10-17 08:23:49.781847
Hostname: kat
gpu1
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 128
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net11
evaluation:
    online_training: False
    model: net11

end Configuration
['patient1_9']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 128)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [9]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.96765952
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 3.35964345932 3.20504875183
20 8.10253810883 7.91148004532
30 12.2129421234 11.8917930603
40 17.4483966827 16.8013538361
50 31.5138092041 27.4074115753
60 142.106063843 126.067256165
70 272.591552734 253.403834534
80 542.72442627 500.744226074
90 1203.21612549 1109.10134277
100 43853.8789062 40357.3945312
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net11
Model name for the evaluation phase:  net11
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ----------
  0          1x192x128
  1          32x192x128
  2          32x192x128
  3          32x192x128
  4          32x96x64
  5          32x96x64
  6          32x96x64
  7          32x48x32
  8          2x48x32
  9          2
 10          2

BI_test_bal_complete called with len(X) = 584
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m1.37437[0m     [32m0.68939[0m    1.99361      0.50109  33.79s
BI_test_bal_complete called with len(X) = 584
      2     [36m0.69893[0m     0.69339    1.00799      0.48412  34.82s
BI_test_bal_complete called with len(X) = 584
      3     [36m0.69645[0m     0.69612    1.00047      0.44144  37.67s
BI_test_bal_complete called with len(X) = 584
      4     [36m0.69633[0m     [32m0.68935[0m    1.01012      0.54882  52.92s
BI_test_bal_complete called with len(X) = 584
      5     0.70311     0.69812    1.00714      0.43308  34.65s
BI_test_bal_complete called with len(X) = 584
      6     [36m0.69194[0m     0.69705    0.99268      0.43463  35.30s
BI_test_bal_complete called with len(X) = 584
      7     [36m0.69047[0m     0.69622    0.99175      0.43549  35.26s
BI_test_bal_complete called with len(X) = 584
      8     [36m0.69038[0m     0.69498    0.99337      0.43505  35.16s
BI_test_bal_complete called with len(X) = 584
      9     0.69135     0.69528    0.99435      0.43757  35.25s
BI_test_bal_complete called with len(X) = 584
     10     0.69380     0.69549    0.99756      0.43833  35.13s
BI_test_bal_complete called with len(X) = 584
     11     [36m0.68805[0m     0.69149    0.99503      0.43914  34.96s
BI_test_bal_complete called with len(X) = 584
     12     [36m0.68702[0m     0.69258    0.99196      0.43220  35.18s
BI_test_bal_complete called with len(X) = 584
     13     0.68748     [32m0.68798[0m    0.99927      0.54622  35.29s
BI_test_bal_complete called with len(X) = 584
     14     0.68803     0.69212    0.99409      0.43000  34.95s
BI_test_bal_complete called with len(X) = 584
     15     [36m0.68547[0m     0.69133    0.99154      0.44130  34.95s
BI_test_bal_complete called with len(X) = 584
     16     [36m0.68513[0m     0.69366    0.98770      0.42141  35.12s
BI_test_bal_complete called with len(X) = 584
     17     [36m0.68411[0m     0.68826    0.99396      0.51499  35.26s
BI_test_bal_complete called with len(X) = 584
     18     0.77541     1.21269    0.63942      0.45195  34.98s
BI_test_bal_complete called with len(X) = 584
     19     0.89508     0.77132    1.16045      0.44330  35.14s
BI_test_bal_complete called with len(X) = 584
     20     0.80202     0.68975    1.16277      0.43262  35.32s
BI_test_bal_complete called with len(X) = 584
     21     0.68467     0.68910    0.99358      0.47437  34.93s
BI_test_bal_complete called with len(X) = 584
     22     [36m0.68333[0m     0.69041    0.98976      0.44128  35.20s
BI_test_bal_complete called with len(X) = 584
     23     [36m0.68222[0m     0.69240    0.98530      0.44785  34.99s
BI_test_bal_complete called with len(X) = 584
Early stopping.
Best valid loss was 0.687982 at epoch 13.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 128)
magnitudes_seizure_val.shape (5, 1, 1406, 128)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.485849952517
Error rate (%):  51.4150047483
[[43609 45086]
 [ 3640  2435]]
(94770,)
(94770,)
roc_auc: 0.487686926367
log_loss: 0.585093666935
roc_auc for the hours: 0.52602739726
log_loss for the hours: 0.579795683758
saving predictions to csv file
hourspatient1_9_net11_10-17-08-58-39.csv
Accuracy validation for the hours:  0.512820512821
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 128)
(2256, 1, 234, 128)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [9]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.389350912
saving predictions to csv file
patient1_9_net11_10-17-09-02-53.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu1', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_10']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_10'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu1')
Git reference:  Timestamp: 2016-10-17 09:02:54.878590
Hostname: kat
gpu1
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 128
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net11
evaluation:
    online_training: False
    model: net11

end Configuration
['patient1_10']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 128)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [10]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.966885376
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 66.8888320923 63.2854866028
20 160.625854492 158.950335693
30 239.390991211 238.001335144
40 327.787109375 325.936590576
50 445.357696533 441.208770752
60 621.952392578 612.398669434
70 896.389892578 876.646807861
80 1331.78234863 1292.5548584
90 2112.39123535 2039.57905273
100 41643.4882812 36225.46875
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net11
Model name for the evaluation phase:  net11
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ----------
  0          1x192x128
  1          32x192x128
  2          32x192x128
  3          32x192x128
  4          32x96x64
  5          32x96x64
  6          32x96x64
  7          32x48x32
  8          2x48x32
  9          2
 10          2

BI_test_bal_complete called with len(X) = 584
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m1.44631[0m     [32m0.69016[0m    2.09561      0.53074  32.35s
BI_test_bal_complete called with len(X) = 584
      2     [36m0.69374[0m     [32m0.68172[0m    1.01764      0.53894  33.47s
BI_test_bal_complete called with len(X) = 584
      3     [36m0.68239[0m     [32m0.67994[0m    1.00360      0.47687  33.96s
BI_test_bal_complete called with len(X) = 584
      4     [36m0.68128[0m     0.68159    0.99955      0.53178  34.07s
BI_test_bal_complete called with len(X) = 584
      5     [36m0.67585[0m     0.68130    0.99199      0.51079  33.99s
BI_test_bal_complete called with len(X) = 584
      6     [36m0.67442[0m     0.68179    0.98919      0.52895  34.00s
BI_test_bal_complete called with len(X) = 584
      7     [36m0.66873[0m     0.68530    0.97583      0.54152  34.29s
BI_test_bal_complete called with len(X) = 584
      8     [36m0.66854[0m     0.68321    0.97852      0.53967  34.55s
BI_test_bal_complete called with len(X) = 584
      9     [36m0.66251[0m     0.68220    0.97114      0.53838  34.48s
BI_test_bal_complete called with len(X) = 584
     10     [36m0.65924[0m     0.68965    0.95590      0.52507  34.49s
BI_test_bal_complete called with len(X) = 584
     11     [36m0.65625[0m     0.68617    0.95639      0.50068  34.39s
BI_test_bal_complete called with len(X) = 584
     12     [36m0.64881[0m     0.68803    0.94299      0.49649  34.56s
BI_test_bal_complete called with len(X) = 584
     13     0.64889     0.69282    0.93660      0.46432  34.29s
BI_test_bal_complete called with len(X) = 584
Early stopping.
Best valid loss was 0.679939 at epoch 3.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 128)
magnitudes_seizure_val.shape (5, 1, 1406, 128)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.376975836235
Error rate (%):  62.3024163765
[[32315 56380]
 [ 2664  3411]]
(94770,)
(94770,)
roc_auc: 0.500583849448
log_loss: 1.03272371691
roc_auc for the hours: 0.493150684932
log_loss for the hours: 0.924255007486
saving predictions to csv file
hourspatient1_10_net11_10-17-09-37-17.csv
Accuracy validation for the hours:  0.320512820513
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 128)
(2256, 1, 234, 128)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [10]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.3375488
saving predictions to csv file
patient1_10_net11_10-17-09-57-10.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu1', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_11']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_11'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu1')
Git reference:  Timestamp: 2016-10-17 09:57:11.497096
Hostname: kat
gpu1
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 128
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net11
evaluation:
    online_training: False
    model: net11

end Configuration
['patient1_11']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 128)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [11]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.966447104
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 60.525062561 57.3594532013
20 145.338256836 144.219766235
30 217.698493958 216.646340942
40 300.634613037 298.80065918
50 413.604797363 408.807891846
60 584.731384277 573.598864746
70 846.355865479 822.354333496
80 1246.6295166 1200.8440918
90 1946.331604 1861.70946045
100 34311.5273438 30092.4199219
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net11
Model name for the evaluation phase:  net11
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ----------
  0          1x192x128
  1          32x192x128
  2          32x192x128
  3          32x192x128
  4          32x96x64
  5          32x96x64
  6          32x96x64
  7          32x48x32
  8          2x48x32
  9          2
 10          2

BI_test_bal_complete called with len(X) = 584
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m1.40343[0m     [32m0.69727[0m    2.01276      0.50326  45.70s
BI_test_bal_complete called with len(X) = 584
      2     [36m0.68367[0m     [32m0.69710[0m    0.98074      0.53813  34.83s
BI_test_bal_complete called with len(X) = 584
      3     [36m0.66337[0m     0.70985    0.93452      0.53557  34.61s
BI_test_bal_complete called with len(X) = 584
      4     [36m0.65332[0m     0.70812    0.92261      0.51501  34.74s
BI_test_bal_complete called with len(X) = 584
      5     [36m0.64924[0m     0.70367    0.92264      0.47868  46.13s
BI_test_bal_complete called with len(X) = 584
      6     [36m0.64458[0m     0.70298    0.91692      0.50285  44.75s
BI_test_bal_complete called with len(X) = 584
      7     [36m0.63375[0m     0.70726    0.89606      0.47714  34.35s
BI_test_bal_complete called with len(X) = 584
      8     [36m0.62656[0m     0.71903    0.87140      0.46902  34.44s
BI_test_bal_complete called with len(X) = 584
      9     [36m0.62415[0m     0.71072    0.87818      0.49081  34.57s
BI_test_bal_complete called with len(X) = 584
     10     [36m0.61445[0m     0.71690    0.85709      0.53456  34.53s
BI_test_bal_complete called with len(X) = 584
     11     [36m0.60840[0m     0.71481    0.85113      0.48848  34.47s
BI_test_bal_complete called with len(X) = 584
     12     [36m0.60055[0m     0.71538    0.83949      0.53593  34.36s
BI_test_bal_complete called with len(X) = 584
Early stopping.
Best valid loss was 0.697100 at epoch 2.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 128)
magnitudes_seizure_val.shape (5, 1, 1406, 128)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.177207977208
Error rate (%):  82.2792022792
[[11253 77442]
 [  534  5541]]
(94770,)
(94770,)
roc_auc: 0.485290050033
log_loss: 1.99136968291
roc_auc for the hours: 0.512328767123
log_loss for the hours: 1.76370188431
saving predictions to csv file
hourspatient1_11_net11_10-17-10-30-50.csv
Accuracy validation for the hours:  0.192307692308
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 128)
(2256, 1, 234, 128)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [11]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.38827776
saving predictions to csv file
patient1_11_net11_10-17-10-35-18.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu1', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_12']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_12'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu1')
Git reference:  Timestamp: 2016-10-17 10:35:20.056629
Hostname: kat
gpu1
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 128
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net11
evaluation:
    online_training: False
    model: net11

end Configuration
['patient1_12']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 128)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [12]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.967651328
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 86.7612037659 80.5230926514
20 207.758453369 201.967654419
30 306.349380493 299.434872437
40 411.187866211 402.185339355
50 538.487548828 526.588867188
60 709.49597168 692.006640625
70 955.721862793 928.018432617
80 1335.3548584 1288.53144531
90 2054.22277832 1965.38182373
100 68176.640625 59867.6914062
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net11
Model name for the evaluation phase:  net11
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ----------
  0          1x192x128
  1          32x192x128
  2          32x192x128
  3          32x192x128
  4          32x96x64
  5          32x96x64
  6          32x96x64
  7          32x48x32
  8          2x48x32
  9          2
 10          2

BI_test_bal_complete called with len(X) = 584
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m1.44604[0m     [32m0.70641[0m    2.04703      0.53183  32.22s
BI_test_bal_complete called with len(X) = 584
      2     [36m0.67356[0m     [32m0.70633[0m    0.95360      0.55224  32.28s
BI_test_bal_complete called with len(X) = 584
      3     [36m0.66430[0m     [32m0.70135[0m    0.94718      0.56127  33.72s
BI_test_bal_complete called with len(X) = 584
      4     [36m0.66027[0m     [32m0.69879[0m    0.94487      0.56235  34.68s
BI_test_bal_complete called with len(X) = 584
      5     [36m0.65586[0m     [32m0.69787[0m    0.93981      0.56449  34.22s
BI_test_bal_complete called with len(X) = 584
      6     0.65683     [32m0.68549[0m    0.95819      0.56646  34.08s
BI_test_bal_complete called with len(X) = 584
      7     [36m0.64903[0m     [32m0.67263[0m    0.96490      0.57777  34.00s
BI_test_bal_complete called with len(X) = 584
      8     [36m0.64838[0m     [32m0.66757[0m    0.97126      0.57418  33.99s
BI_test_bal_complete called with len(X) = 584
      9     [36m0.64157[0m     [32m0.66428[0m    0.96581      0.57514  34.10s
BI_test_bal_complete called with len(X) = 584
     10     0.64194     0.66602    0.96384      0.56790  33.99s
BI_test_bal_complete called with len(X) = 584
     11     [36m0.63528[0m     [32m0.65675[0m    0.96731      0.57604  33.83s
BI_test_bal_complete called with len(X) = 584
     12     0.63861     [32m0.65027[0m    0.98207      0.57672  33.93s
BI_test_bal_complete called with len(X) = 584
     13     [36m0.63050[0m     0.68253    0.92377      0.56270  34.05s
BI_test_bal_complete called with len(X) = 584
     14     0.63289     [32m0.64989[0m    0.97384      0.58408  33.97s
BI_test_bal_complete called with len(X) = 584
     15     [36m0.62676[0m     0.66063    0.94874      0.56896  33.93s
BI_test_bal_complete called with len(X) = 584
     16     [36m0.62283[0m     0.66043    0.94307      0.59315  33.86s
BI_test_bal_complete called with len(X) = 584
     17     0.63079     0.65050    0.96970      0.57386  34.10s
BI_test_bal_complete called with len(X) = 584
     18     [36m0.61869[0m     0.66666    0.92804      0.57655  34.00s
BI_test_bal_complete called with len(X) = 584
     19     [36m0.61849[0m     [32m0.64816[0m    0.95422      0.60610  34.00s
BI_test_bal_complete called with len(X) = 584
     20     [36m0.61778[0m     0.65260    0.94666      0.59438  34.06s
BI_test_bal_complete called with len(X) = 584
     21     [36m0.61148[0m     [32m0.64388[0m    0.94968      0.59696  33.95s
BI_test_bal_complete called with len(X) = 584
     22     [36m0.60587[0m     [32m0.62614[0m    0.96763      0.62598  34.21s
BI_test_bal_complete called with len(X) = 584
     23     0.61012     0.63585    0.95953      0.59777  34.42s
BI_test_bal_complete called with len(X) = 584
     24     [36m0.59624[0m     0.65941    0.90420      0.59555  34.62s
BI_test_bal_complete called with len(X) = 584
     25     [36m0.59267[0m     0.64029    0.92562      0.58951  34.54s
BI_test_bal_complete called with len(X) = 584
     26     [36m0.58220[0m     0.63675    0.91433      0.61680  34.64s
BI_test_bal_complete called with len(X) = 584
     27     [36m0.57892[0m     [32m0.62497[0m    0.92631      0.66213  34.65s
BI_test_bal_complete called with len(X) = 584
     28     [36m0.56465[0m     0.65525    0.86174      0.61615  34.47s
BI_test_bal_complete called with len(X) = 584
     29     [36m0.56127[0m     0.68166    0.82338      0.61503  34.52s
BI_test_bal_complete called with len(X) = 584
     30     [36m0.55795[0m     0.65308    0.85434      0.65157  34.64s
BI_test_bal_complete called with len(X) = 584
     31     [36m0.55528[0m     0.66358    0.83679      0.61595  34.73s
BI_test_bal_complete called with len(X) = 584
     32     [36m0.53620[0m     0.68311    0.78494      0.61995  34.74s
BI_test_bal_complete called with len(X) = 584
     33     0.54064     0.66380    0.81446      0.64025  34.72s
BI_test_bal_complete called with len(X) = 584
     34     [36m0.52331[0m     0.67916    0.77052      0.64534  34.51s
BI_test_bal_complete called with len(X) = 584
     35     [36m0.51171[0m     0.72067    0.71004      0.58158  34.59s
BI_test_bal_complete called with len(X) = 584
     36     [36m0.49768[0m     0.70114    0.70981      0.61989  34.73s
BI_test_bal_complete called with len(X) = 584
     37     0.49956     0.69241    0.72149      0.59493  34.58s
BI_test_bal_complete called with len(X) = 584
Early stopping.
Best valid loss was 0.624969 at epoch 27.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 128)
magnitudes_seizure_val.shape (5, 1, 1406, 128)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.667257570961
Error rate (%):  33.2742429039
[[59388 29307]
 [ 2227  3848]]
(94770,)
(94770,)
roc_auc: 0.707528401882
log_loss: 0.991326115535
roc_auc for the hours: 0.841095890411
log_loss for the hours: 0.474319058553
saving predictions to csv file
hourspatient1_12_net11_10-17-11-19-06.csv
Accuracy validation for the hours:  0.75641025641
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 128)
(2256, 1, 234, 128)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [12]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.389432832
saving predictions to csv file
patient1_12_net11_10-17-11-23-36.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu1', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_13']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_13'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu1')
Git reference:  Timestamp: 2016-10-17 11:23:38.269806
Hostname: kat
gpu1
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 128
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net11
evaluation:
    online_training: False
    model: net11

end Configuration
['patient1_13']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 128)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [13]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.966766592
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 73.9333953857 69.9260322571
20 178.924575806 177.360931396
30 269.78352356 268.467407227
40 374.451538086 372.431341553
50 513.032531738 508.888763428
60 706.827392578 697.641821289
70 978.471557617 960.035961914
80 1377.28601074 1341.23137207
90 2097.61413574 2024.86938477
100 37327.25 36955.34375
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net11
Model name for the evaluation phase:  net11
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ----------
  0          1x192x128
  1          32x192x128
  2          32x192x128
  3          32x192x128
  4          32x96x64
  5          32x96x64
  6          32x96x64
  7          32x48x32
  8          2x48x32
  9          2
 10          2

BI_test_bal_complete called with len(X) = 584
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m1.45688[0m     [32m0.69579[0m    2.09384      0.50299  32.26s
BI_test_bal_complete called with len(X) = 584
      2     [36m0.68749[0m     [32m0.68541[0m    1.00303      0.56716  32.49s
BI_test_bal_complete called with len(X) = 584
      3     [36m0.67187[0m     [32m0.67574[0m    0.99427      0.59021  33.64s
BI_test_bal_complete called with len(X) = 584
      4     [36m0.66608[0m     [32m0.66503[0m    1.00157      0.60400  34.21s
BI_test_bal_complete called with len(X) = 584
      5     [36m0.66048[0m     [32m0.66071[0m    0.99965      0.60982  34.13s
BI_test_bal_complete called with len(X) = 584
      6     0.66130     [32m0.65494[0m    1.00971      0.60940  34.16s
BI_test_bal_complete called with len(X) = 584
      7     [36m0.65397[0m     [32m0.64781[0m    1.00950      0.61049  34.08s
BI_test_bal_complete called with len(X) = 584
      8     [36m0.65308[0m     [32m0.64190[0m    1.01742      0.61359  34.45s
BI_test_bal_complete called with len(X) = 584
      9     [36m0.64649[0m     [32m0.63778[0m    1.01366      0.61595  34.39s
BI_test_bal_complete called with len(X) = 584
     10     [36m0.64648[0m     0.64262    1.00600      0.61507  34.25s
BI_test_bal_complete called with len(X) = 584
     11     [36m0.64461[0m     [32m0.63000[0m    1.02319      0.61182  34.46s
BI_test_bal_complete called with len(X) = 584
     12     0.64856     0.63066    1.02838      0.61804  34.45s
BI_test_bal_complete called with len(X) = 584
     13     [36m0.63848[0m     0.63651    1.00310      0.61622  34.55s
BI_test_bal_complete called with len(X) = 584
     14     [36m0.63782[0m     [32m0.62572[0m    1.01934      0.61793  34.59s
BI_test_bal_complete called with len(X) = 584
     15     [36m0.63202[0m     [32m0.61762[0m    1.02331      0.63023  34.49s
BI_test_bal_complete called with len(X) = 584
     16     [36m0.63185[0m     [32m0.61022[0m    1.03545      0.62766  34.58s
BI_test_bal_complete called with len(X) = 584
     17     [36m0.62950[0m     0.61882    1.01725      0.62220  34.37s
BI_test_bal_complete called with len(X) = 584
     18     [36m0.62176[0m     0.61324    1.01389      0.63219  34.36s
BI_test_bal_complete called with len(X) = 584
     19     [36m0.61589[0m     [32m0.59934[0m    1.02761      0.65038  34.46s
BI_test_bal_complete called with len(X) = 584
     20     0.62071     0.60288    1.02957      0.64731  34.59s
BI_test_bal_complete called with len(X) = 584
     21     [36m0.60972[0m     [32m0.58603[0m    1.04042      0.68619  34.79s
BI_test_bal_complete called with len(X) = 584
     22     [36m0.60578[0m     0.59836    1.01239      0.67209  34.96s
BI_test_bal_complete called with len(X) = 584
     23     [36m0.60485[0m     0.58872    1.02740      0.68658  35.10s
BI_test_bal_complete called with len(X) = 584
     24     [36m0.59806[0m     0.59806    1.00001      0.64821  35.27s
BI_test_bal_complete called with len(X) = 584
     25     [36m0.58892[0m     0.60588    0.97201      0.65279  35.03s
BI_test_bal_complete called with len(X) = 584
     26     [36m0.58396[0m     0.60264    0.96899      0.64959  35.05s
BI_test_bal_complete called with len(X) = 584
     27     [36m0.57063[0m     0.60390    0.94490      0.62568  35.11s
BI_test_bal_complete called with len(X) = 584
     28     [36m0.56209[0m     0.59947    0.93764      0.66478  34.95s
BI_test_bal_complete called with len(X) = 584
     29     [36m0.55665[0m     0.59680    0.93272      0.65844  35.26s
BI_test_bal_complete called with len(X) = 584
     30     [36m0.53870[0m     0.60810    0.88587      0.65157  34.69s
BI_test_bal_complete called with len(X) = 584
     31     [36m0.53330[0m     0.59416    0.89756      0.65784  34.61s
BI_test_bal_complete called with len(X) = 584
Early stopping.
Best valid loss was 0.586029 at epoch 21.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 128)
magnitudes_seizure_val.shape (5, 1, 1406, 128)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.689173789174
Error rate (%):  31.0826210826
[[61650 27045]
 [ 2412  3663]]
(94770,)
(94770,)
roc_auc: 0.738291850024
log_loss: 0.771917886898
roc_auc for the hours: 0.838356164384
log_loss for the hours: 0.4320238378
saving predictions to csv file
hourspatient1_13_net11_10-17-12-26-38.csv
Accuracy validation for the hours:  0.769230769231
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 128)
(2256, 1, 234, 128)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [13]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.388457984
saving predictions to csv file
patient1_13_net11_10-17-12-44-54.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu1', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_14']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_14'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu1')
Git reference:  Timestamp: 2016-10-17 12:44:55.782527
Hostname: kat
gpu1
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 128
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net11
evaluation:
    online_training: False
    model: net11

end Configuration
['patient1_14']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 128)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [14]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.967655424
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 81.7122993469 77.0501960754
20 196.209899902 193.778765869
30 289.95916748 287.775204468
40 390.824188232 387.984130859
50 515.545837402 510.738021851
60 685.187927246 675.473510742
70 925.429931641 907.243328857
80 1279.13037109 1245.98547363
90 1890.15374756 1825.94031982
100 43412.1367188 33402.015625
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net11
Model name for the evaluation phase:  net11
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ----------
  0          1x192x128
  1          32x192x128
  2          32x192x128
  3          32x192x128
  4          32x96x64
  5          32x96x64
  6          32x96x64
  7          32x48x32
  8          2x48x32
  9          2
 10          2

BI_test_bal_complete called with len(X) = 584
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m1.38877[0m     [32m0.69744[0m    1.99122      0.49728  32.00s
BI_test_bal_complete called with len(X) = 584
      2     [36m0.69093[0m     [32m0.68418[0m    1.00987      0.54573  32.07s
BI_test_bal_complete called with len(X) = 584
      3     [36m0.67907[0m     [32m0.66753[0m    1.01728      0.57858  32.92s
BI_test_bal_complete called with len(X) = 584
      4     [36m0.67347[0m     0.67439    0.99863      0.56289  33.96s
BI_test_bal_complete called with len(X) = 584
      5     [36m0.67005[0m     [32m0.65780[0m    1.01864      0.57987  33.93s
BI_test_bal_complete called with len(X) = 584
      6     [36m0.66400[0m     [32m0.65633[0m    1.01168      0.57869  34.21s
BI_test_bal_complete called with len(X) = 584
      7     [36m0.65989[0m     [32m0.64774[0m    1.01876      0.58588  34.59s
BI_test_bal_complete called with len(X) = 584
      8     [36m0.65861[0m     0.66369    0.99234      0.56929  34.68s
BI_test_bal_complete called with len(X) = 584
      9     [36m0.65634[0m     [32m0.63686[0m    1.03058      0.60027  34.51s
BI_test_bal_complete called with len(X) = 584
     10     [36m0.65234[0m     [32m0.63371[0m    1.02941      0.60233  34.55s
BI_test_bal_complete called with len(X) = 584
     11     [36m0.65089[0m     [32m0.63152[0m    1.03068      0.59854  34.69s
BI_test_bal_complete called with len(X) = 584
     12     [36m0.64886[0m     0.63584    1.02049      0.59670  34.54s
BI_test_bal_complete called with len(X) = 584
     13     [36m0.64741[0m     [32m0.62985[0m    1.02789      0.59838  34.65s
BI_test_bal_complete called with len(X) = 584
     14     [36m0.64525[0m     [32m0.62697[0m    1.02915      0.60818  34.77s
BI_test_bal_complete called with len(X) = 584
     15     [36m0.64055[0m     0.64068    0.99980      0.58920  34.60s
BI_test_bal_complete called with len(X) = 584
     16     0.64612     [32m0.62470[0m    1.03428      0.60663  34.71s
BI_test_bal_complete called with len(X) = 584
     17     [36m0.63483[0m     0.63104    1.00601      0.60113  34.39s
BI_test_bal_complete called with len(X) = 584
     18     0.63491     [32m0.62158[0m    1.02144      0.61482  33.94s
BI_test_bal_complete called with len(X) = 584
     19     [36m0.62748[0m     0.62487    1.00418      0.61582  33.89s
BI_test_bal_complete called with len(X) = 584
     20     0.62890     [32m0.61683[0m    1.01958      0.62733  33.89s
BI_test_bal_complete called with len(X) = 584
     21     [36m0.62634[0m     0.65519    0.95596      0.60049  33.91s
BI_test_bal_complete called with len(X) = 584
     22     [36m0.62013[0m     [32m0.61611[0m    1.00653      0.63331  34.12s
BI_test_bal_complete called with len(X) = 584
     23     [36m0.61049[0m     0.63944    0.95473      0.62167  34.22s
BI_test_bal_complete called with len(X) = 584
     24     [36m0.60468[0m     0.62462    0.96807      0.63301  34.12s
BI_test_bal_complete called with len(X) = 584
     25     [36m0.59510[0m     0.62778    0.94794      0.62737  34.24s
BI_test_bal_complete called with len(X) = 584
     26     [36m0.59381[0m     0.62218    0.95440      0.61165  34.22s
BI_test_bal_complete called with len(X) = 584
     27     [36m0.57677[0m     0.65396    0.88197      0.58297  34.36s
BI_test_bal_complete called with len(X) = 584
     28     [36m0.57017[0m     0.65425    0.87149      0.59022  34.26s
BI_test_bal_complete called with len(X) = 584
     29     [36m0.56953[0m     0.63860    0.89185      0.60092  34.45s
BI_test_bal_complete called with len(X) = 584
     30     [36m0.55650[0m     0.65011    0.85600      0.58270  34.60s
BI_test_bal_complete called with len(X) = 584
     31     [36m0.54554[0m     0.65786    0.82926      0.59919  34.49s
BI_test_bal_complete called with len(X) = 584
     32     [36m0.53298[0m     0.64984    0.82017      0.58742  34.45s
BI_test_bal_complete called with len(X) = 584
Early stopping.
Best valid loss was 0.616113 at epoch 22.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 128)
magnitudes_seizure_val.shape (5, 1, 1406, 128)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.637554078295
Error rate (%):  36.2445921705
[[57295 31400]
 [ 2949  3126]]
(94770,)
(94770,)
roc_auc: 0.665870286043
log_loss: 0.822773584864
roc_auc for the hours: 0.682191780822
log_loss for the hours: 0.518913981675
saving predictions to csv file
hourspatient1_14_net11_10-17-13-28-27.csv
Accuracy validation for the hours:  0.679487179487
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 128)
(2256, 1, 234, 128)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [14]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.390071808
saving predictions to csv file
patient1_14_net11_10-17-13-37-03.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu1', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_15']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_15'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu1')
Git reference:  Timestamp: 2016-10-17 13:37:04.764976
Hostname: kat
gpu1
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 128
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net11
evaluation:
    online_training: False
    model: net11

end Configuration
['patient1_15']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 128)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [15]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.967348224
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 82.068359375 77.3070480347
20 198.39692688 195.489349365
30 295.98815918 292.822436523
40 403.813171387 399.203295898
50 539.459503174 531.64642334
60 720.676940918 706.943383789
70 965.831634521 942.75758667
80 1314.2989502 1275.66091309
90 1914.57336426 1849.46102295
100 29197.0292969 29615.0136719
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net11
Model name for the evaluation phase:  net11
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ----------
  0          1x192x128
  1          32x192x128
  2          32x192x128
  3          32x192x128
  4          32x96x64
  5          32x96x64
  6          32x96x64
  7          32x48x32
  8          2x48x32
  9          2
 10          2

BI_test_bal_complete called with len(X) = 584
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m1.43090[0m     [32m0.69462[0m    2.05997      0.49946  32.73s
BI_test_bal_complete called with len(X) = 584
      2     [36m0.68899[0m     [32m0.68950[0m    0.99927      0.54247  34.04s
BI_test_bal_complete called with len(X) = 584
      3     [36m0.67583[0m     [32m0.67915[0m    0.99512      0.56018  34.82s
BI_test_bal_complete called with len(X) = 584
      4     [36m0.66998[0m     0.68700    0.97524      0.55937  34.46s
BI_test_bal_complete called with len(X) = 584
      5     [36m0.66181[0m     [32m0.67156[0m    0.98548      0.57205  34.48s
BI_test_bal_complete called with len(X) = 584
      6     [36m0.65984[0m     [32m0.66522[0m    0.99192      0.56646  34.66s
BI_test_bal_complete called with len(X) = 584
      7     [36m0.65828[0m     [32m0.65917[0m    0.99865      0.56586  34.63s
BI_test_bal_complete called with len(X) = 584
      8     [36m0.65339[0m     0.66396    0.98408      0.58451  34.63s
BI_test_bal_complete called with len(X) = 584
      9     0.65395     [32m0.65481[0m    0.99868      0.56108  34.57s
BI_test_bal_complete called with len(X) = 584
     10     [36m0.64924[0m     [32m0.65390[0m    0.99288      0.55300  34.55s
BI_test_bal_complete called with len(X) = 584
     11     0.64933     [32m0.65187[0m    0.99611      0.57549  34.57s
BI_test_bal_complete called with len(X) = 584
     12     [36m0.64656[0m     [32m0.65107[0m    0.99307      0.53836  34.50s
BI_test_bal_complete called with len(X) = 584
     13     [36m0.64321[0m     0.65421    0.98318      0.58730  34.07s
BI_test_bal_complete called with len(X) = 584
     14     0.64841     0.65366    0.99197      0.54509  33.83s
BI_test_bal_complete called with len(X) = 584
     15     0.64345     [32m0.65096[0m    0.98846      0.57922  33.93s
BI_test_bal_complete called with len(X) = 584
     16     [36m0.64257[0m     [32m0.65005[0m    0.98848      0.58345  33.89s
BI_test_bal_complete called with len(X) = 584
     17     [36m0.64254[0m     [32m0.64885[0m    0.99029      0.57116  34.21s
BI_test_bal_complete called with len(X) = 584
     18     [36m0.64155[0m     0.64931    0.98806      0.58008  34.49s
BI_test_bal_complete called with len(X) = 584
     19     [36m0.63931[0m     0.66242    0.96511      0.58450  34.31s
BI_test_bal_complete called with len(X) = 584
     20     0.64882     0.65216    0.99488      0.58574  34.37s
BI_test_bal_complete called with len(X) = 584
     21     0.63952     [32m0.64846[0m    0.98622      0.56686  34.24s
BI_test_bal_complete called with len(X) = 584
     22     [36m0.63786[0m     [32m0.64820[0m    0.98405      0.57120  34.29s
BI_test_bal_complete called with len(X) = 584
     23     [36m0.63705[0m     [32m0.64744[0m    0.98395      0.58528  34.34s
BI_test_bal_complete called with len(X) = 584
     24     0.63772     0.65211    0.97794      0.57953  34.34s
BI_test_bal_complete called with len(X) = 584
     25     [36m0.62727[0m     0.65308    0.96048      0.59005  34.22s
BI_test_bal_complete called with len(X) = 584
     26     [36m0.62451[0m     0.65763    0.94964      0.58211  34.00s
BI_test_bal_complete called with len(X) = 584
     27     [36m0.62283[0m     0.65493    0.95098      0.54461  33.90s
BI_test_bal_complete called with len(X) = 584
     28     [36m0.61787[0m     0.66287    0.93212      0.55511  33.81s
BI_test_bal_complete called with len(X) = 584
     29     0.62424     0.66847    0.93384      0.58953  34.30s
BI_test_bal_complete called with len(X) = 584
     30     0.61970     0.67229    0.92179      0.53552  34.45s
BI_test_bal_complete called with len(X) = 584
     31     [36m0.61396[0m     0.66754    0.91974      0.54297  34.00s
BI_test_bal_complete called with len(X) = 584
     32     [36m0.61054[0m     0.68136    0.89606      0.51559  33.85s
BI_test_bal_complete called with len(X) = 584
     33     [36m0.59563[0m     0.68093    0.87473      0.53232  33.92s
BI_test_bal_complete called with len(X) = 584
Early stopping.
Best valid loss was 0.647439 at epoch 23.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 128)
magnitudes_seizure_val.shape (5, 1, 1406, 128)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.475699060884
Error rate (%):  52.4300939116
[[41364 47331]
 [ 2357  3718]]
(94770,)
(94770,)
roc_auc: 0.574525430818
log_loss: 0.862246201239
roc_auc for the hours: 0.564383561644
log_loss for the hours: 0.760218467378
saving predictions to csv file
hourspatient1_15_net11_10-17-14-14-08.csv
Accuracy validation for the hours:  0.5
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 128)
(2256, 1, 234, 128)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [15]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.389461504
saving predictions to csv file
patient1_15_net11_10-17-14-18-59.csv
