['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_0']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_0'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-22 01:12:47.543136
Hostname: kat
gpu3
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net34
evaluation:
    online_training: False
    model: net34

end Configuration
['patient1_0']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [0]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.838909952
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 199.036781311 184.038919067
20 483.221002197 465.519171143
30 718.880554199 694.377087402
40 969.482617188 933.868884277
50 1265.8637085 1213.74743652
60 1644.84228516 1568.92561035
70 2171.59033203 2061.92285156
80 2997.35341797 2842.94628906
90 4640.41015625 4440.24106445
100 101397.328125 96893.890625
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net34
Model name for the evaluation phase:  net34
Training model...
# Neural Network with 160482 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x163x66
  2          32x165x65
  3          32x165x65
  4          32x83x33
  5          32x83x33
  6          32x83x33
  7          32x42x17
  8          2x42x17
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1    [36m52.60307[0m     [32m7.04170[0m    7.47022      0.39109  169.98s
      2     [36m4.13187[0m     [32m3.00561[0m    1.37472      0.39173  127.95s
      3     [36m2.71118[0m     [32m2.31756[0m    1.16984      0.42908  115.14s
      4     [36m2.27456[0m     [32m2.18215[0m    1.04235      0.42235  114.80s
      5     [36m1.80748[0m     [32m1.61910[0m    1.11635      0.50068  114.58s
      6     [36m1.61716[0m     [32m1.52931[0m    1.05745      0.48784  115.32s
      7     [36m1.39685[0m     [32m1.40355[0m    0.99523      0.38426  124.85s
      8     [36m1.18700[0m     [32m1.39613[0m    0.85021      0.39540  114.56s
      9     [36m1.09875[0m     [32m1.19669[0m    0.91816      0.45420  114.71s
     10     [36m0.95387[0m     [32m1.11138[0m    0.85827      0.47577  114.48s
     11     [36m0.88487[0m     [32m0.96193[0m    0.91989      0.57418  114.54s
     12     [36m0.84039[0m     1.08914    0.77161      0.59026  114.52s
     13     [36m0.77356[0m     0.99642    0.77635      0.48410  114.47s
     14     [36m0.70201[0m     0.99287    0.70705      0.59131  114.61s
     15     [36m0.69852[0m     [32m0.89104[0m    0.78393      0.57667  114.68s
     16     [36m0.66579[0m     0.96506    0.68989      0.58630  161.21s
     17     [36m0.62365[0m     0.98025    0.63621      0.59486  170.98s
     18     [36m0.56692[0m     0.92850    0.61057      0.55956  170.98s
     19     [36m0.52745[0m     0.91880    0.57407      0.55305  171.50s
     20     [36m0.50760[0m     0.89441    0.56753      0.59680  171.95s
     21     [36m0.48431[0m     0.96496    0.50190      0.49592  171.32s
     22     [36m0.44219[0m     0.94487    0.46799      0.51550  164.15s
     23     [36m0.39831[0m     1.02082    0.39019      0.50514  114.58s
     24     [36m0.36125[0m     0.99959    0.36140      0.54365  124.32s
     25     [36m0.34755[0m     1.14571    0.30335      0.50565  114.68s
Early stopping.
Best valid loss was 0.891041 at epoch 15.
Loaded parameters to layer 'conv2d1' (shape 32x1x32x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x1x128).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[ 0.99347705  0.99760073  0.98525399  0.99880207  0.99860889  0.99335951
  0.95549369  0.99556088  0.96805823  0.99813795  0.97099811  0.99972337
  0.99054354  0.99727172  0.99548113  0.99885356  0.99450254  0.95467478
  0.99964941  0.96546924  0.98763752  0.95543367  0.99049044  0.99980205
  0.99083519  0.91062742  0.99994791  0.99961674  0.99984682  0.96691185]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.336762688615
Error rate (%):  66.3237311385
[[27051 61644]
 [ 1211  4864]]
(94770,)
(94770,)
roc_auc: 0.487172449535
log_loss: nan
roc_auc for the hours: 0.498630136986
log_loss for the hours: inf
saving predictions to csv file
hourspatient1_0_net34_10-22-02-35-37.csv
Accuracy validation for the hours:  0.320512820513
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [0]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.074855936
saving predictions to csv file
patient1_0_net34_10-22-02-44-29.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_1']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_1'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-22 02:44:30.690315
Hostname: kat
gpu3
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net34
evaluation:
    online_training: False
    model: net34

end Configuration
['patient1_1']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [1]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.838549504
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 203.761627197 188.411010742
20 496.77197876 482.61751709
30 732.597296143 714.697686768
40 973.972167969 949.532727051
50 1245.81005859 1212.85552979
60 1576.76357422 1532.16108398
70 2013.54516602 1951.80438232
80 2668.75805664 2577.9690918
90 3942.10078125 3797.89812012
100 71591.0625 60304.03125
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net34
Model name for the evaluation phase:  net34
Training model...
# Neural Network with 160482 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x163x66
  2          32x165x65
  3          32x165x65
  4          32x83x33
  5          32x83x33
  6          32x83x33
  7          32x42x17
  8          2x42x17
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1    [36m48.17891[0m     [32m5.58760[0m    8.62247      0.46904  115.61s
      2     [36m3.65932[0m     [32m3.09826[0m    1.18109      0.52474  114.46s
      3     [36m2.33086[0m     [32m2.36605[0m    0.98513      0.52582  114.74s
      4     [36m1.73378[0m     2.52284    0.68723      0.52165  114.43s
      5     [36m1.53260[0m     [32m1.97764[0m    0.77497      0.52530  125.41s
      6     [36m1.28700[0m     2.24048    0.57443      0.50568  171.93s
      7     [36m1.12085[0m     [32m1.43474[0m    0.78123      0.54191  171.77s
      8     [36m0.95033[0m     [32m1.36737[0m    0.69500      0.53992  172.37s
      9     [36m0.88325[0m     [32m1.17236[0m    0.75340      0.55854  171.88s
     10     [36m0.82925[0m     1.30245    0.63669      0.55250  171.60s
     11     [36m0.75850[0m     [32m1.11912[0m    0.67777      0.57527  147.48s
     12     [36m0.69614[0m     1.34370    0.51807      0.55589  124.32s
     13     [36m0.63983[0m     [32m1.10221[0m    0.58050      0.58383  114.76s
     14     [36m0.56813[0m     [32m1.06151[0m    0.53521      0.59536  114.63s
     15     [36m0.54630[0m     1.06674    0.51212      0.58558  114.29s
     16     [36m0.49668[0m     1.18003    0.42091      0.58873  114.18s
     17     [36m0.45650[0m     [32m0.90556[0m    0.50411      0.59081  137.76s
     18     [36m0.39251[0m     1.06188    0.36964      0.60260  172.79s
     19     [36m0.37587[0m     1.06618    0.35254      0.59712  172.71s
     20     [36m0.34040[0m     1.03601    0.32857      0.60656  173.04s
     21     [36m0.29197[0m     1.07213    0.27233      0.60076  172.58s
     22     [36m0.25301[0m     1.05186    0.24053      0.60250  172.69s
     23     [36m0.21908[0m     0.97793    0.22403      0.60087  173.06s
     24     [36m0.18664[0m     1.00454    0.18580      0.55888  117.40s
     25     [36m0.16590[0m     1.05651    0.15702      0.58724  124.28s
     26     [36m0.15082[0m     1.07383    0.14045      0.56899  114.66s
     27     [36m0.14235[0m     1.11480    0.12769      0.55268  114.79s
Early stopping.
Best valid loss was 0.905563 at epoch 17.
Loaded parameters to layer 'conv2d1' (shape 32x1x32x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x1x128).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[ 0.67194337  0.91241425  0.16134502  0.58291405  0.31934357  0.67649639
  0.05270116  0.70241207  0.75892544  0.89685136  0.36969721  0.88549381
  0.97377825  0.72298414  0.54659444  0.76165628  0.80490237  0.91744894
  0.33788079  0.95902646  0.97377408  0.9911412   0.74762607  0.98088354
  0.96586388  0.98596245  0.86319178  0.99757761  0.8081063   0.97880131]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.347050754458
Error rate (%):  65.2949245542
[[27783 60912]
 [  968  5107]]
(94770,)
(94770,)
roc_auc: 0.578791086205
log_loss: nan
roc_auc for the hours: 0.613698630137
log_loss for the hours: 2.44369816442
saving predictions to csv file
hourspatient1_1_net34_10-22-04-17-08.csv
Accuracy validation for the hours:  0.282051282051
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [1]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.0745856
saving predictions to csv file
patient1_1_net34_10-22-04-26-04.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_2']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_2'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-22 04:26:05.847511
Hostname: kat
gpu3
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net34
evaluation:
    online_training: False
    model: net34

end Configuration
['patient1_2']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [2]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.83970048
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 210.389639282 196.646928406
20 506.963934326 496.903918457
30 739.698999023 728.238903809
40 971.565100098 956.919091797
50 1226.64501953 1206.60388184
60 1529.57705078 1501.93178711
70 1919.78259277 1881.66341553
80 2487.38320313 2434.10976563
90 3554.0130127 3481.28129883
100 119907.929688 146484.890625
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net34
Model name for the evaluation phase:  net34
Training model...
# Neural Network with 160482 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x163x66
  2          32x165x65
  3          32x165x65
  4          32x83x33
  5          32x83x33
  6          32x83x33
  7          32x42x17
  8          2x42x17
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1    [36m48.98050[0m     [32m6.15101[0m    7.96300      0.45383  112.55s
      2     [36m4.02626[0m     [32m1.96484[0m    2.04916      0.49175  114.43s
      3     [36m2.59769[0m     2.63576    0.98556      0.55489  114.62s
      4     [36m1.98448[0m     2.27354    0.87286      0.57738  114.68s
      5     [36m1.69697[0m     2.20027    0.77125      0.56319  114.60s
      6     [36m1.42458[0m     [32m1.43230[0m    0.99461      0.58514  150.77s
      7     [36m1.23410[0m     [32m1.22632[0m    1.00634      0.57355  172.27s
      8     [36m1.10724[0m     1.24838    0.88695      0.59269  172.88s
      9     [36m0.98892[0m     [32m1.04139[0m    0.94962      0.57805  172.73s
     10     [36m0.89711[0m     [32m1.03136[0m    0.86984      0.59451  172.98s
     11     [36m0.85331[0m     [32m0.94346[0m    0.90445      0.59837  171.96s
     12     [36m0.79426[0m     0.96707    0.82131      0.61055  172.61s
     13     [36m0.79316[0m     [32m0.87003[0m    0.91164      0.61482  172.30s
     14     [36m0.72069[0m     0.99449    0.72468      0.62207  139.92s
     15     [36m0.68278[0m     [32m0.86677[0m    0.78773      0.62122  124.34s
     16     [36m0.66481[0m     0.92044    0.72227      0.61839  114.44s
     17     [36m0.61607[0m     [32m0.80693[0m    0.76348      0.61784  114.44s
     18     [36m0.60041[0m     0.88421    0.67904      0.62398  114.18s
     19     [36m0.56010[0m     0.91868    0.60968      0.61752  155.68s
     20     [36m0.55775[0m     0.95665    0.58303      0.62175  172.18s
     21     [36m0.52333[0m     [32m0.80595[0m    0.64933      0.61547  172.57s
     22     [36m0.50031[0m     [32m0.79847[0m    0.62659      0.61283  171.75s
     23     [36m0.46239[0m     0.83861    0.55137      0.60114  172.25s
     24     [36m0.41849[0m     0.83482    0.50129      0.56432  171.63s
     25     [36m0.37322[0m     0.86021    0.43387      0.58858  172.62s
     26     [36m0.35752[0m     0.91011    0.39283      0.54816  171.88s
     27     [36m0.27930[0m     0.97329    0.28696      0.55214  172.50s
     28     [36m0.24726[0m     1.02511    0.24120      0.52199  151.94s
     29     [36m0.22217[0m     0.98678    0.22514      0.57313  124.07s
     30     [36m0.21148[0m     1.10674    0.19108      0.50095  114.59s
     31     [36m0.17349[0m     1.34720    0.12878      0.49042  114.55s
     32     [36m0.15206[0m     1.14639    0.13265      0.56926  114.66s
Early stopping.
Best valid loss was 0.798468 at epoch 22.
Loaded parameters to layer 'conv2d1' (shape 32x1x32x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x1x128).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[ 0.00469075  0.01085697  0.29270425  0.2565234   0.00495237  0.05648305
  0.07258996  0.28563032  0.00401369  0.19870356  0.04692313  0.26116452
  0.00131094  0.14113709  0.07134666  0.2844114   0.00247324  0.40323636
  0.06449864  0.29845941  0.00968939  0.2838155   0.00980363  0.36680588
  0.0199073   0.48609331  0.03680758  0.66373026  0.14625673  0.56949168]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.446407090852
Error rate (%):  55.3592909148
[[37698 50997]
 [ 1467  4608]]
(94770,)
(94770,)
roc_auc: 0.57535248947
log_loss: nan
roc_auc for the hours: 0.616438356164
log_loss for the hours: inf
saving predictions to csv file
hourspatient1_2_net34_10-22-06-18-15.csv
Accuracy validation for the hours:  0.423076923077
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [2]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.076297728
saving predictions to csv file
patient1_2_net34_10-22-06-26-55.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_3']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_3'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-22 06:26:56.737911
Hostname: kat
gpu3
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net34
evaluation:
    online_training: False
    model: net34

end Configuration
['patient1_3']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [3]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.837963776
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 19.1249866486 16.0321680069
20 110.960594177 117.977423096
30 462.367929077 465.247445679
40 726.516931152 722.714147949
50 983.638244629 972.796356201
60 1269.06445312 1248.00100098
70 1619.77319336 1586.1126709
80 2106.37036133 2054.18427734
90 2963.09577637 2880.79763184
100 141686.875 89649.6484375
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net34
Model name for the evaluation phase:  net34
Training model...
# Neural Network with 160482 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x163x66
  2          32x165x65
  3          32x165x65
  4          32x83x33
  5          32x83x33
  6          32x83x33
  7          32x42x17
  8          2x42x17
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1    [36m31.17131[0m     [32m2.39977[0m   12.98928      0.50163  172.41s
      2     [36m2.89003[0m     [32m2.29655[0m    1.25842      0.55069  172.00s
      3     [36m1.84257[0m     [32m1.64615[0m    1.11932      0.56766  143.67s
      4     [36m1.38795[0m     [32m1.56419[0m    0.88733      0.56223  124.33s
      5     [36m1.25116[0m     [32m1.20362[0m    1.03950      0.57294  114.24s
      6     [36m1.04267[0m     1.38312    0.75385      0.56595  114.23s
      7     [36m0.91999[0m     [32m0.89014[0m    1.03353      0.58518  114.33s
      8     [36m0.84957[0m     0.96849    0.87721      0.56428  114.45s
      9     [36m0.75296[0m     [32m0.88587[0m    0.84996      0.56748  151.38s
     10     0.75779     0.91608    0.82721      0.56677  171.83s
     11     [36m0.64446[0m     [32m0.88301[0m    0.72985      0.57446  172.28s
     12     [36m0.62997[0m     0.91022    0.69211      0.57808  172.18s
     13     [36m0.59942[0m     0.95531    0.62746      0.58949  172.94s
     14     [36m0.57150[0m     0.95289    0.59976      0.59563  172.59s
     15     [36m0.53896[0m     0.98679    0.54617      0.58207  172.98s
     16     [36m0.51707[0m     0.93957    0.55033      0.57686  173.12s
     17     [36m0.50242[0m     0.95280    0.52731      0.59459  117.53s
     18     [36m0.47319[0m     1.00463    0.47101      0.59339  123.88s
     19     [36m0.45439[0m     0.97633    0.46541      0.59032  114.07s
     20     [36m0.44286[0m     1.10581    0.40048      0.58894  114.17s
     21     [36m0.40793[0m     1.09983    0.37090      0.59069  114.42s
Early stopping.
Best valid loss was 0.883005 at epoch 11.
Loaded parameters to layer 'conv2d1' (shape 32x1x32x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x1x128).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[  3.47277429e-10   6.23828083e-13   1.47399032e-16   8.60789575e-14
   2.03594190e-11   5.15900744e-13   6.84996074e-17   1.32659844e-14
   1.63000668e-12   1.26635437e-13   2.13428665e-16   2.52947890e-14
   3.39765507e-11   1.03557320e-13   5.60341478e-17   3.35137971e-14
   1.44383550e-09   8.38726397e-12   1.77230295e-17   4.44455497e-12
   3.91109471e-11   4.61062449e-13   6.28144599e-16   4.12314199e-13
   2.29465877e-10   4.86514336e-11   1.85155155e-15   4.02248235e-11
   3.30531392e-12   9.40293815e-11]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.480679539939
Error rate (%):  51.9320460061
[[41561 47134]
 [ 2082  3993]]
(94770,)
(94770,)
roc_auc: 0.628409368862
log_loss: nan
roc_auc for the hours: 0.627397260274
log_loss for the hours: 1.81142429692
saving predictions to csv file
hourspatient1_3_net34_10-22-07-34-51.csv
Accuracy validation for the hours:  0.448717948718
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [3]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.073709056
saving predictions to csv file
patient1_3_net34_10-22-07-43-41.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_4']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_4'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-22 07:43:42.305197
Hostname: kat
gpu3
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net34
evaluation:
    online_training: False
    model: net34

end Configuration
['patient1_4']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [4]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.837677056
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 235.407817078 219.809516907
20 571.790344238 556.848303223
30 840.501837158 821.775939941
40 1116.47878418 1091.31035156
50 1434.89074707 1400.26373291
60 1840.24331055 1790.55202637
70 2408.61494141 2333.43139648
80 3297.89345703 3176.70976563
90 4956.27602539 4739.19238281
100 52009.53125 38008.9335938
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net34
Model name for the evaluation phase:  net34
Training model...
# Neural Network with 160482 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x163x66
  2          32x165x65
  3          32x165x65
  4          32x83x33
  5          32x83x33
  6          32x83x33
  7          32x42x17
  8          2x42x17
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1    [36m60.84256[0m    [32m10.31663[0m    5.89752      0.47800  110.27s
      2     [36m5.05081[0m     [32m2.53391[0m    1.99329      0.51392  114.32s
      3     [36m2.93480[0m     4.68844    0.62597      0.50027  114.15s
      4     [36m2.17233[0m     [32m2.40983[0m    0.90145      0.51353  129.89s
      5     [36m1.82996[0m     2.69475    0.67908      0.50041  172.67s
      6     [36m1.48881[0m     [32m2.26672[0m    0.65681      0.50514  173.03s
      7     [36m1.36156[0m     [32m1.50791[0m    0.90295      0.52975  172.72s
      8     [36m1.21667[0m     2.22547    0.54670      0.50311  173.11s
      9     [36m1.07050[0m     [32m1.36135[0m    0.78635      0.54228  172.82s
     10     [36m1.01299[0m     1.43359    0.70661      0.52881  173.27s
     11     [36m0.92332[0m     [32m1.24874[0m    0.73940      0.55000  172.28s
     12     [36m0.87598[0m     1.39229    0.62917      0.54723  156.69s
     13     [36m0.85168[0m     [32m1.17975[0m    0.72191      0.55067  123.72s
     14     [36m0.77551[0m     [32m1.06342[0m    0.72926      0.55867  114.27s
     15     [36m0.69935[0m     [32m0.96795[0m    0.72251      0.55589  114.34s
     16     [36m0.68615[0m     1.11591    0.61488      0.55367  114.29s
     17     [36m0.65194[0m     [32m0.95968[0m    0.67933      0.56622  114.24s
     18     [36m0.59724[0m     1.04796    0.56991      0.56280  114.03s
     19     [36m0.53938[0m     0.97621    0.55252      0.57345  114.41s
     20     [36m0.48329[0m     0.97349    0.49646      0.57348  114.49s
     21     [36m0.40887[0m     [32m0.94822[0m    0.43120      0.57625  114.40s
     22     [36m0.36057[0m     [32m0.94273[0m    0.38248      0.54024  114.26s
     23     [36m0.29008[0m     [32m0.92571[0m    0.31336      0.50352  114.26s
     24     [36m0.24933[0m     1.00153    0.24895      0.50177  114.21s
     25     [36m0.22080[0m     1.08386    0.20372      0.48869  114.39s
     26     [36m0.19426[0m     1.11069    0.17490      0.49026  114.33s
     27     [36m0.16169[0m     1.42926    0.11313      0.46726  114.46s
     28     [36m0.14446[0m     1.25860    0.11478      0.49484  114.36s
     29     [36m0.12763[0m     1.76515    0.07230      0.45612  114.22s
     30     [36m0.10588[0m     2.04942    0.05166      0.47118  114.48s
     31     [36m0.10061[0m     2.66076    0.03781      0.46291  114.47s
     32     [36m0.09066[0m     2.54208    0.03567      0.45920  114.44s
     33     [36m0.08065[0m     2.53956    0.03176      0.46522  114.53s
Early stopping.
Best valid loss was 0.925711 at epoch 23.
Loaded parameters to layer 'conv2d1' (shape 32x1x32x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x1x128).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[ 0.99884963  0.99997222  0.83438897  0.99994802  0.99559659  0.99998713
  0.99835855  1.          0.99998343  0.99999964  0.9990232   0.9999994
  0.99999714  1.          0.99982136  0.99999893  0.99999976  1.
  0.99990082  0.9999975   0.99997556  0.99999905  0.99705637  0.99999821
  0.99995291  0.99999964  0.99958795  0.99992442  0.99994493  0.99999905]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.507713411417
Error rate (%):  49.2286588583
[[45081 43614]
 [ 3040  3035]]
(94770,)
(94770,)
roc_auc: 0.516725233768
log_loss: nan
roc_auc for the hours: 0.495890410959
log_loss for the hours: 0.90541349822
saving predictions to csv file
hourspatient1_4_net34_10-22-09-15-01.csv
Accuracy validation for the hours:  0.487179487179
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [4]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.07401216
saving predictions to csv file
patient1_4_net34_10-22-09-23-35.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_5']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_5'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-22 09:23:36.841633
Hostname: kat
gpu3
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net34
evaluation:
    online_training: False
    model: net34

end Configuration
['patient1_5']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [5]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.838336512
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 231.335012817 211.108001709
20 564.578271484 538.999780273
30 830.936474609 795.66987915
40 1104.11230469 1055.32932129
50 1420.78125 1352.56451416
60 1826.70258789 1730.86726074
70 2401.11716309 2262.68579102
80 3287.26503906 3085.56469727
90 4899.46132813 4571.94418945
100 55591.203125 52662.2460938
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net34
Model name for the evaluation phase:  net34
Training model...
# Neural Network with 160482 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x163x66
  2          32x165x65
  3          32x165x65
  4          32x83x33
  5          32x83x33
  6          32x83x33
  7          32x42x17
  8          2x42x17
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1    [36m54.39683[0m     [32m5.65866[0m    9.61302      0.47909  109.54s
      2     [36m4.72859[0m     [32m2.57630[0m    1.83542      0.50743  165.46s
      3     [36m3.14590[0m     4.75795    0.66119      0.50054  173.89s
      4     [36m2.61164[0m     5.03331    0.51887      0.50325  172.98s
      5     [36m1.91897[0m     4.48500    0.42786      0.49905  172.99s
      6     [36m1.58183[0m     3.03762    0.52074      0.50162  172.23s
      7     [36m1.38250[0m     [32m2.48285[0m    0.55682      0.50324  172.99s
      8     [36m1.16623[0m     2.51162    0.46433      0.50149  172.80s
      9     [36m1.05204[0m     [32m1.79746[0m    0.58529      0.50976  173.38s
     10     [36m0.97077[0m     [32m1.48146[0m    0.65528      0.51939  172.96s
     11     [36m0.88138[0m     [32m1.21833[0m    0.72343      0.52908  172.34s
     12     [36m0.82758[0m     1.75596    0.47130      0.51637  172.89s
     13     [36m0.78646[0m     1.63589    0.48075      0.51968  173.00s
     14     [36m0.73115[0m     1.35294    0.54042      0.52441  173.04s
     15     [36m0.65090[0m     1.39540    0.46646      0.52538  152.19s
     16     [36m0.64020[0m     1.32324    0.48381      0.52832  123.68s
     17     [36m0.59160[0m     [32m1.17409[0m    0.50388      0.53324  114.01s
     18     [36m0.55590[0m     1.20485    0.46138      0.53844  113.62s
     19     [36m0.49551[0m     1.24181    0.39902      0.53781  113.88s
     20     [36m0.46443[0m     1.24125    0.37416      0.55613  113.97s
     21     [36m0.43367[0m     1.22796    0.35316      0.55991  113.87s
     22     [36m0.36768[0m     [32m1.06122[0m    0.34647      0.56525  113.66s
     23     [36m0.30897[0m     1.08411    0.28500      0.55625  113.82s
     24     [36m0.28047[0m     1.07543    0.26080      0.56921  113.68s
     25     [36m0.25106[0m     [32m0.98881[0m    0.25390      0.56677  113.96s
     26     [36m0.24548[0m     1.08372    0.22652      0.55032  113.89s
     27     [36m0.19746[0m     1.07195    0.18421      0.53247  114.01s
     28     [36m0.16869[0m     1.19221    0.14149      0.54343  114.03s
     29     [36m0.14842[0m     1.20018    0.12367      0.51219  114.15s
     30     [36m0.12487[0m     1.17594    0.10619      0.51123  114.39s
     31     [36m0.12358[0m     1.29289    0.09558      0.51066  114.28s
     32     [36m0.10795[0m     1.58785    0.06799      0.48848  114.18s
     33     [36m0.10689[0m     1.59155    0.06716      0.48092  114.18s
     34     [36m0.08531[0m     1.42208    0.05999      0.49207  114.08s
     35     [36m0.08003[0m     2.59853    0.03080      0.47914  114.01s
Early stopping.
Best valid loss was 0.988815 at epoch 25.
Loaded parameters to layer 'conv2d1' (shape 32x1x32x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x1x128).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[  9.99684930e-01   1.00000000e+00   9.98082995e-01   9.99992251e-01
   9.93756294e-01   9.99996662e-01   9.92576897e-01   9.99994636e-01
   9.93904769e-01   9.99992967e-01   8.65383446e-01   9.99310851e-01
   8.53617430e-01   9.99999881e-01   2.27461129e-01   5.50290227e-01
   7.08381762e-04   9.99154568e-01   1.82829387e-02   6.65779054e-01
   2.79870983e-06   1.37920231e-02   6.04444313e-06   7.84647930e-03
   2.79200231e-06   8.11724886e-02   1.23028450e-01   1.19899534e-01
   8.24695690e-06   9.02871907e-01]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.478020470613
Error rate (%):  52.1979529387
[[41419 47276]
 [ 2192  3883]]
(94770,)
(94770,)
roc_auc: 0.586900346752
log_loss: nan
roc_auc for the hours: 0.638356164384
log_loss for the hours: 1.07496860257
saving predictions to csv file
hourspatient1_5_net34_10-22-11-02-44.csv
Accuracy validation for the hours:  0.448717948718
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [5]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.074561024
saving predictions to csv file
patient1_5_net34_10-22-11-09-43.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_6']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_6'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-22 11:09:44.693619
Hostname: kat
gpu3
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net34
evaluation:
    online_training: False
    model: net34

end Configuration
['patient1_6']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [6]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.837984256
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 199.270783997 178.304678345
20 484.265484619 454.425598145
30 715.207281494 673.034472656
40 957.550097656 897.335144043
50 1246.79968262 1160.86651611
60 1628.27236328 1502.71569824
70 2172.52145996 1989.60817871
80 3015.20869141 2745.85849609
90 4633.05883789 4178.59511719
100 66751.359375 59361.5703125
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net34
Model name for the evaluation phase:  net34
Training model...
# Neural Network with 160482 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x163x66
  2          32x165x65
  3          32x165x65
  4          32x83x33
  5          32x83x33
  6          32x83x33
  7          32x42x17
  8          2x42x17
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1    [36m56.28724[0m     [32m1.95946[0m   28.72591      0.45274  108.86s
      2     [36m3.39271[0m     2.94500    1.15202      0.50554  113.99s
      3     [36m2.42620[0m     2.48625    0.97585      0.50462  114.47s
      4     [36m1.91279[0m     2.69424    0.70996      0.50460  114.01s
      5     [36m1.51629[0m     2.76959    0.54748      0.50014  113.76s
      6     [36m1.33829[0m     2.71875    0.49224      0.50216  113.64s
      7     [36m1.17578[0m     [32m1.47072[0m    0.79946      0.52488  113.89s
      8     [36m1.02925[0m     1.97083    0.52224      0.50447  113.89s
      9     [36m0.93411[0m     1.68409    0.55467      0.51436  114.13s
     10     [36m0.87048[0m     1.66575    0.52258      0.51158  113.89s
     11     [36m0.79220[0m     [32m1.32334[0m    0.59864      0.52880  113.82s
     12     [36m0.71776[0m     1.51536    0.47366      0.52476  113.75s
     13     0.73203     1.55713    0.47011      0.52264  113.94s
     14     [36m0.63900[0m     1.33022    0.48037      0.53089  113.88s
     15     [36m0.59777[0m     [32m1.21329[0m    0.49269      0.54131  114.22s
     16     [36m0.56264[0m     1.26142    0.44604      0.53479  113.76s
     17     [36m0.50709[0m     1.29148    0.39264      0.54351  113.84s
     18     [36m0.47861[0m     1.34609    0.35556      0.54764  113.71s
     19     [36m0.43648[0m     1.34834    0.32372      0.54897  114.29s
     20     [36m0.39183[0m     1.44865    0.27048      0.54745  114.18s
     21     [36m0.36699[0m     1.32693    0.27657      0.57244  113.95s
     22     [36m0.32572[0m     [32m0.99533[0m    0.32725      0.60250  113.90s
     23     [36m0.27723[0m     1.22621    0.22608      0.58221  113.85s
     24     [36m0.22740[0m     1.03058    0.22066      0.59124  113.52s
     25     [36m0.20841[0m     1.05968    0.19667      0.59181  113.73s
     26     [36m0.18923[0m     1.10321    0.17153      0.59659  113.63s
     27     [36m0.16582[0m     1.06004    0.15643      0.61035  113.79s
     28     [36m0.13726[0m     1.05330    0.13031      0.59881  113.40s
     29     [36m0.12626[0m     1.02111    0.12365      0.56582  113.53s
     30     [36m0.11979[0m     1.01607    0.11790      0.57970  113.74s
     31     [36m0.11794[0m     1.08594    0.10861      0.54033  114.13s
     32     [36m0.09592[0m     1.24463    0.07707      0.48116  113.84s
Early stopping.
Best valid loss was 0.995333 at epoch 22.
Loaded parameters to layer 'conv2d1' (shape 32x1x32x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x1x128).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[  9.60820063e-04   8.71380866e-02   9.04200375e-01   6.96406960e-01
   4.38682873e-05   9.93014276e-01   9.85886097e-01   8.64239693e-01
   2.10838298e-05   9.82295156e-01   9.41133082e-01   8.28580916e-01
   5.18330016e-05   9.99550641e-01   7.85472572e-01   9.80662882e-01
   1.07181852e-03   9.93393719e-01   9.48624611e-01   8.75650823e-01
   5.72227764e-05   6.88919842e-01   9.13475275e-01   9.04408753e-01
   2.19629565e-05   9.86906350e-01   9.90842104e-01   9.93353844e-01
   4.62430966e-04   9.91429508e-01]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.345225282262
Error rate (%):  65.4774717738
[[27315 61380]
 [  673  5402]]
(94770,)
(94770,)
roc_auc: 0.612063868944
log_loss: nan
roc_auc for the hours: 0.772602739726
log_loss for the hours: inf
saving predictions to csv file
hourspatient1_6_net34_10-22-12-22-39.csv
Accuracy validation for the hours:  0.294871794872
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [6]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.074016256
saving predictions to csv file
patient1_6_net34_10-22-12-29-37.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_7']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_7'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-22 12:29:38.920263
Hostname: kat
gpu3
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net34
evaluation:
    online_training: False
    model: net34

end Configuration
['patient1_7']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [7]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.838270976
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 182.900706482 163.150218201
20 446.00692749 416.755505371
30 662.357696533 620.480499268
40 892.956396484 834.12010498
50 1172.0982666 1087.89544678
60 1542.81384277 1420.86425781
70 2076.69821777 1899.79864502
80 2929.02983398 2668.57714844
90 4619.13442383 4199.77285156
100 65353.1796875 57503.8945312
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net34
Model name for the evaluation phase:  net34
Training model...
# Neural Network with 160482 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x163x66
  2          32x165x65
  3          32x165x65
  4          32x83x33
  5          32x83x33
  6          32x83x33
  7          32x42x17
  8          2x42x17
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1    [36m48.86008[0m     [32m1.34681[0m   36.27850      0.45220  110.28s
      2     [36m3.41702[0m     3.74814    0.91166      0.50257  114.06s
      3     [36m2.29276[0m     2.70982    0.84609      0.50408  114.24s
      4     [36m1.85429[0m     2.90869    0.63750      0.50460  114.03s
      5     [36m1.46516[0m     1.80100    0.81353      0.52558  113.55s
      6     [36m1.34849[0m     1.83911    0.73323      0.51703  113.53s
      7     [36m1.16525[0m     1.41870    0.82135      0.53380  113.70s
      8     [36m1.02423[0m     1.82636    0.56081      0.52152  113.69s
      9     [36m0.93909[0m     [32m1.31751[0m    0.71277      0.53631  113.83s
     10     [36m0.84278[0m     [32m1.07119[0m    0.78677      0.56247  113.68s
     11     [36m0.80518[0m     1.32598    0.60724      0.54620  113.43s
     12     [36m0.71089[0m     1.22665    0.57954      0.54858  113.54s
     13     [36m0.68047[0m     1.20524    0.56459      0.55391  113.84s
     14     [36m0.61465[0m     [32m1.04364[0m    0.58895      0.56811  113.69s
     15     [36m0.58947[0m     [32m0.91847[0m    0.64180      0.58126  113.71s
     16     [36m0.53661[0m     [32m0.90980[0m    0.58981      0.58549  113.57s
     17     [36m0.50997[0m     [32m0.80988[0m    0.62968      0.61324  113.68s
     18     [36m0.46483[0m     0.90246    0.51507      0.60314  113.49s
     19     [36m0.43312[0m     0.87547    0.49474      0.62024  113.77s
     20     [36m0.39545[0m     0.89128    0.44368      0.60792  113.85s
     21     [36m0.35870[0m     [32m0.80818[0m    0.44383      0.62609  113.74s
     22     [36m0.32074[0m     [32m0.80299[0m    0.39943      0.64356  113.59s
     23     [36m0.28649[0m     0.93153    0.30754      0.60032  113.84s
     24     [36m0.23661[0m     0.86402    0.27385      0.62469  113.68s
     25     [36m0.22113[0m     0.92785    0.23832      0.61443  113.90s
     26     [36m0.21243[0m     0.85796    0.24760      0.60741  113.70s
     27     [36m0.17530[0m     0.95677    0.18322      0.58098  113.87s
     28     [36m0.15788[0m     1.02090    0.15464      0.58496  113.48s
     29     [36m0.14679[0m     1.17357    0.12508      0.52925  113.59s
     30     [36m0.11736[0m     1.30321    0.09005      0.55101  113.92s
     31     [36m0.10808[0m     1.32133    0.08179      0.55894  113.89s
     32     [36m0.10763[0m     1.37725    0.07815      0.53944  113.77s
Early stopping.
Best valid loss was 0.802991 at epoch 22.
Loaded parameters to layer 'conv2d1' (shape 32x1x32x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x1x128).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[ 0.99882728  0.99999988  0.69693416  0.99979049  0.99987388  0.99999917
  0.12702018  0.99999893  0.99843591  1.          0.88685906  0.99999475
  0.99967968  1.          0.98366541  0.9999975   0.99999702  1.
  0.70313716  0.99999976  0.9999826   1.          0.93071449  1.
  0.99997926  1.          0.99293834  0.99999988  0.99996293  1.        ]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.503112799409
Error rate (%):  49.6887200591
[[42915 45780]
 [ 1310  4765]]
(94770,)
(94770,)
roc_auc: 0.66578999888
log_loss: nan
roc_auc for the hours: 0.78904109589
log_loss for the hours: inf
saving predictions to csv file
hourspatient1_7_net34_10-22-13-47-20.csv
Accuracy validation for the hours:  0.512820512821
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [7]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.074151424
saving predictions to csv file
patient1_7_net34_10-22-13-54-22.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_8']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_8'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-22 13:54:24.050598
Hostname: kat
gpu3
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net34
evaluation:
    online_training: False
    model: net34

end Configuration
['patient1_8']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [8]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.83755008
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 179.447947693 164.423493958
20 434.278393555 418.093994141
30 634.319030762 613.24385376
40 834.442565918 807.11171875
50 1056.00579834 1020.13357544
60 1321.37426758 1274.3189209
70 1666.15869141 1603.34324951
80 2169.84814453 2082.13676758
90 3113.30068359 2981.24484863
100 59862.1054688 57871.4179688
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net34
Model name for the evaluation phase:  net34
Training model...
# Neural Network with 160482 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x163x66
  2          32x165x65
  3          32x165x65
  4          32x83x33
  5          32x83x33
  6          32x83x33
  7          32x42x17
  8          2x42x17
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1    [36m40.49651[0m     [32m5.53460[0m    7.31697      0.46361  108.64s
      2     [36m2.61284[0m     [32m1.39606[0m    1.87158      0.49257  113.80s
      3     [36m1.73514[0m     [32m1.15231[0m    1.50580      0.50870  114.09s
      4     [36m1.55699[0m     2.22037    0.70123      0.53436  113.85s
      5     [36m1.46368[0m     1.84868    0.79174      0.52368  113.55s
      6     [36m1.10734[0m     1.63506    0.67725      0.52595  113.55s
      7     [36m0.98309[0m     [32m0.88625[0m    1.10927      0.49378  113.75s
      8     [36m0.88401[0m     1.03671    0.85271      0.54885  113.82s
      9     [36m0.78665[0m     1.19830    0.65647      0.54282  113.95s
     10     [36m0.75507[0m     1.03162    0.73192      0.54039  113.77s
     11     [36m0.70354[0m     [32m0.87174[0m    0.80705      0.54212  113.66s
     12     [36m0.65271[0m     0.96777    0.67444      0.56617  114.09s
     13     [36m0.64189[0m     1.00269    0.64017      0.55526  113.90s
     14     [36m0.58099[0m     0.94179    0.61690      0.56757  113.81s
     15     [36m0.54264[0m     [32m0.78067[0m    0.69510      0.54860  114.16s
     16     [36m0.48995[0m     1.02406    0.47844      0.56931  113.64s
     17     [36m0.44242[0m     0.80347    0.55064      0.56486  113.70s
     18     [36m0.39297[0m     0.78462    0.50084      0.58013  113.61s
     19     [36m0.33732[0m     0.87338    0.38623      0.56719  113.85s
     20     [36m0.32538[0m     0.88038    0.36959      0.57836  113.91s
     21     [36m0.24766[0m     0.87950    0.28160      0.56454  113.80s
     22     [36m0.20578[0m     1.16927    0.17599      0.54269  113.71s
     23     [36m0.17796[0m     1.04679    0.17000      0.56328  114.06s
     24     [36m0.14954[0m     1.21848    0.12273      0.54419  113.85s
     25     [36m0.12024[0m     1.32158    0.09098      0.56058  114.16s
Early stopping.
Best valid loss was 0.780666 at epoch 15.
Loaded parameters to layer 'conv2d1' (shape 32x1x32x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x1x128).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[ 0.0696398   0.92962128  0.03069611  0.85640651  0.06162249  0.89658719
  0.08345751  0.39527002  0.27977467  0.87041408  0.04561574  0.28734031
  0.31166494  0.73485601  0.07013275  0.62702656  0.12899671  0.97371078
  0.03787408  0.0915774   0.09604868  0.77756256  0.0193569   0.52122557
  0.09482691  0.94558382  0.06223323  0.34951189  0.38197392  0.98064387]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.326537933945
Error rate (%):  67.3462066055
[[26417 62278]
 [ 1546  4529]]
(94770,)
(94770,)
roc_auc: 0.598871296348
log_loss: nan
roc_auc for the hours: 0.553424657534
log_loss for the hours: 2.22437922116
saving predictions to csv file
hourspatient1_8_net34_10-22-14-51-48.csv
Accuracy validation for the hours:  0.333333333333
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [8]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.073496064
saving predictions to csv file
patient1_8_net34_10-22-14-58-53.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_9']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_9'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-22 14:58:54.485291
Hostname: kat
gpu3
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net34
evaluation:
    online_training: False
    model: net34

end Configuration
['patient1_9']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [9]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.838381568
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 3.68383948803 3.51945617199
20 8.91916770935 8.73870506287
30 13.5332503319 13.2244482994
40 19.6162849426 18.9431503296
50 42.7269630432 33.8711013794
60 446.623547363 383.009014893
70 778.942749023 709.81932373
80 1201.11340332 1105.85910645
90 1927.03088379 1777.32213135
100 43853.8789062 40357.3945312
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net34
Model name for the evaluation phase:  net34
Training model...
# Neural Network with 160482 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x163x66
  2          32x165x65
  3          32x165x65
  4          32x83x33
  5          32x83x33
  6          32x83x33
  7          32x42x17
  8          2x42x17
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1    [36m51.01681[0m     [32m5.09725[0m   10.00870      0.52309  108.62s
      2     [36m1.94288[0m     [32m2.37928[0m    0.81659      0.51500  113.79s
      3     [36m1.32594[0m     [32m1.78027[0m    0.74480      0.50000  114.26s
      4     [36m1.11108[0m     [32m1.42591[0m    0.77921      0.50298  114.44s
      5     [36m1.00773[0m     [32m1.19026[0m    0.84664      0.49932  114.06s
      6     [36m0.90947[0m     [32m1.10176[0m    0.82548      0.50189  113.57s
      7     [36m0.87620[0m     [32m0.96285[0m    0.91000      0.50027  113.66s
      8     [36m0.80814[0m     [32m0.91183[0m    0.88628      0.48281  113.78s
      9     [36m0.77997[0m     [32m0.89247[0m    0.87395      0.47832  113.91s
     10     [36m0.74947[0m     [32m0.88859[0m    0.84344      0.47361  113.74s
     11     [36m0.70615[0m     [32m0.87138[0m    0.81039      0.45272  113.59s
     12     [36m0.67901[0m     [32m0.86475[0m    0.78521      0.47172  113.67s
     13     [36m0.64597[0m     [32m0.86187[0m    0.74949      0.44394  113.90s
     14     [36m0.61954[0m     0.86824    0.71356      0.42163  113.95s
     15     [36m0.58643[0m     0.89104    0.65813      0.40200  113.85s
     16     [36m0.56386[0m     0.91866    0.61379      0.38511  113.66s
     17     [36m0.52294[0m     0.96657    0.54103      0.40243  113.77s
     18     [36m0.50567[0m     1.08508    0.46602      0.40661  113.62s
     19     [36m0.47253[0m     1.10316    0.42834      0.41676  113.86s
     20     [36m0.44802[0m     1.32521    0.33808      0.43709  113.98s
     21     [36m0.42702[0m     1.36379    0.31311      0.45425  114.09s
     22     [36m0.40340[0m     1.54465    0.26116      0.46955  113.81s
     23     [36m0.39326[0m     1.79736    0.21880      0.48350  113.76s
Early stopping.
Best valid loss was 0.861874 at epoch 13.
Loaded parameters to layer 'conv2d1' (shape 32x1x32x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x1x128).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[  1.21322116e-02   9.46373213e-03   1.61943614e-01   9.89936113e-01
   2.11072154e-02   1.91692973e-03   8.93414497e-01   9.70126569e-01
   2.67532561e-03   5.11598587e-03   4.18529809e-01   9.95203137e-01
   1.79129979e-03   4.52141576e-05   3.28855157e-01   9.75065112e-01
   4.60339757e-03   4.55588561e-05   3.94523628e-02   8.18757772e-01
   6.48557616e-05   5.04489708e-06   1.43590942e-02   8.40753496e-01
   5.45594012e-05   3.36983589e-06   6.35969173e-03   8.18703413e-01
   2.97653780e-04   3.46362031e-05]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.165157750343
Error rate (%):  83.4842249657
[[11065 77630]
 [ 1488  4587]]
(94770,)
(94770,)
roc_auc: 0.444171332979
log_loss: nan
roc_auc for the hours: 0.460273972603
log_loss for the hours: 1.62277540283
saving predictions to csv file
hourspatient1_9_net34_10-22-15-52-27.csv
Accuracy validation for the hours:  0.115384615385
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [9]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.074188288
saving predictions to csv file
patient1_9_net34_10-22-16-00-30.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_10']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_10'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-22 16:00:31.744053
Hostname: kat
gpu3
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net34
evaluation:
    online_training: False
    model: net34

end Configuration
['patient1_10']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [10]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.838402048
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 181.207902527 167.670619202
20 438.332196045 424.686590576
30 639.719543457 622.390942383
40 839.969042969 817.731738281
50 1060.19781494 1030.7331543
60 1320.43032227 1280.04846191
70 1650.03087158 1595.78609619
80 2111.48989258 2038.48054199
90 2911.55273438 2807.46408691
100 41643.4882812 36225.46875
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net34
Model name for the evaluation phase:  net34
Training model...
# Neural Network with 160482 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x163x66
  2          32x165x65
  3          32x165x65
  4          32x83x33
  5          32x83x33
  6          32x83x33
  7          32x42x17
  8          2x42x17
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1    [36m33.59272[0m     [32m9.09986[0m    3.69157      0.47338  108.59s
      2     [36m2.91768[0m     [32m1.55428[0m    1.87720      0.47094  113.67s
      3     [36m1.74742[0m     [32m1.41598[0m    1.23407      0.51630  113.95s
      4     [36m1.48061[0m     [32m1.26391[0m    1.17146      0.53301  113.72s
      5     [36m1.22921[0m     1.39479    0.88129      0.55426  113.42s
      6     [36m1.07507[0m     [32m1.21391[0m    0.88563      0.57486  113.43s
      7     [36m0.89694[0m     [32m0.97526[0m    0.91970      0.54083  113.52s
      8     [36m0.85247[0m     1.00226    0.85055      0.56184  113.65s
      9     [36m0.74574[0m     [32m0.93605[0m    0.79669      0.57751  113.78s
     10     [36m0.73621[0m     [32m0.92305[0m    0.79758      0.57377  113.64s
     11     [36m0.68091[0m     [32m0.82200[0m    0.82836      0.54674  113.39s
     12     [36m0.61165[0m     0.90965    0.67240      0.58106  113.51s
     13     [36m0.57722[0m     0.85203    0.67746      0.54474  113.71s
     14     [36m0.53411[0m     0.83475    0.63985      0.56542  113.62s
     15     [36m0.48612[0m     0.90452    0.53744      0.49973  113.67s
     16     [36m0.43054[0m     0.94575    0.45523      0.50566  113.53s
     17     [36m0.39436[0m     0.94969    0.41525      0.50108  113.61s
     18     [36m0.36959[0m     1.02273    0.36138      0.48024  113.43s
     19     [36m0.32018[0m     1.18327    0.27059      0.47552  113.70s
     20     [36m0.25297[0m     1.46417    0.17277      0.46828  113.79s
     21     [36m0.22389[0m     1.45871    0.15348      0.46187  113.68s
Early stopping.
Best valid loss was 0.821996 at epoch 11.
Loaded parameters to layer 'conv2d1' (shape 32x1x32x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x1x128).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[ 0.14916597  0.09578404  0.00325292  0.00157759  0.02563087  0.05144861
  0.00206527  0.00564521  0.21216954  0.1203128   0.00163353  0.00442535
  0.40864918  0.68240017  0.02242509  0.01516294  0.62030178  0.61505175
  0.06210134  0.03427096  0.38141936  0.10994595  0.07278691  0.03763847
  0.18773575  0.54753023  0.03460814  0.15945655  0.74313742  0.73413891]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.37589954627
Error rate (%):  62.410045373
[[31345 57350]
 [ 1796  4279]]
(94770,)
(94770,)
roc_auc: 0.54472616079
log_loss: nan
roc_auc for the hours: 0.553424657534
log_loss for the hours: 2.19246708586
saving predictions to csv file
hourspatient1_10_net34_10-22-16-50-10.csv
Accuracy validation for the hours:  0.346153846154
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [10]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.074733056
saving predictions to csv file
patient1_10_net34_10-22-16-57-06.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_11']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_11'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-22 16:57:08.012011
Hostname: kat
gpu3
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net34
evaluation:
    online_training: False
    model: net34

end Configuration
['patient1_11']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [11]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.838139904
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 172.641601563 159.5427948
20 417.636303711 403.23772583
30 608.427856445 589.179815674
40 796.191516113 769.670605469
50 999.883514404 964.325683594
60 1236.0432373 1189.17692871
70 1532.10228271 1470.09255371
80 1945.44143066 1860.52646484
90 2669.32939453 2545.69404297
100 34311.5273438 30092.4199219
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net34
Model name for the evaluation phase:  net34
Training model...
# Neural Network with 160482 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x163x66
  2          32x165x65
  3          32x165x65
  4          32x83x33
  5          32x83x33
  6          32x83x33
  7          32x42x17
  8          2x42x17
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1    [36m32.03601[0m     [32m5.51614[0m    5.80768      0.46632  108.65s
      2     [36m2.43402[0m     [32m1.24361[0m    1.95721      0.63423  113.75s
      3     [36m1.56392[0m     [32m1.22018[0m    1.28171      0.61386  114.05s
      4     [36m1.26295[0m     1.33131    0.94865      0.60823  113.78s
      5     [36m1.09796[0m     1.49785    0.73302      0.59378  113.48s
      6     [36m1.02622[0m     1.96381    0.52257      0.55135  113.50s
      7     [36m0.94805[0m     1.39487    0.67967      0.56301  113.59s
      8     [36m0.78917[0m     1.34534    0.58660      0.56915  113.72s
      9     [36m0.73754[0m     [32m1.15012[0m    0.64128      0.59106  113.84s
     10     [36m0.70773[0m     [32m0.97255[0m    0.72770      0.62682  113.68s
     11     [36m0.64015[0m     [32m0.95288[0m    0.67181      0.62962  113.44s
     12     [36m0.60128[0m     1.04106    0.57756      0.61164  113.54s
     13     [36m0.57249[0m     [32m0.93198[0m    0.61427      0.63181  113.79s
     14     [36m0.52847[0m     [32m0.92746[0m    0.56980      0.64338  113.71s
     15     [36m0.48971[0m     [32m0.83623[0m    0.58561      0.63472  113.74s
     16     [36m0.44081[0m     0.92687    0.47559      0.63511  113.60s
     17     [36m0.39935[0m     [32m0.80686[0m    0.49495      0.62514  113.67s
     18     [36m0.35008[0m     0.85195    0.41092      0.58121  113.47s
     19     [36m0.33371[0m     0.84556    0.39466      0.58624  113.72s
     20     [36m0.28916[0m     0.90874    0.31820      0.57592  113.81s
     21     [36m0.24183[0m     0.95246    0.25390      0.52424  113.68s
     22     [36m0.21048[0m     1.20152    0.17518      0.47308  113.50s
     23     [36m0.16562[0m     1.28253    0.12914      0.46620  113.66s
     24     [36m0.15005[0m     1.81021    0.08289      0.45281  113.56s
     25     [36m0.12337[0m     1.44910    0.08513      0.47038  113.78s
     26     0.13537     1.50398    0.09001      0.43155  113.68s
     27     [36m0.11099[0m     2.13970    0.05187      0.44786  113.83s
Early stopping.
Best valid loss was 0.806857 at epoch 17.
Loaded parameters to layer 'conv2d1' (shape 32x1x32x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x1x128).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[  2.69008870e-03   2.62058750e-02   8.80368098e-05   2.96029449e-01
   6.53314273e-05   7.66823953e-03   3.19500134e-04   9.21569392e-02
   1.98210182e-05   1.03424434e-02   7.86189321e-06   2.28203228e-03
   1.31843180e-05   4.75086197e-02   1.49951541e-06   2.03231839e-03
   2.00977534e-04   9.15671792e-03   3.06690454e-05   4.52072956e-02
   3.96246469e-04   1.25814648e-02   6.19086495e-05   4.23501372e-01
   1.00785773e-02   1.57055512e-01   3.67288449e-04   8.26470137e-01
   2.29010405e-03   1.59020394e-01]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.441500474834
Error rate (%):  55.8499525166
[[37073 51622]
 [ 1307  4768]]
(94770,)
(94770,)
roc_auc: 0.588121316473
log_loss: nan
roc_auc for the hours: 0.632876712329
log_loss for the hours: inf
saving predictions to csv file
hourspatient1_11_net34_10-22-17-58-12.csv
Accuracy validation for the hours:  0.448717948718
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [11]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.074003968
saving predictions to csv file
patient1_11_net34_10-22-18-05-07.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_12']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_12'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-22 18:05:09.503383
Hostname: kat
gpu3
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net34
evaluation:
    online_training: False
    model: net34

end Configuration
['patient1_12']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [12]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.838402048
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 194.413856506 178.851933289
20 463.675524902 446.537554932
30 666.165478516 644.010736084
40 859.942541504 831.373522949
50 1065.9508667 1029.34899902
60 1304.29125977 1256.71569824
70 1606.91943359 1543.18864746
80 2047.88012695 1958.46350098
90 2871.70686035 2742.33198242
100 68176.640625 59867.6914062
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net34
Model name for the evaluation phase:  net34
Training model...
# Neural Network with 160482 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x163x66
  2          32x165x65
  3          32x165x65
  4          32x83x33
  5          32x83x33
  6          32x83x33
  7          32x42x17
  8          2x42x17
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1    [36m33.90341[0m     [32m2.37602[0m   14.26901      0.43781  108.39s
      2     [36m2.55505[0m     [32m1.09371[0m    2.33613      0.61125  113.74s
      3     [36m1.54118[0m     [32m1.03817[0m    1.48451      0.62908  114.03s
      4     [36m1.33727[0m     1.22715    1.08973      0.60877  113.80s
      5     [36m1.16929[0m     1.33142    0.87823      0.58647  113.49s
      6     [36m1.01431[0m     1.34154    0.75608      0.57649  113.51s
      7     [36m0.87567[0m     [32m1.00547[0m    0.87090      0.61168  113.60s
      8     [36m0.80904[0m     [32m0.88678[0m    0.91233      0.62815  113.74s
      9     [36m0.72461[0m     1.00673    0.71977      0.60298  113.86s
     10     [36m0.67068[0m     0.92520    0.72490      0.61255  113.70s
     11     [36m0.64958[0m     [32m0.87575[0m    0.74174      0.61821  113.44s
     12     [36m0.59637[0m     0.97879    0.60930      0.61164  113.55s
     13     [36m0.57989[0m     [32m0.87261[0m    0.66455      0.61429  113.78s
     14     [36m0.51695[0m     [32m0.85150[0m    0.60711      0.61775  113.71s
     15     [36m0.51612[0m     [32m0.79307[0m    0.65079      0.61798  113.75s
     16     [36m0.47383[0m     0.86590    0.54720      0.61785  113.62s
     17     [36m0.45699[0m     0.83903    0.54466      0.61622  113.70s
     18     [36m0.40597[0m     0.94552    0.42936      0.62534  113.50s
     19     0.41226     0.79783    0.51673      0.58950  113.78s
     20     [36m0.34876[0m     0.89916    0.38787      0.60249  113.85s
     21     [36m0.30186[0m     0.91658    0.32933      0.59069  113.74s
     22     [36m0.25008[0m     0.87483    0.28586      0.60277  113.54s
     23     [36m0.22073[0m     1.03181    0.21393      0.57247  113.71s
     24     [36m0.17883[0m     1.10851    0.16133      0.56432  113.59s
     25     [36m0.15269[0m     1.25195    0.12196      0.55089  113.81s
Early stopping.
Best valid loss was 0.793070 at epoch 15.
Loaded parameters to layer 'conv2d1' (shape 32x1x32x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x1x128).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[ 0.97437423  0.98804384  0.97202116  0.87780476  0.96639198  0.98887849
  0.98051238  0.94567788  0.97292352  0.91075861  0.97278929  0.86738652
  0.98123115  0.98471469  0.9950794   0.84283078  0.99098301  0.98905224
  0.98060971  0.937626    0.99576169  0.98355341  0.99000615  0.90281332
  0.99642557  0.99082339  0.9862743   0.93313342  0.99895322  0.99763143]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.414804262952
Error rate (%):  58.5195737048
[[34201 54494]
 [  965  5110]]
(94770,)
(94770,)
roc_auc: 0.618384477994
log_loss: nan
roc_auc for the hours: 0.660273972603
log_loss for the hours: inf
saving predictions to csv file
hourspatient1_12_net34_10-22-19-02-26.csv
Accuracy validation for the hours:  0.397435897436
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [12]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.074188288
saving predictions to csv file
patient1_12_net34_10-22-19-09-21.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_13']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_13'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-22 19:09:23.215321
Hostname: kat
gpu3
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net34
evaluation:
    online_training: False
    model: net34

end Configuration
['patient1_13']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [13]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.838520832
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 197.41583252 182.761578369
20 473.741113281 459.648413086
30 683.193365479 665.443499756
40 884.565112305 862.165649414
50 1098.331604 1068.85339355
60 1343.71057129 1304.4578125
70 1651.5090332 1598.25623779
80 2090.38417969 2016.00366211
90 2902.72646484 2791.59272461
100 37327.25 36955.34375
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net34
Model name for the evaluation phase:  net34
Training model...
# Neural Network with 160482 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x163x66
  2          32x165x65
  3          32x165x65
  4          32x83x33
  5          32x83x33
  6          32x83x33
  7          32x42x17
  8          2x42x17
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1    [36m34.65110[0m     [32m9.96666[0m    3.47670      0.47610  108.45s
      2     [36m2.27622[0m     [32m2.08025[0m    1.09420      0.45255  113.71s
      3     [36m1.48429[0m     [32m1.43729[0m    1.03270      0.45163  114.00s
      4     [36m1.25191[0m     [32m0.93742[0m    1.33548      0.47781  113.75s
      5     [36m1.06136[0m     [32m0.88896[0m    1.19393      0.50690  113.44s
      6     [36m0.91807[0m     [32m0.85936[0m    1.06831      0.51351  113.45s
      7     [36m0.83054[0m     1.01093    0.82156      0.45457  113.56s
      8     [36m0.73045[0m     0.87062    0.83900      0.48552  113.71s
      9     [36m0.68493[0m     1.05846    0.64710      0.45556  113.84s
     10     [36m0.63180[0m     0.89385    0.70684      0.49973  113.68s
     11     0.63218     [32m0.79151[0m    0.79870      0.55870  113.43s
     12     [36m0.54858[0m     [32m0.77372[0m    0.70901      0.64655  113.53s
     13     [36m0.52222[0m     0.80575    0.64812      0.61833  113.80s
     14     [36m0.47254[0m     0.84261    0.56081      0.54465  113.70s
     15     [36m0.41947[0m     1.09250    0.38395      0.46517  113.74s
     16     [36m0.40672[0m     0.94965    0.42829      0.55556  113.60s
     17     [36m0.35673[0m     1.15200    0.30966      0.45703  113.66s
     18     [36m0.33008[0m     0.95158    0.34687      0.54629  113.47s
     19     [36m0.29181[0m     1.23793    0.23572      0.47116  113.78s
     20     [36m0.25329[0m     1.31340    0.19285      0.47533  113.94s
     21     [36m0.22461[0m     1.43711    0.15630      0.46215  113.81s
     22     [36m0.18365[0m     1.66737    0.11014      0.45432  113.61s
Early stopping.
Best valid loss was 0.773719 at epoch 12.
Loaded parameters to layer 'conv2d1' (shape 32x1x32x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x1x128).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[ 0.99999952  1.          0.99999976  0.99999988  0.99999964  0.99999988
  0.99999893  0.99999988  0.99999917  0.99999988  0.99999547  0.99999928
  0.99999976  1.          0.99999762  0.99999988  0.99999976  0.99999988
  0.99999487  0.99999988  0.99999928  1.          0.99999952  0.99999988
  1.          1.          0.99999952  0.99999988  1.          1.        ]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.531761105835
Error rate (%):  46.8238894165
[[45821 42874]
 [ 1501  4574]]
(94770,)
(94770,)
roc_auc: 0.63350589863
log_loss: nan
roc_auc for the hours: 0.723287671233
log_loss for the hours: 1.21725840505
saving predictions to csv file
hourspatient1_13_net34_10-22-20-01-01.csv
Accuracy validation for the hours:  0.525641025641
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [13]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.074466816
saving predictions to csv file
patient1_13_net34_10-22-20-08-00.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_14']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_14'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-22 20:08:01.753172
Hostname: kat
gpu3
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net34
evaluation:
    online_training: False
    model: net34

end Configuration
['patient1_14']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [14]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.838524928
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 189.141261292 174.980825806
20 452.630731201 438.836401367
30 649.66987915 632.660009766
40 836.557116699 814.948742676
50 1031.56469727 1003.98742676
60 1251.25163574 1216.06953125
70 1519.30529785 1471.67954102
80 1885.33984375 1820.3204834
90 2516.96833496 2415.86462402
100 43412.1367188 33402.015625
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net34
Model name for the evaluation phase:  net34
Training model...
# Neural Network with 160482 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x163x66
  2          32x165x65
  3          32x165x65
  4          32x83x33
  5          32x83x33
  6          32x83x33
  7          32x42x17
  8          2x42x17
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1    [36m33.05677[0m     [32m2.52253[0m   13.10462      0.45790  108.41s
      2     [36m2.33262[0m     [32m0.84364[0m    2.76495      0.61341  113.65s
      3     [36m1.42708[0m     1.07830    1.32346      0.61277  113.94s
      4     [36m1.22613[0m     1.45069    0.84521      0.58685  113.67s
      5     [36m1.00185[0m     1.19222    0.84032      0.59107  113.37s
      6     [36m0.91149[0m     1.37513    0.66284      0.57405  113.38s
      7     [36m0.81130[0m     0.87048    0.93202      0.61655  113.51s
      8     [36m0.74731[0m     0.88641    0.84308      0.60893  113.64s
      9     [36m0.68589[0m     1.08340    0.63309      0.58699  113.73s
     10     [36m0.66808[0m     [32m0.79897[0m    0.83618      0.61066  113.58s
     11     [36m0.61681[0m     0.95562    0.64545      0.60679  113.36s
     12     [36m0.57945[0m     0.84428    0.68633      0.61976  113.47s
     13     [36m0.56061[0m     0.84719    0.66173      0.60620  113.73s
     14     [36m0.50619[0m     0.95674    0.52908      0.60696  114.21s
     15     [36m0.48709[0m     0.81851    0.59509      0.62743  114.29s
     16     [36m0.47048[0m     0.85840    0.54809      0.61381  114.13s
     17     [36m0.41126[0m     0.85424    0.48144      0.62865  114.23s
     18     [36m0.39091[0m     0.80071    0.48820      0.63833  114.05s
     19     [36m0.34351[0m     0.87122    0.39429      0.63547  114.31s
     20     [36m0.30239[0m     0.91493    0.33050      0.63395  114.41s
Early stopping.
Best valid loss was 0.798967 at epoch 10.
Loaded parameters to layer 'conv2d1' (shape 32x1x32x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x1x128).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[ 0.108753    0.93218678  0.95571685  0.99413484  0.03368939  0.91498208
  0.99421149  0.99681622  0.14699039  0.97964352  0.99179322  0.99344218
  0.15778667  0.97713256  0.99294186  0.9912799   0.0241914   0.93223071
  0.93846875  0.92910671  0.04990314  0.95927066  0.96474409  0.98234797
  0.06562191  0.99626678  0.85685432  0.98047811  0.04433953  0.92979062]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.326928352854
Error rate (%):  67.3071647146
[[25333 63362]
 [  425  5650]]
(94770,)
(94770,)
roc_auc: 0.697552401917
log_loss: nan
roc_auc for the hours: 0.731506849315
log_loss for the hours: inf
saving predictions to csv file
hourspatient1_14_net34_10-22-20-55-52.csv
Accuracy validation for the hours:  0.282051282051
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [14]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.074540544
saving predictions to csv file
patient1_14_net34_10-22-21-03-54.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_15']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_15'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-22 21:03:55.410211
Hostname: kat
gpu3
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net34
evaluation:
    online_training: False
    model: net34

end Configuration
['patient1_15']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [15]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.838938624
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 192.412426758 176.768930054
20 459.689099121 442.431689453
30 658.81307373 637.209912109
40 846.730224609 819.873974609
50 1042.01245117 1009.00811768
60 1261.45869141 1219.99689941
70 1528.8362793 1476.44569092
80 1896.24025879 1829.35996094
90 2539.709375 2448.71398926
100 29197.0292969 29615.0136719
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net34
Model name for the evaluation phase:  net34
Training model...
# Neural Network with 160482 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x163x66
  2          32x165x65
  3          32x165x65
  4          32x83x33
  5          32x83x33
  6          32x83x33
  7          32x42x17
  8          2x42x17
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1    [36m34.86832[0m     [32m4.10588[0m    8.49229      0.46252  109.01s
      2     [36m2.37082[0m     [32m1.07715[0m    2.20100      0.62125  114.30s
      3     [36m1.47217[0m     1.30759    1.12587      0.60707  114.59s
      4     [36m1.26047[0m     1.12490    1.12052      0.62473  114.39s
      5     [36m1.07728[0m     1.66573    0.64673      0.58674  114.06s
      6     [36m1.06911[0m     1.55687    0.68671      0.58622  113.79s
      7     [36m0.86525[0m     [32m1.05005[0m    0.82401      0.61006  113.46s
      8     [36m0.79580[0m     1.19918    0.66362      0.60189  113.68s
      9     [36m0.70963[0m     1.53215    0.46316      0.57263  113.77s
     10     [36m0.68766[0m     1.11036    0.61931      0.59801  113.57s
     11     [36m0.62766[0m     1.21443    0.51683      0.59484  113.34s
     12     [36m0.58077[0m     1.47237    0.39445      0.57645  113.45s
     13     0.59726     1.13726    0.52517      0.60216  113.68s
     14     [36m0.53944[0m     [32m0.98254[0m    0.54902      0.60831  113.68s
     15     [36m0.49015[0m     1.03372    0.47416      0.60367  113.91s
     16     [36m0.46863[0m     0.98499    0.47577      0.61435  114.13s
     17     [36m0.45344[0m     [32m0.89233[0m    0.50815      0.62216  114.21s
     18     [36m0.42453[0m     0.92385    0.45953      0.62019  114.02s
     19     0.42695     1.11171    0.38405      0.60147  114.32s
     20     [36m0.36746[0m     0.98574    0.37277      0.60358  114.40s
     21     [36m0.33829[0m     1.10629    0.30578      0.61574  114.28s
     22     [36m0.29615[0m     1.00606    0.29437      0.60957  114.09s
     23     [36m0.24867[0m     0.96329    0.25814      0.60546  113.81s
     24     [36m0.21826[0m     1.02158    0.21365      0.58961  113.80s
     25     [36m0.18744[0m     1.04273    0.17976      0.58885  114.32s
     26     [36m0.17471[0m     1.07731    0.16218      0.59578  114.25s
     27     [36m0.13908[0m     1.07200    0.12974      0.56966  114.63s
Early stopping.
Best valid loss was 0.892334 at epoch 17.
Loaded parameters to layer 'conv2d1' (shape 32x1x32x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x1x128).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[ 0.9410063   0.99948311  0.81698489  0.99964881  0.96520805  0.99975616
  0.99264246  0.99987638  0.99599957  0.99995482  0.98259705  0.99994385
  0.99897999  0.99998832  0.9978388   0.99995923  0.99916553  0.99999857
  0.99959689  0.99992836  0.99951053  0.99998283  0.99855298  0.9997887
  0.99884427  0.99996078  0.99331361  0.99974424  0.99440837  0.99998891]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.344476100032
Error rate (%):  65.5523899968
[[27108 61587]
 [  537  5538]]
(94770,)
(94770,)
roc_auc: 0.652685364396
log_loss: nan
roc_auc for the hours: 0.687671232877
log_loss for the hours: inf
saving predictions to csv file
hourspatient1_15_net34_10-22-22-05-10.csv
Accuracy validation for the hours:  0.333333333333
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [15]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.075081216
saving predictions to csv file
patient1_15_net34_10-22-22-12-12.csv
