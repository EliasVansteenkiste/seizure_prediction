['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config4.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_0']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config4.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_0'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-04 16:47:02.709809
Hostname: kat
gpu2
Configuration 'config4.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net12
evaluation:
    online_training: False
    model: net12

end Configuration
['patient2_0']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [0]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.746508288
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 367.479559326 395.117904663
20 582.979382324 615.201062012
30 795.170080566 830.338665771
40 1032.00554199 1067.2041748
50 1317.6385498 1346.52661133
60 1685.20253906 1697.71447754
70 2197.84929199 2175.63908691
80 3011.64487305 2914.53989258
90 4710.7300293 4431.95449219
100 63321.7421875 58944.8007812
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net12
Model name for the evaluation phase:  net12
Training model...
# Neural Network with 540034 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          64x192x64
  3          64x192x64
  4          128x96x32
  5          128x96x32
  6          128x96x32
  7          256x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m7.25660[0m     [32m0.74722[0m    9.71146      0.54379  18.53s
      2     [36m0.54507[0m     [32m0.70191[0m    0.77656      0.63464  19.58s
      3     [36m0.52650[0m     0.71270    0.73874      0.57386  18.94s
      4     [36m0.51971[0m     0.72038    0.72145      0.57190  18.73s
      5     [36m0.51883[0m     0.71651    0.72410      0.59804  18.78s
      6     [36m0.51241[0m     [32m0.69618[0m    0.73602      0.64183  18.79s
      7     0.51806     [32m0.69343[0m    0.74710      0.67059  18.87s
      8     0.51814     0.71317    0.72653      0.71699  19.98s
      9     [36m0.50926[0m     0.71636    0.71090      0.70000  26.03s
     10     [36m0.50501[0m     0.72616    0.69546      0.72614  26.05s
     11     0.50606     0.73472    0.68877      0.71111  21.64s
     12     [36m0.50403[0m     0.74546    0.67613      0.72026  19.02s
     13     [36m0.49505[0m     0.78781    0.62838      0.68693  19.26s
     14     [36m0.49229[0m     0.82227    0.59869      0.70327  19.02s
     15     0.50000     0.76506    0.65355      0.71046  19.15s
     16     [36m0.49164[0m     0.80022    0.61438      0.70000  19.10s
     17     0.49539     0.80955    0.61193      0.68889  18.93s
Early stopping.
Best valid loss was 0.693425 at epoch 7.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d4' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d4' (shape 128).
Loaded parameters to layer 'conv2d5' (shape 128x128x3x3).
Loaded parameters to layer 'conv2d5' (shape 128).
Loaded parameters to layer 'conv2d7' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d7' (shape 256).
Loaded parameters to layer 'conv2d8' (shape 2x256x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
probabilities.shape (1140, 2)
Showing last 30 test samples..
Predictions:
[0 1 1 1 1 0 1 1 1 1 0 1 1 1 1 0 1 1 1 1 0 1 1 1 1 0 1 1 1 1]
Ground Truth:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Performance on relevant data
Accuracy validation:  0.676315789474
Error rate (%):  32.3684210526
[[317 253]
 [116 454]]
roc_auc: 0.736603570329
log_loss: 0.701238447481
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[  9.99964237e-01   3.80007223e-05]
[ 0.17785065  0.82214928]
[ 0.10960172  0.89039785]
[  1.45505612e-06   9.99999702e-01]
[ 0.00159818  0.99840385]
roc_auc for the hours: 0.752631578947
log_loss for the hours: 1.57576339908
saving predictions to csv file
hourspatient2_0_net12_10-04-16-56-18.csv
Accuracy validation for the hours:  0.720930232558
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [0]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.038225408
saving predictions to csv file
patient2_0_net12_10-04-17-01-21.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config4.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_1']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config4.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_1'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-04 17:01:22.178525
Hostname: kat
gpu2
Configuration 'config4.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net12
evaluation:
    online_training: False
    model: net12

end Configuration
['patient2_1']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [1]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.74625024
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 263.661355591 284.954690552
20 416.892218018 440.678961182
30 568.269549561 590.942108154
40 738.6140625 756.022766113
50 948.0390625 954.364257812
60 1230.36213379 1214.27253418
70 1653.89840088 1589.50096436
80 2395.20083008 2220.65932617
90 4170.49838867 3672.37075195
100 56617.8046875 55581.1640625
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net12
Model name for the evaluation phase:  net12
Training model...
# Neural Network with 540034 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          64x192x64
  3          64x192x64
  4          128x96x32
  5          128x96x32
  6          128x96x32
  7          256x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m6.44466[0m     [32m0.81489[0m    7.90860      0.53333  18.16s
      2     [36m0.54717[0m     [32m0.78345[0m    0.69841      0.59608  18.49s
      3     [36m0.53428[0m     0.79362    0.67322      0.59020  19.04s
      4     [36m0.52918[0m     0.80814    0.65482      0.55556  18.79s
      5     [36m0.52662[0m     0.83521    0.63052      0.56863  18.45s
      6     [36m0.52238[0m     0.83978    0.62204      0.55752  18.46s
      7     0.52290     0.82612    0.63296      0.56471  18.75s
      8     [36m0.52104[0m     0.81320    0.64073      0.53137  18.81s
      9     [36m0.51968[0m     0.79565    0.65315      0.55490  18.69s
     10     [36m0.51556[0m     [32m0.77633[0m    0.66409      0.58693  18.43s
     11     [36m0.50654[0m     [32m0.77498[0m    0.65362      0.56013  18.35s
     12     0.51934     [32m0.73854[0m    0.70320      0.59935  18.37s
     13     [36m0.49954[0m     [32m0.73563[0m    0.67906      0.60850  18.50s
     14     [36m0.49852[0m     0.77115    0.64646      0.61242  18.64s
     15     [36m0.49384[0m     0.78385    0.63002      0.61699  18.87s
     16     [36m0.48923[0m     [32m0.70558[0m    0.69337      0.62157  18.75s
     17     [36m0.48829[0m     0.71305    0.68479      0.61373  18.60s
     18     [36m0.48213[0m     0.71931    0.67026      0.60458  18.53s
     19     0.48851     0.72682    0.67212      0.57582  18.50s
     20     [36m0.47717[0m     0.73559    0.64869      0.57124  18.92s
     21     [36m0.46983[0m     [32m0.69652[0m    0.67453      0.60523  18.77s
     22     [36m0.46617[0m     0.71260    0.65418      0.57974  24.92s
     23     [36m0.46542[0m     [32m0.69299[0m    0.67161      0.59150  30.82s
     24     [36m0.46260[0m     0.74712    0.61918      0.57778  30.61s
     25     [36m0.44923[0m     0.77120    0.58251      0.58562  30.75s
     26     0.47301     [32m0.68790[0m    0.68761      0.58824  30.99s
     27     0.45313     0.89429    0.50670      0.59281  30.72s
     28     [36m0.42577[0m     0.92830    0.45865      0.58562  30.90s
     29     [36m0.41968[0m     0.93004    0.45124      0.56536  30.69s
     30     0.42835     1.06623    0.40174      0.56797  31.07s
     31     [36m0.40729[0m     1.03808    0.39235      0.56144  30.93s
     32     0.41040     0.90864    0.45167      0.58627  29.53s
     33     [36m0.40400[0m     0.96817    0.41728      0.57190  28.38s
     34     0.40542     1.09522    0.37018      0.56209  19.52s
     35     [36m0.38226[0m     0.96916    0.39443      0.58235  19.57s
     36     [36m0.38141[0m     1.05295    0.36223      0.59935  19.33s
Early stopping.
Best valid loss was 0.687899 at epoch 26.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d4' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d4' (shape 128).
Loaded parameters to layer 'conv2d5' (shape 128x128x3x3).
Loaded parameters to layer 'conv2d5' (shape 128).
Loaded parameters to layer 'conv2d7' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d7' (shape 256).
Loaded parameters to layer 'conv2d8' (shape 2x256x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
probabilities.shape (1140, 2)
Showing last 30 test samples..
Predictions:
[0 1 0 1 0 1 1 1 1 1 1 1 1 1 1 0 1 0 1 0 0 1 1 1 1 0 1 1 1 1]
Ground Truth:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Performance on relevant data
Accuracy validation:  0.610526315789
Error rate (%):  38.9473684211
[[285 285]
 [159 411]]
roc_auc: 0.630387811634
log_loss: 0.694622244439
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[ 0.94332933  0.05667111]
[ 0.25789902  0.74210137]
[ 0.84253329  0.15746699]
[ 0.40781972  0.59218061]
[ 0.79998016  0.20002015]
roc_auc for the hours: 0.668421052632
log_loss for the hours: 0.487825517667
saving predictions to csv file
hourspatient2_1_net12_10-04-17-19-15.csv
Accuracy validation for the hours:  0.813953488372
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [1]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.036886016
saving predictions to csv file
patient2_1_net12_10-04-17-23-17.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config4.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_2']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config4.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_2'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-04 17:23:18.707655
Hostname: kat
gpu2
Configuration 'config4.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net12
evaluation:
    online_training: False
    model: net12

end Configuration
['patient2_2']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [2]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.746180608
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 209.986540222 225.906962585
20 329.095306396 346.162701416
30 444.230593872 460.11050415
40 570.524414062 582.58815918
50 722.16116333 726.961212158
60 921.348901367 911.623071289
70 1211.68074951 1175.55042725
80 1700.91003418 1611.25981445
90 2771.39865723 2552.46484375
100 58473.7617188 75930.625
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net12
Model name for the evaluation phase:  net12
Training model...
# Neural Network with 540034 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          64x192x64
  3          64x192x64
  4          128x96x32
  5          128x96x32
  6          128x96x32
  7          256x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m4.59981[0m     [32m0.95797[0m    4.80164      0.49281  18.03s
      2     [36m0.53735[0m     [32m0.81188[0m    0.66186      0.54248  17.99s
      3     [36m0.51639[0m     0.88416    0.58404      0.51961  18.45s
      4     [36m0.50940[0m     0.91912    0.55423      0.52484  18.98s
      5     [36m0.50224[0m     0.95551    0.52563      0.56340  19.89s
      6     [36m0.48659[0m     1.02200    0.47611      0.56732  26.21s
      7     [36m0.48498[0m     1.11363    0.43550      0.57647  26.03s
      8     0.48796     1.18319    0.41241      0.56667  22.19s
      9     [36m0.47008[0m     1.30307    0.36075      0.57908  19.02s
     10     0.47010     1.38085    0.34044      0.57059  19.13s
     11     [36m0.46797[0m     1.47066    0.31821      0.57451  19.09s
     12     [36m0.45982[0m     1.55095    0.29648      0.57190  19.18s
Early stopping.
Best valid loss was 0.811876 at epoch 2.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d4' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d4' (shape 128).
Loaded parameters to layer 'conv2d5' (shape 128x128x3x3).
Loaded parameters to layer 'conv2d5' (shape 128).
Loaded parameters to layer 'conv2d7' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d7' (shape 256).
Loaded parameters to layer 'conv2d8' (shape 2x256x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
probabilities.shape (1140, 2)
Showing last 30 test samples..
Predictions:
[0 1 0 1 1 0 1 0 1 1 0 1 1 1 1 0 1 1 1 1 0 1 0 1 1 0 1 0 1 1]
Ground Truth:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Performance on relevant data
Accuracy validation:  0.552631578947
Error rate (%):  44.7368421053
[[232 338]
 [172 398]]
roc_auc: 0.61595567867
log_loss: 0.814307724671
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[  9.99999225e-01   1.93279857e-06]
[  5.67074690e-04   9.99431968e-01]
[ 0.61344218  0.38655749]
[  4.44007710e-05   9.99958277e-01]
[  2.16732928e-06   9.99999583e-01]
roc_auc for the hours: 0.621052631579
log_loss for the hours: inf
saving predictions to csv file
hourspatient2_2_net12_10-04-17-38-06.csv
Accuracy validation for the hours:  0.441860465116
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [2]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.04329216
saving predictions to csv file
patient2_2_net12_10-04-17-42-20.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config4.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_3']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config4.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_3'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-04 17:42:21.742029
Hostname: kat
gpu2
Configuration 'config4.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net12
evaluation:
    online_training: False
    model: net12

end Configuration
['patient2_3']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [3]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.74729472
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 232.146871948 248.098060608
20 362.633648682 379.823339844
30 488.15196228 505.159686279
40 627.292626953 642.350366211
50 799.678375244 809.175415039
60 1039.14638672 1037.57441406
70 1420.94019775 1395.75299072
80 2108.71582031 2036.62312012
90 3569.3847168 3399.96303711
100 147926.25 114985.820312
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net12
Model name for the evaluation phase:  net12
Training model...
# Neural Network with 540034 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          64x192x64
  3          64x192x64
  4          128x96x32
  5          128x96x32
  6          128x96x32
  7          256x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m8.65958[0m     [32m0.93358[0m    9.27566      0.45425  18.76s
      2     [36m0.61100[0m     [32m0.78371[0m    0.77963      0.53464  18.63s
      3     [36m0.54724[0m     0.94351    0.58000      0.53399  18.95s
      4     [36m0.52660[0m     0.98944    0.53222      0.54771  19.17s
      5     [36m0.51542[0m     1.00830    0.51118      0.56144  19.08s
      6     [36m0.49822[0m     1.01034    0.49312      0.56797  18.88s
      7     [36m0.49479[0m     1.03139    0.47973      0.57059  18.96s
      8     [36m0.49358[0m     1.03605    0.47641      0.58105  18.64s
      9     [36m0.48184[0m     1.05578    0.45638      0.64510  18.75s
     10     [36m0.48042[0m     1.12809    0.42587      0.60261  19.07s
     11     [36m0.47606[0m     1.09997    0.43279      0.62941  19.12s
     12     [36m0.46779[0m     1.17232    0.39903      0.60980  22.97s
Early stopping.
Best valid loss was 0.783712 at epoch 2.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d4' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d4' (shape 128).
Loaded parameters to layer 'conv2d5' (shape 128x128x3x3).
Loaded parameters to layer 'conv2d5' (shape 128).
Loaded parameters to layer 'conv2d7' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d7' (shape 256).
Loaded parameters to layer 'conv2d8' (shape 2x256x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
probabilities.shape (1140, 2)
Showing last 30 test samples..
Predictions:
[0 1 1 1 1 0 1 1 1 1 0 1 1 1 1 0 1 1 1 1 0 1 1 1 1 0 1 1 1 1]
Ground Truth:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Performance on relevant data
Accuracy validation:  0.528070175439
Error rate (%):  47.1929824561
[[146 424]
 [114 456]]
roc_auc: 0.548707294552
log_loss: 0.776020924868
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[ 0.99869198  0.00130971]
[  1.78364717e-05   9.99988854e-01]
[ 0.01227066  0.98772895]
[ 0.01834521  0.98165387]
[ 0.00586964  0.9941299 ]
roc_auc for the hours: 0.563157894737
log_loss for the hours: 3.43358037923
saving predictions to csv file
hourspatient2_3_net12_10-04-17-56-54.csv
Accuracy validation for the hours:  0.348837209302
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [3]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.038442496
saving predictions to csv file
patient2_3_net12_10-04-18-01-07.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config4.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_4']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config4.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_4'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-04 18:01:08.598604
Hostname: kat
gpu2
Configuration 'config4.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net12
evaluation:
    online_training: False
    model: net12

end Configuration
['patient2_4']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [4]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.746303488
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 165.436743164 175.107310486
20 259.898529053 270.363952637
30 352.872415161 363.763861084
40 459.585931396 469.051629639
50 596.801239014 602.84375
60 794.120068359 791.004992676
70 1106.86796875 1082.3704834
80 1648.70195313 1577.21459961
90 2803.05773926 2610.05686035
100 44210.6640625 39898.75
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net12
Model name for the evaluation phase:  net12
Training model...
# Neural Network with 540034 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          64x192x64
  3          64x192x64
  4          128x96x32
  5          128x96x32
  6          128x96x32
  7          256x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m3.46188[0m     [32m0.70981[0m    4.87720      0.52941  18.64s
      2     [36m0.50819[0m     0.75815    0.67030      0.65556  18.58s
      3     [36m0.49782[0m     0.75964    0.65533      0.61569  18.92s
      4     [36m0.49558[0m     0.75225    0.65880      0.63268  18.95s
      5     [36m0.49162[0m     0.72595    0.67720      0.65359  18.67s
      6     [36m0.48752[0m     [32m0.70744[0m    0.68913      0.68366  18.87s
      7     [36m0.48433[0m     0.71753    0.67499      0.65686  18.91s
      8     [36m0.48099[0m     0.72508    0.66337      0.65294  19.57s
      9     [36m0.47459[0m     [32m0.70405[0m    0.67408      0.68627  31.06s
     10     0.47634     0.70492    0.67574      0.63464  30.94s
     11     0.47582     [32m0.67866[0m    0.70113      0.68301  30.67s
     12     [36m0.46853[0m     [32m0.67840[0m    0.69065      0.65752  30.99s
     13     [36m0.46762[0m     [32m0.67591[0m    0.69184      0.68366  30.87s
     14     [36m0.46412[0m     0.67985    0.68269      0.65425  30.98s
     15     [36m0.46275[0m     [32m0.65294[0m    0.70873      0.63268  31.20s
     16     0.46290     0.66970    0.69120      0.64379  31.05s
     17     [36m0.44918[0m     0.66532    0.67513      0.62810  29.58s
     18     0.45749     0.69339    0.65979      0.60196  19.75s
     19     0.45194     0.71211    0.63466      0.59542  19.64s
     20     [36m0.44808[0m     0.75819    0.59099      0.60000  19.61s
     21     [36m0.43749[0m     0.67204    0.65098      0.62092  19.58s
     22     [36m0.42766[0m     [32m0.64994[0m    0.65799      0.65294  19.36s
     23     0.43520     [32m0.64298[0m    0.67685      0.69216  19.52s
     24     [36m0.41355[0m     0.72677    0.56903      0.62810  19.18s
     25     0.41777     0.64763    0.64506      0.65948  19.07s
     26     [36m0.39893[0m     0.68206    0.58489      0.64837  19.10s
     27     0.41324     0.65357    0.63228      0.68301  25.40s
     28     [36m0.39076[0m     0.65291    0.59849      0.68758  26.15s
     29     [36m0.37675[0m     0.75749    0.49736      0.68431  23.15s
     30     0.38060     0.68836    0.55291      0.68431  19.27s
     31     [36m0.36922[0m     0.68344    0.54024      0.66928  19.33s
     32     0.39893     0.83534    0.47756      0.70327  19.32s
     33     [36m0.35715[0m     0.76180    0.46883      0.64510  19.41s
Early stopping.
Best valid loss was 0.642985 at epoch 23.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d4' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d4' (shape 128).
Loaded parameters to layer 'conv2d5' (shape 128x128x3x3).
Loaded parameters to layer 'conv2d5' (shape 128).
Loaded parameters to layer 'conv2d7' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d7' (shape 256).
Loaded parameters to layer 'conv2d8' (shape 2x256x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
probabilities.shape (1140, 2)
Showing last 30 test samples..
Predictions:
[0 1 0 1 1 1 1 1 1 1 0 1 0 1 1 1 1 1 1 1 0 1 0 1 1 0 1 0 1 1]
Ground Truth:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Performance on relevant data
Accuracy validation:  0.69298245614
Error rate (%):  30.701754386
[[393 177]
 [173 397]]
roc_auc: 0.756555863343
log_loss: 0.618091736412
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[ 0.96951425  0.03048621]
[ 0.1740151   0.82598495]
[ 0.97507173  0.02492966]
[ 0.42181307  0.57818681]
[ 0.06534024  0.93466091]
roc_auc for the hours: 0.805263157895
log_loss for the hours: 0.503850657915
saving predictions to csv file
hourspatient2_4_net12_10-04-18-23-36.csv
Accuracy validation for the hours:  0.883720930233
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [4]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.03819264
saving predictions to csv file
patient2_4_net12_10-04-18-27-38.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config4.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_5']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config4.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_5'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-04 18:27:39.103375
Hostname: kat
gpu2
Configuration 'config4.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net12
evaluation:
    online_training: False
    model: net12

end Configuration
['patient2_5']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [5]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.745537536
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 185.196789551 197.613002014
20 294.801989746 307.815057373
30 407.290542603 420.04319458
40 542.552478027 552.726599121
50 726.239715576 729.61151123
60 1003.9644165 990.04107666
70 1455.43812256 1400.85588379
80 2251.58901367 2106.12675781
90 4066.22578125 3684.91796875
100 67580.4921875 68869.3984375
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net12
Model name for the evaluation phase:  net12
Training model...
# Neural Network with 540034 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          64x192x64
  3          64x192x64
  4          128x96x32
  5          128x96x32
  6          128x96x32
  7          256x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m9.46136[0m     [32m0.79095[0m   11.96208      0.62941  19.19s
      2     [36m0.55417[0m     [32m0.74971[0m    0.73918      0.60915  19.12s
      3     [36m0.54303[0m     [32m0.74833[0m    0.72566      0.59281  19.00s
      4     [36m0.54027[0m     0.75182    0.71861      0.60980  19.16s
      5     [36m0.53478[0m     [32m0.73896[0m    0.72369      0.60065  19.02s
      6     [36m0.52241[0m     0.77062    0.67790      0.64118  19.23s
      7     0.52404     0.79250    0.66125      0.63137  22.39s
      8     [36m0.52194[0m     0.81273    0.64221      0.58039  25.71s
      9     [36m0.51104[0m     0.83543    0.61171      0.56340  25.90s
     10     0.51108     0.81465    0.62737      0.58039  18.62s
     11     [36m0.50304[0m     0.77195    0.65165      0.59085  18.54s
     12     0.50419     0.76123    0.66233      0.60850  18.78s
     13     [36m0.48548[0m     0.80135    0.60583      0.59346  18.94s
     14     0.49604     0.76465    0.64872      0.58562  18.86s
     15     [36m0.47357[0m     0.74773    0.63335      0.57190  18.90s
     16     0.47916     [32m0.70667[0m    0.67805      0.62026  18.87s
     17     [36m0.46245[0m     0.71925    0.64296      0.59346  18.79s
     18     0.48642     [32m0.69941[0m    0.69547      0.60654  18.91s
     19     [36m0.45780[0m     0.74144    0.61744      0.58954  18.92s
     20     [36m0.45325[0m     0.73326    0.61813      0.59869  18.92s
     21     [36m0.44957[0m     0.75264    0.59732      0.61046  18.66s
     22     [36m0.43955[0m     0.77511    0.56708      0.59739  18.64s
     23     [36m0.43708[0m     0.82378    0.53058      0.60458  18.88s
     24     [36m0.43531[0m     0.84308    0.51633      0.57516  18.94s
     25     0.43888     0.80487    0.54527      0.60458  19.00s
     26     [36m0.42218[0m     0.78264    0.53943      0.62026  18.69s
     27     [36m0.41690[0m     0.95801    0.43517      0.60261  18.75s
     28     0.42906     0.83517    0.51375      0.62614  18.75s
Early stopping.
Best valid loss was 0.699410 at epoch 18.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d4' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d4' (shape 128).
Loaded parameters to layer 'conv2d5' (shape 128x128x3x3).
Loaded parameters to layer 'conv2d5' (shape 128).
Loaded parameters to layer 'conv2d7' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d7' (shape 256).
Loaded parameters to layer 'conv2d8' (shape 2x256x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
probabilities.shape (1140, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 0 0 1 1 1 1 0 1 1 1 1 1 1 1 1 1 0 1 1 1 1 0 1 1 1 1]
Ground Truth:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Performance on relevant data
Accuracy validation:  0.600877192982
Error rate (%):  39.9122807018
[[251 319]
 [136 434]]
roc_auc: 0.641265004617
log_loss: 0.724376842477
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[ 0.75204587  0.2479548 ]
[ 0.08330817  0.91669279]
[ 0.60251188  0.3974885 ]
[ 0.0019934   0.99800712]
[ 0.91619676  0.08380365]
roc_auc for the hours: 0.689473684211
log_loss for the hours: 0.729609766332
saving predictions to csv file
hourspatient2_5_net12_10-04-18-43-10.csv
Accuracy validation for the hours:  0.674418604651
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [5]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.037021184
saving predictions to csv file
patient2_5_net12_10-04-18-47-19.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config4.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_6']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config4.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_6'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-04 18:47:20.287856
Hostname: kat
gpu2
Configuration 'config4.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net12
evaluation:
    online_training: False
    model: net12

end Configuration
['patient2_6']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [6]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.745906176
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 163.101298523 175.881399536
20 258.470428467 274.155731201
30 355.682626343 373.270678711
40 471.085089111 488.984100342
50 626.310150146 642.409729004
60 861.122949219 869.392102051
70 1253.91723633 1241.61234131
80 1956.83286133 1902.809375
90 3422.80100098 3262.08793945
100 47858.3515625 52179.953125
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net12
Model name for the evaluation phase:  net12
Training model...
# Neural Network with 540034 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          64x192x64
  3          64x192x64
  4          128x96x32
  5          128x96x32
  6          128x96x32
  7          256x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m4.42275[0m     [32m0.68817[0m    6.42686      0.71699  18.31s
      2     [36m0.55796[0m     0.72917    0.76520      0.64837  18.39s
      3     [36m0.54888[0m     0.71850    0.76393      0.63203  19.15s
      4     [36m0.54230[0m     0.71523    0.75822      0.66340  19.16s
      5     [36m0.53887[0m     0.70789    0.76123      0.64510  19.15s
      6     [36m0.52065[0m     0.71581    0.72735      0.74314  19.03s
      7     [36m0.51435[0m     0.73642    0.69844      0.69935  19.11s
      8     0.51486     0.70894    0.72624      0.66209  18.96s
      9     [36m0.50205[0m     0.72115    0.69618      0.66078  18.91s
     10     0.51165     0.72636    0.70440      0.72026  18.74s
     11     0.50277     0.75090    0.66956      0.71569  19.12s
Early stopping.
Best valid loss was 0.688166 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d4' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d4' (shape 128).
Loaded parameters to layer 'conv2d5' (shape 128x128x3x3).
Loaded parameters to layer 'conv2d5' (shape 128).
Loaded parameters to layer 'conv2d7' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d7' (shape 256).
Loaded parameters to layer 'conv2d8' (shape 2x256x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
probabilities.shape (1140, 2)
Showing last 30 test samples..
Predictions:
[0 1 1 1 1 0 0 1 1 1 0 1 1 1 1 0 1 1 0 1 0 1 1 1 1 0 0 1 1 0]
Ground Truth:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Performance on relevant data
Accuracy validation:  0.719298245614
Error rate (%):  28.0701754386
[[394 176]
 [144 426]]
roc_auc: 0.706820560172
log_loss: 0.692055310995
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[  9.99961793e-01   3.99353048e-05]
[ 0.30368081  0.69631988]
[ 0.08365043  0.91635066]
[ 0.25929463  0.74070591]
[ 0.13072424  0.86927646]
roc_auc for the hours: 0.731578947368
log_loss for the hours: 0.987339729539
saving predictions to csv file
hourspatient2_6_net12_10-04-18-55-06.csv
Accuracy validation for the hours:  0.790697674419
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [6]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.035259904
saving predictions to csv file
patient2_6_net12_10-04-18-59-16.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config4.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_7']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config4.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_7'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-04 18:59:17.737428
Hostname: kat
gpu2
Configuration 'config4.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net12
evaluation:
    online_training: False
    model: net12

end Configuration
['patient2_7']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [7]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.746307584
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 177.49072113 198.887155151
20 286.226177979 314.740679932
30 400.515246582 436.170880127
40 540.098596191 582.037194824
50 725.995513916 773.688720703
60 988.882971191 1040.23283691
70 1379.6152832 1428.96156006
80 1995.99584961 2035.20236816
90 3121.08054199 3130.02658691
100 70629.9609375 92128.8515625
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net12
Model name for the evaluation phase:  net12
Training model...
# Neural Network with 540034 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          64x192x64
  3          64x192x64
  4          128x96x32
  5          128x96x32
  6          128x96x32
  7          256x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m4.81517[0m     [32m0.69480[0m    6.93035      0.62680  18.66s
      2     [36m0.57677[0m     0.79632    0.72429      0.57778  18.69s
      3     [36m0.53200[0m     0.79890    0.66591      0.59673  19.05s
      4     [36m0.51567[0m     0.79021    0.65258      0.67712  19.45s
      5     [36m0.50357[0m     0.84168    0.59829      0.69804  19.36s
      6     [36m0.48602[0m     0.91253    0.53260      0.70065  19.24s
      7     [36m0.48061[0m     0.98015    0.49035      0.67386  18.87s
      8     [36m0.47759[0m     1.01589    0.47012      0.68366  18.78s
      9     [36m0.46834[0m     0.92484    0.50640      0.65752  18.74s
     10     0.47516     1.02255    0.46468      0.67386  18.90s
     11     0.49233     0.98248    0.50111      0.66601  19.20s
Early stopping.
Best valid loss was 0.694795 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d4' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d4' (shape 128).
Loaded parameters to layer 'conv2d5' (shape 128x128x3x3).
Loaded parameters to layer 'conv2d5' (shape 128).
Loaded parameters to layer 'conv2d7' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d7' (shape 256).
Loaded parameters to layer 'conv2d8' (shape 2x256x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
probabilities.shape (1140, 2)
Showing last 30 test samples..
Predictions:
[0 0 1 1 1 0 0 1 1 1 0 0 1 1 1 0 0 1 1 1 0 0 1 1 1 0 0 1 1 1]
Ground Truth:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Performance on relevant data
Accuracy validation:  0.630701754386
Error rate (%):  36.9298245614
[[397 173]
 [248 322]]
roc_auc: 0.645561711296
log_loss: 0.697272075912
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[  9.99981940e-01   2.29647521e-05]
[ 0.94417059  0.05582914]
[ 0.00377131  0.99622959]
[ 0.24533509  0.75466514]
[ 0.02573598  0.97426468]
roc_auc for the hours: 0.647368421053
log_loss for the hours: 1.4165092626
saving predictions to csv file
hourspatient2_7_net12_10-04-19-06-59.csv
Accuracy validation for the hours:  0.674418604651
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [7]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.035505664
saving predictions to csv file
patient2_7_net12_10-04-19-10-49.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config4.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_8']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config4.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_8'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-04 19:10:51.043022
Hostname: kat
gpu2
Configuration 'config4.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net12
evaluation:
    online_training: False
    model: net12

end Configuration
['patient2_8']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [8]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.745160704
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 304.582891846 331.561761475
20 484.435198975 519.064501953
30 665.606323242 707.089782715
40 874.991894531 920.50123291
50 1137.25024414 1183.24688721
60 1487.04992676 1528.72434082
70 1983.92612305 2011.19562988
80 2754.95263672 2754.76303711
90 4202.81694336 4159.4034668
100 105201.65625 53464.578125
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net12
Model name for the evaluation phase:  net12
Training model...
# Neural Network with 540034 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          64x192x64
  3          64x192x64
  4          128x96x32
  5          128x96x32
  6          128x96x32
  7          256x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m6.05956[0m     [32m0.76990[0m    7.87053      0.66797  18.25s
      2     [36m0.53339[0m     0.79836    0.66811      0.63595  18.20s
      3     [36m0.49400[0m     0.91200    0.54167      0.64837  19.00s
      4     [36m0.48547[0m     0.94188    0.51543      0.64118  19.08s
      5     [36m0.47484[0m     1.05944    0.44820      0.63137  19.13s
      6     [36m0.46018[0m     1.15580    0.39815      0.62680  18.94s
      7     [36m0.45432[0m     1.31552    0.34536      0.60065  18.92s
      8     [36m0.44948[0m     1.30097    0.34550      0.60523  19.04s
      9     0.45037     1.33153    0.33824      0.60850  19.10s
     10     0.45119     1.40520    0.32108      0.59216  19.24s
     11     [36m0.44611[0m     1.35135    0.33012      0.63399  18.85s
Early stopping.
Best valid loss was 0.769905 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d4' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d4' (shape 128).
Loaded parameters to layer 'conv2d5' (shape 128x128x3x3).
Loaded parameters to layer 'conv2d5' (shape 128).
Loaded parameters to layer 'conv2d7' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d7' (shape 256).
Loaded parameters to layer 'conv2d8' (shape 2x256x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
probabilities.shape (1140, 2)
Showing last 30 test samples..
Predictions:
[0 1 0 1 1 0 1 0 1 1 0 0 0 1 1 0 1 0 1 1 0 1 1 1 1 0 1 1 1 1]
Ground Truth:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Performance on relevant data
Accuracy validation:  0.651754385965
Error rate (%):  34.8245614035
[[384 186]
 [211 359]]
roc_auc: 0.616020313943
log_loss: 0.778520320533
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[ 0.99782395  0.00217886]
[ 0.21313158  0.78686857]
[ 0.81775624  0.18224327]
[  1.56058011e-08   1.00000000e+00]
[ 0.04582255  0.95417762]
roc_auc for the hours: 0.668421052632
log_loss for the hours: nan
saving predictions to csv file
hourspatient2_8_net12_10-04-19-17-31.csv
Accuracy validation for the hours:  0.697674418605
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [8]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.038667776
saving predictions to csv file
patient2_8_net12_10-04-19-21-32.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config4.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_9']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config4.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_9'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-04 19:21:33.968438
Hostname: kat
gpu2
Configuration 'config4.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net12
evaluation:
    online_training: False
    model: net12

end Configuration
['patient2_9']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [9]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.745783296
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 283.37227478 306.047775269
20 448.091705322 476.795318604
30 612.117547607 646.27376709
40 800.063977051 838.327783203
50 1035.82800293 1076.41149902
60 1355.32043457 1393.14555664
70 1821.88786621 1848.28326416
80 2583.80039063 2579.61362305
90 4184.19125977 4103.89086914
100 81443.234375 46753.0546875
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net12
Model name for the evaluation phase:  net12
Training model...
# Neural Network with 540034 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          64x192x64
  3          64x192x64
  4          128x96x32
  5          128x96x32
  6          128x96x32
  7          256x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m5.15523[0m     [32m0.71108[0m    7.24984      0.53007  18.33s
      2     [36m0.56497[0m     0.74377    0.75960      0.48562  18.23s
      3     [36m0.54913[0m     0.75279    0.72946      0.48497  18.78s
      4     [36m0.53583[0m     0.77647    0.69008      0.51046  19.33s
      5     [36m0.52722[0m     0.77014    0.68457      0.50784  19.22s
      6     [36m0.51154[0m     0.83895    0.60974      0.55490  18.96s
      7     [36m0.50342[0m     0.87306    0.57661      0.56471  18.92s
      8     [36m0.49399[0m     0.95778    0.51577      0.62418  18.93s
      9     [36m0.49111[0m     0.92615    0.53027      0.61830  18.82s
     10     [36m0.48782[0m     0.96175    0.50722      0.60719  18.90s
     11     [36m0.48600[0m     1.07693    0.45128      0.63987  18.72s
Early stopping.
Best valid loss was 0.711081 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d4' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d4' (shape 128).
Loaded parameters to layer 'conv2d5' (shape 128x128x3x3).
Loaded parameters to layer 'conv2d5' (shape 128).
Loaded parameters to layer 'conv2d7' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d7' (shape 256).
Loaded parameters to layer 'conv2d8' (shape 2x256x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
xVal.shape (1140, 2)
probabilities.shape (1140, 2)
Showing last 30 test samples..
Predictions:
[0 1 0 1 0 0 1 0 1 0 0 1 0 1 0 0 1 0 1 0 0 1 0 1 0 0 1 0 1 1]
Ground Truth:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Performance on relevant data
Accuracy validation:  0.534210526316
Error rate (%):  46.5789473684
[[330 240]
 [291 279]]
roc_auc: 0.59864881502
log_loss: 0.71666935436
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
roc_auc for the hours: 0.594736842105
log_loss for the hours: 0.99594530436
saving predictions to csv file
hourspatient2_9_net12_10-04-19-28-14.csv
Accuracy validation for the hours:  0.604651162791
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [9]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.035046912
saving predictions to csv file
patient2_9_net12_10-04-19-32-06.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config4.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_10']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config4.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_10'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-04 19:32:07.388758
Hostname: kat
gpu2
Configuration 'config4.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net12
evaluation:
    online_training: False
    model: net12

end Configuration
['patient2_10']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [10]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.746074112
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 235.353125 259.209658813
20 373.425970459 404.270147705
30 511.624740601 548.895672607
40 670.266955566 710.672009277
50 867.946899414 908.465515137
60 1130.38996582 1165.67106934
70 1502.52767334 1525.50710449
80 2081.78022461 2081.2378418
90 3192.88137207 3135.13125
100 33467.8828125 31567.0722656
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net12
Model name for the evaluation phase:  net12
Training model...
# Neural Network with 540034 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          64x192x64
  3          64x192x64
  4          128x96x32
  5          128x96x32
  6          128x96x32
  7          256x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m5.00724[0m     [32m0.74539[0m    6.71765      0.49608  18.36s
      2     [36m0.54961[0m     0.77633    0.70796      0.63464  18.31s
      3     [36m0.53016[0m     0.78599    0.67451      0.60850  18.56s
      4     [36m0.52502[0m     0.80475    0.65240      0.60915  19.46s
      5     [36m0.52487[0m     0.79868    0.65717      0.61895  19.42s
      6     [36m0.51858[0m     0.80826    0.64160      0.63856  19.37s
      7     [36m0.51445[0m     0.85037    0.60497      0.64248  19.25s
      8     0.51555     0.82536    0.62463      0.63072  19.15s
      9     [36m0.51207[0m     0.82509    0.62062      0.62614  19.10s
     10     [36m0.50777[0m     0.85323    0.59511      0.63203  19.07s
     11     0.50941     0.85056    0.59891      0.63856  19.37s
Early stopping.
Best valid loss was 0.745386 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d4' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d4' (shape 128).
Loaded parameters to layer 'conv2d5' (shape 128x128x3x3).
Loaded parameters to layer 'conv2d5' (shape 128).
Loaded parameters to layer 'conv2d7' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d7' (shape 256).
Loaded parameters to layer 'conv2d8' (shape 2x256x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
xVal.shape (1140, 2)
probabilities.shape (1140, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 0 1 1 1 1 0 1 1 1 1 0 1 1 1 1 0 1 1 1 1 0 1 1 1 1]
Ground Truth:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Performance on relevant data
Accuracy validation:  0.518421052632
Error rate (%):  48.1578947368
[[103 467]
 [ 82 488]]
roc_auc: 0.636512773161
log_loss: 0.750960869604
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
roc_auc for the hours: 0.684210526316
log_loss for the hours: 3.78618997343
saving predictions to csv file
hourspatient2_10_net12_10-04-19-39-11.csv
Accuracy validation for the hours:  0.232558139535
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [10]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.03530496
saving predictions to csv file
patient2_10_net12_10-04-19-42-59.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config4.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_11']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config4.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_11'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-04 19:43:00.363892
Hostname: kat
gpu2
Configuration 'config4.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net12
evaluation:
    online_training: False
    model: net12

end Configuration
['patient2_11']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [11]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.745979904
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 185.314794922 208.111297607
20 299.770111084 330.638024902
30 420.835580444 458.932080078
40 567.582995605 611.673339844
50 760.888244629 809.9090271
60 1030.30930176 1080.86318359
70 1423.52952881 1473.30863037
80 2039.71828613 2086.87138672
90 3209.50048828 3264.72282715
100 47304.0664062 104914.585938
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net12
Model name for the evaluation phase:  net12
Training model...
# Neural Network with 540034 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          64x192x64
  3          64x192x64
  4          128x96x32
  5          128x96x32
  6          128x96x32
  7          256x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m5.29756[0m     [32m0.72268[0m    7.33039      0.59935  18.35s
      2     [36m0.53773[0m     [32m0.67431[0m    0.79745      0.63856  18.64s
      3     [36m0.51407[0m     0.69665    0.73791      0.69150  18.40s
      4     [36m0.50427[0m     0.73762    0.68365      0.70980  19.15s
      5     [36m0.50416[0m     0.76330    0.66050      0.73464  19.40s
      6     [36m0.49332[0m     0.80117    0.61575      0.75359  19.36s
      7     [36m0.48458[0m     0.89567    0.54102      0.75033  19.47s
      8     [36m0.47369[0m     0.95214    0.49750      0.73987  19.24s
      9     [36m0.46846[0m     0.95909    0.48844      0.73660  19.43s
     10     [36m0.46191[0m     1.11520    0.41420      0.65621  19.35s
     11     [36m0.45311[0m     1.29436    0.35007      0.64837  19.12s
     12     [36m0.44795[0m     1.24341    0.36026      0.64641  19.33s
Early stopping.
Best valid loss was 0.674310 at epoch 2.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d4' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d4' (shape 128).
Loaded parameters to layer 'conv2d5' (shape 128x128x3x3).
Loaded parameters to layer 'conv2d5' (shape 128).
Loaded parameters to layer 'conv2d7' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d7' (shape 256).
Loaded parameters to layer 'conv2d8' (shape 2x256x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
xVal.shape (1140, 2)
probabilities.shape (1140, 2)
Showing last 30 test samples..
Predictions:
[0 1 1 1 1 0 1 1 1 1 0 1 1 1 1 0 1 1 1 1 0 1 1 1 1 0 1 1 1 1]
Ground Truth:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Performance on relevant data
Accuracy validation:  0.631578947368
Error rate (%):  36.8421052632
[[264 306]
 [114 456]]
roc_auc: 0.744072022161
log_loss: 0.671761771196
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
roc_auc for the hours: 0.778947368421
log_loss for the hours: inf
saving predictions to csv file
hourspatient2_11_net12_10-04-19-51-08.csv
Accuracy validation for the hours:  0.511627906977
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [11]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.042386944
saving predictions to csv file
patient2_11_net12_10-04-19-55-11.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config4.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_12']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config4.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_12'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-04 19:55:12.867276
Hostname: kat
gpu2
Configuration 'config4.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net12
evaluation:
    online_training: False
    model: net12

end Configuration
['patient2_12']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [12]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.74612736
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 246.400856018 260.383670044
20 388.318774414 405.029217529
30 528.878991699 548.355413818
40 689.669812012 711.362548828
50 892.074920654 915.121887207
60 1170.23933105 1190.96369629
70 1584.49351807 1593.89857178
80 2252.05878906 2238.45820313
90 3510.49829102 3446.85510254
100 68512.453125 43195.7773438
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net12
Model name for the evaluation phase:  net12
Training model...
# Neural Network with 540034 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          64x192x64
  3          64x192x64
  4          128x96x32
  5          128x96x32
  6          128x96x32
  7          256x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m4.71119[0m     [32m0.73107[0m    6.44427      0.57974  18.27s
      2     [36m0.56205[0m     0.74506    0.75437      0.59739  18.31s
      3     [36m0.54483[0m     0.76582    0.71143      0.66536  18.70s
      4     [36m0.53059[0m     0.79946    0.66369      0.68693  19.15s
      5     [36m0.51888[0m     0.85095    0.60976      0.68627  19.20s
      6     [36m0.51131[0m     0.88446    0.57810      0.69739  19.35s
      7     [36m0.49693[0m     1.04134    0.47720      0.68170  19.40s
      8     0.50913     0.86008    0.59196      0.68627  19.26s
      9     [36m0.48563[0m     1.06284    0.45692      0.67516  18.99s
     10     0.49164     0.99307    0.49507      0.68562  19.05s
     11     [36m0.48202[0m     1.03012    0.46793      0.68954  18.83s
Early stopping.
Best valid loss was 0.731066 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d4' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d4' (shape 128).
Loaded parameters to layer 'conv2d5' (shape 128x128x3x3).
Loaded parameters to layer 'conv2d5' (shape 128).
Loaded parameters to layer 'conv2d7' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d7' (shape 256).
Loaded parameters to layer 'conv2d8' (shape 2x256x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
xVal.shape (1140, 2)
probabilities.shape (1140, 2)
Showing last 30 test samples..
Predictions:
[0 1 1 1 1 0 1 1 1 1 0 1 1 1 1 0 1 1 1 1 0 1 1 1 1 0 1 1 1 1]
Ground Truth:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Performance on relevant data
Accuracy validation:  0.590350877193
Error rate (%):  40.9649122807
[[259 311]
 [156 414]]
roc_auc: 0.652354570637
log_loss: 0.733788724714
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
roc_auc for the hours: 0.660526315789
log_loss for the hours: nan
saving predictions to csv file
hourspatient2_12_net12_10-04-20-02-47.csv
Accuracy validation for the hours:  0.558139534884
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [12]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.04009728
saving predictions to csv file
patient2_12_net12_10-04-20-06-42.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config4.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_13']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config4.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_13'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-04 20:06:44.007438
Hostname: kat
gpu2
Configuration 'config4.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net12
evaluation:
    online_training: False
    model: net12

end Configuration
['patient2_13']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [13]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.746446848
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 310.902963257 337.861572266
20 495.955010986 532.738879395
30 683.185546875 729.780834961
40 898.82401123 954.485388184
50 1167.24829102 1228.47143555
60 1520.5864502 1581.93601074
70 2018.97246094 2072.08920898
80 2789.6487793 2824.08540039
90 4233.0871582 4224.4074707
100 35079.8945312 31263.9492188
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net12
Model name for the evaluation phase:  net12
Training model...
# Neural Network with 540034 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          64x192x64
  3          64x192x64
  4          128x96x32
  5          128x96x32
  6          128x96x32
  7          256x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m5.80093[0m     [32m0.77394[0m    7.49533      0.54641  18.21s
      2     [36m0.52816[0m     0.86303    0.61198      0.58039  18.58s
      3     [36m0.51571[0m     0.91565    0.56322      0.56732  18.73s
      4     [36m0.50573[0m     0.94017    0.53791      0.58627  19.45s
      5     0.50692     0.90976    0.55721      0.58889  19.11s
      6     [36m0.49753[0m     0.95124    0.52303      0.61242  19.28s
      7     [36m0.48776[0m     0.99911    0.48819      0.61503  19.44s
      8     0.48966     0.91741    0.53375      0.62680  19.30s
      9     [36m0.47927[0m     0.99570    0.48133      0.62222  19.26s
     10     0.48431     0.94767    0.51105      0.63856  19.21s
     11     0.48529     1.03411    0.46928      0.64248  19.18s
Early stopping.
Best valid loss was 0.773939 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d4' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d4' (shape 128).
Loaded parameters to layer 'conv2d5' (shape 128x128x3x3).
Loaded parameters to layer 'conv2d5' (shape 128).
Loaded parameters to layer 'conv2d7' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d7' (shape 256).
Loaded parameters to layer 'conv2d8' (shape 2x256x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
xVal.shape (1140, 2)
probabilities.shape (1140, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 0 1 1 1 1 0 1 1 1 1 0 1 1 1 1]
Ground Truth:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Performance on relevant data
Accuracy validation:  0.580701754386
Error rate (%):  41.9298245614
[[171 399]
 [ 79 491]]
roc_auc: 0.559113573407
log_loss: 0.768361050204
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
roc_auc for the hours: 0.547368421053
log_loss for the hours: 3.32105185376
saving predictions to csv file
hourspatient2_13_net12_10-04-20-13-26.csv
Accuracy validation for the hours:  0.302325581395
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [13]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.035722752
saving predictions to csv file
patient2_13_net12_10-04-20-17-13.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config4.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_14']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config4.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_14'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-04 20:17:14.448299
Hostname: kat
gpu2
Configuration 'config4.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net12
evaluation:
    online_training: False
    model: net12

end Configuration
['patient2_14']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [14]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.745537536
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 266.172717285 282.912625122
20 417.956640625 438.4277771
30 566.452648926 591.266082764
40 733.547790527 761.89486084
50 939.345672607 969.588409424
60 1211.49157715 1239.79914551
70 1602.63823242 1619.38890381
80 2236.86499023 2222.94345703
90 3516.40424805 3422.74516602
100 38412.0351562 39300.5585938
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net12
Model name for the evaluation phase:  net12
Training model...
# Neural Network with 540034 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          64x192x64
  3          64x192x64
  4          128x96x32
  5          128x96x32
  6          128x96x32
  7          256x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m4.71834[0m     [32m0.81160[0m    5.81363      0.46209  18.26s
      2     [36m0.54007[0m     1.00930    0.53510      0.48170  18.40s
      3     [36m0.53391[0m     1.03992    0.51341      0.46340  18.62s
      4     [36m0.52966[0m     1.06122    0.49911      0.47190  19.12s
      5     0.53020     1.10071    0.48169      0.49935  19.42s
      6     [36m0.50904[0m     1.13970    0.44664      0.49804  19.50s
      7     0.50935     1.18206    0.43090      0.48889  19.18s
      8     0.51399     1.13979    0.45095      0.48170  19.46s
      9     [36m0.50643[0m     1.14660    0.44168      0.48758  19.36s
     10     0.50912     1.14850    0.44329      0.48235  19.37s
     11     [36m0.50286[0m     1.18007    0.42612      0.47255  19.16s
Early stopping.
Best valid loss was 0.811600 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d4' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d4' (shape 128).
Loaded parameters to layer 'conv2d5' (shape 128x128x3x3).
Loaded parameters to layer 'conv2d5' (shape 128).
Loaded parameters to layer 'conv2d7' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d7' (shape 256).
Loaded parameters to layer 'conv2d8' (shape 2x256x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
xVal.shape (1140, 2)
probabilities.shape (1140, 2)
Showing last 30 test samples..
Predictions:
[0 1 1 1 1 0 1 1 1 1 0 1 1 1 0 0 1 1 1 1 0 1 1 1 1 0 1 1 1 1]
Ground Truth:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Performance on relevant data
Accuracy validation:  0.460526315789
Error rate (%):  53.9473684211
[[ 88 482]
 [133 437]]
roc_auc: 0.484847645429
log_loss: 0.81491125041
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
roc_auc for the hours: 0.510526315789
log_loss for the hours: 3.13461116113
saving predictions to csv file
hourspatient2_14_net12_10-04-20-25-26.csv
Accuracy validation for the hours:  0.162790697674
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [14]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.037021184
saving predictions to csv file
patient2_14_net12_10-04-20-29-26.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config4.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_15']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config4.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_15'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-10-04 20:29:27.790992
Hostname: kat
gpu2
Configuration 'config4.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net12
evaluation:
    online_training: False
    model: net12

end Configuration
['patient2_15']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [15]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.745971712
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 207.538546753 227.35309906
20 331.033721924 357.463000488
30 457.867379761 491.204870605
40 608.373034668 648.207519531
50 801.816497803 847.310424805
60 1065.05288086 1112.36008301
70 1442.92700195 1484.37923584
80 2028.23110352 2052.16914063
90 3108.79804688 3089.25849609
100 28167.1855469 26524.03125
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net12
Model name for the evaluation phase:  net12
Training model...
# Neural Network with 540034 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          64x192x64
  3          64x192x64
  4          128x96x32
  5          128x96x32
  6          128x96x32
  7          256x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m4.20837[0m     [32m0.71095[0m    5.91937      0.51569  18.14s
      2     [36m0.54044[0m     0.73654    0.73376      0.57190  17.80s
      3     [36m0.53002[0m     0.72477    0.73130      0.60000  18.25s
      4     [36m0.52331[0m     0.72866    0.71817      0.61046  18.98s
      5     [36m0.51624[0m     [32m0.70434[0m    0.73294      0.68693  18.77s
      6     [36m0.50621[0m     0.71936    0.70369      0.70915  18.75s
      7     [36m0.49811[0m     0.78360    0.63567      0.70523  18.88s
      8     [36m0.49487[0m     0.77684    0.63703      0.71046  18.92s
      9     [36m0.49159[0m     0.78402    0.62700      0.71699  19.10s
     10     [36m0.48904[0m     0.79319    0.61655      0.71373  19.30s
     11     0.49101     0.80255    0.61181      0.71895  19.16s
     12     [36m0.48452[0m     0.82228    0.58923      0.71830  19.27s
     13     [36m0.47861[0m     0.83940    0.57018      0.71830  19.09s
     14     [36m0.47664[0m     0.84208    0.56603      0.71046  19.43s
     15     0.47670     0.84371    0.56501      0.70327  19.43s
Early stopping.
Best valid loss was 0.704342 at epoch 5.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d4' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d4' (shape 128).
Loaded parameters to layer 'conv2d5' (shape 128x128x3x3).
Loaded parameters to layer 'conv2d5' (shape 128).
Loaded parameters to layer 'conv2d7' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d7' (shape 256).
Loaded parameters to layer 'conv2d8' (shape 2x256x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
xVal.shape (1140, 2)
probabilities.shape (1140, 2)
Showing last 30 test samples..
Predictions:
[0 1 0 1 1 0 1 0 1 1 0 1 0 1 1 0 1 0 1 1 0 1 1 1 1 0 1 0 1 1]
Ground Truth:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Performance on relevant data
Accuracy validation:  0.664912280702
Error rate (%):  33.5087719298
[[378 192]
 [190 380]]
roc_auc: 0.697737765466
log_loss: 0.741094499012
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
roc_auc for the hours: 0.747368421053
log_loss for the hours: 0.913222762982
saving predictions to csv file
hourspatient2_15_net12_10-04-20-37-28.csv
Accuracy validation for the hours:  0.720930232558
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [15]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.039986688
saving predictions to csv file
patient2_15_net12_10-04-20-41-15.csv
