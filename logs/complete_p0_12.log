['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config4.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_0']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config4.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_0'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-04 16:54:06.951856
Hostname: kat
gpu0
Configuration 'config4.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net12
evaluation:
    online_training: False
    model: net12

end Configuration
['patient0_0']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [0]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.745476096
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 77.4825836182 42.2078788757
20 305.512463379 300.472479248
30 461.135577393 459.25463562
40 614.021606445 614.238354492
50 784.364746094 787.311828613
60 993.193286133 998.551342773
70 1272.31512451 1279.6506958
80 1694.84467773 1704.01054688
90 2529.98266602 2551.26169434
100 45472.875 51963.8164062
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net12
Model name for the evaluation phase:  net12
Training model...
# Neural Network with 540034 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          64x192x64
  3          64x192x64
  4          128x96x32
  5          128x96x32
  6          128x96x32
  7          256x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m4.30530[0m     [32m0.67245[0m    6.40238      0.59346  18.27s
      2     [36m0.64020[0m     0.77252    0.82871      0.46993  18.41s
      3     [36m0.61394[0m     0.76182    0.80588      0.47516  18.47s
      4     0.61658     0.74526    0.82734      0.48301  18.30s
      5     [36m0.60629[0m     0.78308    0.77424      0.47712  22.35s
      6     [36m0.60405[0m     0.80509    0.75029      0.47255  29.19s
      7     [36m0.60263[0m     0.80053    0.75279      0.47320  29.58s
      8     [36m0.59829[0m     0.87325    0.68513      0.46144  30.09s
      9     [36m0.59687[0m     0.86178    0.69260      0.46732  30.05s
     10     [36m0.59002[0m     0.89164    0.66172      0.46601  30.08s
     11     0.59104     0.90009    0.65665      0.46732  30.14s
Early stopping.
Best valid loss was 0.672453 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d4' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d4' (shape 128).
Loaded parameters to layer 'conv2d5' (shape 128x128x3x3).
Loaded parameters to layer 'conv2d5' (shape 128).
Loaded parameters to layer 'conv2d7' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d7' (shape 256).
Loaded parameters to layer 'conv2d8' (shape 2x256x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
probabilities.shape (1140, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 0 1 1 1 1 0 1 1 1 1 0 1 1 1 1 0 1 1 1 1 0 1 1 1 1 1]
Ground Truth:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Performance on relevant data
Accuracy validation:  0.588596491228
Error rate (%):  41.1403508772
[[196 374]
 [ 95 475]]
roc_auc: 0.639122807018
log_loss: 0.668886381388
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[ 0.0651884   0.93481094]
[ 0.22171439  0.77828622]
[ 0.10292941  0.89707011]
[ 0.20198648  0.79801351]
[ 0.78357172  0.21642825]
roc_auc for the hours: 0.673684210526
log_loss for the hours: 1.08300918765
saving predictions to csv file
hourspatient0_0_net12_10-04-17-04-37.csv
Accuracy validation for the hours:  0.441860465116
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [0]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 0.944766976
saving predictions to csv file
patient0_0_net12_10-04-17-07-25.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config4.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_1']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config4.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_1'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-04 17:07:26.038356
Hostname: kat
gpu0
Configuration 'config4.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net12
evaluation:
    online_training: False
    model: net12

end Configuration
['patient0_1']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [1]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.746405888
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 79.8583602905 43.7949028015
20 305.763250732 299.520977783
30 453.40585022 450.005862427
40 592.349865723 590.177758789
50 740.968597412 740.054229736
60 918.324951172 917.797363281
70 1161.24418945 1163.53183594
80 1578.52695313 1588.20612793
90 2613.2675293 2653.38178711
100 212492.21875 103666.890625
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net12
Model name for the evaluation phase:  net12
Training model...
# Neural Network with 540034 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          64x192x64
  3          64x192x64
  4          128x96x32
  5          128x96x32
  6          128x96x32
  7          256x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m4.45825[0m     [32m0.69129[0m    6.44918      0.56209  17.89s
      2     [36m0.64583[0m     [32m0.67817[0m    0.95231      0.60131  21.52s
      3     [36m0.62300[0m     0.70813    0.87979      0.54248  28.18s
      4     0.62378     0.67912    0.91850      0.61634  28.48s
      5     [36m0.60345[0m     0.70471    0.85632      0.57451  28.77s
      6     [36m0.60315[0m     0.73630    0.81916      0.51373  29.02s
      7     [36m0.59460[0m     0.74915    0.79370      0.54183  29.36s
      8     [36m0.59111[0m     0.74045    0.79831      0.55490  29.72s
      9     0.59359     0.75219    0.78915      0.50458  29.65s
     10     [36m0.58083[0m     0.83606    0.69472      0.45359  29.73s
     11     0.58799     0.82814    0.71001      0.44118  28.93s
     12     0.59513     0.74565    0.79814      0.52353  28.15s
Early stopping.
Best valid loss was 0.678170 at epoch 2.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d4' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d4' (shape 128).
Loaded parameters to layer 'conv2d5' (shape 128x128x3x3).
Loaded parameters to layer 'conv2d5' (shape 128).
Loaded parameters to layer 'conv2d7' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d7' (shape 256).
Loaded parameters to layer 'conv2d8' (shape 2x256x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
probabilities.shape (1140, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 0 0 1 1 1 0 0 1 1 1 0 0 1 1 0 0 1 1 1 1 0]
Ground Truth:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Performance on relevant data
Accuracy validation:  0.611403508772
Error rate (%):  38.8596491228
[[296 274]
 [169 401]]
roc_auc: 0.611662049861
log_loss: 0.674649254808
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[ 0.43846676  0.56153363]
[ 0.37680429  0.62319547]
[ 0.23328446  0.76671511]
[ 0.40555149  0.59444934]
[ 0.94339883  0.05660177]
roc_auc for the hours: 0.657894736842
log_loss for the hours: 0.743580707536
saving predictions to csv file
hourspatient0_1_net12_10-04-17-21-17.csv
Accuracy validation for the hours:  0.651162790698
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [1]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 0.943427584
saving predictions to csv file
patient0_1_net12_10-04-17-24-01.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config4.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_2']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config4.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_2'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-04 17:24:02.723803
Hostname: kat
gpu0
Configuration 'config4.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net12
evaluation:
    online_training: False
    model: net12

end Configuration
['patient0_2']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [2]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.745992192
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 72.0125099182 40.3037857056
20 276.55925293 272.411431885
30 416.599380493 415.294677734
40 555.997583008 556.773425293
50 715.97946167 718.930877686
60 923.099047852 927.542578125
70 1228.42805176 1233.38067627
80 1756.11213379 1761.63308105
90 3001.92504883 3026.81286621
100 72650.4921875 53126.640625
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net12
Model name for the evaluation phase:  net12
Training model...
# Neural Network with 540034 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          64x192x64
  3          64x192x64
  4          128x96x32
  5          128x96x32
  6          128x96x32
  7          256x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m7.59039[0m     [32m0.71238[0m   10.65502      0.59477  29.10s
      2     [36m0.64795[0m     0.72902    0.88880      0.57843  29.02s
      3     [36m0.61744[0m     0.82584    0.74765      0.48366  29.20s
      4     [36m0.61054[0m     0.84624    0.72148      0.55229  29.44s
      5     [36m0.58882[0m     0.91335    0.64468      0.57059  29.62s
      6     [36m0.58512[0m     0.93328    0.62695      0.56928  29.85s
      7     [36m0.58088[0m     1.02648    0.56590      0.46471  29.74s
      8     [36m0.57765[0m     1.02784    0.56200      0.57255  30.14s
      9     [36m0.57273[0m     1.06241    0.53909      0.49150  30.06s
     10     [36m0.56202[0m     1.08265    0.51911      0.47516  30.48s
     11     0.56749     1.08445    0.52330      0.50065  29.98s
Early stopping.
Best valid loss was 0.712377 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d4' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d4' (shape 128).
Loaded parameters to layer 'conv2d5' (shape 128x128x3x3).
Loaded parameters to layer 'conv2d5' (shape 128).
Loaded parameters to layer 'conv2d7' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d7' (shape 256).
Loaded parameters to layer 'conv2d8' (shape 2x256x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
probabilities.shape (1140, 2)
Showing last 30 test samples..
Predictions:
[0 0 1 1 0 0 0 1 1 0 0 0 1 1 0 0 0 1 1 0 0 0 1 1 0 0 0 1 1 0]
Ground Truth:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Performance on relevant data
Accuracy validation:  0.593859649123
Error rate (%):  40.6140350877
[[449 121]
 [342 228]]
roc_auc: 0.669021237304
log_loss: 0.705466560278
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[ 0.85447973  0.14552006]
[ 0.91224051  0.0877597 ]
[ 0.06603667  0.93396288]
[ 0.00727018  0.99273014]
[ 0.99868876  0.00131168]
roc_auc for the hours: 0.652631578947
log_loss for the hours: 0.670520695338
saving predictions to csv file
hourspatient0_2_net12_10-04-17-40-40.csv
Accuracy validation for the hours:  0.813953488372
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [2]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 0.9998336
saving predictions to csv file
patient0_2_net12_10-04-17-43-34.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config4.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_3']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config4.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_3'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-04 17:43:35.790945
Hostname: kat
gpu0
Configuration 'config4.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net12
evaluation:
    online_training: False
    model: net12

end Configuration
['patient0_3']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [3]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.746074112
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 52.0612277985 28.9869352341
20 191.337734985 185.116714478
30 292.577377319 287.197384644
40 400.500439453 396.009564209
50 535.735168457 532.537109375
60 731.05357666 729.604919434
70 1066.69674072 1069.19353027
80 1804.39440918 1808.60009766
90 3908.51987305 3891.41049805
100 124376.210938 175654.078125
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net12
Model name for the evaluation phase:  net12
Training model...
# Neural Network with 540034 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          64x192x64
  3          64x192x64
  4          128x96x32
  5          128x96x32
  6          128x96x32
  7          256x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m8.83958[0m     [32m0.75022[0m   11.78263      0.53399  17.96s
      2     [36m0.66147[0m     [32m0.69178[0m    0.95619      0.62745  17.77s
      3     [36m0.62184[0m     0.71770    0.86644      0.60980  24.92s
      4     0.62584     0.73550    0.85090      0.48301  28.89s
      5     [36m0.61122[0m     0.71982    0.84913      0.50915  28.75s
      6     [36m0.60959[0m     0.74947    0.81336      0.46013  29.06s
      7     [36m0.60723[0m     0.83342    0.72859      0.46013  29.30s
      8     [36m0.60240[0m     0.80494    0.74838      0.46144  29.59s
      9     [36m0.59836[0m     0.84693    0.70650      0.46667  29.69s
     10     [36m0.59148[0m     0.84304    0.70160      0.45817  27.28s
     11     0.59212     0.87656    0.67550      0.46797  27.86s
     12     0.59271     0.77470    0.76508      0.44967  18.60s
Early stopping.
Best valid loss was 0.691779 at epoch 2.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d4' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d4' (shape 128).
Loaded parameters to layer 'conv2d5' (shape 128x128x3x3).
Loaded parameters to layer 'conv2d5' (shape 128).
Loaded parameters to layer 'conv2d7' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d7' (shape 256).
Loaded parameters to layer 'conv2d8' (shape 2x256x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
probabilities.shape (1140, 2)
Showing last 30 test samples..
Predictions:
[0 1 1 1 0 0 0 1 1 0 0 1 1 1 0 0 1 1 1 0 0 1 0 1 0 0 0 1 1 0]
Ground Truth:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Performance on relevant data
Accuracy validation:  0.629824561404
Error rate (%):  37.0175438596
[[426 144]
 [278 292]]
roc_auc: 0.653985841797
log_loss: 0.690370544863
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[ 0.98066384  0.01933577]
[ 0.57034528  0.42965496]
[ 0.40479034  0.59520876]
[ 0.36941695  0.63058299]
[ 0.98260546  0.01739684]
roc_auc for the hours: 0.668421052632
log_loss for the hours: 0.461463089077
saving predictions to csv file
hourspatient0_3_net12_10-04-18-00-34.csv
Accuracy validation for the hours:  0.790697674419
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [3]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.000198144
saving predictions to csv file
patient0_3_net12_10-04-18-03-19.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config4.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_4']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config4.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_4'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-04 18:03:20.941421
Hostname: kat
gpu0
Configuration 'config4.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net12
evaluation:
    online_training: False
    model: net12

end Configuration
['patient0_4']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [4]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.746360832
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 60.27771492 33.2891647339
20 230.724859619 226.139196777
30 348.998257446 345.771307373
40 468.468225098 465.978533936
50 608.787628174 607.555786133
60 801.863439941 803.590454102
70 1127.33896484 1136.01357422
80 1802.12897949 1820.19179688
90 3236.02592773 3251.78005371
100 159526.84375 66619.4296875
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net12
Model name for the evaluation phase:  net12
Training model...
# Neural Network with 540034 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          64x192x64
  3          64x192x64
  4          128x96x32
  5          128x96x32
  6          128x96x32
  7          256x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m7.48126[0m     [32m0.70435[0m   10.62153      0.50000  28.71s
      2     [36m0.68006[0m     [32m0.67358[0m    1.00962      0.49346  28.97s
      3     [36m0.65296[0m     [32m0.67222[0m    0.97136      0.52745  28.94s
      4     [36m0.63547[0m     [32m0.65070[0m    0.97659      0.60850  29.79s
      5     [36m0.60795[0m     0.68069    0.89314      0.59739  30.15s
      6     [36m0.59558[0m     0.74474    0.79972      0.53660  29.92s
      7     [36m0.59038[0m     0.77966    0.75723      0.50131  30.11s
      8     [36m0.58271[0m     0.83944    0.69417      0.48105  29.13s
      9     0.58700     0.87891    0.66788      0.46209  28.06s
     10     [36m0.57085[0m     0.91028    0.62711      0.46928  19.03s
     11     0.57503     1.00826    0.57032      0.46732  18.96s
     12     0.57826     1.00181    0.57721      0.46340  19.00s
     13     [36m0.56622[0m     0.97151    0.58282      0.46471  19.27s
     14     0.57344     0.93656    0.61228      0.51046  18.92s
Early stopping.
Best valid loss was 0.650700 at epoch 4.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d4' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d4' (shape 128).
Loaded parameters to layer 'conv2d5' (shape 128x128x3x3).
Loaded parameters to layer 'conv2d5' (shape 128).
Loaded parameters to layer 'conv2d7' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d7' (shape 256).
Loaded parameters to layer 'conv2d8' (shape 2x256x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
probabilities.shape (1140, 2)
Showing last 30 test samples..
Predictions:
[0 0 1 1 0 0 0 1 1 0 0 1 1 0 0 1 0 0 1 0 1 0 0 1 0 0 0 1 1 0]
Ground Truth:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Performance on relevant data
Accuracy validation:  0.621052631579
Error rate (%):  37.8947368421
[[461 109]
 [323 247]]
roc_auc: 0.725838719606
log_loss: 0.646636250589
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[ 0.87655997  0.12343941]
[ 0.8525852   0.14741519]
[ 0.74169797  0.25830173]
[ 0.64966351  0.35033596]
[ 0.98778635  0.0122164 ]
roc_auc for the hours: 0.742105263158
log_loss for the hours: 0.332669841876
saving predictions to csv file
hourspatient0_4_net12_10-04-18-19-51.csv
Accuracy validation for the hours:  0.883720930233
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [4]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.0005504
saving predictions to csv file
patient0_4_net12_10-04-18-22-32.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config4.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_5']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config4.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_5'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-04 18:22:33.723922
Hostname: kat
gpu0
Configuration 'config4.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net12
evaluation:
    online_training: False
    model: net12

end Configuration
['patient0_5']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [5]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.745807872
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 44.228635788 24.8328939438
20 167.781503296 163.806289673
30 254.511244202 251.485551453
40 343.928485107 341.169134521
50 452.231292725 450.168884277
60 604.746826172 604.360339355
70 863.724084473 868.017297363
80 1408.11137695 1423.19575195
90 2638.64152832 2674.38774414
100 60107.1914062 35895.5507812
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net12
Model name for the evaluation phase:  net12
Training model...
# Neural Network with 540034 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          64x192x64
  3          64x192x64
  4          128x96x32
  5          128x96x32
  6          128x96x32
  7          256x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m3.16040[0m     [32m0.64227[0m    4.92065      0.57974  18.05s
      2     [36m0.62726[0m     0.69313    0.90497      0.52288  18.03s
      3     [36m0.60871[0m     0.70899    0.85856      0.54902  18.06s
      4     0.60899     0.68828    0.88480      0.53856  18.09s
      5     [36m0.59685[0m     0.74694    0.79906      0.52810  18.35s
      6     [36m0.59660[0m     0.72721    0.82039      0.52288  18.34s
      7     [36m0.58705[0m     0.75123    0.78146      0.49216  18.24s
      8     0.58732     0.75078    0.78227      0.48954  18.25s
      9     [36m0.58344[0m     0.78750    0.74087      0.50392  18.60s
     10     [36m0.57635[0m     0.75831    0.76004      0.51046  18.91s
     11     [36m0.57595[0m     0.80519    0.71529      0.46013  18.59s
Early stopping.
Best valid loss was 0.642273 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d4' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d4' (shape 128).
Loaded parameters to layer 'conv2d5' (shape 128x128x3x3).
Loaded parameters to layer 'conv2d5' (shape 128).
Loaded parameters to layer 'conv2d7' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d7' (shape 256).
Loaded parameters to layer 'conv2d8' (shape 2x256x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
probabilities.shape (1140, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 0 0 1 1 1 0 0 1 1 1 0 0 1 1 1 0 0 1 1 1 0 0 1 1 1 0]
Ground Truth:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Performance on relevant data
Accuracy validation:  0.590350877193
Error rate (%):  40.9649122807
[[311 259]
 [208 362]]
roc_auc: 0.657854724531
log_loss: 0.638177768487
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[ 0.82813096  0.17186904]
[ 0.00605412  0.9939453 ]
[ 0.18363661  0.81636328]
[ 0.177544   0.8224563]
[ 0.96014673  0.0398521 ]
roc_auc for the hours: 0.652631578947
log_loss for the hours: 0.883046346869
saving predictions to csv file
hourspatient0_5_net12_10-04-18-35-39.csv
Accuracy validation for the hours:  0.627906976744
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [5]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 0.999755776
saving predictions to csv file
patient0_5_net12_10-04-18-38-16.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config4.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_6']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config4.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_6'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-04 18:38:17.901722
Hostname: kat
gpu0
Configuration 'config4.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net12
evaluation:
    online_training: False
    model: net12

end Configuration
['patient0_6']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [6]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.746323968
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 52.9203617096 28.9710264206
20 204.033294678 198.010336304
30 310.279055786 304.778164673
40 419.120050049 413.251306152
50 547.291717529 541.047363281
60 717.765319824 711.321618652
70 980.086315918 974.004034424
80 1476.19272461 1468.43618164
90 2691.36994629 2660.87460937
100 459356.3125 258723.5625
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net12
Model name for the evaluation phase:  net12
Training model...
# Neural Network with 540034 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          64x192x64
  3          64x192x64
  4          128x96x32
  5          128x96x32
  6          128x96x32
  7          256x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m4.22480[0m     [32m0.65802[0m    6.42043      0.61373  17.97s
      2     [36m0.61896[0m     0.72700    0.85139      0.60654  18.25s
      3     [36m0.59630[0m     0.72642    0.82088      0.57190  18.10s
      4     0.60560     0.70334    0.86103      0.59020  18.24s
      5     [36m0.58792[0m     0.73131    0.80393      0.56667  18.28s
      6     0.59044     0.74516    0.79237      0.54444  18.23s
      7     [36m0.58044[0m     0.75235    0.77150      0.53529  18.20s
      8     [36m0.57977[0m     0.75314    0.76981      0.55948  18.75s
      9     [36m0.57836[0m     0.79580    0.72677      0.55359  18.78s
     10     [36m0.56858[0m     0.71882    0.79099      0.58235  18.91s
     11     0.57067     0.75798    0.75289      0.51111  18.97s
Early stopping.
Best valid loss was 0.658024 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d4' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d4' (shape 128).
Loaded parameters to layer 'conv2d5' (shape 128x128x3x3).
Loaded parameters to layer 'conv2d5' (shape 128).
Loaded parameters to layer 'conv2d7' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d7' (shape 256).
Loaded parameters to layer 'conv2d8' (shape 2x256x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
probabilities.shape (1140, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 0 1 1 1 1 0 1 1 1 1 0 1 1 1 1 0 1 1 1 1 0 1 1 1 1 1]
Ground Truth:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Performance on relevant data
Accuracy validation:  0.622807017544
Error rate (%):  37.7192982456
[[257 313]
 [117 453]]
roc_auc: 0.709704524469
log_loss: 0.644875174467
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[ 0.28810018  0.71189976]
[ 0.13022566  0.8697747 ]
[ 0.02626647  0.97373468]
[ 0.17008153  0.82991892]
[ 0.88525856  0.11474188]
roc_auc for the hours: 0.721052631579
log_loss for the hours: 0.860013669278
saving predictions to csv file
hourspatient0_6_net12_10-04-18-49-39.csv
Accuracy validation for the hours:  0.558139534884
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [6]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 0.945664
saving predictions to csv file
patient0_6_net12_10-04-18-52-29.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config4.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_7']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config4.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_7'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-04 18:52:30.514868
Hostname: kat
gpu0
Configuration 'config4.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net12
evaluation:
    online_training: False
    model: net12

end Configuration
['patient0_7']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [7]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.745836544
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 42.2832771301 23.406820488
20 162.516268921 157.987145996
30 247.963627625 243.623634338
40 336.95199585 332.831341553
50 445.399627686 441.292938232
60 597.128845215 593.310778809
70 844.070202637 839.791943359
80 1309.5418457 1299.71809082
90 2364.6079834 2327.02700195
100 202022.625 78149.3203125
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net12
Model name for the evaluation phase:  net12
Training model...
# Neural Network with 540034 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          64x192x64
  3          64x192x64
  4          128x96x32
  5          128x96x32
  6          128x96x32
  7          256x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m3.16081[0m     [32m0.67434[0m    4.68726      0.52876  18.46s
      2     [36m0.61877[0m     0.71852    0.86117      0.47974  18.29s
      3     [36m0.58623[0m     0.71046    0.82515      0.55686  18.21s
      4     0.60732     0.69962    0.86808      0.52614  18.54s
      5     [36m0.58192[0m     0.69318    0.83949      0.56144  18.42s
      6     0.58426     0.69912    0.83570      0.52549  18.49s
      7     0.58268     0.70997    0.82071      0.51830  18.47s
      8     0.58776     0.70071    0.83881      0.51242  18.57s
      9     [36m0.57789[0m     0.70451    0.82027      0.55490  18.70s
     10     [36m0.56988[0m     0.70885    0.80395      0.55882  18.80s
     11     0.57461     0.69857    0.82256      0.57451  18.75s
     12     0.57216     [32m0.67312[0m    0.85002      0.63137  18.84s
     13     [36m0.56854[0m     [32m0.67010[0m    0.84843      0.63856  18.96s
     14     0.56890     [32m0.66437[0m    0.85630      0.63660  18.87s
     15     [36m0.55466[0m     0.69937    0.79308      0.62092  18.98s
     16     0.57062     0.68145    0.83737      0.63987  18.99s
     17     0.56771     0.70229    0.80837      0.59150  19.04s
     18     [36m0.54859[0m     0.70025    0.78342      0.61961  19.21s
     19     [36m0.54410[0m     0.70974    0.76661      0.61699  19.15s
     20     0.56194     0.71112    0.79022      0.61503  19.26s
     21     [36m0.53482[0m     0.74904    0.71400      0.60523  19.60s
     22     0.53826     0.82721    0.65070      0.47843  19.07s
     23     [36m0.52545[0m     0.74200    0.70816      0.54575  19.37s
     24     [36m0.52160[0m     0.76156    0.68491      0.58170  19.03s
Early stopping.
Best valid loss was 0.664369 at epoch 14.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d4' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d4' (shape 128).
Loaded parameters to layer 'conv2d5' (shape 128x128x3x3).
Loaded parameters to layer 'conv2d5' (shape 128).
Loaded parameters to layer 'conv2d7' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d7' (shape 256).
Loaded parameters to layer 'conv2d8' (shape 2x256x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
probabilities.shape (1140, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 0 1 1 1 1 0 1 1 1 1 0 1 1 1 1 0 1 1 1 1 0 1 1 1 1 1]
Ground Truth:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Performance on relevant data
Accuracy validation:  0.624561403509
Error rate (%):  37.5438596491
[[212 358]
 [ 70 500]]
roc_auc: 0.626334256694
log_loss: 0.682660193351
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[ 0.19490811  0.80509168]
[ 0.52297992  0.47702003]
[ 0.29163975  0.70836014]
[ 0.07462135  0.92537898]
[ 0.87938285  0.12061756]
roc_auc for the hours: 0.657894736842
log_loss for the hours: 0.997490696236
saving predictions to csv file
hourspatient0_7_net12_10-04-19-04-55.csv
Accuracy validation for the hours:  0.604651162791
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [7]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 0.944816128
saving predictions to csv file
patient0_7_net12_10-04-19-07-30.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config4.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_8']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config4.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_8'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-04 19:07:31.155652
Hostname: kat
gpu0
Configuration 'config4.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net12
evaluation:
    online_training: False
    model: net12

end Configuration
['patient0_8']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [8]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.746688512
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 54.1830825806 29.6300670624
20 210.284432983 202.797094727
30 322.79552002 315.015945435
40 440.955853271 432.186102295
50 584.439239502 573.883850098
60 779.399060059 765.642810059
70 1072.5894043 1055.17028809
80 1571.89633789 1552.87558594
90 2680.80834961 2671.50136719
100 68448.984375 353074.21875
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net12
Model name for the evaluation phase:  net12
Training model...
# Neural Network with 540034 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          64x192x64
  3          64x192x64
  4          128x96x32
  5          128x96x32
  6          128x96x32
  7          256x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m4.09330[0m     [32m0.65852[0m    6.21588      0.59608  18.12s
      2     [36m0.60542[0m     0.73819    0.82014      0.56536  18.15s
      3     [36m0.58644[0m     0.75852    0.77313      0.56013  18.35s
      4     0.59299     0.73223    0.80984      0.58562  18.46s
      5     [36m0.57850[0m     0.71513    0.80893      0.60588  18.42s
      6     0.58228     0.71674    0.81240      0.58693  18.51s
      7     [36m0.57805[0m     0.73696    0.78438      0.57843  18.57s
      8     [36m0.57574[0m     0.68958    0.83491      0.62941  18.87s
      9     0.57895     0.69902    0.82823      0.59346  18.75s
     10     [36m0.56400[0m     0.70196    0.80346      0.58889  19.05s
     11     0.57248     0.70375    0.81348      0.56928  18.81s
Early stopping.
Best valid loss was 0.658524 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d4' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d4' (shape 128).
Loaded parameters to layer 'conv2d5' (shape 128x128x3x3).
Loaded parameters to layer 'conv2d5' (shape 128).
Loaded parameters to layer 'conv2d7' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d7' (shape 256).
Loaded parameters to layer 'conv2d8' (shape 2x256x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
probabilities.shape (1140, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 0 1 1 1 1 0 1 1 1 1 0 1 1 1 1 0 1 1 1 1 0 1 1 1 1 1]
Ground Truth:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Performance on relevant data
Accuracy validation:  0.606140350877
Error rate (%):  39.3859649123
[[223 347]
 [102 468]]
roc_auc: 0.698402585411
log_loss: 0.647444104259
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[ 0.07900134  0.92099881]
[ 0.20684324  0.79315656]
[ 0.00861677  0.99138343]
[ 0.02885972  0.97114027]
[ 0.89782906  0.10217126]
roc_auc for the hours: 0.726315789474
log_loss for the hours: 1.17484282364
saving predictions to csv file
hourspatient0_8_net12_10-04-19-15-09.csv
Accuracy validation for the hours:  0.46511627907
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [8]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 0.946016256
saving predictions to csv file
patient0_8_net12_10-04-19-17-43.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config4.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_9']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config4.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_9'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-04 19:17:44.133597
Hostname: kat
gpu0
Configuration 'config4.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net12
evaluation:
    online_training: False
    model: net12

end Configuration
['patient0_9']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [9]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.745824256
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 66.6869514465 35.6989082336
20 256.319952393 245.103649902
30 392.878082275 380.05057373
40 536.743615723 521.363696289
50 716.260894775 697.441894531
60 975.356860352 953.108215332
70 1387.67550049 1363.3236084
80 2106.65888672 2072.82099609
90 3733.63100586 3669.75898437
100 262006.171875 86094.46875
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net12
Model name for the evaluation phase:  net12
Training model...
# Neural Network with 540034 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          64x192x64
  3          64x192x64
  4          128x96x32
  5          128x96x32
  6          128x96x32
  7          256x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m4.54273[0m     [32m0.73352[0m    6.19308      0.64118  18.10s
      2     [36m0.60203[0m     0.89810    0.67034      0.54314  18.33s
      3     [36m0.57849[0m     0.91731    0.63063      0.52876  18.25s
      4     0.58541     0.92076    0.63579      0.54641  18.37s
      5     [36m0.57029[0m     0.97281    0.58623      0.54183  18.39s
      6     0.57172     0.85947    0.66521      0.52941  18.39s
      7     [36m0.56338[0m     0.97751    0.57634      0.53856  18.50s
      8     0.56535     0.93818    0.60260      0.52745  18.79s
      9     [36m0.55987[0m     0.97428    0.57465      0.52026  18.83s
     10     [36m0.54807[0m     0.92612    0.59179      0.51176  18.95s
     11     0.55266     0.99257    0.55680      0.53529  18.99s
Early stopping.
Best valid loss was 0.733517 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d4' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d4' (shape 128).
Loaded parameters to layer 'conv2d5' (shape 128x128x3x3).
Loaded parameters to layer 'conv2d5' (shape 128).
Loaded parameters to layer 'conv2d7' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d7' (shape 256).
Loaded parameters to layer 'conv2d8' (shape 2x256x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
xVal.shape (1140, 2)
probabilities.shape (1140, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 0 1 1 1 1 0 1 1 1 1 0 1 1 1 1 0 1 1 1 1 0 1 1 1 1 0]
Ground Truth:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Performance on relevant data
Accuracy validation:  0.638596491228
Error rate (%):  36.1403508772
[[277 293]
 [119 451]]
roc_auc: 0.663973530317
log_loss: 0.723171921006
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
roc_auc for the hours: 0.673684210526
log_loss for the hours: 1.28935199115
saving predictions to csv file
hourspatient0_9_net12_10-04-19-25-56.csv
Accuracy validation for the hours:  0.558139534884
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [9]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 0.995909632
saving predictions to csv file
patient0_9_net12_10-04-19-28-31.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config4.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_10']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config4.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_10'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-04 19:28:32.717244
Hostname: kat
gpu0
Configuration 'config4.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net12
evaluation:
    online_training: False
    model: net12

end Configuration
['patient0_10']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [10]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.745811968
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 49.5935062408 26.4832733154
20 190.337982178 178.602871704
30 296.224377441 280.857037354
40 415.984814453 394.469250488
50 577.838653564 548.425720215
60 818.775402832 780.941381836
70 1187.2631958 1144.36071777
80 1820.75270996 1769.78515625
90 3363.41669922 3314.3128418
100 50863.234375 51923.34375
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net12
Model name for the evaluation phase:  net12
Training model...
# Neural Network with 540034 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          64x192x64
  3          64x192x64
  4          128x96x32
  5          128x96x32
  6          128x96x32
  7          256x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m4.25850[0m     [32m0.71532[0m    5.95329      0.58497  18.16s
      2     [36m0.60968[0m     0.80166    0.76053      0.59281  18.38s
      3     [36m0.58589[0m     0.86318    0.67876      0.60261  18.64s
      4     0.59488     0.77336    0.76921      0.60654  18.92s
      5     [36m0.57882[0m     0.77714    0.74480      0.58627  18.75s
      6     [36m0.57847[0m     0.79951    0.72353      0.58105  18.82s
      7     [36m0.56664[0m     0.76491    0.74079      0.57778  18.78s
      8     [36m0.56248[0m     0.80081    0.70239      0.58431  19.00s
      9     0.56547     0.73993    0.76422      0.59869  18.91s
     10     [36m0.54819[0m     0.74824    0.73263      0.57908  18.98s
     11     0.55426     [32m0.70152[0m    0.79009      0.59020  19.19s
     12     0.55998     [32m0.63258[0m    0.88523      0.63268  18.84s
     13     [36m0.54523[0m     0.71258    0.76515      0.59673  18.89s
     14     [36m0.54231[0m     0.65527    0.82761      0.61765  18.93s
     15     [36m0.52423[0m     0.69274    0.75674      0.60980  19.04s
     16     0.53726     0.68648    0.78263      0.61438  19.08s
     17     0.52971     0.74344    0.71251      0.57516  19.15s
     18     [36m0.52094[0m     0.64813    0.80377      0.62288  18.90s
     19     0.52770     0.69135    0.76329      0.60980  19.03s
     20     [36m0.51109[0m     0.67884    0.75289      0.60588  19.43s
     21     [36m0.50523[0m     0.74182    0.68106      0.60654  19.22s
     22     0.50991     0.74344    0.68588      0.60065  19.19s
Early stopping.
Best valid loss was 0.632578 at epoch 12.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d4' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d4' (shape 128).
Loaded parameters to layer 'conv2d5' (shape 128x128x3x3).
Loaded parameters to layer 'conv2d5' (shape 128).
Loaded parameters to layer 'conv2d7' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d7' (shape 256).
Loaded parameters to layer 'conv2d8' (shape 2x256x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
xVal.shape (1140, 2)
probabilities.shape (1140, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 0 1 1 1 1 0 1 1 1 1 0 0 1 1 1 0 1 1 1 0 0 0 1 1 1 0]
Ground Truth:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Performance on relevant data
Accuracy validation:  0.629824561404
Error rate (%):  37.0175438596
[[291 279]
 [143 427]]
roc_auc: 0.683217913204
log_loss: 0.630108564617
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
roc_auc for the hours: 0.726315789474
log_loss for the hours: 0.533462979581
saving predictions to csv file
hourspatient0_10_net12_10-04-19-39-58.csv
Accuracy validation for the hours:  0.674418604651
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [10]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 0.997036032
saving predictions to csv file
patient0_10_net12_10-04-19-42-28.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config4.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_11']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config4.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_11'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-04 19:42:29.930254
Hostname: kat
gpu0
Configuration 'config4.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net12
evaluation:
    online_training: False
    model: net12

end Configuration
['patient0_11']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [11]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.745910272
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 37.4027713776 20.3596906662
20 138.625271606 132.382019043
30 211.681109619 204.980381775
40 289.691271973 281.780712891
50 389.566116333 380.066696167
60 543.70489502 531.805041504
70 834.583398437 818.790313721
80 1463.92446289 1432.4847168
90 3328.68920898 3260.95727539
100 410646.09375 69810.453125
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net12
Model name for the evaluation phase:  net12
Training model...
# Neural Network with 540034 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          64x192x64
  3          64x192x64
  4          128x96x32
  5          128x96x32
  6          128x96x32
  7          256x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m7.99035[0m     [32m0.79829[0m   10.00927      0.58627  18.31s
      2     [36m0.61942[0m     [32m0.68428[0m    0.90520      0.58039  18.10s
      3     [36m0.59840[0m     0.70953    0.84337      0.58562  18.52s
      4     0.59865     0.68509    0.87382      0.59150  18.39s
      5     [36m0.58703[0m     [32m0.65898[0m    0.89081      0.61699  18.37s
      6     [36m0.58343[0m     0.71348    0.81773      0.58497  18.45s
      7     0.59134     0.69843    0.84667      0.59412  18.58s
      8     0.58824     0.68982    0.85274      0.60196  18.74s
      9     [36m0.57989[0m     0.74639    0.77692      0.57908  18.73s
     10     [36m0.56925[0m     0.75494    0.75403      0.56993  18.90s
     11     0.57099     0.81028    0.70468      0.58562  18.74s
     12     0.57294     0.80643    0.71047      0.59216  18.76s
     13     [36m0.56809[0m     0.74265    0.76495      0.58954  18.87s
     14     0.57162     0.74720    0.76501      0.58431  18.74s
     15     [36m0.55485[0m     0.74849    0.74130      0.56601  19.00s
Early stopping.
Best valid loss was 0.658977 at epoch 5.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d4' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d4' (shape 128).
Loaded parameters to layer 'conv2d5' (shape 128x128x3x3).
Loaded parameters to layer 'conv2d5' (shape 128).
Loaded parameters to layer 'conv2d7' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d7' (shape 256).
Loaded parameters to layer 'conv2d8' (shape 2x256x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
xVal.shape (1140, 2)
probabilities.shape (1140, 2)
Showing last 30 test samples..
Predictions:
[0 1 1 1 0 0 1 1 1 1 1 1 1 1 0 0 1 1 1 0 0 1 1 1 1 0 1 1 1 0]
Ground Truth:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Performance on relevant data
Accuracy validation:  0.626315789474
Error rate (%):  37.3684210526
[[308 262]
 [164 406]]
roc_auc: 0.62297014466
log_loss: 0.668845625022
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
roc_auc for the hours: 0.689473684211
log_loss for the hours: 0.666120400719
saving predictions to csv file
hourspatient0_11_net12_10-04-19-51-21.csv
Accuracy validation for the hours:  0.651162790698
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [11]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 0.99868672
saving predictions to csv file
patient0_11_net12_10-04-19-54-14.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config4.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_12']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config4.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_12'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-04 19:54:15.346138
Hostname: kat
gpu0
Configuration 'config4.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net12
evaluation:
    online_training: False
    model: net12

end Configuration
['patient0_12']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [12]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.746340352
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 65.1829460144 35.0811794281
20 246.685302734 233.028952026
30 381.222595215 364.982098389
40 530.423962402 509.868566895
50 730.584533691 703.699279785
60 1040.28303223 1008.42225342
70 1558.99154053 1521.31486816
80 2527.43164063 2455.40673828
90 5046.20957031 4843.92373047
100 126710.1875 64910.4453125
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net12
Model name for the evaluation phase:  net12
Training model...
# Neural Network with 540034 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          64x192x64
  3          64x192x64
  4          128x96x32
  5          128x96x32
  6          128x96x32
  7          256x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1    [36m11.18911[0m     [32m0.69876[0m   16.01272      0.69281  17.84s
      2     [36m0.61260[0m     0.71966    0.85124      0.68627  17.68s
      3     [36m0.58150[0m     0.75318    0.77206      0.68562  17.78s
      4     0.58602     0.77216    0.75894      0.59020  18.21s
      5     [36m0.56982[0m     0.75866    0.75109      0.61830  18.54s
      6     [36m0.56874[0m     0.78438    0.72508      0.56209  18.30s
      7     0.57271     0.77134    0.74248      0.55294  18.61s
      8     0.56882     0.74258    0.76600      0.59085  18.78s
      9     [36m0.56759[0m     0.79694    0.71221      0.53333  18.91s
     10     [36m0.54715[0m     0.87290    0.62682      0.48627  18.63s
     11     0.55168     0.86730    0.63609      0.47843  18.81s
Early stopping.
Best valid loss was 0.698764 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d4' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d4' (shape 128).
Loaded parameters to layer 'conv2d5' (shape 128x128x3x3).
Loaded parameters to layer 'conv2d5' (shape 128).
Loaded parameters to layer 'conv2d7' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d7' (shape 256).
Loaded parameters to layer 'conv2d8' (shape 2x256x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
xVal.shape (1140, 2)
probabilities.shape (1140, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 0 1 0 1 1 0 1 0 0 1 0 1 1 0 1 0 1 0 0 1 0 1 0 1 1 0]
Ground Truth:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Performance on relevant data
Accuracy validation:  0.687719298246
Error rate (%):  31.2280701754
[[459 111]
 [245 325]]
roc_auc: 0.764850723299
log_loss: 0.685808607989
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
roc_auc for the hours: 0.805263157895
log_loss for the hours: 0.355930282565
saving predictions to csv file
hourspatient0_12_net12_10-04-20-01-30.csv
Accuracy validation for the hours:  0.883720930233
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [12]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 0.945577984
saving predictions to csv file
patient0_12_net12_10-04-20-04-01.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config4.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_13']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config4.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_13'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-04 20:04:02.155417
Hostname: kat
gpu0
Configuration 'config4.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net12
evaluation:
    online_training: False
    model: net12

end Configuration
['patient0_13']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [13]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.746278912
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 69.0897041321 37.7125782013
20 266.439715576 253.817520142
30 414.331445313 399.039959717
40 579.853991699 560.493823242
50 802.805938721 779.214904785
60 1136.38771973 1110.1892334
70 1641.78244629 1620.17226562
80 2489.06611328 2463.09140625
90 4471.61362305 4441.97880859
100 100082.695312 85056.0390625
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net12
Model name for the evaluation phase:  net12
Training model...
# Neural Network with 540034 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          64x192x64
  3          64x192x64
  4          128x96x32
  5          128x96x32
  6          128x96x32
  7          256x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m5.70950[0m     [32m0.71711[0m    7.96179      0.58627  18.07s
      2     [36m0.61585[0m     0.76583    0.80416      0.60458  17.99s
      3     [36m0.58730[0m     0.83001    0.70758      0.60000  18.08s
      4     0.59684     0.75947    0.78586      0.58301  18.21s
      5     [36m0.58263[0m     0.79651    0.73147      0.56405  18.28s
      6     [36m0.57678[0m     0.76046    0.75847      0.56405  18.20s
      7     [36m0.57568[0m     0.75542    0.76207      0.54379  18.52s
      8     [36m0.57034[0m     0.75185    0.75858      0.55882  18.58s
      9     [36m0.56942[0m     0.77300    0.73664      0.57647  18.75s
     10     [36m0.55290[0m     [32m0.70595[0m    0.78320      0.54314  19.18s
     11     [36m0.55116[0m     [32m0.69511[0m    0.79291      0.57451  19.17s
     12     0.56826     [32m0.69348[0m    0.81943      0.59804  19.15s
     13     0.55391     [32m0.67321[0m    0.82278      0.58627  19.16s
     14     0.55270     [32m0.64186[0m    0.86110      0.64118  18.95s
     15     [36m0.52152[0m     0.66467    0.78463      0.62549  18.94s
     16     0.54095     0.67821    0.79762      0.63791  19.00s
     17     0.52249     0.70570    0.74038      0.58366  19.01s
     18     0.52382     0.64884    0.80732      0.62941  19.24s
     19     0.52556     0.68971    0.76199      0.61699  19.10s
     20     [36m0.50907[0m     0.68322    0.74510      0.60458  19.17s
     21     0.51312     0.67221    0.76334      0.62810  19.13s
     22     0.52578     0.70489    0.74590      0.61765  18.93s
     23     [36m0.49973[0m     0.75071    0.66568      0.58431  18.93s
     24     0.50334     0.73668    0.68325      0.59412  18.90s
Early stopping.
Best valid loss was 0.641860 at epoch 14.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d4' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d4' (shape 128).
Loaded parameters to layer 'conv2d5' (shape 128x128x3x3).
Loaded parameters to layer 'conv2d5' (shape 128).
Loaded parameters to layer 'conv2d7' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d7' (shape 256).
Loaded parameters to layer 'conv2d8' (shape 2x256x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
xVal.shape (1140, 2)
probabilities.shape (1140, 2)
Showing last 30 test samples..
Predictions:
[0 1 1 1 0 1 1 1 1 1 0 1 1 1 1 0 1 1 1 0 0 1 1 1 1 0 1 1 1 0]
Ground Truth:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Performance on relevant data
Accuracy validation:  0.625438596491
Error rate (%):  37.4561403509
[[264 306]
 [121 449]]
roc_auc: 0.637519236688
log_loss: 0.663621759699
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
roc_auc for the hours: 0.605263157895
log_loss for the hours: 0.480710818342
saving predictions to csv file
hourspatient0_13_net12_10-04-20-14-51.csv
Accuracy validation for the hours:  0.860465116279
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [13]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 0.943976448
saving predictions to csv file
patient0_13_net12_10-04-20-17-22.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config4.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_14']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config4.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_14'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-04 20:17:23.768616
Hostname: kat
gpu0
Configuration 'config4.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net12
evaluation:
    online_training: False
    model: net12

end Configuration
['patient0_14']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [14]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.746508288
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 51.4431194305 28.1161405563
20 195.642379761 187.486203003
30 299.57428894 291.18163147
40 410.908746338 402.061425781
50 555.348205566 546.590423584
60 781.114685059 775.59395752
70 1179.35510254 1183.46280518
80 1939.34797363 1949.83596191
90 3877.67912598 3944.7189209
100 65181.1953125 57682.203125
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net12
Model name for the evaluation phase:  net12
Training model...
# Neural Network with 540034 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          64x192x64
  3          64x192x64
  4          128x96x32
  5          128x96x32
  6          128x96x32
  7          256x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m8.92555[0m     [32m0.75821[0m   11.77195      0.47582  18.12s
      2     [36m0.64235[0m     [32m0.74426[0m    0.86307      0.51176  18.35s
      3     [36m0.61155[0m     0.80006    0.76437      0.52876  18.39s
      4     0.61373     0.75883    0.80878      0.56144  18.45s
      5     [36m0.59348[0m     0.78915    0.75205      0.54837  18.33s
      6     [36m0.59282[0m     0.80794    0.73374      0.56078  18.55s
      7     0.59685     0.84160    0.70919      0.51503  18.39s
      8     0.59577     [32m0.72241[0m    0.82470      0.58431  18.82s
      9     [36m0.58946[0m     0.74410    0.79218      0.60784  18.96s
     10     [36m0.56544[0m     0.79870    0.70795      0.58366  18.92s
     11     0.56601     0.82517    0.68592      0.57516  18.90s
     12     0.57298     0.74909    0.76490      0.59608  18.90s
     13     [36m0.55706[0m     [32m0.67037[0m    0.83097      0.59542  19.06s
     14     0.56518     [32m0.63239[0m    0.89372      0.60719  18.96s
     15     [36m0.54459[0m     0.70147    0.77634      0.58170  18.89s
     16     0.55718     0.65876    0.84580      0.61046  18.87s
     17     0.55365     0.70325    0.78727      0.58105  18.99s
     18     [36m0.53735[0m     0.65884    0.81560      0.61307  18.88s
     19     0.54889     0.69796    0.78641      0.57843  19.01s
     20     0.53812     0.67053    0.80253      0.60850  19.06s
     21     [36m0.53031[0m     0.70588    0.75128      0.58039  18.99s
     22     [36m0.52861[0m     0.72150    0.73265      0.58366  19.16s
     23     [36m0.51430[0m     0.75017    0.68558      0.56471  18.88s
     24     0.52264     0.74707    0.69958      0.57582  18.84s
Early stopping.
Best valid loss was 0.632389 at epoch 14.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d4' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d4' (shape 128).
Loaded parameters to layer 'conv2d5' (shape 128x128x3x3).
Loaded parameters to layer 'conv2d5' (shape 128).
Loaded parameters to layer 'conv2d7' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d7' (shape 256).
Loaded parameters to layer 'conv2d8' (shape 2x256x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
xVal.shape (1140, 2)
probabilities.shape (1140, 2)
Showing last 30 test samples..
Predictions:
[0 1 1 1 0 0 1 1 1 1 0 1 1 1 1 0 1 1 1 0 0 1 1 1 1 0 1 1 1 0]
Ground Truth:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Performance on relevant data
Accuracy validation:  0.607894736842
Error rate (%):  39.2105263158
[[290 280]
 [167 403]]
roc_auc: 0.650052323792
log_loss: 0.648649291495
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
roc_auc for the hours: 0.652631578947
log_loss for the hours: 0.849060347301
saving predictions to csv file
hourspatient0_14_net12_10-04-20-29-30.csv
Accuracy validation for the hours:  0.627906976744
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [14]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 0.944029696
saving predictions to csv file
patient0_14_net12_10-04-20-32-02.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config4.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_15']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config4.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_15'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-04 20:32:03.054032
Hostname: kat
gpu0
Configuration 'config4.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net12
evaluation:
    online_training: False
    model: net12

end Configuration
['patient0_15']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [15]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.746651648
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 34.6773342133 19.007179451
20 129.966018677 125.497892761
30 197.840336609 193.760687256
40 269.3421875 264.920050049
50 359.024520874 354.514923096
60 493.65269165 489.852355957
70 739.064575195 735.682330322
80 1252.53088379 1250.05979004
90 2505.61677246 2502.26618652
100 37134.734375 63323.234375
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net12
Model name for the evaluation phase:  net12
Training model...
# Neural Network with 540034 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          64x192x64
  3          64x192x64
  4          128x96x32
  5          128x96x32
  6          128x96x32
  7          256x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m6.12789[0m     [32m0.67961[0m    9.01676      0.54771  18.25s
      2     [36m0.65306[0m     0.68289    0.95631      0.53333  18.47s
      3     [36m0.62065[0m     0.73871    0.84018      0.49804  18.44s
      4     0.62404     0.70723    0.88238      0.55752  18.20s
      5     [36m0.60906[0m     0.72579    0.83917      0.55033  18.60s
      6     [36m0.60719[0m     0.72104    0.84211      0.54379  18.70s
      7     [36m0.60573[0m     0.71112    0.85180      0.57647  19.06s
      8     [36m0.59757[0m     0.73637    0.81150      0.56340  18.99s
      9     [36m0.59737[0m     0.73492    0.81284      0.57059  19.03s
     10     [36m0.58331[0m     0.83008    0.70271      0.48627  19.12s
     11     0.58702     0.85921    0.68321      0.46667  19.02s
Early stopping.
Best valid loss was 0.679612 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 64x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d4' (shape 128x64x3x3).
Loaded parameters to layer 'conv2d4' (shape 128).
Loaded parameters to layer 'conv2d5' (shape 128x128x3x3).
Loaded parameters to layer 'conv2d5' (shape 128).
Loaded parameters to layer 'conv2d7' (shape 256x128x3x3).
Loaded parameters to layer 'conv2d7' (shape 256).
Loaded parameters to layer 'conv2d8' (shape 2x256x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
xVal.shape (1140, 2)
probabilities.shape (1140, 2)
Showing last 30 test samples..
Predictions:
[1 0 1 1 0 1 0 1 1 0 1 0 0 1 0 1 0 1 1 0 1 0 1 1 0 1 0 1 1 0]
Ground Truth:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Performance on relevant data
Accuracy validation:  0.585964912281
Error rate (%):  41.4035087719
[[352 218]
 [254 316]]
roc_auc: 0.627913204063
log_loss: 0.674916303367
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
(1, 1215, 1, 192, 64)
(1, 1215, 1, 192, 64)
(1215, 2)
(2,)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
roc_auc for the hours: 0.642105263158
log_loss for the hours: 0.539137736851
saving predictions to csv file
hourspatient0_15_net12_10-04-20-38-43.csv
Accuracy validation for the hours:  0.744186046512
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [15]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 0.945618944
saving predictions to csv file
patient0_15_net12_10-04-20-41-14.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config4.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_0']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config4.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_0'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-10 00:02:33.584697
Hostname: kat
gpu0
Configuration 'config4.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net12
evaluation:
    online_training: False
    model: net12

end Configuration
['patient0_0']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [0]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.686809088
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 77.4825836182 42.2078788757
20 305.512463379 300.472479248
30 461.135577393 459.25463562
40 614.021606445 614.238354492
50 784.364746094 787.311828613
60 993.193286133 998.551342773
70 1272.31512451 1279.6506958
80 1694.84467773 1704.01054688
90 2529.98266602 2551.26169434
100 45472.875 51963.8164062
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net12
Model name for the evaluation phase:  net12
Training model...
# Neural Network with 540034 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          64x192x64
  3          64x192x64
  4          128x96x32
  5          128x96x32
  6          128x96x32
  7          256x48x16
  8          2x48x16
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config4.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_1']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config4.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_1'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-10 00:28:44.190515
Hostname: kat
gpu0
Configuration 'config4.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net12
evaluation:
    online_training: False
    model: net12

end Configuration
['patient0_1']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [1]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.687468544
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 79.8583602905 43.7949028015
20 305.763250732 299.520977783
30 453.40585022 450.005862427
40 592.349865723 590.177758789
50 740.968597412 740.054229736
60 918.324951172 917.797363281
70 1161.24418945 1163.53183594
80 1578.52695313 1588.20612793
90 2613.2675293 2653.38178711
100 212492.21875 103666.890625
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net12
Model name for the evaluation phase:  net12
Training model...
# Neural Network with 540034 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          64x192x64
  3          64x192x64
  4          128x96x32
  5          128x96x32
  6          128x96x32
  7          256x48x16
  8          2x48x16
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config4.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_2']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config4.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_2'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-10 00:32:49.132064
Hostname: kat
gpu0
Configuration 'config4.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net12
evaluation:
    online_training: False
    model: net12

end Configuration
['patient0_2']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [2]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.687640576
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 72.0125099182 40.3037857056
20 276.55925293 272.411431885
30 416.599380493 415.294677734
40 555.997583008 556.773425293
50 715.97946167 718.930877686
60 923.099047852 927.542578125
70 1228.42805176 1233.38067627
80 1756.11213379 1761.63308105
90 3001.92504883 3026.81286621
100 72650.4921875 53126.640625
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net12
Model name for the evaluation phase:  net12
Training model...
# Neural Network with 540034 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          64x192x64
  3          64x192x64
  4          128x96x32
  5          128x96x32
  6          128x96x32
  7          256x48x16
  8          2x48x16
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config4.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_3']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config4.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_3'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-10 00:36:08.369641
Hostname: kat
gpu0
Configuration 'config4.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net12
evaluation:
    online_training: False
    model: net12

end Configuration
['patient0_3']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [3]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.687521792
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 52.0612277985 28.9869352341
20 191.337734985 185.116714478
30 292.577377319 287.197384644
40 400.500439453 396.009564209
50 535.735168457 532.537109375
60 731.05357666 729.604919434
70 1066.69674072 1069.19353027
80 1804.39440918 1808.60009766
90 3908.51987305 3891.41049805
100 124376.210938 175654.078125
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net12
Model name for the evaluation phase:  net12
Training model...
# Neural Network with 540034 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          64x192x64
  3          64x192x64
  4          128x96x32
  5          128x96x32
  6          128x96x32
  7          256x48x16
  8          2x48x16
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config4.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_4']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config4.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_4'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-10 00:39:16.007071
Hostname: kat
gpu0
Configuration 'config4.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net12
evaluation:
    online_training: False
    model: net12

end Configuration
['patient0_4']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [4]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.687849472
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 60.27771492 33.2891647339
20 230.724859619 226.139196777
30 348.998257446 345.771307373
40 468.468225098 465.978533936
50 608.787628174 607.555786133
60 801.863439941 803.590454102
70 1127.33896484 1136.01357422
80 1802.12897949 1820.19179688
90 3236.02592773 3251.78005371
100 159526.84375 66619.4296875
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net12
Model name for the evaluation phase:  net12
Training model...
# Neural Network with 540034 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          64x192x64
  3          64x192x64
  4          128x96x32
  5          128x96x32
  6          128x96x32
  7          256x48x16
  8          2x48x16
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config4.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_5']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config4.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_5'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-10 00:42:17.446114
Hostname: kat
gpu0
Configuration 'config4.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net12
evaluation:
    online_training: False
    model: net12

end Configuration
['patient0_5']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [5]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.687927296
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 44.228635788 24.8328939438
20 167.781503296 163.806289673
30 254.511244202 251.485551453
40 343.928485107 341.169134521
50 452.231292725 450.168884277
60 604.746826172 604.360339355
70 863.724084473 868.017297363
80 1408.11137695 1423.19575195
90 2638.64152832 2674.38774414
100 60107.1914062 35895.5507812
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net12
Model name for the evaluation phase:  net12
Training model...
# Neural Network with 540034 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          64x192x64
  3          64x192x64
  4          128x96x32
  5          128x96x32
  6          128x96x32
  7          256x48x16
  8          2x48x16
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config4.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_6']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config4.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_6'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-10 00:45:24.105048
Hostname: kat
gpu0
Configuration 'config4.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net12
evaluation:
    online_training: False
    model: net12

end Configuration
['patient0_6']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [6]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.686845952
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 52.9203617096 28.9710264206
20 204.033294678 198.010336304
30 310.279055786 304.778164673
40 419.120050049 413.251306152
50 547.291717529 541.047363281
60 717.765319824 711.321618652
70 980.086315918 974.004034424
80 1476.19272461 1468.43618164
90 2691.36994629 2660.87460937
100 459356.3125 258723.5625
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net12
Model name for the evaluation phase:  net12
Training model...
# Neural Network with 540034 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          64x192x64
  3          64x192x64
  4          128x96x32
  5          128x96x32
  6          128x96x32
  7          256x48x16
  8          2x48x16
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config4.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_7']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config4.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_7'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-10 00:48:16.315443
Hostname: kat
gpu0
Configuration 'config4.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net12
evaluation:
    online_training: False
    model: net12

end Configuration
['patient0_7']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [7]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.687140864
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 42.2832771301 23.406820488
20 162.516268921 157.987145996
30 247.963627625 243.623634338
40 336.95199585 332.831341553
50 445.399627686 441.292938232
60 597.128845215 593.310778809
70 844.070202637 839.791943359
80 1309.5418457 1299.71809082
90 2364.6079834 2327.02700195
100 202022.625 78149.3203125
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net12
Model name for the evaluation phase:  net12
Training model...
# Neural Network with 540034 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          64x192x64
  3          64x192x64
  4          128x96x32
  5          128x96x32
  6          128x96x32
  7          256x48x16
  8          2x48x16
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config4.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_8']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config4.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_8'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-10 00:51:20.514378
Hostname: kat
gpu0
Configuration 'config4.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net12
evaluation:
    online_training: False
    model: net12

end Configuration
['patient0_8']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [8]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.687480832
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 54.1830825806 29.6300670624
20 210.284432983 202.797094727
30 322.79552002 315.015945435
40 440.955853271 432.186102295
50 584.439239502 573.883850098
60 779.399060059 765.642810059
70 1072.5894043 1055.17028809
80 1571.89633789 1552.87558594
90 2680.80834961 2671.50136719
100 68448.984375 353074.21875
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net12
Model name for the evaluation phase:  net12
Training model...
# Neural Network with 540034 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          64x192x64
  3          64x192x64
  4          128x96x32
  5          128x96x32
  6          128x96x32
  7          256x48x16
  8          2x48x16
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config4.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_9']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config4.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_9'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-10 00:54:11.919796
Hostname: kat
gpu0
Configuration 'config4.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net12
evaluation:
    online_training: False
    model: net12

end Configuration
['patient0_9']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [9]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.687968256
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 66.6869514465 35.6989082336
20 256.319952393 245.103649902
30 392.878082275 380.05057373
40 536.743615723 521.363696289
50 716.260894775 697.441894531
60 975.356860352 953.108215332
70 1387.67550049 1363.3236084
80 2106.65888672 2072.82099609
90 3733.63100586 3669.75898437
100 262006.171875 86094.46875
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net12
Model name for the evaluation phase:  net12
Training model...
# Neural Network with 540034 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          64x192x64
  3          64x192x64
  4          128x96x32
  5          128x96x32
  6          128x96x32
  7          256x48x16
  8          2x48x16
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config4.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_10']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config4.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_10'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-10 00:56:39.984874
Hostname: kat
gpu0
Configuration 'config4.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net12
evaluation:
    online_training: False
    model: net12

end Configuration
['patient0_10']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [10]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.687742976
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 49.5935062408 26.4832733154
20 190.337982178 178.602871704
30 296.224377441 280.857037354
40 415.984814453 394.469250488
50 577.838653564 548.425720215
60 818.775402832 780.941381836
70 1187.2631958 1144.36071777
80 1820.75270996 1769.78515625
90 3363.41669922 3314.3128418
100 50863.234375 51923.34375
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net12
Model name for the evaluation phase:  net12
Training model...
# Neural Network with 540034 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          64x192x64
  3          64x192x64
  4          128x96x32
  5          128x96x32
  6          128x96x32
  7          256x48x16
  8          2x48x16
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config4.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_11']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config4.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_11'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-10 00:59:12.433697
Hostname: kat
gpu0
Configuration 'config4.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net12
evaluation:
    online_training: False
    model: net12

end Configuration
['patient0_11']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [11]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.687726592
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 37.4027713776 20.3596906662
20 138.625271606 132.382019043
30 211.681109619 204.980381775
40 289.691271973 281.780712891
50 389.566116333 380.066696167
60 543.70489502 531.805041504
70 834.583398437 818.790313721
80 1463.92446289 1432.4847168
90 3328.68920898 3260.95727539
100 410646.09375 69810.453125
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net12
Model name for the evaluation phase:  net12
Training model...
# Neural Network with 540034 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          64x192x64
  3          64x192x64
  4          128x96x32
  5          128x96x32
  6          128x96x32
  7          256x48x16
  8          2x48x16
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config4.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_12']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config4.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_12'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-10 01:01:37.562294
Hostname: kat
gpu0
Configuration 'config4.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net12
evaluation:
    online_training: False
    model: net12

end Configuration
['patient0_12']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [12]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.687927296
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 65.1829460144 35.0811794281
20 246.685302734 233.028952026
30 381.222595215 364.982098389
40 530.423962402 509.868566895
50 730.584533691 703.699279785
60 1040.28303223 1008.42225342
70 1558.99154053 1521.31486816
80 2527.43164063 2455.40673828
90 5046.20957031 4843.92373047
100 126710.1875 64910.4453125
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net12
Model name for the evaluation phase:  net12
Training model...
# Neural Network with 540034 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          64x192x64
  3          64x192x64
  4          128x96x32
  5          128x96x32
  6          128x96x32
  7          256x48x16
  8          2x48x16
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config4.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_13']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config4.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_13'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-10 01:04:06.305748
Hostname: kat
gpu0
Configuration 'config4.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net12
evaluation:
    online_training: False
    model: net12

end Configuration
['patient0_13']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [13]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.687235072
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 69.0897041321 37.7125782013
20 266.439715576 253.817520142
30 414.331445313 399.039959717
40 579.853991699 560.493823242
50 802.805938721 779.214904785
60 1136.38771973 1110.1892334
70 1641.78244629 1620.17226562
80 2489.06611328 2463.09140625
90 4471.61362305 4441.97880859
100 100082.695312 85056.0390625
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net12
Model name for the evaluation phase:  net12
Training model...
# Neural Network with 540034 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          64x192x64
  3          64x192x64
  4          128x96x32
  5          128x96x32
  6          128x96x32
  7          256x48x16
  8          2x48x16
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config4.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_14']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config4.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_14'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-10 01:06:28.823753
Hostname: kat
gpu0
Configuration 'config4.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net12
evaluation:
    online_training: False
    model: net12

end Configuration
['patient0_14']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [14]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.686768128
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 51.4431194305 28.1161405563
20 195.642379761 187.486203003
30 299.57428894 291.18163147
40 410.908746338 402.061425781
50 555.348205566 546.590423584
60 781.114685059 775.59395752
70 1179.35510254 1183.46280518
80 1939.34797363 1949.83596191
90 3877.67912598 3944.7189209
100 65181.1953125 57682.203125
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net12
Model name for the evaluation phase:  net12
Training model...
# Neural Network with 540034 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          64x192x64
  3          64x192x64
  4          128x96x32
  5          128x96x32
  6          128x96x32
  7          256x48x16
  8          2x48x16
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config4.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_15']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config4.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_15'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-10 01:08:53.227930
Hostname: kat
gpu0
Configuration 'config4.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net12
evaluation:
    online_training: False
    model: net12

end Configuration
['patient0_15']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [15]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.688136192
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 34.6773342133 19.007179451
20 129.966018677 125.497892761
30 197.840336609 193.760687256
40 269.3421875 264.920050049
50 359.024520874 354.514923096
60 493.65269165 489.852355957
70 739.064575195 735.682330322
80 1252.53088379 1250.05979004
90 2505.61677246 2502.26618652
100 37134.734375 63323.234375
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net12
Model name for the evaluation phase:  net12
Training model...
# Neural Network with 540034 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          64x192x64
  3          64x192x64
  4          128x96x32
  5          128x96x32
  6          128x96x32
  7          256x48x16
  8          2x48x16
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
