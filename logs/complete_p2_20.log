['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_0']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_0'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-13 14:48:53.168346
Hostname: kat
gpu0
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 32
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net11
evaluation:
    online_training: False
    model: net11

end Configuration
['patient2_0']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 32)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [0]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.71391232
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 719.493286133 713.301513672
20 1125.04443359 1099.65490723
30 1499.04968262 1452.75018311
40 1889.57055664 1818.82214355
50 2330.37634277 2232.24707031
60 2868.7409668 2727.1159668
70 3588.09667969 3382.57849121
80 4677.31054688 4375.19628906
90 6773.26660156 6329.9074707
100 63321.7421875 58944.8007812
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net11
Model name for the evaluation phase:  net11
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x32
  1          32x192x32
  2          32x192x32
  3          32x192x32
  4          32x96x16
  5          32x96x16
  6          32x96x16
  7          32x48x8
  8          2x48x8
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m0.78072[0m     [32m0.77182[0m    1.01153      0.68929  20.75s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.52918[0m     0.78697    0.67243      0.74482  20.79s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.51597[0m     [32m0.75951[0m    0.67934      0.74446  20.84s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.50709[0m     [32m0.74793[0m    0.67799      0.72088  21.08s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.49567[0m     0.78990    0.62750      0.72505  20.91s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.48233[0m     0.88659    0.54403      0.70656  20.94s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.45895[0m     0.89894    0.51054      0.68619  21.00s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.42535[0m     0.99298    0.42836      0.67659  21.00s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.38015[0m     1.25508    0.30289      0.67792  21.01s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.34048[0m     1.51592    0.22460      0.67505  21.01s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.31675[0m     1.34064    0.23627      0.66373  21.05s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     12     [36m0.24775[0m     1.74157    0.14226      0.67453  21.04s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     13     [36m0.21462[0m     2.43399    0.08818      0.61525  21.24s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     14     [36m0.20385[0m     2.14736    0.09493      0.60706  21.04s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.747928 at epoch 4.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 32)
magnitudes_seizure_val.shape (5, 1, 1406, 32)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.790085175615
Error rate (%):  20.9914824385
[[37920  8250]
 [ 2717  3358]]
(52245,)
(52245,)
roc_auc: 0.728446524786
log_loss: 1.43082723603
roc_auc for the hours: 0.747368421053
log_loss for the hours: 1.00622226118
saving predictions to csv file
hourspatient2_0_net11_10-13-14-58-03.csv
Accuracy validation for the hours:  0.813953488372
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 32)
(2286, 1, 234, 32)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [0]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 0.938356736
saving predictions to csv file
patient2_0_net11_10-13-15-01-04.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_1']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_1'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-13 15:01:05.017605
Hostname: kat
gpu0
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 32
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net11
evaluation:
    online_training: False
    model: net11

end Configuration
['patient2_1']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 32)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [1]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.717111296
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 552.902008057 533.659088135
20 865.409118652 821.86340332
30 1159.57305908 1092.72888184
40 1476.37988281 1379.27514648
50 1848.48779297 1711.05456543
60 2326.09619141 2125.72558594
70 3010.23718262 2702.53100586
80 4156.28466797 3647.63256836
90 6534.52490234 5720.0703125
100 56617.8046875 55581.1640625
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net11
Model name for the evaluation phase:  net11
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x32
  1          32x192x32
  2          32x192x32
  3          32x192x32
  4          32x96x16
  5          32x96x16
  6          32x96x16
  7          32x48x8
  8          2x48x8
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m0.77222[0m     [32m0.91486[0m    0.84408      0.54591  20.80s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.53888[0m     [32m0.86725[0m    0.62136      0.60812  20.81s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.52089[0m     0.88204    0.59055      0.60185  20.85s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.49850[0m     0.91489    0.54488      0.60626  20.89s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.47500[0m     0.97457    0.48740      0.61263  20.95s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.45179[0m     1.04147    0.43380      0.58710  21.18s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.42046[0m     1.12219    0.37467      0.59848  20.97s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.38596[0m     1.21865    0.31671      0.56417  20.99s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.34781[0m     1.38946    0.25032      0.56691  21.00s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.31385[0m     1.82707    0.17178      0.57816  20.99s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.28376[0m     1.73594    0.16346      0.53018  21.03s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     12     [36m0.24945[0m     1.85134    0.13474      0.57109  21.03s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.867247 at epoch 2.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 32)
magnitudes_seizure_val.shape (5, 1, 1406, 32)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.757316489616
Error rate (%):  24.2683510384
[[37547  8623]
 [ 4056  2019]]
(52245,)
(52245,)
roc_auc: 0.591992742869
log_loss: 1.44893496964
roc_auc for the hours: 0.636842105263
log_loss for the hours: 0.936348522999
saving predictions to csv file
hourspatient2_1_net11_10-13-15-09-47.csv
Accuracy validation for the hours:  0.767441860465
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 32)
(2286, 1, 234, 32)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [1]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 0.94154752
saving predictions to csv file
patient2_1_net11_10-13-15-13-12.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_2']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_2'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-13 15:13:13.692737
Hostname: kat
gpu0
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 32
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net11
evaluation:
    online_training: False
    model: net11

end Configuration
['patient2_2']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 32)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [2]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.71542784
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 428.785522461 418.371994019
20 660.637023926 635.674499512
30 873.2394104 834.340087891
40 1095.95544434 1041.45812988
50 1349.51568604 1274.42279053
60 1663.90258789 1561.61645508
70 2094.06872559 1947.54901123
80 2766.80664062 2544.0949707
90 4074.02539062 3758.82739258
100 58473.7617188 75930.625
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net11
Model name for the evaluation phase:  net11
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x32
  1          32x192x32
  2          32x192x32
  3          32x192x32
  4          32x96x16
  5          32x96x16
  6          32x96x16
  7          32x48x8
  8          2x48x8
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m0.68208[0m     [32m1.10271[0m    0.61856      0.57442  20.68s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.50214[0m     1.42807    0.35162      0.57031  21.00s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.48235[0m     1.74757    0.27601      0.55003  20.79s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.46716[0m     2.04184    0.22879      0.57259  20.89s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.45391[0m     2.58694    0.17546      0.56294  20.94s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.44379[0m     2.74833    0.16148      0.57401  21.00s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.42368[0m     2.89930    0.14613      0.56182  21.03s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.40863[0m     2.76585    0.14774      0.57936  21.02s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.37604[0m     3.32136    0.11322      0.57755  21.05s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.35082[0m     4.34284    0.08078      0.58872  21.03s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.31906[0m     4.74882    0.06719      0.60700  21.26s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 1.102707 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 32)
magnitudes_seizure_val.shape (5, 1, 1406, 32)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.534137238013
Error rate (%):  46.5862761987
[[24152 22018]
 [ 2321  3754]]
(52245,)
(52245,)
roc_auc: 0.638806395402
log_loss: nan
roc_auc for the hours: 0.642105263158
log_loss for the hours: 2.59649963353
saving predictions to csv file
hourspatient2_2_net11_10-13-15-21-24.csv
Accuracy validation for the hours:  0.558139534884
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 32)
(2286, 1, 234, 32)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [2]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 0.938356736
saving predictions to csv file
patient2_2_net11_10-13-15-24-47.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_3']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_3'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-13 15:24:48.872660
Hostname: kat
gpu0
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 32
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net11
evaluation:
    online_training: False
    model: net11

end Configuration
['patient2_3']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 32)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [3]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.715853824
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 479.824264526 479.04234314
20 751.240722656 737.689819336
30 1011.26626587 987.554412842
40 1296.50561523 1260.15625
50 1636.68695068 1580.99505615
60 2067.08496094 1988.26037598
70 2658.17211914 2540.98034668
80 3561.02392578 3388.41943359
90 5310.82470703 5052.78613281
100 147926.25 114985.820312
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net11
Model name for the evaluation phase:  net11
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x32
  1          32x192x32
  2          32x192x32
  3          32x192x32
  4          32x96x16
  5          32x96x16
  6          32x96x16
  7          32x48x8
  8          2x48x8
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m0.78176[0m     [32m1.01051[0m    0.77363      0.65107  21.63s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.52279[0m     1.12575    0.46439      0.64253  21.96s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.49706[0m     1.20224    0.41345      0.64462  22.04s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.47732[0m     1.26628    0.37694      0.64354  22.11s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.46150[0m     1.40666    0.32808      0.64275  22.10s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.44242[0m     1.46237    0.30254      0.65028  22.09s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.41817[0m     1.37516    0.30409      0.65037  22.16s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.38824[0m     1.60573    0.24178      0.66625  22.17s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.34645[0m     1.76606    0.19617      0.68453  21.31s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.31636[0m     1.95773    0.16159      0.65694  21.02s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.26442[0m     2.00696    0.13175      0.65338  21.09s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 1.010509 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 32)
magnitudes_seizure_val.shape (5, 1, 1406, 32)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.800669920567
Error rate (%):  19.9330079433
[[39047  7123]
 [ 3291  2784]]
(52245,)
(52245,)
roc_auc: 0.689386459595
log_loss: 1.16385508471
roc_auc for the hours: 0.702631578947
log_loss for the hours: 0.989160124089
saving predictions to csv file
hourspatient2_3_net11_10-13-15-33-19.csv
Accuracy validation for the hours:  0.860465116279
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 32)
(2286, 1, 234, 32)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [3]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 0.938201088
saving predictions to csv file
patient2_3_net11_10-13-15-36-20.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_4']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_4'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-13 15:36:21.857947
Hostname: kat
gpu0
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 32
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net11
evaluation:
    online_training: False
    model: net11

end Configuration
['patient2_4']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 32)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [4]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.715808768
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 390.218261719 390.211807251
20 610.542480469 600.937316895
30 817.157592773 797.18649292
40 1038.01391602 1005.71862793
50 1296.46325684 1246.49615479
60 1623.5012207 1547.53442383
70 2076.46130371 1957.37371826
80 2791.97241211 2594.88134766
90 4208.98388672 3867.06982422
100 44210.6640625 39898.75
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net11
Model name for the evaluation phase:  net11
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x32
  1          32x192x32
  2          32x192x32
  3          32x192x32
  4          32x96x16
  5          32x96x16
  6          32x96x16
  7          32x48x8
  8          2x48x8
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m0.65799[0m     [32m0.71568[0m    0.91939      0.69135  21.91s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.49253[0m     [32m0.69413[0m    0.70957      0.66004  22.55s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.48066[0m     [32m0.66392[0m    0.72397      0.64111  22.29s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.47370[0m     [32m0.64582[0m    0.73349      0.64829  22.74s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.44858[0m     [32m0.61577[0m    0.72848      0.64586  22.45s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.42752[0m     0.65142    0.65629      0.65883  22.55s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.38633[0m     0.69069    0.55933      0.65510  22.58s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.35015[0m     0.76261    0.45915      0.68403  22.53s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.30194[0m     0.88538    0.34103      0.67720  22.47s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.26584[0m     1.01020    0.26316      0.67640  22.26s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.21708[0m     1.16701    0.18602      0.67295  22.03s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     12     [36m0.19244[0m     1.48604    0.12950      0.69792  21.86s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     13     [36m0.17192[0m     1.39194    0.12351      0.68115  22.05s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     14     [36m0.14584[0m     1.90309    0.07663      0.67778  21.89s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     15     [36m0.12407[0m     2.18730    0.05672      0.69216  21.86s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.615771 at epoch 5.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 32)
magnitudes_seizure_val.shape (5, 1, 1406, 32)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.720719686094
Error rate (%):  27.9280313906
[[33751 12419]
 [ 2172  3903]]
(52245,)
(52245,)
roc_auc: 0.761061058122
log_loss: nan
roc_auc for the hours: 0.736842105263
log_loss for the hours: 0.878921051108
saving predictions to csv file
hourspatient2_4_net11_10-13-15-46-56.csv
Accuracy validation for the hours:  0.767441860465
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 32)
(2286, 1, 234, 32)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [4]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 0.940064768
saving predictions to csv file
patient2_4_net11_10-13-15-50-02.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_5']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_5'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-13 15:50:03.716045
Hostname: kat
gpu0
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 32
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net11
evaluation:
    online_training: False
    model: net11

end Configuration
['patient2_5']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 32)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [5]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.715628544
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 500.997558594 496.955749512
20 786.887695312 767.024230957
30 1060.9019165 1024.31774902
40 1362.56335449 1303.07714844
50 1726.42736816 1631.80206299
60 2204.31811523 2056.01953125
70 2895.97033691 2658.55493164
80 4038.65673828 3649.9375
90 6400.25073242 5760.42578125
100 67580.4921875 68869.3984375
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net11
Model name for the evaluation phase:  net11
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x32
  1          32x192x32
  2          32x192x32
  3          32x192x32
  4          32x96x16
  5          32x96x16
  6          32x96x16
  7          32x48x8
  8          2x48x8
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m0.76894[0m     [32m0.81018[0m    0.94910      0.64250  20.42s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.53960[0m     0.84280    0.64024      0.63109  20.49s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.52132[0m     0.83249    0.62621      0.61515  20.57s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.48105[0m     0.95759    0.50235      0.59665  20.65s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.45382[0m     0.98883    0.45894      0.60041  20.71s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.42561[0m     1.12829    0.37722      0.58411  20.71s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.40844[0m     1.18464    0.34478      0.57377  20.72s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.37532[0m     1.25365    0.29938      0.57925  20.72s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.34362[0m     1.40971    0.24375      0.58075  20.72s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.32720[0m     1.42910    0.22895      0.57226  20.73s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.30219[0m     1.69013    0.17879      0.57635  20.76s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.810178 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 32)
magnitudes_seizure_val.shape (5, 1, 1406, 32)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.718441956168
Error rate (%):  28.1558043832
[[34558 11612]
 [ 3098  2977]]
(52245,)
(52245,)
roc_auc: 0.618024113782
log_loss: 1.71470327882
roc_auc for the hours: 0.623684210526
log_loss for the hours: 1.22515269688
saving predictions to csv file
hourspatient2_5_net11_10-13-15-57-51.csv
Accuracy validation for the hours:  0.720930232558
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 32)
(2286, 1, 234, 32)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [5]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 0.93943808
saving predictions to csv file
patient2_5_net11_10-13-16-00-49.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_6']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_6'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-13 16:00:51.436983
Hostname: kat
gpu0
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 32
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net11
evaluation:
    online_training: False
    model: net11

end Configuration
['patient2_6']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 32)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [6]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.715436032
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 434.732299805 441.592254639
20 683.031433105 682.651306152
30 923.467041016 915.819732666
40 1191.10705566 1172.34521484
50 1514.71838379 1481.43304443
60 1935.15698242 1877.18664551
70 2520.36157227 2421.70605469
80 3416.31811523 3252.6171875
90 5095.53173828 4810.91186523
100 47858.3515625 52179.953125
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net11
Model name for the evaluation phase:  net11
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x32
  1          32x192x32
  2          32x192x32
  3          32x192x32
  4          32x96x16
  5          32x96x16
  6          32x96x16
  7          32x48x8
  8          2x48x8
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m0.75936[0m     [32m0.76785[0m    0.98894      0.65768  20.41s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.53732[0m     0.86675    0.61993      0.68384  20.50s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.51516[0m     0.83658    0.61580      0.72293  20.60s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.49044[0m     0.86664    0.56590      0.70900  20.66s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.45803[0m     0.94522    0.48457      0.68054  20.71s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.41712[0m     1.05157    0.39666      0.69058  20.70s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.37210[0m     1.24265    0.29944      0.68187  20.76s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.32763[0m     1.27128    0.25772      0.65954  20.78s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.29334[0m     1.45343    0.20182      0.65872  20.80s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.27866[0m     1.66052    0.16781      0.66108  20.80s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.22652[0m     1.83039    0.12375      0.64893  20.84s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.767850 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 32)
magnitudes_seizure_val.shape (5, 1, 1406, 32)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.871413532395
Error rate (%):  12.8586467605
[[43555  2615]
 [ 4103  1972]]
(52245,)
(52245,)
roc_auc: 0.744236891574
log_loss: 0.985562387636
roc_auc for the hours: 0.784210526316
log_loss for the hours: 0.564363540834
saving predictions to csv file
hourspatient2_6_net11_10-13-16-07-22.csv
Accuracy validation for the hours:  0.883720930233
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 32)
(2286, 1, 234, 32)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [6]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 0.939761664
saving predictions to csv file
patient2_6_net11_10-13-16-10-21.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_7']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_7'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-13 16:10:22.632411
Hostname: kat
gpu0
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 32
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net11
evaluation:
    online_training: False
    model: net11

end Configuration
['patient2_7']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 32)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [7]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.714981376
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 494.198287964 528.927490234
20 771.678955078 812.729187012
30 1029.53637695 1075.96337891
40 1301.0369873 1347.06640625
50 1608.16815186 1652.12762451
60 1977.01428223 2015.74353027
70 2449.22216797 2478.16870117
80 3119.11621094 3128.29785156
90 4277.18310547 4243.28125
100 70629.9609375 92128.8515625
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net11
Model name for the evaluation phase:  net11
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x32
  1          32x192x32
  2          32x192x32
  3          32x192x32
  4          32x96x16
  5          32x96x16
  6          32x96x16
  7          32x48x8
  8          2x48x8
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m0.75859[0m     [32m0.95417[0m    0.79502      0.57308  20.44s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.52014[0m     0.99233    0.52416      0.68497  20.52s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.49244[0m     1.09103    0.45135      0.68016  20.65s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.47826[0m     1.04943    0.45573      0.67782  20.92s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.46123[0m     1.11143    0.41498      0.68023  21.03s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.43819[0m     1.19951    0.36530      0.68161  20.93s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.40908[0m     1.40024    0.29215      0.65603  21.09s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.39405[0m     1.46269    0.26940      0.64249  21.01s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.34411[0m     2.08758    0.16484      0.63238  21.13s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.32702[0m     1.99845    0.16364      0.64617  20.99s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.27504[0m     2.20317    0.12484      0.60369  21.09s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.954174 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 32)
magnitudes_seizure_val.shape (5, 1, 1406, 32)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.895415829266
Error rate (%):  10.4584170734
[[46033   137]
 [ 5327   748]]
(52245,)
(52245,)
roc_auc: 0.716383606478
log_loss: 1.24403124339
roc_auc for the hours: 0.694736842105
log_loss for the hours: 1.06635454639
saving predictions to csv file
hourspatient2_7_net11_10-13-16-16-56.csv
Accuracy validation for the hours:  0.906976744186
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 32)
(2286, 1, 234, 32)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [7]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 0.938528768
saving predictions to csv file
patient2_7_net11_10-13-16-19-55.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_8']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_8'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-13 16:19:56.483465
Hostname: kat
gpu0
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 32
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net11
evaluation:
    online_training: False
    model: net11

end Configuration
['patient2_8']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 32)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [8]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.71469056
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 685.534393311 705.405639648
20 1069.26208496 1082.72961426
30 1421.00726318 1428.65856934
40 1785.91943359 1787.84545898
50 2194.5760498 2188.42041016
60 2681.6574707 2665.95166016
70 3304.97106934 3277.14660645
80 4190.52294922 4143.78808594
90 5727.90161133 5662.48022461
100 105201.65625 53464.578125
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net11
Model name for the evaluation phase:  net11
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x32
  1          32x192x32
  2          32x192x32
  3          32x192x32
  4          32x96x16
  5          32x96x16
  6          32x96x16
  7          32x48x8
  8          2x48x8
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m0.78214[0m     [32m1.56419[0m    0.50003      0.50573  20.56s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.47778[0m     [32m1.46736[0m    0.32560      0.57464  20.71s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.46320[0m     [32m1.13210[0m    0.40915      0.60536  20.75s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.45662[0m     1.28043    0.35662      0.62113  20.86s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.44786[0m     1.16559    0.38423      0.62402  20.93s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.44056[0m     1.34234    0.32821      0.63255  21.00s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.43042[0m     1.35043    0.31873      0.62947  20.82s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.41372[0m     1.26964    0.32585      0.64548  20.98s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.39520[0m     1.46933    0.26897      0.62753  21.00s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.36078[0m     1.86660    0.19328      0.62443  20.92s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     11     0.39836     1.78871    0.22271      0.62978  20.96s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     12     [36m0.29372[0m     2.08510    0.14086      0.63620  21.08s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     13     [36m0.25667[0m     2.10345    0.12202      0.64184  21.01s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 1.132101 at epoch 3.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 32)
magnitudes_seizure_val.shape (5, 1, 1406, 32)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 1 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.808421858551
Error rate (%):  19.1578141449
[[40429  5741]
 [ 4268  1807]]
(52245,)
(52245,)
roc_auc: 0.655772873733
log_loss: 1.74997886164
roc_auc for the hours: 0.657894736842
log_loss for the hours: 1.3425110511
saving predictions to csv file
hourspatient2_8_net11_10-13-16-30-37.csv
Accuracy validation for the hours:  0.790697674419
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 32)
(2286, 1, 234, 32)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [8]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 0.938827776
saving predictions to csv file
patient2_8_net11_10-13-16-33-37.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_9']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_9'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-13 16:33:38.549224
Hostname: kat
gpu0
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 32
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net11
evaluation:
    online_training: False
    model: net11

end Configuration
['patient2_9']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 32)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [9]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.71487488
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 614.386383057 625.168212891
20 956.830749512 962.09564209
30 1275.68701172 1275.11291504
40 1613.11242676 1607.60571289
50 2002.34893799 1988.71716309
60 2488.19726562 2461.32910156
70 3148.66479492 3103.29663086
80 4169.85205078 4085.34692383
90 6188.64941406 5975.96850586
100 81443.234375 46753.0546875
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net11
Model name for the evaluation phase:  net11
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x32
  1          32x192x32
  2          32x192x32
  3          32x192x32
  4          32x96x16
  5          32x96x16
  6          32x96x16
  7          32x48x8
  8          2x48x8
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m0.79309[0m     [32m0.92250[0m    0.85972      0.66274  20.40s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.51049[0m     0.96174    0.53080      0.65870  20.51s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.49227[0m     [32m0.90513[0m    0.54387      0.63380  20.56s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.47176[0m     [32m0.88947[0m    0.53039      0.59190  20.66s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.44552[0m     0.93033    0.47889      0.58323  20.73s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.42277[0m     0.96090    0.43997      0.54442  20.72s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.39902[0m     1.09600    0.36407      0.58931  20.71s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.35929[0m     1.23795    0.29023      0.57874  20.79s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.32837[0m     1.39453    0.23547      0.57879  20.81s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.28096[0m     1.59857    0.17576      0.60942  20.80s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.23971[0m     1.55896    0.15376      0.58981  20.85s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     12     [36m0.20429[0m     1.99667    0.10232      0.58531  20.83s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     13     [36m0.18068[0m     2.49063    0.07254      0.60759  21.15s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     14     [36m0.15272[0m     2.54969    0.05990      0.60397  21.06s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.889467 at epoch 4.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 32)
magnitudes_seizure_val.shape (5, 1, 1406, 32)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.790295722079
Error rate (%):  20.9704277921
[[38857  7313]
 [ 3643  2432]]
(52245,)
(52245,)
roc_auc: 0.592384813326
log_loss: 1.71047207817
roc_auc for the hours: 0.578947368421
log_loss for the hours: 0.690333303481
saving predictions to csv file
hourspatient2_9_net11_10-13-16-43-54.csv
Accuracy validation for the hours:  0.860465116279
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 32)
(2286, 1, 234, 32)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [9]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 0.939245568
saving predictions to csv file
patient2_9_net11_10-13-16-46-52.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_10']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_10'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-13 16:46:53.932646
Hostname: kat
gpu0
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 32
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net11
evaluation:
    online_training: False
    model: net11

end Configuration
['patient2_10']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 32)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [10]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.715935744
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 529.121643066 550.755096436
20 821.037536621 839.698913574
30 1086.16131592 1102.3145752
40 1359.51257324 1371.30981445
50 1663.11535645 1668.14556885
60 2026.01086426 2020.1895752
70 2496.7644043 2471.83251953
80 3180.73754883 3121.64038086
90 4417.43041992 4276.05029297
100 33467.8828125 31567.0722656
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net11
Model name for the evaluation phase:  net11
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x32
  1          32x192x32
  2          32x192x32
  3          32x192x32
  4          32x96x16
  5          32x96x16
  6          32x96x16
  7          32x48x8
  8          2x48x8
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m0.74477[0m     [32m0.82772[0m    0.89979      0.67751  20.58s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.53209[0m     0.86350    0.61619      0.65911  20.81s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.52059[0m     0.88105    0.59088      0.62854  20.73s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.51245[0m     0.96489    0.53110      0.61473  20.96s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.48181[0m     1.08514    0.44401      0.60155  20.89s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.44585[0m     1.13578    0.39255      0.60493  20.96s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.40006[0m     1.35751    0.29470      0.60434  20.94s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.34869[0m     1.57362    0.22159      0.58142  21.02s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.30124[0m     1.63726    0.18399      0.60409  20.93s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.25092[0m     1.81613    0.13816      0.58851  21.00s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.21384[0m     2.06137    0.10374      0.58712  21.00s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.827719 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 32)
magnitudes_seizure_val.shape (5, 1, 1406, 32)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.766178581682
Error rate (%):  23.3821418318
[[36683  9487]
 [ 2729  3346]]
(52245,)
(52245,)
roc_auc: 0.696055805571
log_loss: 1.19446063107
roc_auc for the hours: 0.731578947368
log_loss for the hours: 0.713004087257
saving predictions to csv file
hourspatient2_10_net11_10-13-16-55-56.csv
Accuracy validation for the hours:  0.790697674419
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 32)
(2286, 1, 234, 32)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [10]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 0.938754048
saving predictions to csv file
patient2_10_net11_10-13-16-59-00.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_11']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_11'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-13 16:59:01.257506
Hostname: kat
gpu0
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 32
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net11
evaluation:
    online_training: False
    model: net11

end Configuration
['patient2_11']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 32)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [11]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.715853824
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 481.243530273 513.171875
20 756.69152832 794.288696289
30 1015.19189453 1056.5592041
40 1288.74182129 1333.85644531
50 1600.75793457 1646.66448975
60 1978.22375488 2025.31689453
70 2470.34765625 2522.77404785
80 3190.85961914 3248.54516602
90 4485.05664062 4541.92578125
100 47304.0664062 104914.585938
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net11
Model name for the evaluation phase:  net11
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x32
  1          32x192x32
  2          32x192x32
  3          32x192x32
  4          32x96x16
  5          32x96x16
  6          32x96x16
  7          32x48x8
  8          2x48x8
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m0.74921[0m     [32m0.94595[0m    0.79202      0.55986  20.39s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.49983[0m     0.98799    0.50591      0.66694  20.48s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.46447[0m     1.21749    0.38150      0.67718  20.57s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.43200[0m     1.44647    0.29866      0.70684  20.65s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.40249[0m     1.61952    0.24852      0.69493  20.70s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.37899[0m     1.67201    0.22667      0.70357  20.70s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.35158[0m     1.88659    0.18636      0.70256  20.68s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.33375[0m     2.00100    0.16679      0.67700  20.69s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.28390[0m     2.00488    0.14160      0.67276  20.81s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.24177[0m     2.78420    0.08684      0.66232  20.79s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.21564[0m     2.38907    0.09026      0.63443  20.84s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.945952 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 32)
magnitudes_seizure_val.shape (5, 1, 1406, 32)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.853976457077
Error rate (%):  14.6023542923
[[43725  2445]
 [ 5184   891]]
(52245,)
(52245,)
roc_auc: 0.75110416416
log_loss: 1.13305905459
roc_auc for the hours: 0.75
log_loss for the hours: 0.742872315194
saving predictions to csv file
hourspatient2_11_net11_10-13-17-08-10.csv
Accuracy validation for the hours:  0.860465116279
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 32)
(2286, 1, 234, 32)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [11]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 0.939257856
saving predictions to csv file
patient2_11_net11_10-13-17-11-09.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_12']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_12'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-13 17:11:11.374744
Hostname: kat
gpu0
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 32
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net11
evaluation:
    online_training: False
    model: net11

end Configuration
['patient2_12']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 32)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [12]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.715972608
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 552.749664307 564.594726562
20 864.064147949 870.582519531
30 1153.465271 1155.3236084
40 1456.99194336 1453.87451172
50 1799.94903564 1789.68011475
60 2212.0012207 2191.87939453
70 2743.08496094 2708.07727051
80 3504.67041016 3439.00854492
90 4847.20605469 4726.08178711
100 68512.453125 43195.7773438
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net11
Model name for the evaluation phase:  net11
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x32
  1          32x192x32
  2          32x192x32
  3          32x192x32
  4          32x96x16
  5          32x96x16
  6          32x96x16
  7          32x48x8
  8          2x48x8
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m0.75536[0m     [32m0.88844[0m    0.85021      0.70489  20.40s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.52078[0m     0.89648    0.58091      0.69610  20.50s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.50148[0m     [32m0.86932[0m    0.57686      0.66007  20.59s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.47738[0m     0.87858    0.54335      0.64849  20.72s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.45027[0m     0.95749    0.47026      0.65569  20.72s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.42186[0m     1.06459    0.39627      0.62750  20.70s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.37462[0m     1.21364    0.30868      0.61783  20.71s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.33171[0m     1.36682    0.24268      0.61831  20.78s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.27930[0m     1.43829    0.19419      0.60946  20.80s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.25484[0m     1.47552    0.17271      0.60663  20.79s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.20843[0m     1.82913    0.11395      0.60979  20.83s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     12     [36m0.17913[0m     2.02771    0.08834      0.61920  20.83s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     13     [36m0.15338[0m     2.30047    0.06667      0.62487  20.83s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.869320 at epoch 3.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 32)
magnitudes_seizure_val.shape (5, 1, 1406, 32)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 1 1 0 0 1 1 0 0 1 1 0 0 1 0 0 0 1 0 0 0 0 0 0 0 1 1 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.85242606948
Error rate (%):  14.757393052
[[41874  4296]
 [ 3414  2661]]
(52245,)
(52245,)
roc_auc: 0.667509210459
log_loss: 1.39635960518
roc_auc for the hours: 0.652631578947
log_loss for the hours: 1.01580328585
saving predictions to csv file
hourspatient2_12_net11_10-13-17-19-07.csv
Accuracy validation for the hours:  0.883720930233
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 32)
(2286, 1, 234, 32)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [12]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 0.94058496
saving predictions to csv file
patient2_12_net11_10-13-17-22-07.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_13']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_13'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-13 17:22:09.213207
Hostname: kat
gpu0
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 32
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net11
evaluation:
    online_training: False
    model: net11

end Configuration
['patient2_13']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 32)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [13]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.715825152
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 674.796112061 698.693786621
20 1056.390625 1077.47119141
30 1409.3079834 1432.33648682
40 1778.50671387 1800.46057129
50 2192.96240234 2212.86853027
60 2686.8972168 2702.88647461
70 3318.54443359 3326.45690918
80 4210.55029297 4196.8671875
90 5771.20166016 5692.11865234
100 35079.8945312 31263.9492188
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net11
Model name for the evaluation phase:  net11
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x32
  1          32x192x32
  2          32x192x32
  3          32x192x32
  4          32x96x16
  5          32x96x16
  6          32x96x16
  7          32x48x8
  8          2x48x8
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m0.79813[0m     [32m1.21002[0m    0.65960      0.48590  20.41s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.50635[0m     1.21207    0.41775      0.49809  20.50s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.49429[0m     [32m1.10643[0m    0.44674      0.54395  20.58s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.48438[0m     [32m1.06814[0m    0.45348      0.57197  20.66s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.46841[0m     1.16307    0.40273      0.57992  20.71s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.46090[0m     1.11060    0.41501      0.62472  20.70s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.42983[0m     1.23061    0.34928      0.59467  20.72s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.39062[0m     1.39633    0.27975      0.63030  20.79s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.35076[0m     1.66674    0.21044      0.62020  20.80s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.31384[0m     1.77682    0.17663      0.59979  20.80s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.26146[0m     2.03906    0.12823      0.63454  20.83s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     12     [36m0.22872[0m     2.50833    0.09118      0.53132  20.80s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     13     [36m0.19229[0m     2.52299    0.07622      0.60221  20.78s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     14     [36m0.15990[0m     3.11582    0.05132      0.57608  20.81s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 1.068141 at epoch 4.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 32)
magnitudes_seizure_val.shape (5, 1, 1406, 32)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.800133984113
Error rate (%):  19.9866015887
[[40900  5270]
 [ 5172   903]]
(52245,)
(52245,)
roc_auc: 0.655371346366
log_loss: 1.83814572212
roc_auc for the hours: 0.671052631579
log_loss for the hours: 0.919226781754
saving predictions to csv file
hourspatient2_13_net11_10-13-17-30-20.csv
Accuracy validation for the hours:  0.813953488372
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 32)
(2286, 1, 234, 32)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [13]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 0.940367872
saving predictions to csv file
patient2_13_net11_10-13-17-33-18.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_14']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_14'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-13 17:33:20.371629
Hostname: kat
gpu0
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 32
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net11
evaluation:
    online_training: False
    model: net11

end Configuration
['patient2_14']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 32)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [14]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.715497472
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 563.514282227 578.797058105
20 872.205322266 883.155273438
30 1154.68133545 1161.2824707
40 1448.24572754 1449.52600098
50 1780.36651611 1771.1819458
60 2183.18945312 2159.11547852
70 2715.40576172 2667.08557129
80 3508.41796875 3412.0793457
90 4984.85693359 4788.19702148
100 38412.0351562 39300.5585938
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net11
Model name for the evaluation phase:  net11
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x32
  1          32x192x32
  2          32x192x32
  3          32x192x32
  4          32x96x16
  5          32x96x16
  6          32x96x16
  7          32x48x8
  8          2x48x8
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m0.75581[0m     [32m1.23469[0m    0.61215      0.61047  20.54s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.53429[0m     [32m1.17862[0m    0.45332      0.53219  20.53s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.52289[0m     1.18672    0.44062      0.53014  20.61s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.51418[0m     1.23881    0.41506      0.49267  20.67s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.49789[0m     1.34148    0.37115      0.53209  20.73s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.47783[0m     1.46155    0.32694      0.54855  20.72s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.44916[0m     1.46418    0.30677      0.57068  20.70s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.41035[0m     1.38603    0.29606      0.55352  20.76s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.37697[0m     1.38875    0.27144      0.53098  20.82s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.31589[0m     1.91895    0.16462      0.56304  20.81s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.27795[0m     2.17069    0.12804      0.53556  20.86s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     12     [36m0.22755[0m     2.58876    0.08790      0.55790  20.86s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 1.178621 at epoch 2.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 32)
magnitudes_seizure_val.shape (5, 1, 1406, 32)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.692506459948
Error rate (%):  30.7493540052
[[33750 12420]
 [ 3645  2430]]
(52245,)
(52245,)
roc_auc: 0.520973320106
log_loss: 2.42751071185
roc_auc for the hours: 0.455263157895
log_loss for the hours: 1.50548839154
saving predictions to csv file
hourspatient2_14_net11_10-13-17-40-52.csv
Accuracy validation for the hours:  0.720930232558
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 32)
(2286, 1, 234, 32)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [14]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 0.939667456
saving predictions to csv file
patient2_14_net11_10-13-17-43-51.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_15']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_15'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-13 17:43:52.662184
Hostname: kat
gpu0
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 32
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net11
evaluation:
    online_training: False
    model: net11

end Configuration
['patient2_15']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 32)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [15]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.715350016
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 504.805053711 530.28112793
20 788.140441895 814.44354248
30 1048.72442627 1076.60375977
40 1320.20410156 1346.54309082
50 1623.44073486 1647.79748535
60 1984.45874023 2002.1484375
70 2445.72192383 2449.84423828
80 3100.90722656 3079.56640625
90 4260.35400391 4181.36035156
100 28167.1855469 26524.03125
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net11
Model name for the evaluation phase:  net11
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x32
  1          32x192x32
  2          32x192x32
  3          32x192x32
  4          32x96x16
  5          32x96x16
  6          32x96x16
  7          32x48x8
  8          2x48x8
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m0.68878[0m     [32m0.74788[0m    0.92098      0.70416  20.41s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.51692[0m     0.82227    0.62864      0.71320  20.51s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.49816[0m     0.84102    0.59232      0.70757  20.61s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.48273[0m     0.88455    0.54573      0.69909  20.68s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.46245[0m     0.94640    0.48864      0.70145  20.73s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.44263[0m     0.98236    0.45058      0.68439  20.72s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.39661[0m     1.15427    0.34360      0.66952  20.75s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.35709[0m     1.25629    0.28424      0.65148  20.80s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.30109[0m     1.33841    0.22496      0.65242  20.81s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.26290[0m     1.44502    0.18193      0.65528  20.80s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.22947[0m     1.90373    0.12054      0.64665  20.85s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.747877 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 32)
magnitudes_seizure_val.shape (5, 1, 1406, 32)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.778007464829
Error rate (%):  22.1992535171
[[37003  9167]
 [ 2431  3644]]
(52245,)
(52245,)
roc_auc: 0.70831422788
log_loss: 1.45679387563
roc_auc for the hours: 0.747368421053
log_loss for the hours: 0.716443488099
saving predictions to csv file
hourspatient2_15_net11_10-13-17-51-11.csv
Accuracy validation for the hours:  0.767441860465
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 32)
(2286, 1, 234, 32)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [15]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 0.938889216
saving predictions to csv file
patient2_15_net11_10-13-17-54-11.csv
