['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config6.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_0']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config6.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_0'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-23 20:18:32.538455
Hostname: kat
gpu3
Configuration 'config6.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net29
evaluation:
    online_training: False
    model: net29

end Configuration
['patient1_0']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [0]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.838029312
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 199.036781311 184.038919067
20 483.221002197 465.519171143
30 718.880554199 694.377087402
40 969.482617188 933.868884277
50 1265.8637085 1213.74743652
60 1644.84228516 1568.92561035
70 2171.59033203 2061.92285156
80 2997.35341797 2842.94628906
90 4640.41015625 4440.24106445
100 101397.328125 96893.890625
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net29
Model name for the evaluation phase:  net29
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1    [36m65.66394[0m    [32m11.92893[0m    5.50460      0.48688  24.91s
      2     [36m4.94372[0m     [32m6.53411[0m    0.75660      0.48157  26.51s
      3     [36m3.36654[0m     [32m3.73897[0m    0.90039      0.47080  26.62s
      4     [36m2.57662[0m     [32m3.36325[0m    0.76611      0.46968  25.46s
      5     [36m2.13046[0m     [32m1.71633[0m    1.24129      0.42065  26.99s
      6     [36m1.64783[0m     [32m1.15477[0m    1.42697      0.44501  27.69s
      7     [36m1.41797[0m     1.27634    1.11097      0.40546  25.30s
      8     [36m1.26699[0m     1.30923    0.96774      0.39864  26.67s
      9     [36m1.08786[0m     1.17076    0.92919      0.40395  26.27s
     10     [36m0.95803[0m     1.24831    0.76746      0.40254  27.14s
     11     [36m0.88158[0m     1.16612    0.75599      0.40442  26.61s
     12     [36m0.84359[0m     1.29537    0.65124      0.43747  24.59s
     13     [36m0.80652[0m     1.53638    0.52495      0.46522  23.64s
     14     [36m0.77029[0m     1.98403    0.38825      0.48638  22.20s
     15     [36m0.75064[0m     2.00021    0.37528      0.48873  22.47s
     16     [36m0.73338[0m     1.47208    0.49820      0.48344  22.31s
     17     [36m0.70454[0m     [32m1.08215[0m    0.65105      0.43186  21.69s
     18     0.71107     [32m1.01942[0m    0.69753      0.42073  21.63s
     19     [36m0.68408[0m     1.20409    0.56813      0.46330  21.75s
     20     [36m0.67632[0m     [32m0.87460[0m    0.77329      0.38574  21.73s
     21     [36m0.66742[0m     [32m0.77602[0m    0.86005      0.41049  21.72s
     22     [36m0.65657[0m     1.40728    0.46655      0.48250  21.53s
     23     0.65979     1.13066    0.58354      0.48294  21.58s
     24     [36m0.65553[0m     1.42927    0.45864      0.48920  21.61s
     25     [36m0.65453[0m     0.80571    0.81237      0.37833  21.61s
     26     [36m0.63226[0m     1.56256    0.40463      0.48668  21.47s
     27     0.63483     [32m0.75072[0m    0.84563      0.39573  21.54s
     28     [36m0.63111[0m     1.00334    0.62901      0.45974  21.50s
     29     [36m0.62977[0m     [32m0.73312[0m    0.85902      0.55372  21.59s
     30     [36m0.62476[0m     [32m0.73138[0m    0.85422      0.55886  21.68s
     31     [36m0.61874[0m     0.78276    0.79046      0.42795  21.56s
     32     [36m0.61418[0m     0.74950    0.81944      0.56514  21.72s
     33     [36m0.61206[0m     [32m0.72290[0m    0.84667      0.56001  21.72s
     34     0.61450     0.73184    0.83967      0.55065  21.55s
     35     0.61341     0.76165    0.80537      0.57693  21.63s
     36     0.61392     0.76464    0.80289      0.59058  21.58s
     37     [36m0.60148[0m     0.77500    0.77611      0.59627  21.71s
     38     0.60224     0.73628    0.81795      0.54985  21.74s
     39     0.60797     0.75965    0.80033      0.56504  21.65s
     40     0.60599     0.74288    0.81573      0.54054  21.55s
     41     0.62478     0.89866    0.69523      0.38842  21.60s
     42     0.61035     0.74346    0.82096      0.53319  21.57s
     43     [36m0.60000[0m     0.73733    0.81374      0.57131  21.64s
Early stopping.
Best valid loss was 0.722902 at epoch 33.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[ 0.99262792  0.97639489  0.98964769  0.98021758  0.98279667  0.98524821
  0.97881913  0.94964218  0.9767645   0.55405802  0.91074383  0.94109368
  0.98015058  0.99192917  0.98039699  0.98715776  0.98650211  0.91497779
  0.97863936  0.9808147   0.99129677  0.96106458  0.99335492  0.99616289
  0.995713    0.99654824  0.99702758  0.99630511  0.99892908  0.99612039]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.440065421547
Error rate (%):  55.9934578453
[[37837 50858]
 [ 2207  3868]]
(94770,)
(94770,)
roc_auc: 0.491739068807
log_loss: inf
roc_auc for the hours: 0.515068493151
log_loss for the hours: 1.99686244179
saving predictions to csv file
hourspatient1_0_net29_10-23-21-09-25.csv
Accuracy validation for the hours:  0.435897435897
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [0]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.07413504
saving predictions to csv file
patient1_0_net29_10-23-21-44-57.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config6.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_1']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config6.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_1'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-23 21:44:59.875188
Hostname: kat
gpu3
Configuration 'config6.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net29
evaluation:
    online_training: False
    model: net29

end Configuration
['patient1_1']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [1]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.838275072
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 203.761627197 188.411010742
20 496.77197876 482.61751709
30 732.597296143 714.697686768
40 973.972167969 949.532727051
50 1245.81005859 1212.85552979
60 1576.76357422 1532.16108398
70 2013.54516602 1951.80438232
80 2668.75805664 2577.9690918
90 3942.10078125 3797.89812012
100 71591.0625 60304.03125
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net29
Model name for the evaluation phase:  net29
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1    [36m50.58865[0m     [32m2.50716[0m   20.17769      0.49662  19.74s
      2     [36m4.78376[0m     [32m1.05775[0m    4.52259      0.58367  22.11s
      3     [36m3.47231[0m     [32m0.82510[0m    4.20834      0.55012  22.03s
      4     [36m2.36458[0m     [32m0.76577[0m    3.08786      0.53463  22.03s
      5     [36m1.87609[0m     [32m0.70460[0m    2.66262      0.57367  21.99s
      6     [36m1.42633[0m     0.85768    1.66302      0.48663  21.98s
      7     [36m1.27164[0m     [32m0.68423[0m    1.85850      0.59264  22.18s
      8     [36m1.10336[0m     [32m0.68243[0m    1.61680      0.53415  22.13s
      9     [36m0.99171[0m     [32m0.66869[0m    1.48306      0.61797  22.07s
     10     [36m0.95126[0m     0.68889    1.38085      0.50149  22.00s
     11     [36m0.88973[0m     [32m0.66792[0m    1.33210      0.54227  21.99s
     12     [36m0.83569[0m     0.72284    1.15612      0.47185  22.00s
     13     [36m0.80185[0m     [32m0.66286[0m    1.20969      0.56319  21.94s
     14     [36m0.77636[0m     0.68767    1.12898      0.47236  22.18s
     15     [36m0.76102[0m     0.67570    1.12627      0.50258  21.86s
     16     [36m0.73430[0m     0.67542    1.08718      0.49825  21.94s
     17     [36m0.71789[0m     [32m0.65945[0m    1.08862      0.56435  21.93s
     18     [36m0.71373[0m     0.67633    1.05529      0.49852  21.97s
     19     [36m0.70580[0m     0.66297    1.06460      0.52664  22.23s
     20     [36m0.70346[0m     0.66153    1.06338      0.54676  22.30s
     21     [36m0.68454[0m     [32m0.65137[0m    1.05093      0.63683  22.37s
     22     [36m0.67133[0m     0.70374    0.95394      0.59512  22.21s
     23     0.67226     [32m0.64948[0m    1.03507      0.63597  21.57s
     24     [36m0.66126[0m     [32m0.64001[0m    1.03320      0.62851  21.48s
     25     [36m0.65612[0m     0.73398    0.89393      0.59017  21.46s
     26     0.66696     0.64204    1.03882      0.61141  21.48s
     27     [36m0.64417[0m     0.66491    0.96880      0.62858  21.47s
     28     0.64739     0.70423    0.91928      0.60333  21.52s
     29     [36m0.64003[0m     0.68667    0.93207      0.61449  21.12s
     30     0.64866     0.65815    0.98558      0.63627  21.05s
     31     0.64344     0.78019    0.82473      0.57016  21.13s
     32     [36m0.63835[0m     0.77916    0.81929      0.56243  21.08s
     33     0.64929     0.73452    0.88396      0.59171  21.13s
     34     [36m0.63771[0m     0.69336    0.91974      0.61268  21.08s
Early stopping.
Best valid loss was 0.640012 at epoch 24.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[ 0.6772089   0.74844849  0.84816635  0.9183585   0.59519845  0.38528973
  0.81455344  0.72955519  0.45707613  0.45491102  0.89719355  0.79829615
  0.57200104  0.65436691  0.69156408  0.96405047  0.24529573  0.7278387
  0.75667799  0.95940936  0.45150554  0.49930191  0.96164352  0.9840852
  0.25569779  0.34165713  0.9785499   0.67985326  0.83991331  0.75954956]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.47124617495
Error rate (%):  52.875382505
[[40103 48592]
 [ 1518  4557]]
(94770,)
(94770,)
roc_auc: 0.617842903166
log_loss: 1.59171570913
roc_auc for the hours: 0.660273972603
log_loss for the hours: 1.03911888174
saving predictions to csv file
hourspatient1_1_net29_10-23-22-18-23.csv
Accuracy validation for the hours:  0.448717948718
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [1]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.128050688
saving predictions to csv file
patient1_1_net29_10-23-22-27-55.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config6.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_2']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config6.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_2'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-23 22:27:56.467402
Hostname: kat
gpu3
Configuration 'config6.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net29
evaluation:
    online_training: False
    model: net29

end Configuration
['patient1_2']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [2]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.838045696
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 210.389639282 196.646928406
20 506.963934326 496.903918457
30 739.698999023 728.238903809
40 971.565100098 956.919091797
50 1226.64501953 1206.60388184
60 1529.57705078 1501.93178711
70 1919.78259277 1881.66341553
80 2487.38320313 2434.10976563
90 3554.0130127 3481.28129883
100 119907.929688 146484.890625
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net29
Model name for the evaluation phase:  net29
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1    [36m55.41050[0m     [32m1.98120[0m   27.96818      0.47850  18.54s
      2     [36m4.41407[0m     [32m1.40812[0m    3.13472      0.54791  20.96s
      3     [36m3.11487[0m     [32m1.04373[0m    2.98437      0.55094  21.45s
      4     [36m2.37364[0m     [32m0.91161[0m    2.60378      0.53975  21.45s
      5     [36m1.76967[0m     [32m0.81256[0m    2.17789      0.52447  21.29s
      6     [36m1.43609[0m     0.85486    1.67992      0.54283  21.45s
      7     [36m1.29338[0m     0.86007    1.50381      0.56208  21.44s
      8     [36m1.16067[0m     0.81497    1.42420      0.53821  21.54s
      9     [36m1.02608[0m     [32m0.77739[0m    1.31991      0.53274  21.31s
     10     [36m0.93784[0m     0.77891    1.20404      0.49500  21.30s
     11     [36m0.87862[0m     [32m0.76128[0m    1.15413      0.54470  21.21s
     12     [36m0.86240[0m     0.77502    1.11275      0.50785  21.29s
     13     [36m0.81974[0m     0.76301    1.07435      0.51069  21.36s
     14     [36m0.81767[0m     0.87065    0.93914      0.47587  21.28s
     15     [36m0.78413[0m     [32m0.74012[0m    1.05947      0.49633  21.26s
     16     [36m0.76945[0m     0.77604    0.99151      0.48020  21.37s
     17     [36m0.76346[0m     0.77785    0.98151      0.48280  21.14s
     18     [36m0.74830[0m     0.75245    0.99448      0.48964  21.43s
     19     [36m0.72509[0m     0.77213    0.93908      0.47499  21.30s
     20     [36m0.70513[0m     [32m0.73758[0m    0.95601      0.48414  21.34s
     21     [36m0.70342[0m     0.83150    0.84597      0.58356  21.16s
     22     [36m0.69223[0m     [32m0.72022[0m    0.96114      0.51316  21.23s
     23     [36m0.68498[0m     0.73887    0.92707      0.56690  21.39s
     24     [36m0.67595[0m     0.80607    0.83856      0.57073  21.47s
     25     [36m0.66520[0m     [32m0.70202[0m    0.94755      0.54726  21.27s
     26     [36m0.65899[0m     0.71370    0.92334      0.51196  21.41s
     27     0.66426     0.73714    0.90114      0.47677  21.62s
     28     [36m0.65751[0m     0.71690    0.91716      0.50161  21.37s
     29     [36m0.65210[0m     0.72819    0.89551      0.52279  21.32s
     30     0.65946     0.71068    0.92792      0.51881  21.38s
     31     [36m0.65016[0m     0.73008    0.89053      0.57555  21.34s
     32     [36m0.63975[0m     0.74635    0.85717      0.48378  21.38s
     33     0.65508     0.71282    0.91900      0.50772  21.34s
     34     [36m0.63638[0m     0.75765    0.83994      0.59263  21.25s
     35     0.65400     0.79006    0.82778      0.59283  21.24s
     36     0.65982     [32m0.69564[0m    0.94851      0.51097  21.19s
     37     0.65725     0.71942    0.91359      0.49405  21.38s
     38     0.63827     0.83347    0.76581      0.57919  21.28s
     39     [36m0.63629[0m     0.71200    0.89367      0.57317  21.34s
     40     [36m0.63440[0m     0.80157    0.79145      0.58216  21.23s
     41     0.65048     0.70031    0.92885      0.49280  21.28s
     42     0.63659     0.74095    0.85915      0.48171  21.26s
     43     0.65496     0.72136    0.90795      0.57619  21.25s
     44     0.63973     [32m0.68390[0m    0.93541      0.53200  21.20s
     45     0.63718     0.70642    0.90199      0.51001  21.24s
     46     0.65780     0.79529    0.82713      0.57903  21.39s
     47     0.64986     0.69877    0.93000      0.52596  21.27s
     48     0.65136     0.72740    0.89547      0.53058  21.21s
     49     [36m0.62338[0m     0.75031    0.83083      0.55324  21.24s
     50     0.62989     0.68592    0.91832      0.53744  21.20s
     51     0.71897     0.82324    0.87335      0.59488  21.34s
     52     [36m0.62272[0m     0.74567    0.83511      0.53209  21.29s
     53     0.67762     0.70986    0.95458      0.56022  21.13s
     54     0.62488     0.88064    0.70957      0.59145  21.10s
Early stopping.
Best valid loss was 0.683896 at epoch 44.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[ 0.51816142  0.0817444   0.56574303  0.50661433  0.4975386   0.13196845
  0.66597468  0.37866682  0.45331433  0.07027044  0.44771498  0.35088387
  0.30348459  0.09537876  0.39308417  0.3522675   0.31922212  0.09118292
  0.29524541  0.24074671  0.21670128  0.05751013  0.54790115  0.36609074
  0.27390808  0.06655769  0.376968    0.21694648  0.42107937  0.03207346]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.402036509444
Error rate (%):  59.7963490556
[[34269 54426]
 [ 2243  3832]]
(94770,)
(94770,)
roc_auc: 0.520263796703
log_loss: inf
roc_auc for the hours: 0.482191780822
log_loss for the hours: 1.59034567965
saving predictions to csv file
hourspatient1_2_net29_10-23-23-43-50.csv
Accuracy validation for the hours:  0.333333333333
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [2]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.124913152
saving predictions to csv file
patient1_2_net29_10-23-23-56-49.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config6.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_3']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config6.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_3'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-23 23:56:50.743187
Hostname: kat
gpu3
Configuration 'config6.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net29
evaluation:
    online_training: False
    model: net29

end Configuration
['patient1_3']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [3]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.83830784
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 19.1249866486 16.0321680069
20 110.960594177 117.977423096
30 462.367929077 465.247445679
40 726.516931152 722.714147949
50 983.638244629 972.796356201
60 1269.06445312 1248.00100098
70 1619.77319336 1586.1126709
80 2106.37036133 2054.18427734
90 2963.09577637 2880.79763184
100 141686.875 89649.6484375
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net29
Model name for the evaluation phase:  net29
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1    [36m42.66532[0m     [32m3.13652[0m   13.60275      0.43792  18.62s
      2     [36m3.83587[0m     3.19680    1.19991      0.44608  21.17s
      3     [36m2.54752[0m     [32m1.84275[0m    1.38246      0.47976  21.05s
      4     [36m1.96224[0m     [32m1.72523[0m    1.13738      0.41983  21.13s
      5     [36m1.56337[0m     [32m1.39571[0m    1.12012      0.41822  21.07s
      6     [36m1.29107[0m     [32m1.04132[0m    1.23984      0.42961  21.10s
      7     [36m1.15613[0m     [32m1.03352[0m    1.11863      0.43414  21.26s
      8     [36m1.04001[0m     1.12523    0.92427      0.42141  21.03s
      9     [36m0.93011[0m     [32m1.03210[0m    0.90118      0.42154  21.21s
     10     0.93337     2.32296    0.40180      0.45364  21.03s
     11     [36m0.89311[0m     [32m0.79926[0m    1.11741      0.48223  21.06s
     12     [36m0.84484[0m     0.94180    0.89705      0.40985  21.03s
     13     [36m0.78967[0m     0.85283    0.92594      0.44871  21.17s
     14     [36m0.78247[0m     1.01518    0.77077      0.51766  21.43s
     15     [36m0.74901[0m     1.01414    0.73857      0.42516  21.12s
     16     [36m0.74056[0m     [32m0.72240[0m    1.02513      0.53569  21.28s
     17     [36m0.71317[0m     0.76550    0.93163      0.54592  21.44s
     18     [36m0.69933[0m     [32m0.71076[0m    0.98393      0.52355  21.51s
     19     [36m0.68320[0m     [32m0.70983[0m    0.96249      0.56063  21.26s
     20     [36m0.63959[0m     0.71485    0.89471      0.48821  21.19s
     21     [36m0.63376[0m     0.71725    0.88361      0.50270  21.28s
     22     [36m0.62722[0m     0.74460    0.84235      0.55034  21.24s
     23     0.63467     0.79895    0.79438      0.50731  21.28s
     24     0.63561     0.74539    0.85272      0.55076  21.22s
     25     [36m0.62476[0m     0.81386    0.76766      0.52254  21.34s
     26     [36m0.62365[0m     0.73498    0.84852      0.54185  21.39s
     27     0.62679     0.75210    0.83338      0.56321  21.59s
     28     0.62861     0.78068    0.80521      0.52684  21.75s
     29     [36m0.61498[0m     0.87318    0.70430      0.54097  21.73s
Early stopping.
Best valid loss was 0.709826 at epoch 19.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[ 0.55307823  0.10360399  0.14195521  0.11769883  0.33439156  0.10620873
  0.19575498  0.12537295  0.40113604  0.02095931  0.48880005  0.02629024
  0.08455475  0.02740698  0.05209148  0.04120952  0.09645948  0.01710762
  0.59900236  0.01825675  0.08461736  0.01385956  0.12894915  0.05682556
  0.23747714  0.02751109  0.09350164  0.07253912  0.43211582  0.09274811]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.315068059513
Error rate (%):  68.4931940487
[[25342 63353]
 [ 1558  4517]]
(94770,)
(94770,)
roc_auc: 0.510862918816
log_loss: inf
roc_auc for the hours: 0.476712328767
log_loss for the hours: 1.37573092198
saving predictions to csv file
hourspatient1_3_net29_10-24-00-29-43.csv
Accuracy validation for the hours:  0.25641025641
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [3]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.074425856
saving predictions to csv file
patient1_3_net29_10-24-00-33-33.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config6.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_4']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config6.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_4'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-24 00:33:35.351192
Hostname: kat
gpu3
Configuration 'config6.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net29
evaluation:
    online_training: False
    model: net29

end Configuration
['patient1_4']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [4]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.838045696
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 235.407817078 219.809516907
20 571.790344238 556.848303223
30 840.501837158 821.775939941
40 1116.47878418 1091.31035156
50 1434.89074707 1400.26373291
60 1840.24331055 1790.55202637
70 2408.61494141 2333.43139648
80 3297.89345703 3176.70976563
90 4956.27602539 4739.19238281
100 52009.53125 38008.9335938
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net29
Model name for the evaluation phase:  net29
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1    [36m61.81414[0m     [32m1.82810[0m   33.81337      0.53259  18.26s
      2     [36m5.48719[0m     2.41315    2.27387      0.52853  20.97s
      3     [36m3.66529[0m     [32m1.48884[0m    2.46185      0.54578  21.21s
      4     [36m2.56675[0m     [32m1.32373[0m    1.93903      0.53301  21.16s
      5     [36m2.10301[0m     [32m1.14432[0m    1.83779      0.52771  21.34s
      6     [36m1.61985[0m     [32m0.88952[0m    1.82103      0.53931  21.21s
      7     [36m1.45281[0m     0.98197    1.47949      0.52232  21.35s
      8     [36m1.25980[0m     [32m0.87509[0m    1.43962      0.53089  21.44s
      9     [36m1.13208[0m     0.94778    1.19445      0.51813  21.55s
     10     [36m1.02144[0m     [32m0.81761[0m    1.24930      0.52933  21.39s
     11     [36m0.96824[0m     [32m0.79596[0m    1.21644      0.53043  21.49s
     12     [36m0.89794[0m     [32m0.74616[0m    1.20342      0.54467  21.43s
     13     [36m0.86038[0m     [32m0.71982[0m    1.19526      0.54750  21.43s
     14     [36m0.82225[0m     [32m0.71857[0m    1.14428      0.55028  21.29s
     15     [36m0.78913[0m     [32m0.69369[0m    1.13759      0.55474  21.38s
     16     [36m0.76415[0m     [32m0.69212[0m    1.10408      0.56046  21.49s
     17     [36m0.76062[0m     0.69788    1.08990      0.56760  21.31s
     18     [36m0.74914[0m     [32m0.68981[0m    1.08602      0.54240  21.36s
     19     [36m0.74392[0m     0.69093    1.07670      0.51495  21.36s
     20     [36m0.72199[0m     0.71107    1.01536      0.56194  21.29s
     21     [36m0.72118[0m     0.70713    1.01986      0.56382  21.56s
     22     0.73464     0.70265    1.04554      0.56174  21.34s
     23     [36m0.70479[0m     0.70413    1.00093      0.56582  21.41s
     24     [36m0.70051[0m     0.79889    0.87685      0.52619  21.68s
     25     [36m0.68973[0m     [32m0.67280[0m    1.02516      0.55785  21.21s
     26     0.69518     0.71494    0.97236      0.56440  21.17s
     27     [36m0.68567[0m     0.68969    0.99417      0.56834  21.28s
     28     [36m0.67912[0m     0.69968    0.97061      0.56361  21.48s
     29     [36m0.67297[0m     0.72491    0.92834      0.56321  21.40s
     30     0.68349     0.86932    0.78623      0.51313  21.42s
     31     0.68313     0.68776    0.99327      0.55397  21.83s
     32     0.69368     0.76657    0.90492      0.48027  21.62s
     33     0.68134     0.75677    0.90033      0.55595  21.72s
     34     0.69212     0.70761    0.97810      0.40926  21.73s
     35     0.68559     0.75198    0.91172      0.55187  21.70s
Early stopping.
Best valid loss was 0.672804 at epoch 25.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[ 0.12913834  0.16468209  0.20802878  0.16117848  0.24057747  0.16131482
  0.29823434  0.11073524  0.31818548  0.07183366  0.36194873  0.1387036
  0.21581776  0.22013852  0.17996925  0.19555792  0.14606191  0.04661819
  0.31284341  0.11705475  0.2031197   0.09913892  0.4806155   0.20174426
  0.3116048   0.10939542  0.50889689  0.08131733  0.31192589  0.10819392]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.587633217263
Error rate (%):  41.2366782737
[[53112 35583]
 [ 3497  2578]]
(94770,)
(94770,)
roc_auc: 0.544059504795
log_loss: 0.855608061653
roc_auc for the hours: 0.53698630137
log_loss for the hours: 0.628434954111
saving predictions to csv file
hourspatient1_4_net29_10-24-01-08-50.csv
Accuracy validation for the hours:  0.666666666667
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [4]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.127940096
saving predictions to csv file
patient1_4_net29_10-24-01-12-36.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config6.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_5']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config6.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_5'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-24 01:12:37.635191
Hostname: kat
gpu3
Configuration 'config6.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net29
evaluation:
    online_training: False
    model: net29

end Configuration
['patient1_5']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [5]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.838336512
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 231.335012817 211.108001709
20 564.578271484 538.999780273
30 830.936474609 795.66987915
40 1104.11230469 1055.32932129
50 1420.78125 1352.56451416
60 1826.70258789 1730.86726074
70 2401.11716309 2262.68579102
80 3287.26503906 3085.56469727
90 4899.46132813 4571.94418945
100 55591.203125 52662.2460938
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net29
Model name for the evaluation phase:  net29
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1    [36m72.37081[0m     [32m3.70835[0m   19.51562      0.51880  18.76s
      2     [36m5.03859[0m     [32m3.02790[0m    1.66406      0.51242  21.50s
      3     [36m3.47640[0m     [32m2.28148[0m    1.52375      0.51426  21.52s
      4     [36m2.61460[0m     [32m1.86011[0m    1.40562      0.51037  21.61s
      5     [36m2.07116[0m     [32m1.22126[0m    1.69592      0.52257  21.42s
      6     [36m1.57325[0m     [32m0.88820[0m    1.77129      0.54526  21.31s
      7     [36m1.41166[0m     1.15772    1.21934      0.51582  21.46s
      8     [36m1.21701[0m     0.91545    1.32942      0.52954  21.41s
      9     [36m1.09226[0m     0.98064    1.11383      0.52300  21.48s
     10     [36m1.01066[0m     0.92287    1.09512      0.52068  21.28s
     11     [36m0.95823[0m     [32m0.79009[0m    1.21282      0.54577  21.39s
     12     [36m0.86734[0m     [32m0.73166[0m    1.18544      0.55360  21.41s
     13     [36m0.83319[0m     [32m0.69365[0m    1.20118      0.54777  21.37s
     14     [36m0.80642[0m     0.70513    1.14365      0.55783  21.48s
     15     [36m0.80500[0m     0.70462    1.14245      0.52948  21.41s
     16     [36m0.76108[0m     [32m0.67861[0m    1.12154      0.55454  21.37s
     17     [36m0.75563[0m     0.68120    1.10927      0.58196  21.35s
     18     [36m0.74684[0m     0.79648    0.93768      0.52086  21.51s
     19     [36m0.72564[0m     [32m0.67447[0m    1.07587      0.57586  21.81s
     20     [36m0.72151[0m     [32m0.67129[0m    1.07481      0.57685  21.66s
     21     [36m0.71005[0m     [32m0.66965[0m    1.06032      0.57274  21.72s
     22     [36m0.69658[0m     0.81108    0.85883      0.48385  21.62s
     23     [36m0.69499[0m     0.79460    0.87464      0.48185  21.74s
     24     [36m0.68674[0m     0.67807    1.01278      0.54563  21.78s
     25     [36m0.67708[0m     0.68943    0.98210      0.57686  21.67s
     26     0.67939     0.67896    1.00064      0.54239  21.61s
     27     [36m0.67535[0m     0.67211    1.00482      0.56942  21.66s
     28     0.68740     0.67677    1.01571      0.57729  21.58s
     29     [36m0.67485[0m     0.67221    1.00393      0.54802  21.63s
     30     0.67639     0.74182    0.91180      0.53694  21.66s
     31     [36m0.66278[0m     0.67131    0.98730      0.57097  21.76s
Early stopping.
Best valid loss was 0.669651 at epoch 21.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[  2.27034670e-05   8.43738148e-04   1.60741256e-04   8.04563460e-05
   3.66817039e-05   1.37669395e-03   3.19520175e-03   1.02645768e-04
   2.28636578e-04   9.02822800e-03   1.38913689e-03   8.26240983e-04
   4.78221365e-04   1.22963320e-02   9.82440310e-04   3.41642677e-04
   1.00800084e-04   1.89688394e-03   2.05173914e-04   3.73807634e-05
   1.94698041e-05   9.14603239e-04   1.00295380e-04   2.05234930e-04
   2.82438239e-04   1.48164073e-03   9.19405196e-04   1.45058249e-04
   8.61487235e-04   6.30646944e-04]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.696612852168
Error rate (%):  30.3387147832
[[63668 25027]
 [ 3725  2350]]
(94770,)
(94770,)
roc_auc: 0.604718341883
log_loss: 0.757424581428
roc_auc for the hours: 0.641095890411
log_loss for the hours: 0.452951360178
saving predictions to csv file
hourspatient1_5_net29_10-24-01-43-13.csv
Accuracy validation for the hours:  0.769230769231
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [5]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.074847744
saving predictions to csv file
patient1_5_net29_10-24-01-47-05.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config6.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_6']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config6.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_6'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-24 01:47:07.060241
Hostname: kat
gpu3
Configuration 'config6.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net29
evaluation:
    online_training: False
    model: net29

end Configuration
['patient1_6']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [6]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.838660096
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 199.270783997 178.304678345
20 484.265484619 454.425598145
30 715.207281494 673.034472656
40 957.550097656 897.335144043
50 1246.79968262 1160.86651611
60 1628.27236328 1502.71569824
70 2172.52145996 1989.60817871
80 3015.20869141 2745.85849609
90 4633.05883789 4178.59511719
100 66751.359375 59361.5703125
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net29
Model name for the evaluation phase:  net29
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1    [36m67.82690[0m     [32m1.95727[0m   34.65388      0.57127  18.80s
      2     [36m4.83570[0m     2.56951    1.88196      0.53235  21.63s
      3     [36m3.40047[0m     [32m1.17682[0m    2.88954      0.57756  21.47s
      4     [36m2.49043[0m     1.30291    1.91145      0.55430  21.71s
      5     [36m2.08835[0m     [32m0.91268[0m    2.28815      0.56988  21.63s
      6     [36m1.55795[0m     [32m0.85259[0m    1.82731      0.57984  21.56s
      7     [36m1.38123[0m     0.88315    1.56397      0.56370  21.66s
      8     [36m1.19598[0m     [32m0.72759[0m    1.64375      0.60027  21.63s
      9     [36m1.08368[0m     [32m0.71120[0m    1.52374      0.60390  21.27s
     10     [36m0.95743[0m     [32m0.65000[0m    1.47297      0.59854  21.38s
     11     [36m0.90574[0m     0.68298    1.32616      0.61901  21.40s
     12     [36m0.86379[0m     [32m0.63490[0m    1.36051      0.60287  21.47s
     13     [36m0.82341[0m     [32m0.63357[0m    1.29964      0.59892  21.25s
     14     [36m0.78652[0m     0.63589    1.23688      0.57293  21.23s
     15     [36m0.76475[0m     0.64543    1.18487      0.53029  21.20s
     16     [36m0.73912[0m     [32m0.62713[0m    1.17857      0.61244  21.40s
     17     [36m0.73403[0m     0.66258    1.10785      0.48253  21.44s
     18     [36m0.72203[0m     0.65319    1.10540      0.50175  21.71s
     19     [36m0.71796[0m     0.63374    1.13290      0.64138  21.89s
     20     [36m0.71085[0m     0.67409    1.05454      0.47249  21.94s
     21     [36m0.68074[0m     0.72640    0.93715      0.57518  21.87s
     22     [36m0.67754[0m     0.67127    1.00934      0.47110  21.83s
     23     0.68895     0.76529    0.90025      0.55038  21.75s
     24     [36m0.66463[0m     0.69256    0.95967      0.59422  21.92s
     25     [36m0.65959[0m     0.69802    0.94494      0.59234  22.00s
     26     [36m0.64668[0m     0.63070    1.02533      0.64484  22.05s
Early stopping.
Best valid loss was 0.627132 at epoch 16.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[ 0.00520253  0.17340189  0.00225827  0.18101424  0.00064545  0.19127868
  0.01644784  0.06209913  0.03085051  0.30070144  0.00724584  0.09576321
  0.00960146  0.19653086  0.00484244  0.29611969  0.0008239   0.05779187
  0.00444626  0.33046952  0.00192676  0.06711932  0.00110398  0.31266508
  0.01606529  0.23831744  0.18968286  0.06234441  0.01995768  0.0289149 ]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.747567795716
Error rate (%):  25.2432204284
[[69017 19678]
 [ 4245  1830]]
(94770,)
(94770,)
roc_auc: 0.656245830663
log_loss: 0.560015800863
roc_auc for the hours: 0.67397260274
log_loss for the hours: 0.360712537337
saving predictions to csv file
hourspatient1_6_net29_10-24-02-15-27.csv
Accuracy validation for the hours:  0.846153846154
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [6]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.128706048
saving predictions to csv file
patient1_6_net29_10-24-02-19-18.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config6.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_7']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config6.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_7'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-24 02:19:19.780239
Hostname: kat
gpu3
Configuration 'config6.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net29
evaluation:
    online_training: False
    model: net29

end Configuration
['patient1_7']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [7]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.838270976
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 182.900706482 163.150218201
20 446.00692749 416.755505371
30 662.357696533 620.480499268
40 892.956396484 834.12010498
50 1172.0982666 1087.89544678
60 1542.81384277 1420.86425781
70 2076.69821777 1899.79864502
80 2929.02983398 2668.57714844
90 4619.13442383 4199.77285156
100 65353.1796875 57503.8945312
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net29
Model name for the evaluation phase:  net29
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1    [36m65.19878[0m     [32m1.74641[0m   37.33295      0.56154  18.84s
      2     [36m4.74575[0m     [32m1.07820[0m    4.40155      0.55610  21.50s
      3     [36m3.28253[0m     [32m0.83137[0m    3.94835      0.58354  21.67s
      4     [36m2.37624[0m     0.83487    2.84624      0.57909  21.82s
      5     [36m1.82251[0m     [32m0.74444[0m    2.44815      0.59232  21.40s
      6     [36m1.43785[0m     [32m0.67625[0m    2.12623      0.58903  21.61s
      7     [36m1.29052[0m     [32m0.67096[0m    1.92339      0.59345  21.54s
      8     [36m1.11538[0m     [32m0.65345[0m    1.70691      0.59946  21.67s
      9     [36m0.98420[0m     0.67983    1.44771      0.54383  21.47s
     10     [36m0.88550[0m     [32m0.64181[0m    1.37968      0.56691  21.49s
     11     [36m0.84857[0m     [32m0.63359[0m    1.33931      0.57351  21.28s
     12     [36m0.79904[0m     0.65975    1.21112      0.55143  21.48s
     13     [36m0.76604[0m     0.66401    1.15366      0.55751  21.43s
     14     [36m0.73633[0m     0.67210    1.09557      0.54786  21.60s
     15     [36m0.72616[0m     0.77795    0.93344      0.49552  21.30s
     16     [36m0.69398[0m     0.68065    1.01959      0.54053  21.41s
     17     [36m0.68881[0m     0.70216    0.98099      0.52560  21.49s
     18     [36m0.67930[0m     0.64364    1.05540      0.55989  21.63s
     19     [36m0.66469[0m     0.65274    1.01831      0.54568  21.29s
     20     [36m0.66009[0m     0.74646    0.88430      0.50149  21.45s
     21     [36m0.65767[0m     0.67856    0.96921      0.52893  21.27s
     22     0.66184     [32m0.61493[0m    1.07629      0.63148  21.39s
     23     [36m0.64858[0m     [32m0.60857[0m    1.06575      0.63841  21.45s
     24     [36m0.63844[0m     0.61366    1.04037      0.67711  21.46s
     25     [36m0.63457[0m     0.61428    1.03304      0.67735  21.60s
     26     [36m0.62488[0m     0.62054    1.00700      0.58886  21.32s
     27     [36m0.62363[0m     0.60966    1.02291      0.67612  21.24s
     28     [36m0.62254[0m     0.62071    1.00295      0.58078  21.20s
     29     0.66789     0.62431    1.06979      0.58492  21.19s
     30     [36m0.61706[0m     0.63483    0.97201      0.63978  21.44s
     31     [36m0.61288[0m     0.61055    1.00382      0.63761  21.73s
     32     0.64949     0.61311    1.05932      0.65973  21.47s
     33     [36m0.60936[0m     0.61050    0.99813      0.64373  21.80s
     34     [36m0.60814[0m     [32m0.60790[0m    1.00039      0.66387  21.87s
     35     [36m0.60672[0m     0.61300    0.98974      0.65481  21.93s
     36     0.61402     [32m0.60347[0m    1.01748      0.66775  21.52s
     37     0.61325     0.61104    1.00361      0.66495  21.74s
     38     [36m0.60650[0m     0.61897    0.97985      0.65988  21.89s
     39     0.63290     0.61125    1.03542      0.66450  21.67s
     40     [36m0.59859[0m     0.61259    0.97715      0.66622  21.73s
     41     0.59915     0.61131    0.98011      0.66295  21.49s
     42     [36m0.59632[0m     0.61714    0.96626      0.66161  21.58s
     43     0.61927     0.63609    0.97355      0.63693  21.50s
     44     0.59731     0.62172    0.96074      0.65022  21.55s
     45     0.63414     0.61846    1.02536      0.66685  21.59s
     46     0.60951     0.64581    0.94380      0.63956  21.76s
Early stopping.
Best valid loss was 0.603473 at epoch 36.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[  2.27052842e-05   2.63573835e-04   2.76543760e-05   3.67316126e-04
   1.02157119e-05   3.74689524e-04   2.57968000e-04   2.28389938e-04
   2.18146379e-04   8.20504210e-04   2.70001736e-04   2.16467935e-03
   8.40409892e-04   1.46547006e-03   1.08931796e-03   4.19175113e-03
   1.57860180e-04   2.47808639e-03   2.57707463e-04   1.52557052e-03
   1.06896019e-04   5.78007940e-03   6.38402009e-04   2.69900262e-03
   5.45041694e-04   2.72569666e-03   1.11244794e-03   7.53992610e-03
   1.49483746e-03   1.97611633e-03]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.79894481376
Error rate (%):  20.105518624
[[73877 14818]
 [ 4236  1839]]
(94770,)
(94770,)
roc_auc: 0.695252715356
log_loss: 0.497107508581
roc_auc for the hours: 0.657534246575
log_loss for the hours: 0.296194814434
saving predictions to csv file
hourspatient1_7_net29_10-24-02-55-40.csv
Accuracy validation for the hours:  0.897435897436
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [7]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.074245632
saving predictions to csv file
patient1_7_net29_10-24-02-59-21.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config6.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_8']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config6.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_8'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-24 02:59:22.284889
Hostname: kat
gpu3
Configuration 'config6.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net29
evaluation:
    online_training: False
    model: net29

end Configuration
['patient1_8']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [8]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.838008832
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 179.447947693 164.423493958
20 434.278393555 418.093994141
30 634.319030762 613.24385376
40 834.442565918 807.11171875
50 1056.00579834 1020.13357544
60 1321.37426758 1274.3189209
70 1666.15869141 1603.34324951
80 2169.84814453 2082.13676758
90 3113.30068359 2981.24484863
100 59862.1054688 57871.4179688
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net29
Model name for the evaluation phase:  net29
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1    [36m49.12284[0m     [32m1.02915[0m   47.73160      0.56072  18.42s
      2     [36m3.51080[0m     1.30004    2.70052      0.59487  21.53s
      3     [36m2.41198[0m     [32m0.93945[0m    2.56743      0.60147  21.35s
      4     [36m1.90054[0m     [32m0.68184[0m    2.78738      0.59310  21.36s
      5     [36m1.51050[0m     0.70828    2.13264      0.60503  21.31s
      6     [36m1.32378[0m     0.69088    1.91607      0.61173  21.52s
      7     [36m1.11523[0m     [32m0.64388[0m    1.73203      0.60968  21.45s
      8     [36m1.00341[0m     0.64565    1.55411      0.61192  21.55s
      9     [36m0.93039[0m     0.64792    1.43597      0.58604  21.47s
     10     [36m0.85706[0m     [32m0.64204[0m    1.33491      0.60368  21.50s
     11     [36m0.81816[0m     0.64520    1.26806      0.58239  21.54s
     12     [36m0.78675[0m     0.65958    1.19281      0.54575  21.61s
     13     [36m0.76116[0m     0.69174    1.10036      0.49310  21.56s
     14     [36m0.73751[0m     0.68662    1.07411      0.50688  21.27s
     15     [36m0.72253[0m     0.82589    0.87485      0.49688  21.09s
     16     [36m0.69463[0m     0.67652    1.02677      0.51953  21.10s
     17     [36m0.68643[0m     0.67094    1.02308      0.51693  21.20s
     18     [36m0.68027[0m     0.85402    0.79655      0.49448  21.29s
     19     [36m0.67487[0m     [32m0.63915[0m    1.05589      0.62289  21.16s
     20     [36m0.66059[0m     0.78269    0.84400      0.48983  21.02s
     21     0.66202     0.65845    1.00541      0.54002  20.99s
     22     [36m0.65217[0m     [32m0.63335[0m    1.02972      0.63772  21.17s
     23     [36m0.64359[0m     0.63621    1.01160      0.63705  21.31s
     24     [36m0.63684[0m     0.63992    0.99518      0.61690  21.47s
     25     0.63767     0.73279    0.87020      0.58745  21.41s
     26     [36m0.63136[0m     0.64018    0.98622      0.61658  21.17s
     27     0.63243     0.72616    0.87092      0.58671  21.18s
     28     [36m0.62859[0m     0.63916    0.98346      0.62426  21.35s
     29     [36m0.62686[0m     [32m0.62874[0m    0.99701      0.63755  21.19s
     30     0.62751     0.73690    0.85155      0.57267  21.16s
     31     0.63993     0.64679    0.98940      0.56449  21.22s
     32     [36m0.61942[0m     0.78591    0.78815      0.57054  21.16s
     33     0.62975     [32m0.62055[0m    1.01483      0.62612  21.14s
     34     [36m0.61778[0m     0.75707    0.81602      0.58749  21.14s
     35     [36m0.61659[0m     0.64770    0.95197      0.62679  21.09s
     36     [36m0.60959[0m     0.79372    0.76802      0.58516  21.23s
     37     0.64016     0.74265    0.86199      0.58761  21.24s
     38     0.62238     0.79882    0.77912      0.57946  21.09s
     39     0.61206     0.66683    0.91787      0.60894  21.46s
     40     [36m0.60847[0m     0.66917    0.90929      0.60892  21.30s
     41     0.60965     0.66215    0.92071      0.60913  20.99s
     42     0.61264     0.71100    0.86165      0.59957  21.21s
     43     [36m0.59903[0m     0.66965    0.89454      0.61795  21.35s
Early stopping.
Best valid loss was 0.620548 at epoch 33.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[ 0.05192894  0.15919898  0.15813844  0.05599654  0.04314772  0.11145261
  0.1725063   0.03573328  0.06538564  0.09176465  0.36681455  0.10563055
  0.10769144  0.46888131  0.49959871  0.16702145  0.25959498  0.26984698
  0.46550635  0.35496721  0.25172472  0.44246808  0.76842076  0.42930114
  0.35111672  0.79322553  0.81226456  0.53288567  0.5146693   0.75915796]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.43915796138
Error rate (%):  56.084203862
[[36849 51846]
 [ 1305  4770]]
(94770,)
(94770,)
roc_auc: 0.649016994245
log_loss: 2.17461954911
roc_auc for the hours: 0.671232876712
log_loss for the hours: 1.27906341145
saving predictions to csv file
hourspatient1_8_net29_10-24-03-39-40.csv
Accuracy validation for the hours:  0.423076923077
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [8]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.127899136
saving predictions to csv file
patient1_8_net29_10-24-03-43-39.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config6.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_9']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config6.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_9'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-24 03:43:41.312809
Hostname: kat
gpu3
Configuration 'config6.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net29
evaluation:
    online_training: False
    model: net29

end Configuration
['patient1_9']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [9]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.837988352
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 3.68383948803 3.51945617199
20 8.91916770935 8.73870506287
30 13.5332503319 13.2244482994
40 19.6162849426 18.9431503296
50 42.7269630432 33.8711013794
60 446.623547363 383.009014893
70 778.942749023 709.81932373
80 1201.11340332 1105.85910645
90 1927.03088379 1777.32213135
100 43853.8789062 40357.3945312
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net29
Model name for the evaluation phase:  net29
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1    [36m39.13912[0m     [32m0.72059[0m   54.31537      0.56397  18.38s
      2     [36m2.90143[0m     0.93345    3.10828      0.47748  21.21s
      3     [36m2.07849[0m     0.94533    2.19869      0.45911  21.31s
      4     [36m1.68734[0m     1.14613    1.47220      0.45055  21.27s
      5     1.79795     0.94404    1.90453      0.44931  21.28s
      6     [36m1.39460[0m     0.74670    1.86768      0.46069  21.26s
      7     [36m0.99540[0m     0.79424    1.25328      0.44685  21.24s
      8     [36m0.91701[0m     0.75999    1.20660      0.44336  21.22s
      9     [36m0.88081[0m     0.75194    1.17139      0.44535  21.21s
     10     [36m0.83063[0m     0.73935    1.12347      0.44526  21.18s
     11     [36m0.82147[0m     [32m0.71596[0m    1.14737      0.44777  21.29s
     12     [36m0.80302[0m     [32m0.70911[0m    1.13243      0.45154  21.18s
     13     [36m0.79236[0m     0.72361    1.09501      0.43897  21.25s
     14     [36m0.76289[0m     [32m0.69150[0m    1.10324      0.50903  21.26s
     15     0.76415     0.70912    1.07761      0.44309  21.34s
     16     [36m0.73903[0m     0.69620    1.06153      0.48047  21.38s
     17     [36m0.72097[0m     [32m0.69096[0m    1.04343      0.52452  21.03s
     18     0.72593     [32m0.68985[0m    1.05231      0.51682  21.29s
     19     [36m0.72054[0m     0.71118    1.01315      0.51577  21.42s
     20     [36m0.70273[0m     0.69207    1.01541      0.50529  21.61s
     21     [36m0.70216[0m     0.69815    1.00574      0.48567  21.56s
     22     0.79130     0.80856    0.97866      0.52673  21.79s
     23     1.55956     1.76173    0.88524      0.50163  21.58s
     24     6.39372     1.06094    6.02649      0.48623  21.24s
     25     1.98339     [32m0.65938[0m    3.00795      0.53531  21.56s
     26     0.70468     0.67226    1.04822      0.54484  21.62s
     27     [36m0.68592[0m     0.67905    1.01012      0.53782  21.62s
     28     [36m0.68392[0m     0.68276    1.00170      0.53570  21.21s
     29     [36m0.68215[0m     0.68328    0.99833      0.53717  21.48s
     30     0.68256     0.68204    1.00077      0.54181  21.46s
     31     [36m0.68124[0m     0.68543    0.99388      0.53157  21.42s
     32     [36m0.68047[0m     0.68573    0.99233      0.52595  21.29s
     33     [36m0.67941[0m     0.68389    0.99344      0.53183  21.53s
     34     [36m0.67761[0m     0.68583    0.98802      0.52384  21.70s
     35     [36m0.67751[0m     0.68655    0.98683      0.51900  21.44s
Early stopping.
Best valid loss was 0.659384 at epoch 25.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[ 0.97789532  0.99594361  0.9967097   0.99279433  0.97144228  0.99601656
  0.98461401  0.99177164  0.93101996  0.98932087  0.9940632   0.99660385
  0.95639461  0.99132335  0.99651223  0.97412688  0.95775747  0.99463499
  0.99497223  0.99198157  0.89681822  0.99347395  0.99220008  0.97977692
  0.93314004  0.98628092  0.99529451  0.99197197  0.97368252  0.98960096]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.162034399071
Error rate (%):  83.7965600929
[[ 9283 79412]
 [    2  6073]]
(94770,)
(94770,)
roc_auc: 0.677999039108
log_loss: 1.68131712478
roc_auc for the hours: 0.72602739726
log_loss for the hours: 1.36358538511
saving predictions to csv file
hourspatient1_9_net29_10-24-04-17-24.csv
Accuracy validation for the hours:  0.153846153846
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [9]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.128148992
saving predictions to csv file
patient1_9_net29_10-24-04-21-04.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config6.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_10']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config6.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_10'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-24 04:21:06.463774
Hostname: kat
gpu3
Configuration 'config6.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net29
evaluation:
    online_training: False
    model: net29

end Configuration
['patient1_10']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [10]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.838045696
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 181.207902527 167.670619202
20 438.332196045 424.686590576
30 639.719543457 622.390942383
40 839.969042969 817.731738281
50 1060.19781494 1030.7331543
60 1320.43032227 1280.04846191
70 1650.03087158 1595.78609619
80 2111.48989258 2038.48054199
90 2911.55273438 2807.46408691
100 41643.4882812 36225.46875
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net29
Model name for the evaluation phase:  net29
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1    [36m38.03772[0m     [32m1.10325[0m   34.47795      0.52827  19.13s
      2     [36m3.49321[0m     1.12486    3.10547      0.57194  21.21s
      3     [36m2.29942[0m     [32m1.00121[0m    2.29663      0.56452  21.06s
      4     [36m1.77173[0m     [32m0.72519[0m    2.44313      0.53517  21.30s
      5     [36m1.34854[0m     0.88520    1.52343      0.56231  21.06s
      6     [36m1.18469[0m     [32m0.72501[0m    1.63403      0.54931  21.26s
      7     [36m1.03707[0m     [32m0.69490[0m    1.49240      0.54260  21.43s
      8     [36m0.96105[0m     0.69824    1.37639      0.53171  21.35s
      9     [36m0.87215[0m     [32m0.69232[0m    1.25975      0.51569  21.59s
     10     [36m0.80492[0m     0.70174    1.14704      0.50770  21.85s
     11     [36m0.77794[0m     0.69606    1.11764      0.55520  21.74s
     12     [36m0.75825[0m     0.71576    1.05937      0.44396  21.76s
     13     [36m0.73042[0m     0.74008    0.98695      0.44114  21.63s
     14     [36m0.69946[0m     0.72321    0.96716      0.46239  21.56s
     15     [36m0.69731[0m     0.73676    0.94646      0.45667  21.32s
     16     [36m0.67791[0m     0.72757    0.93174      0.46728  21.20s
     17     [36m0.66086[0m     0.70692    0.93485      0.47033  21.30s
     18     0.66488     0.71759    0.92654      0.44603  21.59s
     19     [36m0.64901[0m     0.73314    0.88524      0.45922  21.60s
Early stopping.
Best valid loss was 0.692319 at epoch 9.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[ 0.49184299  0.88504678  0.86176193  0.96648425  0.31952932  0.08510082
  0.8244884   0.44382265  0.97520089  0.86104876  0.98347765  0.9631291
  0.95044547  0.89982772  0.97475988  0.99513501  0.90842265  0.98612833
  0.98177403  0.99876022  0.93455589  0.99224609  0.99989605  0.99784136
  0.94640505  0.99775082  0.99850249  0.99278086  0.90309805  0.99155855]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.471383349161
Error rate (%):  52.8616650839
[[41544 47151]
 [ 2946  3129]]
(94770,)
(94770,)
roc_auc: 0.507724770953
log_loss: 1.85865497942
roc_auc for the hours: 0.487671232877
log_loss for the hours: 0.94463404545
saving predictions to csv file
hourspatient1_10_net29_10-24-04-47-37.csv
Accuracy validation for the hours:  0.461538461538
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [10]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.07419648
saving predictions to csv file
patient1_10_net29_10-24-04-51-12.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config6.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_11']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config6.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_11'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-24 04:51:13.776251
Hostname: kat
gpu3
Configuration 'config6.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net29
evaluation:
    online_training: False
    model: net29

end Configuration
['patient1_11']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [11]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.838012928
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 172.641601563 159.5427948
20 417.636303711 403.23772583
30 608.427856445 589.179815674
40 796.191516113 769.670605469
50 999.883514404 964.325683594
60 1236.0432373 1189.17692871
70 1532.10228271 1470.09255371
80 1945.44143066 1860.52646484
90 2669.32939453 2545.69404297
100 34311.5273438 30092.4199219
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net29
Model name for the evaluation phase:  net29
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1    [36m36.25029[0m     [32m1.53658[0m   23.59147      0.45469  18.49s
      2     [36m3.06625[0m     2.28835    1.33994      0.54436  21.14s
      3     [36m2.17699[0m     1.95397    1.11414      0.54224  21.10s
      4     [36m1.62380[0m     [32m1.41232[0m    1.14974      0.54217  21.27s
      5     [36m1.32119[0m     [32m1.15472[0m    1.14416      0.54745  21.33s
      6     [36m1.07255[0m     1.22310    0.87691      0.54148  21.41s
      7     [36m0.97274[0m     1.17572    0.82736      0.53990  21.68s
      8     [36m0.89373[0m     [32m1.01028[0m    0.88463      0.54905  21.38s
      9     [36m0.80422[0m     1.01077    0.79565      0.55519  21.42s
     10     [36m0.76176[0m     [32m0.85938[0m    0.88640      0.56880  21.17s
     11     [36m0.73077[0m     0.88421    0.82647      0.56893  21.42s
     12     [36m0.70126[0m     [32m0.79984[0m    0.87675      0.57932  21.21s
     13     [36m0.67161[0m     0.82083    0.81821      0.57808  21.31s
     14     [36m0.66224[0m     0.80500    0.82266      0.57590  21.39s
     15     [36m0.65045[0m     [32m0.78524[0m    0.82836      0.57675  21.40s
     16     [36m0.62504[0m     [32m0.78473[0m    0.79650      0.58363  21.39s
     17     [36m0.62319[0m     [32m0.78079[0m    0.79816      0.57437  21.98s
     18     [36m0.60454[0m     0.80985    0.74648      0.58223  21.58s
     19     [36m0.60412[0m     0.79632    0.75864      0.58891  21.64s
     20     [36m0.59647[0m     [32m0.77848[0m    0.76620      0.57251  21.76s
     21     [36m0.58631[0m     0.83616    0.70119      0.59005  21.62s
     22     [36m0.57634[0m     0.79307    0.72672      0.50204  21.70s
     23     [36m0.57020[0m     0.79636    0.71601      0.57042  21.89s
     24     [36m0.56647[0m     0.80426    0.70433      0.46868  21.90s
     25     [36m0.56544[0m     0.78737    0.71813      0.53558  21.93s
     26     [36m0.55993[0m     0.80734    0.69355      0.58913  21.79s
     27     [36m0.55840[0m     0.79151    0.70548      0.57428  21.64s
     28     [36m0.55202[0m     0.81297    0.67902      0.58508  21.60s
     29     0.55244     0.80162    0.68915      0.57081  21.71s
     30     0.55686     0.78680    0.70776      0.51664  21.92s
Early stopping.
Best valid loss was 0.778479 at epoch 20.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[ 0.99426234  0.99957758  0.95023197  0.99815077  0.91328913  0.99623448
  0.85710227  0.99349856  0.93079776  0.9972474   0.98800141  0.99893242
  0.93490219  0.99691677  0.79175317  0.99736613  0.85552329  0.99973255
  0.91033602  0.99324155  0.95436066  0.99977893  0.98124552  0.9991774
  0.97962773  0.99984431  0.9985196   0.99993563  0.99139869  0.99992251]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.398227287116
Error rate (%):  60.1772712884
[[33546 55149]
 [ 1881  4194]]
(94770,)
(94770,)
roc_auc: 0.469502883721
log_loss: inf
roc_auc for the hours: 0.515068493151
log_loss for the hours: 1.91069935918
saving predictions to csv file
hourspatient1_11_net29_10-24-05-21-27.csv
Accuracy validation for the hours:  0.448717948718
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [11]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.074253824
saving predictions to csv file
patient1_11_net29_10-24-05-25-02.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config6.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_12']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config6.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_12'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-24 05:25:04.438047
Hostname: kat
gpu3
Configuration 'config6.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net29
evaluation:
    online_training: False
    model: net29

end Configuration
['patient1_12']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [12]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.838299648
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 194.413856506 178.851933289
20 463.675524902 446.537554932
30 666.165478516 644.010736084
40 859.942541504 831.373522949
50 1065.9508667 1029.34899902
60 1304.29125977 1256.71569824
70 1606.91943359 1543.18864746
80 2047.88012695 1958.46350098
90 2871.70686035 2742.33198242
100 68176.640625 59867.6914062
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net29
Model name for the evaluation phase:  net29
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1    [36m41.72663[0m     [32m3.24817[0m   12.84619      0.56018  18.71s
      2     [36m3.15667[0m     [32m2.83954[0m    1.11168      0.55774  21.37s
      3     [36m2.14376[0m     [32m1.98664[0m    1.07909      0.55474  21.20s
      4     [36m1.68141[0m     [32m1.27057[0m    1.32335      0.56050  21.32s
      5     [36m1.31247[0m     [32m1.15635[0m    1.13500      0.55339  21.17s
      6     [36m1.12555[0m     [32m1.07646[0m    1.04560      0.55607  21.28s
      7     [36m1.06540[0m     [32m0.94760[0m    1.12432      0.55342  21.24s
      8     [36m0.95535[0m     [32m0.86733[0m    1.10149      0.55718  21.45s
      9     [36m0.85721[0m     [32m0.76329[0m    1.12306      0.56899  21.33s
     10     [36m0.79189[0m     0.82061    0.96500      0.55988  21.45s
     11     [36m0.77102[0m     0.82718    0.93211      0.56166  21.33s
     12     [36m0.74118[0m     [32m0.74987[0m    0.98842      0.56605  21.29s
     13     [36m0.71193[0m     [32m0.73758[0m    0.96523      0.57240  21.29s
     14     [36m0.70005[0m     0.81082    0.86338      0.56107  21.37s
     15     [36m0.68695[0m     0.83637    0.82135      0.55610  21.25s
     16     [36m0.66985[0m     0.75422    0.88814      0.56208  21.20s
     17     [36m0.65530[0m     0.77833    0.84192      0.58819  21.23s
     18     [36m0.64766[0m     0.77810    0.83236      0.56689  21.23s
     19     [36m0.64462[0m     0.89427    0.72083      0.55030  21.18s
     20     [36m0.63882[0m     0.82245    0.77672      0.55571  21.21s
     21     [36m0.63105[0m     0.86553    0.72910      0.55219  21.33s
     22     [36m0.62300[0m     [32m0.70166[0m    0.88790      0.58046  21.30s
     23     [36m0.62246[0m     [32m0.69381[0m    0.89716      0.60970  21.22s
     24     [36m0.61265[0m     0.72333    0.84698      0.57748  21.24s
     25     [36m0.61001[0m     0.71849    0.84902      0.58800  21.37s
     26     [36m0.60163[0m     0.80726    0.74528      0.55516  21.31s
     27     0.60600     0.73730    0.82192      0.58239  21.28s
     28     [36m0.60026[0m     0.70394    0.85272      0.58776  21.31s
     29     [36m0.59998[0m     0.73087    0.82091      0.59387  21.16s
     30     0.60330     [32m0.67516[0m    0.89357      0.60000  21.22s
     31     [36m0.59638[0m     0.73515    0.81124      0.57609  21.54s
     32     0.59730     0.68437    0.87277      0.61459  21.59s
     33     [36m0.59401[0m     0.77019    0.77125      0.57410  21.45s
     34     0.59877     [32m0.67374[0m    0.88873      0.61105  21.36s
     35     0.59687     0.72982    0.81782      0.57666  21.31s
     36     0.59647     0.69128    0.86285      0.59112  21.30s
     37     0.59805     [32m0.66567[0m    0.89841      0.61574  21.44s
     38     0.59917     0.70096    0.85479      0.59277  21.24s
     39     [36m0.59092[0m     0.68523    0.86236      0.60108  20.98s
     40     0.59864     [32m0.65675[0m    0.91152      0.62541  20.92s
     41     [36m0.57852[0m     0.67307    0.85953      0.61294  20.90s
     42     0.58028     0.67502    0.85965      0.62639  20.98s
     43     0.57897     0.66784    0.86692      0.62690  20.96s
     44     0.58319     0.75168    0.77585      0.58785  20.97s
     45     0.61641     0.68424    0.90087      0.60195  20.97s
     46     [36m0.57616[0m     0.67224    0.85708      0.62280  20.99s
     47     [36m0.56976[0m     0.67036    0.84992      0.62626  20.98s
     48     0.58459     0.67395    0.86741      0.63056  20.97s
     49     [36m0.56382[0m     0.69236    0.81434      0.62774  20.98s
     50     0.56736     0.73081    0.77634      0.59854  21.03s
Early stopping.
Best valid loss was 0.656746 at epoch 40.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[ 0.93975198  0.93184763  0.90186733  0.95836556  0.94545317  0.92572957
  0.9129895   0.92977607  0.84558022  0.88561469  0.85796529  0.90010929
  0.85885996  0.91617227  0.90166384  0.90286642  0.9133997   0.8884511
  0.89317459  0.82299721  0.87664199  0.90750188  0.92564714  0.87107861
  0.87289751  0.91939908  0.81039792  0.80257833  0.87127537  0.84854865]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.692550385143
Error rate (%):  30.7449614857
[[63068 25627]
 [ 3510  2565]]
(94770,)
(94770,)
roc_auc: 0.636507164586
log_loss: inf
roc_auc for the hours: 0.682191780822
log_loss for the hours: 0.444114955432
saving predictions to csv file
hourspatient1_12_net29_10-24-06-01-20.csv
Accuracy validation for the hours:  0.769230769231
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [12]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.128083456
saving predictions to csv file
patient1_12_net29_10-24-06-04-33.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config6.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_13']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config6.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_13'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-24 06:04:34.278077
Hostname: kat
gpu3
Configuration 'config6.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net29
evaluation:
    online_training: False
    model: net29

end Configuration
['patient1_13']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [13]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.838037504
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 197.41583252 182.761578369
20 473.741113281 459.648413086
30 683.193365479 665.443499756
40 884.565112305 862.165649414
50 1098.331604 1068.85339355
60 1343.71057129 1304.4578125
70 1651.5090332 1598.25623779
80 2090.38417969 2016.00366211
90 2902.72646484 2791.59272461
100 37327.25 36955.34375
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net29
Model name for the evaluation phase:  net29
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1    [36m38.27692[0m     [32m1.94273[0m   19.70266      0.56884  18.04s
      2     [36m3.16750[0m     2.06263    1.53566      0.55091  20.44s
      3     [36m2.26515[0m     [32m1.48621[0m    1.52411      0.55094  20.87s
      4     [36m1.67743[0m     [32m1.07852[0m    1.55532      0.56292  20.94s
      5     [36m1.36114[0m     1.32159    1.02993      0.53906  20.85s
      6     [36m1.12206[0m     [32m0.94182[0m    1.19137      0.56174  20.88s
      7     [36m1.06292[0m     1.01645    1.04572      0.55153  20.91s
      8     [36m0.95056[0m     [32m0.91566[0m    1.03811      0.55285  20.91s
      9     [36m0.86664[0m     [32m0.77932[0m    1.11205      0.57495  20.88s
     10     [36m0.81169[0m     0.83674    0.97007      0.55312  20.84s
     11     [36m0.76560[0m     [32m0.76294[0m    1.00349      0.57108  20.89s
     12     [36m0.74453[0m     [32m0.67788[0m    1.09832      0.59069  20.89s
     13     [36m0.71601[0m     0.70657    1.01335      0.58674  20.85s
     14     0.71656     [32m0.66927[0m    1.07066      0.59396  20.87s
     15     [36m0.68795[0m     0.70646    0.97380      0.58571  20.89s
     16     [36m0.67006[0m     0.69092    0.96981      0.58928  20.84s
     17     [36m0.65951[0m     0.74257    0.88815      0.58223  20.84s
     18     0.66057     0.87409    0.75573      0.54320  20.85s
     19     [36m0.65101[0m     0.68461    0.95093      0.59570  20.86s
     20     [36m0.64032[0m     0.67044    0.95508      0.60667  20.87s
     21     [36m0.63905[0m     0.67919    0.94091      0.59383  20.84s
     22     [36m0.62604[0m     0.74191    0.84383      0.57992  20.85s
     23     [36m0.62005[0m     [32m0.63741[0m    0.97276      0.62622  20.84s
     24     0.62108     0.66757    0.93036      0.60988  20.89s
     25     [36m0.60526[0m     0.71242    0.84959      0.59560  20.90s
     26     [36m0.60445[0m     0.69101    0.87474      0.59484  20.86s
     27     [36m0.59762[0m     0.75819    0.78822      0.58077  20.89s
     28     0.60169     0.75855    0.79321      0.58374  20.92s
     29     [36m0.59399[0m     0.80147    0.74113      0.58112  20.84s
     30     0.61662     0.89081    0.69220      0.56509  20.90s
     31     [36m0.59317[0m     0.90021    0.65892      0.55909  20.91s
     32     [36m0.58954[0m     0.73762    0.79925      0.58946  20.87s
     33     [36m0.58631[0m     0.65515    0.89492      0.60824  20.93s
Early stopping.
Best valid loss was 0.637412 at epoch 23.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[ 0.99405789  0.99177915  0.98276883  0.98378319  0.96135306  0.98598504
  0.96686572  0.98270595  0.97345442  0.99068439  0.99509239  0.96802777
  0.95545995  0.97364819  0.92875016  0.98423773  0.93772119  0.98915088
  0.97803336  0.98653227  0.98517531  0.98969686  0.97868812  0.98969275
  0.98455739  0.98895043  0.9893952   0.99377668  0.98977774  0.99691188]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.54354753614
Error rate (%):  45.645246386
[[46966 41729]
 [ 1529  4546]]
(94770,)
(94770,)
roc_auc: 0.700228108673
log_loss: inf
roc_auc for the hours: 0.786301369863
log_loss for the hours: 0.772280689074
saving predictions to csv file
hourspatient1_13_net29_10-24-06-30-36.csv
Accuracy validation for the hours:  0.602564102564
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [13]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.074266112
saving predictions to csv file
patient1_13_net29_10-24-06-33-43.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config6.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_14']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config6.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_14'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-24 06:33:45.568011
Hostname: kat
gpu3
Configuration 'config6.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net29
evaluation:
    online_training: False
    model: net29

end Configuration
['patient1_14']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [14]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.837742592
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 189.141261292 174.980825806
20 452.630731201 438.836401367
30 649.66987915 632.660009766
40 836.557116699 814.948742676
50 1031.56469727 1003.98742676
60 1251.25163574 1216.06953125
70 1519.30529785 1471.67954102
80 1885.33984375 1820.3204834
90 2516.96833496 2415.86462402
100 43412.1367188 33402.015625
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net29
Model name for the evaluation phase:  net29
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1    [36m33.84984[0m     [32m2.83674[0m   11.93267      0.54558  17.97s
      2     [36m2.87490[0m     [32m2.65711[0m    1.08196      0.53399  18.99s
      3     [36m2.01876[0m     [32m1.67587[0m    1.20460      0.54306  20.85s
      4     [36m1.52831[0m     [32m1.44610[0m    1.05685      0.53921  20.94s
      5     [36m1.28161[0m     1.56383    0.81954      0.51744  20.85s
      6     [36m1.05500[0m     [32m1.27494[0m    0.82749      0.53040  20.87s
      7     [36m0.97322[0m     [32m1.20895[0m    0.80501      0.52637  20.90s
      8     [36m0.92343[0m     [32m1.05374[0m    0.87633      0.53442  20.90s
      9     [36m0.85164[0m     1.11918    0.76095      0.52543  20.87s
     10     [36m0.79627[0m     1.05538    0.75449      0.52338  20.84s
     11     [36m0.76235[0m     [32m0.91833[0m    0.83015      0.54120  20.88s
     12     [36m0.73592[0m     [32m0.81187[0m    0.90645      0.55089  20.88s
     13     [36m0.70955[0m     0.89180    0.79564      0.53857  20.84s
     14     [36m0.70186[0m     0.85975    0.81636      0.54246  20.86s
     15     [36m0.69792[0m     0.86189    0.80975      0.53844  20.88s
     16     [36m0.68247[0m     0.82463    0.82760      0.54646  20.84s
     17     [36m0.66208[0m     [32m0.76710[0m    0.86309      0.55676  20.83s
     18     0.66917     0.90456    0.73978      0.53997  20.85s
     19     [36m0.65508[0m     0.88281    0.74204      0.53616  20.85s
     20     0.65710     0.84267    0.77978      0.54866  20.87s
     21     [36m0.65254[0m     0.87841    0.74287      0.53651  20.84s
     22     [36m0.65105[0m     0.96040    0.67790      0.52103  20.86s
     23     [36m0.64959[0m     0.90195    0.72021      0.53250  20.84s
     24     [36m0.63669[0m     0.86950    0.73224      0.52781  20.89s
     25     0.64088     0.91196    0.70275      0.54671  20.90s
     26     [36m0.63307[0m     [32m0.76006[0m    0.83292      0.56603  20.86s
     27     [36m0.62846[0m     0.78429    0.80132      0.54700  20.89s
     28     0.62859     [32m0.75273[0m    0.83508      0.56602  20.92s
     29     0.63098     [32m0.73295[0m    0.86087      0.55779  20.84s
     30     0.63424     0.75891    0.83572      0.56969  20.90s
     31     [36m0.62173[0m     [32m0.71004[0m    0.87563      0.56935  20.91s
     32     [36m0.61626[0m     0.75874    0.81222      0.56378  20.87s
     33     [36m0.61352[0m     0.83685    0.73313      0.55974  20.92s
     34     0.61460     0.82623    0.74387      0.55959  20.86s
     35     [36m0.60517[0m     0.74405    0.81335      0.56615  20.82s
     36     0.60632     0.81222    0.74650      0.56810  20.82s
     37     0.62808     0.83060    0.75618      0.54976  20.91s
     38     0.61208     0.80301    0.76224      0.56506  20.86s
     39     0.60588     [32m0.62954[0m    0.96242      0.61003  20.86s
     40     0.61086     0.68617    0.89024      0.58865  20.82s
     41     0.60538     0.75673    0.79999      0.57217  20.81s
     42     [36m0.59871[0m     0.69078    0.86672      0.59632  20.86s
     43     [36m0.58478[0m     0.69086    0.84645      0.59978  20.87s
     44     0.59028     0.72158    0.81804      0.59002  20.88s
     45     0.59153     0.75299    0.78558      0.58491  20.88s
     46     [36m0.56939[0m     0.74355    0.76578      0.58957  20.89s
     47     0.58790     0.67411    0.87211      0.60913  20.89s
     48     [36m0.55975[0m     [32m0.62912[0m    0.88974      0.63514  20.87s
     49     0.58708     0.78854    0.74452      0.58439  20.89s
     50     0.56107     0.74358    0.75454      0.61341  20.86s
     51     [36m0.55596[0m     0.68803    0.80804      0.62776  20.91s
     52     0.57185     0.72508    0.78867      0.61489  20.85s
     53     [36m0.52920[0m     0.71858    0.73645      0.62192  20.89s
     54     [36m0.50909[0m     0.72243    0.70469      0.62847  20.88s
     55     [36m0.49969[0m     0.68535    0.72909      0.64044  20.84s
     56     [36m0.49431[0m     0.67901    0.72799      0.64402  20.83s
     57     0.53343     0.71683    0.74415      0.63135  20.94s
     58     [36m0.48709[0m     0.70144    0.69442      0.63822  20.86s
Early stopping.
Best valid loss was 0.629120 at epoch 48.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[  1.84509996e-03   1.38384593e-03   2.11003819e-03   3.48380010e-04
   2.84517044e-03   4.08994325e-04   1.23746064e-03   6.36365847e-04
   1.58428750e-03   6.68288209e-04   1.21908402e-03   3.64604988e-04
   2.44905683e-03   1.82606559e-03   1.44210283e-03   1.23895297e-03
   3.70167778e-03   1.82090222e-03   1.09294674e-03   5.16820524e-04
   2.43923045e-03   6.09417330e-04   1.00622128e-03   1.64196084e-04
   2.24640500e-03   3.58860620e-04   1.61272113e-03   9.63137936e-05
   1.95088913e-03   2.89847871e-04]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.500168829798
Error rate (%):  49.9831170202
[[42328 46367]
 [ 1002  5073]]
(94770,)
(94770,)
roc_auc: 0.751472536507
log_loss: nan
roc_auc for the hours: 0.824657534247
log_loss for the hours: 0.979008215921
saving predictions to csv file
hourspatient1_14_net29_10-24-07-06-37.csv
Accuracy validation for the hours:  0.5
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [14]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.074765824
saving predictions to csv file
patient1_14_net29_10-24-07-09-43.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config6.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_15']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config6.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_15'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-24 07:09:44.813051
Hostname: kat
gpu3
Configuration 'config6.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net29
evaluation:
    online_training: False
    model: net29

end Configuration
['patient1_15']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [15]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.838254592
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 192.412426758 176.768930054
20 459.689099121 442.431689453
30 658.81307373 637.209912109
40 846.730224609 819.873974609
50 1042.01245117 1009.00811768
60 1261.45869141 1219.99689941
70 1528.8362793 1476.44569092
80 1896.24025879 1829.35996094
90 2539.709375 2448.71398926
100 29197.0292969 29615.0136719
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net29
Model name for the evaluation phase:  net29
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1    [36m34.92563[0m     [32m1.62230[0m   21.52845      0.56830  17.96s
      2     [36m3.17960[0m     2.00264    1.58770      0.54846  19.01s
      3     [36m2.16453[0m     1.78447    1.21299      0.53926  20.87s
      4     [36m1.64347[0m     1.64435    0.99946      0.52493  20.94s
      5     [36m1.32607[0m     [32m1.31703[0m    1.00686      0.52879  20.85s
      6     [36m1.14760[0m     1.43951    0.79721      0.52013  20.87s
      7     [36m1.01881[0m     [32m1.15922[0m    0.87887      0.52962  20.90s
      8     [36m0.92205[0m     1.18931    0.77528      0.52168  20.91s
      9     [36m0.85331[0m     [32m1.03549[0m    0.82407      0.53490  20.88s
     10     [36m0.80251[0m     [32m1.01896[0m    0.78757      0.53068  20.84s
     11     [36m0.78917[0m     [32m0.97813[0m    0.80682      0.53473  20.88s
     12     [36m0.75627[0m     [32m0.83689[0m    0.90366      0.54710  20.89s
     13     [36m0.73044[0m     [32m0.80204[0m    0.91073      0.55101  20.85s
     14     [36m0.71944[0m     [32m0.79115[0m    0.90937      0.55433  20.87s
     15     [36m0.70403[0m     [32m0.75669[0m    0.93041      0.55827  20.89s
     16     [36m0.69716[0m     [32m0.71465[0m    0.97553      0.56531  20.85s
     17     [36m0.67666[0m     [32m0.70322[0m    0.96224      0.57681  20.84s
     18     [36m0.67362[0m     0.77091    0.87380      0.55612  20.86s
     19     [36m0.66393[0m     0.72984    0.90970      0.56552  20.86s
     20     [36m0.66126[0m     0.70611    0.93649      0.56519  20.87s
     21     [36m0.65482[0m     [32m0.66417[0m    0.98593      0.56598  20.85s
     22     [36m0.65038[0m     0.75599    0.86031      0.55929  20.86s
     23     0.65334     0.66772    0.97846      0.53657  20.84s
     24     [36m0.64708[0m     0.69860    0.92626      0.56452  20.89s
     25     [36m0.63862[0m     0.75598    0.84476      0.56573  20.90s
     26     [36m0.63501[0m     0.74554    0.85174      0.56793  20.87s
     27     [36m0.62580[0m     0.74931    0.83517      0.56321  20.89s
     28     0.64577     1.25028    0.51650      0.52415  20.92s
     29     0.65766     [32m0.65825[0m    0.99910      0.55480  20.84s
     30     0.63059     0.68250    0.92394      0.55562  20.90s
     31     [36m0.61967[0m     0.66560    0.93098      0.54614  20.91s
     32     0.63115     0.78279    0.80628      0.56351  20.88s
     33     0.62423     0.70186    0.88940      0.57708  20.93s
     34     0.62199     [32m0.65430[0m    0.95062      0.57340  20.87s
     35     0.62096     [32m0.65129[0m    0.95343      0.57478  20.82s
     36     0.62469     0.71853    0.86940      0.58029  20.82s
     37     [36m0.61942[0m     [32m0.65128[0m    0.95108      0.58221  20.91s
     38     [36m0.61552[0m     0.65829    0.93504      0.59984  20.87s
     39     [36m0.60578[0m     0.81687    0.74159      0.56477  20.86s
     40     0.62840     0.65743    0.95584      0.60757  20.82s
     41     0.62469     0.71309    0.87603      0.57815  20.81s
     42     0.62100     0.66636    0.93193      0.60146  20.87s
     43     0.61056     0.67616    0.90298      0.59789  20.88s
     44     0.61136     0.73552    0.83119      0.58107  20.88s
     45     [36m0.60559[0m     0.65265    0.92789      0.60059  20.88s
     46     [36m0.58713[0m     0.67506    0.86975      0.60389  20.90s
     47     0.59713     0.65346    0.91380      0.62191  20.90s
Early stopping.
Best valid loss was 0.651284 at epoch 37.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[ 0.32873794  0.35536724  0.10379559  0.41936889  0.14870286  0.33522707
  0.15861066  0.4472982   0.23525344  0.5342139   0.20904741  0.64013094
  0.27395314  0.57713795  0.14351496  0.23944986  0.06606621  0.25174928
  0.160385    0.30156463  0.1279721   0.43191597  0.12431841  0.50341845
  0.16440749  0.35725245  0.12198803  0.3501673   0.24596998  0.39540333]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.557518201963
Error rate (%):  44.2481798037
[[49535 39160]
 [ 2774  3301]]
(94770,)
(94770,)
roc_auc: 0.607584256122
log_loss: 1.17561453679
roc_auc for the hours: 0.619178082192
log_loss for the hours: 0.728389564313
saving predictions to csv file
hourspatient1_15_net29_10-24-07-37-08.csv
Accuracy validation for the hours:  0.615384615385
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [15]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.074855936
saving predictions to csv file
patient1_15_net29_10-24-07-40-15.csv
