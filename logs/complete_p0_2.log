['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run1.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0', '--channels=0']
Command line arguments: Namespace(channels=[0], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run1.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient0'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-09-28 11:50:26.958457
Hostname: kat
gpu0
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net5
evaluation:
    online_training: False
    model: net5

end Configuration
Loading and preprocessing data...
test_magnitude.shape (1406, 64)
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_1/1_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.72605696
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 70.7466438293 63.842420578
20 304.508380127 300.779174805
30 460.82131958 457.620559692
40 614.12779541 611.13269043
50 784.973907471 782.218841553
60 994.49576416 989.865478516
70 1274.92553711 1264.19610596
80 1700.02680664 1675.02429199
90 2542.60905762 2483.04052734
100 45472.875 51963.8164062
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net5
Model name for the evaluation phase:  net5
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          64x192x64
  2          64x192x64
  3          64x192x64
  4          64x96x32
  5          64x96x32
  6          64x96x32
  7          64x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m1.07578[0m     [32m0.77762[0m    1.38342      0.45980  60.77s
      2     [36m0.59753[0m     0.80585    0.74150      0.45573  61.56s
      3     [36m0.59120[0m     0.81141    0.72860      0.45459  61.41s
      4     [36m0.57537[0m     0.82865    0.69434      0.45036  62.04s
      5     [36m0.56359[0m     0.85582    0.65854      0.47575  62.58s
Early stopping.
Best valid loss was 0.777622 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d4' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d4' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d7' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d7' (shape 64).
Loaded parameters to layer 'conv2d8' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 1 1 0 0 1 0 0 1 0 1 0 0 1 0 0 1 0 1 0 1 0 1 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.450911458333
Error rate (%):  54.9088541667
yVal [0 0 1 ..., 0 1 1]
[[2668 1152]
 [3065  795]]
roc_auc: 0.523091785801
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (39, 1, 1406, 64)
[  1.00000000e+00   1.80589571e-10]
[ 0.9513678   0.04863263]
[ 0.7676031   0.23239656]
[ 0.56077552  0.43922421]
[ 0.84737742  0.15262313]
[ 0.84981954  0.15018092]
[ 0.88119024  0.11880995]
[  1.00000000e+00   1.83380755e-10]
[ 0.82465357  0.17534675]
[ 0.72780699  0.27219304]
[ 0.94531882  0.0546814 ]
[ 0.98796749  0.01203407]
[ 0.991638    0.00836272]
[ 0.80436009  0.19563937]
[ 0.67656237  0.32343686]
[ 0.84560245  0.15439774]
[ 0.99557942  0.0044209 ]
[ 0.94465405  0.05534606]
[ 0.92141777  0.07858235]
[  1.00000000e+00   2.49940957e-09]
[ 0.84992123  0.15007937]
[ 0.42802092  0.57197988]
[ 0.21342656  0.78657401]
[ 0.80073762  0.19926234]
[ 0.40937626  0.59062439]
[  9.99989927e-01   1.09543280e-05]
[ 0.74557889  0.25442153]
[  9.99999583e-01   5.29573697e-07]
[  1.00000000e+00   6.42712383e-10]
[ 0.97105706  0.02894289]
[  1.00000000e+00   1.02700837e-09]
[ 0.622639    0.37736106]
[  9.99967217e-01   3.30664880e-05]
[ 0.57058209  0.42941755]
[  9.99581754e-01   4.19705204e-04]
[ 0.8600769   0.13992383]
[ 0.80032712  0.19967279]
[ 0.82793677  0.17206295]
[ 0.31768233  0.68231755]
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[ 0.93273532  0.06726464]
[ 0.99460661  0.00539378]
[ 0.61386281  0.38613769]
[ 0.73218048  0.26781911]
[ 0.99593139  0.00406891]
roc_auc for the hours: 0.502564102564
Accuracy validation for the hours:  0.795454545455
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run1.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0', '--channels=1']
Command line arguments: Namespace(channels=[1], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run1.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient0'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-09-28 11:59:29.261109
Hostname: kat
gpu0
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net5
evaluation:
    online_training: False
    model: net5

end Configuration
Loading and preprocessing data...
test_magnitude.shape (1406, 64)
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_1/1_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.724885504
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 73.2094459534 65.3325195312
20 304.830169678 299.064300537
30 453.218609619 447.091934204
40 592.686523438 585.265686035
50 741.791564941 732.578125
60 919.896789551 906.589538574
70 1164.1838501 1144.06207275
80 1584.97133789 1549.58764648
90 2631.43066406 2554.1439209
100 212492.21875 103666.890625
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net5
Model name for the evaluation phase:  net5
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          64x192x64
  2          64x192x64
  3          64x192x64
  4          64x96x32
  5          64x96x32
  6          64x96x32
  7          64x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m1.05861[0m     [32m0.69504[0m    1.52309      0.51953  63.12s
      2     [36m0.60137[0m     0.74808    0.80389      0.54769  63.76s
      3     [36m0.58982[0m     0.76597    0.77004      0.46370  63.57s
      4     [36m0.57233[0m     0.88557    0.64628      0.42269  64.78s
      5     [36m0.57157[0m     0.76310    0.74901      0.53678  64.48s
Early stopping.
Best valid loss was 0.695039 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d4' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d4' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d7' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d7' (shape 64).
Loaded parameters to layer 'conv2d8' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[0 0 1 1 1 1 1 1 1 0 0 1 1 0 1 1 1 0 0 1 0 0 1 1 1 1 1 1 1 1]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.532421875
Error rate (%):  46.7578125
yVal [0 0 1 ..., 0 1 1]
[[1536 2284]
 [1307 2553]]
roc_auc: 0.545867367008
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (39, 1, 1406, 64)
[  9.99948978e-01   5.14446328e-05]
[ 0.66507983  0.33492005]
[ 0.39375758  0.6062426 ]
[ 0.10421066  0.89578861]
[ 0.40880746  0.59119254]
[ 0.40019172  0.59980845]
[ 0.52724195  0.47275877]
[  9.99853790e-01   1.47635874e-04]
[ 0.57145983  0.42854029]
[ 0.32381222  0.67618734]
[ 0.67269045  0.3273094 ]
[ 0.76841378  0.23158637]
[ 0.8535583   0.14644185]
[ 0.76535672  0.23464298]
[ 0.20310342  0.79689628]
[ 0.71710199  0.28289831]
[ 0.87580615  0.12419406]
[ 0.57471353  0.4252865 ]
[ 0.58474356  0.41525695]
[  9.99858439e-01   1.43595797e-04]
[ 0.46576756  0.53423244]
[ 0.11913118  0.88086915]
[ 0.02070453  0.97929519]
[ 0.58098352  0.41901648]
[ 0.25326899  0.74673223]
[ 0.98624724  0.01375153]
[ 0.11722005  0.88278013]
[ 0.99652869  0.00347288]
[  9.99809325e-01   1.91006053e-04]
[ 0.52498299  0.47501668]
[  9.99622047e-01   3.80086538e-04]
[ 0.29552725  0.70447361]
[ 0.99664003  0.00336258]
[ 0.23164703  0.76835322]
[ 0.94252831  0.05747132]
[ 0.07505224  0.92494756]
[ 0.79393196  0.20606981]
[ 0.31367156  0.68632823]
[ 0.03053827  0.96946102]
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[ 0.35920873  0.64079112]
[ 0.64185894  0.35814101]
[ 0.1548049   0.84519494]
[ 0.51433802  0.48566237]
[ 0.96439719  0.03560373]
roc_auc for the hours: 0.553846153846
Accuracy validation for the hours:  0.568181818182
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run1.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0', '--channels=2']
Command line arguments: Namespace(channels=[2], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run1.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient0'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-09-28 12:08:46.764064
Hostname: kat
gpu0
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net5
evaluation:
    online_training: False
    model: net5

end Configuration
Loading and preprocessing data...
test_magnitude.shape (1406, 64)
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_1/1_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.725528576
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 66.0938278198 59.3271923065
20 275.823791504 272.096435547
30 416.650689697 412.592544556
40 556.646313477 551.753051758
50 717.273956299 710.977752686
60 925.331677246 914.809448242
70 1232.3055542 1212.10852051
80 1764.00136719 1717.79833984
90 3024.64064941 2907.14428711
100 72650.4921875 58577.3359375
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net5
Model name for the evaluation phase:  net5
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          64x192x64
  2          64x192x64
  3          64x192x64
  4          64x96x32
  5          64x96x32
  6          64x96x32
  7          64x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m1.04553[0m     [32m0.90333[0m    1.15742      0.53548  62.90s
      2     [36m0.57443[0m     1.11736    0.51410      0.48958  63.77s
      3     [36m0.56140[0m     1.00392    0.55921      0.49479  63.21s
      4     [36m0.53754[0m     1.12350    0.47845      0.54671  63.87s
      5     [36m0.52086[0m     1.13060    0.46069      0.56445  64.01s
Early stopping.
Best valid loss was 0.903327 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d4' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d4' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d7' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d7' (shape 64).
Loaded parameters to layer 'conv2d8' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[0 0 1 1 1 1 1 1 1 0 0 1 1 0 1 1 1 0 0 1 0 1 1 0 1 0 1 1 1 1]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.5546875
Error rate (%):  44.53125
yVal [0 0 1 ..., 0 1 1]
[[1711 2109]
 [1311 2549]]
roc_auc: 0.540075550009
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (39, 1, 1406, 64)
[  9.99992371e-01   1.09272132e-05]
[ 0.08436779  0.91563171]
[ 0.13382761  0.86617255]
[ 0.02855717  0.97144276]
[ 0.18445052  0.81555027]
[ 0.05538877  0.94461125]
[ 0.54329348  0.4567062 ]
[  1.00000000e+00   2.17480123e-09]
[ 0.57038742  0.42961234]
[ 0.18033718  0.81966347]
[ 0.61401594  0.38598424]
[ 0.88142997  0.1185722 ]
[ 0.96689641  0.03310492]
[ 0.79228312  0.20771699]
[ 0.19736408  0.80263633]
[ 0.64781713  0.35218349]
[ 0.9212293   0.07877053]
[ 0.58245814  0.41754174]
[ 0.88575393  0.11424597]
[ 0.98302019  0.01698002]
[ 0.82557368  0.17442615]
[ 0.52166682  0.47833323]
[ 0.35248417  0.64751637]
[ 0.83483231  0.16516855]
[ 0.33089942  0.66910094]
[ 0.90403384  0.0959655 ]
[ 0.0516342   0.94836605]
[ 0.99819988  0.00180154]
[  9.99995291e-01   5.12044653e-06]
[ 0.57893872  0.42106083]
[  1.00000000e+00   1.42208151e-07]
[ 0.33295754  0.66704327]
[  9.99943316e-01   5.69942567e-05]
[ 0.23470311  0.76529717]
[ 0.99213082  0.00786977]
[ 0.57899809  0.42100182]
[ 0.79906702  0.20093356]
[ 0.4410845   0.55891544]
[ 0.03412955  0.96587056]
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[ 0.0632783   0.93672144]
[ 0.2914277   0.70857203]
[ 0.27256119  0.72743815]
[ 0.82146841  0.17853288]
[ 0.99740827  0.0025922 ]
roc_auc for the hours: 0.584615384615
Accuracy validation for the hours:  0.636363636364
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run1.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0', '--channels=3']
Command line arguments: Namespace(channels=[3], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run1.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient0'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-09-28 12:18:00.206327
Hostname: kat
gpu0
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net5
evaluation:
    online_training: False
    model: net5

end Configuration
Loading and preprocessing data...
test_magnitude.shape (1406, 64)
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_1/1_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.725307392
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 47.6684310913 43.0745182037
20 190.535946655 186.172027588
30 292.377093506 286.294784546
40 400.819000244 392.791015625
50 536.772857666 525.470214844
60 733.36652832 715.44934082
70 1071.4920166 1038.94641113
80 1814.90427246 1741.25292969
90 3935.36066895 3727.35095215
100 175654.078125 94563.71875
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net5
Model name for the evaluation phase:  net5
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          64x192x64
  2          64x192x64
  3          64x192x64
  4          64x96x32
  5          64x96x32
  6          64x96x32
  7          64x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m1.15326[0m     [32m0.74367[0m    1.55077      0.54248  63.74s
      2     [36m0.60159[0m     0.80853    0.74406      0.47087  64.39s
      3     [36m0.58493[0m     0.81420    0.71841      0.49365  63.87s
      4     [36m0.55549[0m     0.88935    0.62460      0.51107  64.53s
      5     [36m0.53748[0m     0.88514    0.60722      0.53662  64.79s
Early stopping.
Best valid loss was 0.743671 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d4' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d4' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d7' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d7' (shape 64).
Loaded parameters to layer 'conv2d8' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 1 0 1 1 0 0 1 1 0 0 1 0 0 0 1 0 0 1 0 1 1 1 1 1 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.554166666667
Error rate (%):  44.5833333333
yVal [0 0 1 ..., 0 1 1]
[[2757 1063]
 [2361 1499]]
roc_auc: 0.58680794428
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (39, 1, 1406, 64)
[  1.00000000e+00   3.39894646e-09]
[ 0.66079938  0.33920121]
[ 0.88468212  0.11531814]
[ 0.86316872  0.13683063]
[ 0.83997166  0.16002807]
[ 0.76197422  0.23802374]
[ 0.95504898  0.04495157]
[  1.00000000e+00   3.34164241e-07]
[ 0.87987405  0.12012646]
[ 0.70655483  0.29344574]
[ 0.82803887  0.17195991]
[ 0.99506384  0.00493805]
[ 0.98717046  0.01283096]
[ 0.79527986  0.20471999]
[ 0.68355131  0.31644884]
[ 0.84235531  0.15764523]
[  9.99838650e-01   1.64035533e-04]
[ 0.97551781  0.0244829 ]
[ 0.98879653  0.01120358]
[  1.00000000e+00   2.27360175e-07]
[ 0.57575852  0.4242416 ]
[ 0.86964989  0.13034953]
[ 0.82745379  0.17254579]
[ 0.83640212  0.16359755]
[ 0.82841688  0.17158344]
[  9.99866188e-01   1.35181632e-04]
[ 0.74268728  0.25731319]
[  9.99991536e-01   9.12612268e-06]
[  1.00000000e+00   2.11573674e-08]
[ 0.93968141  0.06031876]
[  1.00000000e+00   3.27439729e-08]
[ 0.70333624  0.2966637 ]
[  9.99863565e-01   1.37036273e-04]
[ 0.58868647  0.41131338]
[ 0.98916668  0.01083495]
[ 0.70059979  0.29940063]
[ 0.80251163  0.19748832]
[ 0.52379143  0.4762089 ]
[ 0.26282543  0.73717445]
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[ 0.99302101  0.00698192]
[ 0.77032775  0.22967273]
[ 0.45231321  0.54768717]
[ 0.8331126   0.16688749]
[ 0.98660743  0.01339382]
roc_auc for the hours: 0.574358974359
Accuracy validation for the hours:  0.886363636364
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run1.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0', '--channels=4']
Command line arguments: Namespace(channels=[4], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run1.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient0'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-09-28 12:27:22.878359
Hostname: kat
gpu0
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net5
evaluation:
    online_training: False
    model: net5

end Configuration
Loading and preprocessing data...
test_magnitude.shape (1406, 64)
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_1/1_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.7256064
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 54.9849830627 50.1900939941
20 229.307006836 228.20741272
30 348.048464966 346.217544556
40 467.856695557 464.409698486
50 608.873718262 602.048614502
60 803.540222168 789.24432373
70 1133.24448242 1100.21539307
80 1815.55136719 1742.62597656
90 3260.82875977 3121.5411377
100 159526.84375 66619.4296875
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net5
Model name for the evaluation phase:  net5
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          64x192x64
  2          64x192x64
  3          64x192x64
  4          64x96x32
  5          64x96x32
  6          64x96x32
  7          64x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m1.06732[0m     [32m0.73099[0m    1.46011      0.54997  62.58s
      2     [36m0.58883[0m     0.82985    0.70956      0.58838  63.05s
      3     [36m0.56089[0m     0.97178    0.57718      0.49626  63.27s
      4     [36m0.52839[0m     0.92298    0.57248      0.54020  64.01s
      5     [36m0.50591[0m     0.87135    0.58061      0.53044  64.72s
Early stopping.
Best valid loss was 0.730991 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d4' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d4' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d7' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d7' (shape 64).
Loaded parameters to layer 'conv2d8' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 1 0 0 0 1 0 1 0 1 0 0 1 0 0 0 0 1 0 1 0 0 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.550390625
Error rate (%):  44.9609375
yVal [0 0 1 ..., 0 1 1]
[[3310  510]
 [2943  917]]
roc_auc: 0.671697637197
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (39, 1, 1406, 64)
[  1.00000000e+00   1.66137809e-07]
[ 0.9916591   0.00834166]
[ 0.99732119  0.00267943]
[ 0.991225   0.0087753]
[ 0.85928518  0.14071678]
[ 0.92327523  0.07672825]
[ 0.96464783  0.03535208]
[  1.00000000e+00   1.94264146e-10]
[ 0.99800658  0.00199463]
[ 0.81700623  0.18299375]
[ 0.99712414  0.00287605]
[  9.99391377e-01   6.08815753e-04]
[ 0.9985804   0.00141972]
[ 0.81292552  0.18707459]
[ 0.83655888  0.16344127]
[ 0.85804707  0.14195342]
[ 0.98324019  0.01676009]
[ 0.98599243  0.0140082 ]
[ 0.99326038  0.00673986]
[  1.00000000e+00   3.96903062e-08]
[ 0.95099235  0.04900828]
[ 0.71454018  0.28546003]
[ 0.82232362  0.17767593]
[ 0.66511846  0.33488098]
[ 0.98402226  0.0159778 ]
[  9.99998868e-01   2.24043379e-06]
[ 0.97716272  0.02283717]
[  1.00000000e+00   2.78825691e-08]
[  1.00000000e+00   1.06540880e-10]
[  9.99989927e-01   1.21830108e-05]
[  1.00000000e+00   2.53123282e-08]
[ 0.91576797  0.08423197]
[  9.99983430e-01   1.67835733e-05]
[ 0.98228335  0.01771752]
[  9.99686956e-01   3.13609809e-04]
[ 0.92139977  0.07860088]
[ 0.7976076   0.20239246]
[ 0.89938563  0.10061434]
[ 0.89354676  0.10645306]
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[ 0.95775008  0.04224963]
[ 0.96363199  0.03636742]
[ 0.86819458  0.13180666]
[ 0.7164672   0.28353259]
[ 0.99290526  0.00709495]
roc_auc for the hours: 0.671794871795
Accuracy validation for the hours:  0.886363636364
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run1.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0', '--channels=5']
Command line arguments: Namespace(channels=[5], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run1.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient0'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-09-28 12:36:33.441457
Hostname: kat
gpu0
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net5
evaluation:
    online_training: False
    model: net5

end Configuration
Loading and preprocessing data...
test_magnitude.shape (1406, 64)
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_1/1_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.724217856
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 40.4209140778 36.9957923889
20 166.929934692 164.751541138
30 253.996229553 251.12739563
40 343.703009033 339.247955322
50 452.435745239 445.635696411
60 605.83416748 594.33026123
70 867.009185791 845.254577637
80 1415.50119629 1374.06323242
90 2654.56486816 2579.15917969
100 60107.1914062 35847.8867188
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net5
Model name for the evaluation phase:  net5
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          64x192x64
  2          64x192x64
  3          64x192x64
  4          64x96x32
  5          64x96x32
  6          64x96x32
  7          64x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m0.97888[0m     [32m0.74614[0m    1.31193      0.50423  63.06s
      2     [36m0.59325[0m     0.77424    0.76624      0.53630  62.93s
      3     [36m0.57839[0m     0.79319    0.72920      0.44873  63.77s
      4     [36m0.55929[0m     0.86117    0.64945      0.54948  64.16s
      5     [36m0.53879[0m     0.92689    0.58129      0.53597  64.09s
Early stopping.
Best valid loss was 0.746136 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d4' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d4' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d7' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d7' (shape 64).
Loaded parameters to layer 'conv2d8' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 1 1 1 1 0 0 0 0 0 1 1 1 0 0 1 0 0 0 0 1 1 1 1 1 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.51328125
Error rate (%):  48.671875
yVal [0 0 1 ..., 0 1 1]
[[2365 1455]
 [2283 1577]]
roc_auc: 0.554522353037
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (39, 1, 1406, 64)
[  1.00000000e+00   1.35978992e-10]
[ 0.4603388   0.53966087]
[ 0.58868873  0.41131124]
[ 0.60605705  0.39394304]
[ 0.69206619  0.30793306]
[ 0.60991973  0.39008039]
[ 0.60787487  0.39212516]
[  1.00000000e+00   6.71898759e-10]
[ 0.75838381  0.24161649]
[ 0.46075496  0.53924435]
[ 0.92247212  0.07752754]
[ 0.99657428  0.00342649]
[ 0.99381167  0.00618887]
[ 0.80489582  0.19510536]
[ 0.64468402  0.3553153 ]
[ 0.7948758   0.20512447]
[ 0.98186368  0.01813682]
[ 0.79687423  0.20312643]
[ 0.87082499  0.12917511]
[  9.99983251e-01   1.79533472e-05]
[ 0.43294251  0.56705761]
[ 0.88447911  0.1155209 ]
[ 0.57240838  0.42759216]
[ 0.87242669  0.12757319]
[ 0.46378228  0.53621787]
[  9.99991775e-01   8.60507498e-06]
[ 0.62251389  0.37748605]
[  1.00000000e+00   2.91959861e-08]
[  1.00000000e+00   1.20317244e-12]
[ 0.98422611  0.01577532]
[  1.00000000e+00   8.67160477e-09]
[ 0.6306684   0.36933133]
[  9.99886692e-01   1.13704540e-04]
[ 0.59596986  0.40402991]
[  9.99854147e-01   1.46800128e-04]
[ 0.82353139  0.17646857]
[ 0.80266696  0.19733304]
[ 0.99345082  0.00654945]
[ 0.68484753  0.31515208]
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[ 0.95562285  0.04437696]
[ 0.61106348  0.38893655]
[ 0.56672055  0.4332802 ]
[ 0.802894    0.19710603]
[ 0.99653745  0.00346256]
roc_auc for the hours: 0.553846153846
Accuracy validation for the hours:  0.795454545455
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run1.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0', '--channels=6']
Command line arguments: Namespace(channels=[6], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run1.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient0'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-09-28 12:45:45.759656
Hostname: kat
gpu0
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net5
evaluation:
    online_training: False
    model: net5

end Configuration
Loading and preprocessing data...
test_magnitude.shape (1406, 64)
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_1/1_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.725307392
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 48.3308135986 43.7012329102
20 203.010769653 198.697387695
30 309.622598267 303.911743164
40 418.704449463 410.685119629
50 547.045196533 536.160308838
60 717.938061523 702.114440918
70 981.146099854 956.138244629
80 1479.44748535 1432.06201172
90 2699.1140625 2590.68603516
100 459356.3125 258723.5625
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net5
Model name for the evaluation phase:  net5
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          64x192x64
  2          64x192x64
  3          64x192x64
  4          64x96x32
  5          64x96x32
  6          64x96x32
  7          64x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m0.99814[0m     [32m0.76531[0m    1.30424      0.54720  63.19s
      2     [36m0.58514[0m     0.78866    0.74194      0.55713  63.68s
      3     [36m0.56902[0m     0.87832    0.64785      0.51318  64.02s
      4     [36m0.55407[0m     0.83985    0.65973      0.52881  64.92s
      5     [36m0.54230[0m     [32m0.74886[0m    0.72417      0.51302  64.56s
      6     [36m0.51306[0m     0.77968    0.65803      0.54069  64.65s
      7     [36m0.46635[0m     0.91662    0.50876      0.52848  64.42s
      8     [36m0.45116[0m     0.98986    0.45578      0.51807  64.93s
      9     [36m0.39977[0m     0.99269    0.40271      0.52686  65.29s
Early stopping.
Best valid loss was 0.748862 at epoch 5.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d4' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d4' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d7' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d7' (shape 64).
Loaded parameters to layer 'conv2d8' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 1 1 1 0 1 1 0 1 1 1 0 0 1 1 0 0 1 0 1 1 0 1 0 1 1 1 1]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.520703125
Error rate (%):  47.9296875
yVal [0 0 1 ..., 0 1 1]
[[1899 1921]
 [1760 2100]]
roc_auc: 0.574866465019
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (39, 1, 1406, 64)
[  9.99999225e-01   9.29732209e-07]
[ 0.65153831  0.34846184]
[ 0.78049344  0.21950671]
[ 0.39404413  0.60595602]
[ 0.78585279  0.21414767]
[ 0.78548032  0.21451966]
[ 0.89868426  0.10131622]
[  9.99665916e-01   3.34843033e-04]
[ 0.77556181  0.22443829]
[ 0.44532856  0.55467111]
[ 0.67231047  0.32768947]
[ 0.9391104   0.06088956]
[ 0.96576357  0.03423704]
[ 0.7235257   0.27647474]
[ 0.44977549  0.55022436]
[ 0.80522621  0.19477414]
[ 0.98256928  0.01743176]
[ 0.60181105  0.39818919]
[ 0.89599711  0.10400339]
[  1.00000000e+00   5.28046519e-13]
[ 0.19550036  0.80450064]
[ 0.93156254  0.06843716]
[ 0.80728143  0.19271818]
[ 0.83005112  0.16994904]
[ 0.69020766  0.30979267]
[ 0.86578387  0.13421637]
[ 0.08190674  0.91809285]
[  9.99260128e-01   7.40414311e-04]
[  9.99986649e-01   1.33983531e-05]
[ 0.89808363  0.10191669]
[ 0.99669021  0.00330965]
[ 0.19940308  0.80059701]
[ 0.95013803  0.04986214]
[ 0.16918813  0.83081192]
[ 0.98491973  0.01508053]
[ 0.56424803  0.43575233]
[ 0.74761242  0.25238749]
[ 0.08302081  0.91697955]
[ 0.28976747  0.71023273]
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[ 0.87340915  0.12659191]
[ 0.70606738  0.29393306]
[ 0.10400077  0.89599961]
[ 0.79762292  0.2023771 ]
[ 0.9899779   0.01002377]
roc_auc for the hours: 0.523076923077
Accuracy validation for the hours:  0.704545454545
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run1.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0', '--channels=7']
Command line arguments: Namespace(channels=[7], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run1.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient0'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-09-28 12:59:21.443422
Hostname: kat
gpu0
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net5
evaluation:
    online_training: False
    model: net5

end Configuration
Loading and preprocessing data...
test_magnitude.shape (1406, 64)
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_1/1_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.72568832
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 38.6423419952 35.0991477966
20 161.713800049 158.613922119
30 247.503570557 242.854927063
40 336.667449951 330.682769775
50 445.338150024 436.794891357
60 597.433325195 584.704162598
70 844.703747559 824.881347656
80 1311.05961914 1273.43701172
90 2369.42944336 2276.2890625
100 202022.625 78149.3203125
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net5
Model name for the evaluation phase:  net5
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          64x192x64
  2          64x192x64
  3          64x192x64
  4          64x96x32
  5          64x96x32
  6          64x96x32
  7          64x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m0.94738[0m     [32m0.73236[0m    1.29361      0.50244  63.17s
      2     [36m0.57841[0m     0.74821    0.77306      0.51188  63.21s
      3     [36m0.57089[0m     0.73566    0.77603      0.55534  63.63s
      4     [36m0.55373[0m     0.75809    0.73043      0.60856  63.86s
      5     [36m0.55136[0m     0.74603    0.73905      0.59538  64.87s
Early stopping.
Best valid loss was 0.732356 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d4' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d4' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d7' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d7' (shape 64).
Loaded parameters to layer 'conv2d8' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 1 0 1 1 1 1 1 0 0 1 0 1 0 1 0 0 1 0 0 0 0 1 1 0 0 0 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.515625
Error rate (%):  48.4375
yVal [0 0 1 ..., 0 1 1]
[[2389 1431]
 [2289 1571]]
roc_auc: 0.588285069039
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (39, 1, 1406, 64)
[  1.00000000e+00   9.10556353e-11]
[ 0.81671137  0.18328862]
[ 0.81360018  0.18640034]
[ 0.86589664  0.13410379]
[ 0.80317587  0.19682355]
[ 0.78258371  0.21741594]
[ 0.71652389  0.28347665]
[  1.00000000e+00   2.26190355e-09]
[ 0.95739925  0.04260217]
[ 0.58059955  0.41940087]
[ 0.97294712  0.02705317]
[ 0.99784291  0.00215853]
[ 0.96635288  0.0336478 ]
[ 0.78897822  0.21102327]
[ 0.81576103  0.18424001]
[ 0.8562547   0.14374526]
[ 0.99849087  0.00150975]
[ 0.93662208  0.06337813]
[ 0.98604399  0.01395558]
[  1.00000000e+00   7.89863108e-08]
[ 0.45049933  0.5495007 ]
[ 0.18756405  0.8124361 ]
[ 0.14662449  0.85337549]
[ 0.11917845  0.88082111]
[ 0.33742231  0.66257745]
[  9.99988973e-01   1.16911406e-05]
[ 0.19105533  0.80894446]
[  9.99622464e-01   3.77692370e-04]
[  1.00000000e+00   5.46566126e-11]
[  9.99866247e-01   1.36384435e-04]
[  1.00000000e+00   9.61841939e-10]
[ 0.83185148  0.1681484 ]
[  9.99994993e-01   5.27042721e-06]
[ 0.4640424   0.53595686]
[  9.99959409e-01   4.30282817e-05]
[ 0.77138644  0.22861341]
[ 0.79535812  0.20464188]
[ 0.23134005  0.76866043]
[ 0.30488962  0.6951099 ]
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[ 0.83891433  0.1610862 ]
[ 0.84790492  0.15209498]
[ 0.8551653   0.14483511]
[ 0.18997757  0.81002235]
[ 0.99727023  0.00272982]
roc_auc for the hours: 0.538461538462
Accuracy validation for the hours:  0.704545454545
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run1.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0', '--channels=8']
Command line arguments: Namespace(channels=[8], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run1.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient0'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-09-28 13:08:32.630411
Hostname: kat
gpu0
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net5
evaluation:
    online_training: False
    model: net5

end Configuration
Loading and preprocessing data...
test_magnitude.shape (1406, 64)
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_1/1_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.725495808
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 49.4141464233 44.965970993
20 208.958178711 205.577194214
30 321.900491333 316.595809937
40 440.470233154 432.077514648
50 584.674072266 570.474365234
60 780.80411377 755.815979004
70 1076.43822021 1032.71588135
80 1580.6878418 1504.79504395
90 2701.39460449 2561.01733398
100 353074.21875 68448.984375
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net5
Model name for the evaluation phase:  net5
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          64x192x64
  2          64x192x64
  3          64x192x64
  4          64x96x32
  5          64x96x32
  6          64x96x32
  7          64x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m0.95833[0m     [32m0.73203[0m    1.30913      0.58154  63.47s
      2     [36m0.57466[0m     0.73395    0.78297      0.58024  63.01s
      3     [36m0.56682[0m     [32m0.68565[0m    0.82668      0.60156  63.54s
      4     [36m0.55080[0m     0.68641    0.80243      0.62516  63.61s
      5     [36m0.53860[0m     [32m0.66866[0m    0.80549      0.63965  64.12s
      6     [36m0.49340[0m     0.80714    0.61130      0.58496  64.67s
      7     [36m0.45858[0m     0.91854    0.49924      0.59766  64.35s
      8     [36m0.41668[0m     0.92134    0.45226      0.56152  64.35s
      9     [36m0.37724[0m     1.06576    0.35397      0.54883  64.67s
Early stopping.
Best valid loss was 0.668658 at epoch 5.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d4' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d4' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d7' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d7' (shape 64).
Loaded parameters to layer 'conv2d8' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[0 0 1 1 1 1 1 1 1 1 0 1 1 0 1 1 1 0 1 1 0 0 1 0 1 1 1 1 1 1]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.647916666667
Error rate (%):  35.2083333333
yVal [0 0 1 ..., 0 1 1]
[[1819 2001]
 [ 703 3157]]
roc_auc: 0.640037639367
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (39, 1, 1406, 64)
[ 0.99810737  0.00189343]
[ 0.73449403  0.26550588]
[ 0.71058875  0.28941113]
[ 0.48220623  0.51779431]
[ 0.47898567  0.52101386]
[ 0.48743388  0.51256603]
[ 0.82170558  0.17829475]
[  9.99979913e-01   2.06473287e-05]
[ 0.67836833  0.32163131]
[ 0.43258339  0.56741649]
[ 0.64477128  0.35522881]
[  9.99174953e-01   8.25258729e-04]
[ 0.8783794   0.12162127]
[ 0.75423384  0.24576627]
[ 0.51357061  0.48642951]
[ 0.81946266  0.18053722]
[ 0.99008948  0.00991062]
[ 0.97721958  0.02278067]
[  9.99951899e-01   5.03231931e-05]
[  1.00000000e+00   6.56648735e-10]
[ 0.82720357  0.17279606]
[ 0.29573151  0.70426798]
[ 0.4490374   0.55096257]
[ 0.30470499  0.69529539]
[ 0.72821164  0.27178836]
[ 0.99686593  0.0031346 ]
[ 0.36116928  0.63883102]
[  9.99893010e-01   1.07272383e-04]
[ 0.97893727  0.02106275]
[  9.99918818e-01   8.22187867e-05]
[  9.99997914e-01   2.21816958e-06]
[ 0.26650882  0.73349035]
[ 0.83646482  0.16353513]
[ 0.03648491  0.96351504]
[ 0.9986968   0.00130431]
[ 0.70042425  0.29957554]
[ 0.74100041  0.25899953]
[ 0.668778    0.33122221]
[ 0.40545517  0.59454441]
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[ 0.5060491  0.4939509]
[ 0.81640661  0.18359439]
[ 0.41303709  0.58696258]
[ 0.42034811  0.57965273]
[ 0.89133924  0.10866152]
roc_auc for the hours: 0.641025641026
Accuracy validation for the hours:  0.681818181818
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run1.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0', '--channels=9']
Command line arguments: Namespace(channels=[9], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run1.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient0'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-09-28 13:22:03.885364
Hostname: kat
gpu0
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net5
evaluation:
    online_training: False
    model: net5

end Configuration
Loading and preprocessing data...
test_magnitude.shape (1406, 64)
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_1/1_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.724283392
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 60.8246585846 54.0624084473
20 254.689199829 246.874298096
30 391.764382935 379.099685669
40 536.115319824 516.814331055
50 716.320129395 687.126220703
60 976.413891602 932.889160156
70 1390.45943604 1328.53936768
80 2113.4605957 2010.52490234
90 3753.54802246 3538.35632324
100 262006.171875 86094.46875
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net5
Model name for the evaluation phase:  net5
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          64x192x64
  2          64x192x64
  3          64x192x64
  4          64x96x32
  5          64x96x32
  6          64x96x32
  7          64x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m1.04566[0m     [32m0.93559[0m    1.11765      0.52490  63.08s
      2     [36m0.56618[0m     1.02565    0.55202      0.52474  63.41s
      3     [36m0.54971[0m     1.11466    0.49316      0.51660  63.50s
      4     [36m0.53227[0m     1.06488    0.49984      0.49658  63.82s
      5     [36m0.51974[0m     0.94290    0.55122      0.55078  64.08s
Early stopping.
Best valid loss was 0.935590 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d4' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d4' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d7' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d7' (shape 64).
Loaded parameters to layer 'conv2d8' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 1 1 1 0 0 0 1 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 1 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.533984375
Error rate (%):  46.6015625
yVal [0 0 1 ..., 0 1 1]
[[3025  795]
 [2784 1076]]
roc_auc: 0.583624603261
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (39, 1, 1406, 64)
[  1.00000000e+00   4.09336703e-10]
[ 0.31643498  0.68356395]
[ 0.70714051  0.29285946]
[ 0.85773975  0.14226028]
[ 0.7630505   0.23695002]
[ 0.50783759  0.49216244]
[ 0.8268404   0.17315991]
[  1.00000000e+00   1.84884741e-09]
[ 0.99819535  0.0018057 ]
[ 0.65835774  0.3416425 ]
[ 0.99392962  0.00607079]
[  9.99819934e-01   1.79929062e-04]
[ 0.98727995  0.01272026]
[ 0.76679003  0.23320995]
[ 0.80585003  0.19415055]
[ 0.81539482  0.18460578]
[ 0.96930277  0.03069752]
[ 0.97782028  0.02217983]
[  9.99995708e-01   6.34416074e-06]
[  1.00000000e+00   1.24091919e-14]
[ 0.99344319  0.00655801]
[ 0.95579731  0.04420223]
[ 0.96214807  0.03785214]
[ 0.98982656  0.01017618]
[ 0.82053077  0.17946896]
[  9.99912381e-01   8.83741668e-05]
[ 0.64798045  0.35201937]
[  9.99999523e-01   1.08121162e-06]
[  1.00000000e+00   5.62370671e-11]
[  9.99902129e-01   9.98299656e-05]
[  1.00000000e+00   2.07316608e-10]
[ 0.77684414  0.22315603]
[  9.99997079e-01   3.26825966e-06]
[ 0.63647509  0.36352533]
[  1.00000000e+00   2.73084311e-07]
[ 0.99742407  0.00257674]
[ 0.79194313  0.20805635]
[ 0.99303424  0.00696627]
[ 0.64256138  0.35743853]
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[ 0.99552196  0.00447931]
[ 0.07945082  0.92054981]
[ 0.8796469   0.12035241]
[ 0.98961449  0.01038482]
[  9.99584854e-01   4.15541319e-04]
roc_auc for the hours: 0.54358974359
Accuracy validation for the hours:  0.886363636364
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run1.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0', '--channels=10']
Command line arguments: Namespace(channels=[10], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run1.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient0'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-09-28 13:31:25.770218
Hostname: kat
gpu0
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net5
evaluation:
    online_training: False
    model: net5

end Configuration
Loading and preprocessing data...
test_magnitude.shape (1406, 64)
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_1/1_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.724549632
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 45.3170951843 39.5809764862
20 189.624957275 178.504226685
30 296.130010986 277.927627563
40 416.461804199 387.818572998
50 579.042205811 535.606506348
60 821.163928223 759.156677246
70 1192.01209717 1108.3949585
80 1831.40200195 1702.2791748
90 3394.49926758 3141.58947754
100 51527.984375 51923.34375
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net5
Model name for the evaluation phase:  net5
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          64x192x64
  2          64x192x64
  3          64x192x64
  4          64x96x32
  5          64x96x32
  6          64x96x32
  7          64x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m1.02082[0m     [32m0.79765[0m    1.27977      0.55697  63.31s
      2     [36m0.57120[0m     0.84225    0.67819      0.57178  63.28s
      3     [36m0.55049[0m     [32m0.78020[0m    0.70558      0.55908  63.91s
      4     [36m0.52307[0m     0.87505    0.59776      0.57406  64.00s
      5     [36m0.51002[0m     [32m0.77720[0m    0.65623      0.55436  64.39s
      6     [36m0.47410[0m     0.90149    0.52591      0.56706  64.39s
      7     [36m0.44767[0m     0.99007    0.45216      0.55029  63.99s
      8     [36m0.41768[0m     1.37482    0.30381      0.50684  63.45s
      9     [36m0.38125[0m     1.42168    0.26817      0.57812  63.95s
Early stopping.
Best valid loss was 0.777202 at epoch 5.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d4' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d4' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d7' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d7' (shape 64).
Loaded parameters to layer 'conv2d8' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 1 1 1 1 1 1 1 1 1 0 0 1 0 0 0 0 1 0 1 1 0 1 0 1 1 1 1]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.564973958333
Error rate (%):  43.5026041667
yVal [0 0 1 ..., 0 1 1]
[[1636 2184]
 [1157 2703]]
roc_auc: 0.559802918916
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (39, 1, 1406, 64)
[ 0.97514337  0.0248568 ]
[ 0.94265729  0.05734304]
[ 0.74325085  0.25674972]
[ 0.29590517  0.70409489]
[ 0.63955939  0.3604404 ]
[ 0.63134307  0.36865881]
[ 0.9683823   0.03161763]
[  1.00000000e+00   5.76473695e-08]
[ 0.73921365  0.2607868 ]
[ 0.67615658  0.32384318]
[ 0.49562773  0.5043723 ]
[ 0.97631836  0.02368248]
[ 0.99230683  0.00769388]
[ 0.74543923  0.25456107]
[ 0.24093349  0.75906843]
[ 0.70255274  0.29744732]
[ 0.88055307  0.11944726]
[ 0.51883793  0.48116234]
[  9.99569416e-01   4.31557157e-04]
[  1.00000000e+00   6.21615312e-18]
[ 0.60137033  0.39862934]
[ 0.52251583  0.47748446]
[ 0.85548723  0.14451344]
[ 0.90302968  0.09697116]
[ 0.9037199   0.09628025]
[ 0.95520222  0.04479896]
[ 0.32123771  0.67876291]
[ 0.95511931  0.04488197]
[ 0.99899709  0.00100309]
[ 0.92482114  0.07517885]
[ 0.84245008  0.15755032]
[ 0.18193991  0.81805944]
[ 0.86751938  0.13248108]
[ 0.12525783  0.87474167]
[ 0.86954594  0.13045442]
[ 0.78959191  0.21040806]
[ 0.72355908  0.27644134]
[ 0.41567364  0.58432651]
[ 0.59384292  0.40615761]
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[ 0.79797649  0.20202374]
[ 0.93670249  0.06329828]
[ 0.2666122   0.73338836]
[ 0.86039257  0.13960756]
[ 0.79101264  0.20898697]
roc_auc for the hours: 0.523076923077
Accuracy validation for the hours:  0.75
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run1.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0', '--channels=11']
Command line arguments: Namespace(channels=[11], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run1.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient0'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-09-28 13:44:58.347802
Hostname: kat
gpu0
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net5
evaluation:
    online_training: False
    model: net5

end Configuration
Loading and preprocessing data...
test_magnitude.shape (1406, 64)
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_1/1_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.725520384
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 34.3634315491 30.060459137
20 138.222512817 132.134262085
30 211.831253052 202.679618835
40 290.449456787 276.802490234
50 391.356781006 370.085968018
60 547.523474121 512.188842773
70 842.824353027 778.507873535
80 1484.78508301 1340.56811523
90 3403.51403809 2935.4519043
100 410646.09375 69810.453125
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net5
Model name for the evaluation phase:  net5
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          64x192x64
  2          64x192x64
  3          64x192x64
  4          64x96x32
  5          64x96x32
  6          64x96x32
  7          64x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m1.20546[0m     [32m0.68322[0m    1.76439      0.55794  63.32s
      2     [36m0.58129[0m     0.72561    0.80111      0.54785  63.79s
      3     [36m0.56800[0m     0.75230    0.75502      0.52490  63.36s
      4     [36m0.54746[0m     0.87919    0.62268      0.52197  64.26s
      5     [36m0.53548[0m     0.90955    0.58873      0.53044  64.27s
Early stopping.
Best valid loss was 0.683215 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d4' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d4' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d7' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d7' (shape 64).
Loaded parameters to layer 'conv2d8' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[0 0 1 0 1 1 1 1 1 1 0 1 1 0 1 1 1 0 0 1 0 0 1 1 1 1 1 1 1 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.575390625
Error rate (%):  42.4609375
yVal [0 0 1 ..., 0 1 1]
[[1455 2365]
 [ 896 2964]]
roc_auc: 0.611760640751
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (39, 1, 1406, 64)
[ 0.99783367  0.00216799]
[ 0.07521479  0.92478621]
[ 0.17039758  0.82960266]
[ 0.08509305  0.91490692]
[ 0.13505897  0.86494142]
[ 0.12483477  0.87516487]
[ 0.48785245  0.51214743]
[ 0.99440938  0.00559219]
[ 0.52054232  0.47945803]
[ 0.14010161  0.85989755]
[ 0.1513294   0.84867132]
[ 0.62630522  0.37369481]
[ 0.88423604  0.11576384]
[ 0.79346526  0.206536  ]
[ 0.1879227  0.8120774]
[ 0.56077987  0.43922025]
[ 0.95773286  0.04226893]
[ 0.50021535  0.49978423]
[ 0.49233478  0.50766444]
[  1.00000000e+00   8.23256912e-08]
[ 0.01848229  0.98151743]
[ 0.13297538  0.86702496]
[ 0.10806095  0.89193892]
[ 0.22949512  0.77050507]
[ 0.10944664  0.89055395]
[ 0.99169779  0.00830317]
[ 0.03909208  0.96090847]
[ 0.99303025  0.00696986]
[ 0.99683732  0.00316504]
[ 0.65611887  0.34388113]
[  9.99968350e-01   3.39449653e-05]
[ 0.46956757  0.53043276]
[ 0.99543399  0.00456677]
[ 0.26081148  0.73918849]
[ 0.93861258  0.06138936]
[ 0.27769002  0.72230893]
[ 0.80106485  0.19893551]
[ 0.07116834  0.9288317 ]
[ 0.2192366   0.78076327]
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[ 0.36255184  0.63744718]
[ 0.13320577  0.86679405]
[ 0.04280066  0.95719934]
[ 0.22245267  0.77754694]
[ 0.918145    0.08185615]
roc_auc for the hours: 0.625641025641
Accuracy validation for the hours:  0.5
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run1.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0', '--channels=12']
Command line arguments: Namespace(channels=[12], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run1.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient0'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-09-28 13:54:10.995723
Hostname: kat
gpu0
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net5
evaluation:
    online_training: False
    model: net5

end Configuration
Loading and preprocessing data...
test_magnitude.shape (1406, 64)
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_1/1_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.725557248
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 59.5394416809 52.4879989624
20 245.482409668 233.52784729
30 380.90708313 361.512054443
40 531.113098145 500.606658936
50 732.89251709 684.365264893
60 1045.06953125 970.801757812
70 1567.62325439 1455.69378662
80 2545.51733398 2337.99316406
90 5088.38081055 4587.39916992
100 126710.1875 64910.4453125
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net5
Model name for the evaluation phase:  net5
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          64x192x64
  2          64x192x64
  3          64x192x64
  4          64x96x32
  5          64x96x32
  6          64x96x32
  7          64x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m1.14540[0m     [32m0.75802[0m    1.51103      0.63102  62.57s
      2     [36m0.56291[0m     [32m0.75429[0m    0.74627      0.60872  62.88s
      3     [36m0.54246[0m     [32m0.74321[0m    0.72988      0.59798  63.43s
      4     [36m0.52441[0m     0.75247    0.69691      0.60677  63.36s
      5     [36m0.52121[0m     0.78937    0.66028      0.58903  64.11s
      6     [36m0.48328[0m     0.81543    0.59268      0.61393  63.92s
      7     [36m0.46087[0m     0.88735    0.51938      0.56299  64.57s
Early stopping.
Best valid loss was 0.743209 at epoch 3.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d4' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d4' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d7' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d7' (shape 64).
Loaded parameters to layer 'conv2d8' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 1 1 1 1 1 1 1 0 0 1 0 1 1 1 0 0 1 0 0 1 0 1 0 1 1 1 1]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.614322916667
Error rate (%):  38.5677083333
yVal [0 0 1 ..., 0 1 1]
[[1798 2022]
 [ 940 2920]]
roc_auc: 0.578396359493
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (39, 1, 1406, 64)
[  1.00000000e+00   1.87831459e-10]
[ 0.95985353  0.04014666]
[ 0.95779228  0.04220787]
[ 0.84031153  0.15968831]
[ 0.71445531  0.28554407]
[ 0.74629617  0.25370371]
[ 0.96918303  0.03081699]
[  1.00000000e+00   1.64926306e-09]
[ 0.88869822  0.11130209]
[ 0.52909291  0.47090727]
[ 0.70875514  0.29124442]
[ 0.96554083  0.03445935]
[ 0.96532547  0.03467521]
[ 0.75472057  0.24527781]
[ 0.23357689  0.7664237 ]
[ 0.80498236  0.19501814]
[ 0.97270399  0.02729701]
[ 0.85951102  0.14048892]
[  9.99871612e-01   1.30088112e-04]
[  1.00000000e+00   5.66516440e-16]
[ 0.50693989  0.49305972]
[ 0.8146776   0.18532246]
[ 0.88763887  0.1123612 ]
[ 0.73126495  0.26873502]
[ 0.78930122  0.21069905]
[  9.99881148e-01   1.19657074e-04]
[ 0.14809567  0.85190457]
[  9.99999881e-01   6.33176342e-07]
[  1.00000000e+00   1.55474938e-10]
[ 0.93006539  0.06993596]
[  1.00000000e+00   7.55346807e-09]
[ 0.2802701   0.71972942]
[ 0.99548268  0.00451815]
[ 0.27661857  0.72338152]
[  9.99823749e-01   1.76360903e-04]
[ 0.81091708  0.189083  ]
[ 0.74265629  0.25734347]
[ 0.4860352   0.51396453]
[ 0.55066967  0.44932988]
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[ 0.7593354   0.24066477]
[ 0.95622158  0.04377834]
[ 0.51772398  0.48227561]
[ 0.81893218  0.18106775]
[ 0.99180454  0.00819563]
roc_auc for the hours: 0.538461538462
Accuracy validation for the hours:  0.772727272727
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run1.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0', '--channels=13']
Command line arguments: Namespace(channels=[13], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run1.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient0'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-09-28 14:05:31.285429
Hostname: kat
gpu0
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net5
evaluation:
    online_training: False
    model: net5

end Configuration
Loading and preprocessing data...
test_magnitude.shape (1406, 64)
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_1/1_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.724631552
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 63.0294364929 56.5815162659
20 264.939825439 254.637069702
30 413.522460938 396.065826416
40 579.621655273 552.57043457
50 803.26651001 762.77243042
60 1137.32678223 1083.71508789
70 1643.4175293 1582.21246338
80 2494.01391602 2400.1328125
90 4490.2112793 4296.84179688
100 100082.695312 85056.0390625
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net5
Model name for the evaluation phase:  net5
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          64x192x64
  2          64x192x64
  3          64x192x64
  4          64x96x32
  5          64x96x32
  6          64x96x32
  7          64x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m1.15687[0m     [32m0.84613[0m    1.36725      0.56836  63.13s
      2     [36m0.57098[0m     [32m0.83908[0m    0.68048      0.52507  63.21s
      3     [36m0.55082[0m     0.84776    0.64974      0.51888  63.09s
      4     [36m0.52390[0m     [32m0.77523[0m    0.67580      0.55924  64.40s
      5     [36m0.51124[0m     0.80466    0.63536      0.56055  64.22s
      6     [36m0.48055[0m     0.92187    0.52127      0.55745  64.25s
      7     [36m0.45871[0m     1.02258    0.44858      0.54313  64.45s
      8     [36m0.44525[0m     0.95497    0.46624      0.55404  64.12s
Early stopping.
Best valid loss was 0.775230 at epoch 4.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d4' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d4' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d7' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d7' (shape 64).
Loaded parameters to layer 'conv2d8' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[1 0 0 0 0 1 1 1 1 1 0 1 1 0 1 1 1 0 0 1 0 0 1 0 1 1 1 1 1 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.561328125
Error rate (%):  43.8671875
yVal [0 0 1 ..., 0 1 1]
[[1720 2100]
 [1269 2591]]
roc_auc: 0.587089561349
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (39, 1, 1406, 64)
[  9.99987423e-01   1.42759272e-05]
[ 0.97884488  0.02115485]
[ 0.91587293  0.08412626]
[ 0.90037638  0.09962423]
[ 0.80874568  0.19125463]
[ 0.77103621  0.22896507]
[ 0.96931845  0.03068179]
[  9.99999821e-01   7.49334731e-07]
[ 0.95981866  0.04018234]
[ 0.51057225  0.48942801]
[ 0.6699608   0.33003855]
[ 0.86707097  0.13292927]
[ 0.960446    0.03955612]
[ 0.77953219  0.22046818]
[ 0.25815812  0.74184138]
[ 0.79452091  0.20548046]
[ 0.52481925  0.47518045]
[ 0.77312535  0.22687449]
[  9.99999702e-01   6.85754912e-07]
[  1.00000000e+00   1.82289446e-13]
[ 0.6538589   0.34614125]
[ 0.79010653  0.20989288]
[ 0.88331747  0.1166827 ]
[ 0.96155137  0.03844929]
[ 0.8946501   0.10534981]
[  9.99157250e-01   8.43097048e-04]
[ 0.04262775  0.95737332]
[  1.00000000e+00   1.91321070e-10]
[  1.00000000e+00   4.56683909e-12]
[ 0.74889046  0.25111002]
[  9.99802053e-01   1.98268011e-04]
[ 0.15553895  0.8444612 ]
[  9.99986351e-01   1.42902963e-05]
[ 0.17805283  0.82194817]
[  1.00000000e+00   2.17720313e-08]
[ 0.75097674  0.24902341]
[ 0.70730722  0.2926935 ]
[ 0.42523751  0.57476252]
[ 0.63065791  0.36934137]
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[ 0.99733955  0.00266153]
[ 0.51798368  0.48201674]
[ 0.21512072  0.78488016]
[ 0.97035432  0.02964563]
[ 0.98065925  0.01934149]
roc_auc for the hours: 0.512820512821
Accuracy validation for the hours:  0.795454545455
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run1.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0', '--channels=14']
Command line arguments: Namespace(channels=[14], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run1.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient0'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-09-28 14:17:58.293357
Hostname: kat
gpu0
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net5
evaluation:
    online_training: False
    model: net5

end Configuration
Loading and preprocessing data...
test_magnitude.shape (1406, 64)
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_1/1_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.72419328
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 47.1018074036 41.9034309387
20 194.863269043 187.404129028
30 299.46585083 288.103988647
40 411.538861084 394.770477295
50 557.168609619 531.75213623
60 785.241699219 745.654541016
70 1187.45931396 1128.42919922
80 1955.85324707 1847.97949219
90 3920.83825684 3699.4642334
100 65181.1953125 57682.203125
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net5
Model name for the evaluation phase:  net5
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          64x192x64
  2          64x192x64
  3          64x192x64
  4          64x96x32
  5          64x96x32
  6          64x96x32
  7          64x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m1.07418[0m     [32m0.75764[0m    1.41780      0.55827  61.69s
      2     [36m0.58038[0m     0.75849    0.76518      0.55615  63.11s
      3     [36m0.55773[0m     0.78506    0.71044      0.54997  63.76s
      4     [36m0.52912[0m     0.76357    0.69295      0.54346  64.35s
      5     [36m0.51266[0m     0.89500    0.57281      0.53499  64.50s
Early stopping.
Best valid loss was 0.757639 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d4' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d4' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d7' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d7' (shape 64).
Loaded parameters to layer 'conv2d8' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 1 1 1 1 0 0 1 1 0 1 1 1 0 0 1 0 0 1 0 1 1 1 0 1 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.571223958333
Error rate (%):  42.8776041667
yVal [0 0 1 ..., 0 1 1]
[[2139 1681]
 [1612 2248]]
roc_auc: 0.595404877519
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (39, 1, 1406, 64)
[  9.99999881e-01   2.03144594e-07]
[ 0.40460771  0.59539205]
[ 0.61079013  0.38920978]
[ 0.61276954  0.38723075]
[ 0.58443093  0.41556942]
[ 0.379372   0.6206274]
[ 0.71317041  0.28682941]
[  1.00000000e+00   8.98700350e-08]
[ 0.80432749  0.19567242]
[ 0.27372736  0.72627181]
[ 0.84248245  0.15751788]
[ 0.99252659  0.00747372]
[  9.99195158e-01   8.05471849e-04]
[ 0.81674707  0.18325526]
[ 0.71981716  0.28018278]
[ 0.8494491   0.15055108]
[ 0.95906436  0.04093582]
[ 0.80085611  0.1991438 ]
[  9.99024749e-01   9.75974603e-04]
[  1.00000000e+00   1.45019941e-10]
[ 0.77682811  0.22317196]
[ 0.06094649  0.93905425]
[ 0.09548971  0.90451038]
[ 0.40122005  0.5987801 ]
[ 0.17955664  0.82044357]
[  9.99917209e-01   8.37205735e-05]
[ 0.5874517   0.41254812]
[  9.99999821e-01   9.94098286e-07]
[  1.00000000e+00   5.11516305e-08]
[  9.99936283e-01   6.61471204e-05]
[  1.00000000e+00   1.11601128e-09]
[ 0.77690798  0.22309153]
[  9.99917209e-01   8.42192749e-05]
[ 0.89703232  0.10296717]
[  9.99594212e-01   4.06239822e-04]
[ 0.40941775  0.59058237]
[ 0.78738469  0.21261582]
[ 0.47022098  0.52977896]
[ 0.42022306  0.57977664]
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[ 0.99824381  0.00175739]
[ 0.51360518  0.48639482]
[ 0.30705389  0.69294637]
[ 0.37234041  0.62766004]
[ 0.99571389  0.00428772]
roc_auc for the hours: 0.630769230769
Accuracy validation for the hours:  0.704545454545
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run1.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0', '--channels=15']
Command line arguments: Namespace(channels=[15], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run1.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient0'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-09-28 14:27:12.208486
Hostname: kat
gpu0
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net5
evaluation:
    online_training: False
    model: net5

end Configuration
Loading and preprocessing data...
test_magnitude.shape (1406, 64)
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_1/1_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.7251968
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 31.7646816254 28.4185752869
20 129.457452393 125.507354736
30 197.740777588 192.144943237
40 269.609753418 261.310760498
50 359.916183472 347.308181763
60 495.644329834 475.592895508
70 743.125952148 708.52130127
80 1261.15825195 1195.06652832
90 2526.72180176 2381.0592041
100 37134.734375 63323.234375
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net5
Model name for the evaluation phase:  net5
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          64x192x64
  2          64x192x64
  3          64x192x64
  4          64x96x32
  5          64x96x32
  6          64x96x32
  7          64x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m0.91536[0m     [32m0.73489[0m    1.24557      0.55534  63.43s
      2     [36m0.59492[0m     0.74294    0.80076      0.56283  63.43s
      3     [36m0.57750[0m     [32m0.69801[0m    0.82736      0.57178  63.78s
      4     [36m0.55487[0m     0.75735    0.73264      0.57259  64.01s
      5     [36m0.52380[0m     0.75992    0.68928      0.55518  64.29s
      6     [36m0.49577[0m     0.83564    0.59328      0.52816  64.05s
      7     [36m0.46080[0m     0.85116    0.54138      0.55160  64.46s
Early stopping.
Best valid loss was 0.698005 at epoch 3.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d4' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d4' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d7' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d7' (shape 64).
Loaded parameters to layer 'conv2d8' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 1 1 1 1 0 1 0 0 1 0 0 1 1 0 0 0 0 0 1 0 1 0 1 1 1 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.583984375
Error rate (%):  41.6015625
yVal [0 0 1 ..., 0 1 1]
[[2070 1750]
 [1445 2415]]
roc_auc: 0.604746154681
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (39, 1, 1406, 64)
[  1.00000000e+00   3.08066850e-10]
[ 0.98691052  0.01308932]
[ 0.99145269  0.00854688]
[ 0.93235236  0.06764752]
[ 0.80610329  0.1938975 ]
[ 0.88420612  0.11579659]
[ 0.9968583   0.00314208]
[  1.00000000e+00   4.51428929e-11]
[ 0.99754918  0.00245137]
[ 0.80399007  0.19601008]
[ 0.99434358  0.0056575 ]
[ 0.99890763  0.00109272]
[ 0.95686114  0.04313974]
[ 0.76474768  0.2352522 ]
[ 0.72625422  0.27374545]
[ 0.79533875  0.20466231]
[  9.99969244e-01   3.31141346e-05]
[ 0.96273601  0.03726401]
[  9.99997616e-01   4.91431638e-06]
[  1.00000000e+00   1.70925531e-11]
[ 0.98314756  0.01685315]
[ 0.92902428  0.0709756 ]
[ 0.92720789  0.07279025]
[ 0.95936245  0.04063803]
[ 0.9395991   0.06040097]
[  9.99938309e-01   6.20843784e-05]
[ 0.43514791  0.56485176]
[  1.00000000e+00   2.61627964e-09]
[  1.00000000e+00   5.57348112e-10]
[ 0.96380347  0.03619689]
[  1.00000000e+00   4.43230697e-09]
[ 0.76023167  0.23976877]
[  9.99830186e-01   1.70612868e-04]
[ 0.82892233  0.17107807]
[  9.99999523e-01   1.54993336e-06]
[ 0.97059321  0.02940894]
[ 0.73145473  0.26854554]
[ 0.64273918  0.35726118]
[ 0.57343793  0.42656261]
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[ 0.95798039  0.0420212 ]
[ 0.98774517  0.01225512]
[ 0.81077582  0.18922493]
[ 0.95649594  0.04350526]
[ 0.98906368  0.01093682]
roc_auc for the hours: 0.54358974359
Accuracy validation for the hours:  0.863636363636
