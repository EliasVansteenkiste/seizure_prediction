['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config5.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_0']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config5.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_0'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-11 01:35:30.805262
Hostname: kat
gpu0
Configuration 'config5.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net13
evaluation:
    online_training: False
    model: net13

end Configuration
['patient0_0']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [0]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.749121536
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 77.4825836182 42.2078788757
20 305.512463379 300.472479248
30 461.135577393 459.25463562
40 614.021606445 614.238354492
50 784.364746094 787.311828613
60 993.193286133 998.551342773
70 1272.31512451 1279.6506958
80 1694.84467773 1704.01054688
90 2529.98266602 2551.26169434
100 45472.875 51963.8164062
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net13
Model name for the evaluation phase:  net13
Training model...
# Neural Network with 95970 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x131x66
  2          32x133x5
  3          32x133x5
  4          32x67x3
  5          32x67x3
  6          32x67x3
  7          32x34x2
  8          2x34x2
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m0.74784[0m     [32m0.79739[0m    0.93785      0.46791  14.52s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.50389[0m     1.53576    0.32810      0.47124  14.47s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.21197[0m     2.84097    0.07461      0.46998  14.52s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.11335[0m     3.98024    0.02848      0.46695  14.52s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.09240[0m     3.98508    0.02319      0.47310  14.58s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.06736[0m     5.39178    0.01249      0.46296  14.57s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.06576[0m     6.38271    0.01030      0.45612  14.62s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      8     0.56345     0.92621    0.60834      0.52430  14.87s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      9     0.22759     3.21432    0.07081      0.46972  14.80s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.05575[0m     4.75952    0.01171      0.46324  14.86s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.04657[0m     7.39850    0.00629      0.46576  14.85s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.797392 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x64x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x1x64).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.842224136281
Error rate (%):  15.7775863719
[[43990  2180]
 [ 6063    12]]
(52245,)
(52245,)
roc_auc: 0.593320302229
log_loss: 1.04138781622
roc_auc for the hours: 0.478947368421
log_loss for the hours: 0.6811451181
saving predictions to csv file
hourspatient0_0_net13_10-11-01-40-45.csv
Accuracy validation for the hours:  0.883720930233
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [0]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 0.947724288
saving predictions to csv file
patient0_0_net13_10-11-01-42-45.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config5.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_1']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config5.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_1'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-11 01:42:46.583626
Hostname: kat
gpu0
Configuration 'config5.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net13
evaluation:
    online_training: False
    model: net13

end Configuration
['patient0_1']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [1]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.749326336
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 79.8583602905 43.7949028015
20 305.763250732 299.520977783
30 453.40585022 450.005862427
40 592.349865723 590.177758789
50 740.968597412 740.054229736
60 918.324951172 917.797363281
70 1161.24418945 1163.53183594
80 1578.52695313 1588.20612793
90 2613.2675293 2653.38178711
100 212492.21875 103666.890625
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net13
Model name for the evaluation phase:  net13
Training model...
# Neural Network with 95970 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x131x66
  2          32x133x5
  3          32x133x5
  4          32x67x3
  5          32x67x3
  6          32x67x3
  7          32x34x2
  8          2x34x2
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m0.73569[0m     [32m0.69699[0m    1.05553      0.51731  15.01s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.57264[0m     0.85997    0.66589      0.47197  15.24s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.52865[0m     1.37748    0.38378      0.48886  15.46s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.26168[0m     3.17481    0.08243      0.47931  14.85s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.15127[0m     3.40318    0.04445      0.47826  14.80s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.08108[0m     5.37974    0.01507      0.46928  14.83s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.07380[0m     3.73334    0.01977      0.49463  15.00s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      8     0.07779     4.02971    0.01930      0.49886  14.84s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.05275[0m     5.34100    0.00988      0.48584  14.77s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     10     0.06504     6.34307    0.01025      0.48510  14.83s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.04942[0m     3.70339    0.01335      0.54615  14.75s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.696991 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x64x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x1x64).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.833266341277
Error rate (%):  16.6733658723
[[43383  2787]
 [ 5924   151]]
(52245,)
(52245,)
roc_auc: 0.639648773409
log_loss: 0.632670093759
roc_auc for the hours: 0.615789473684
log_loss for the hours: 0.406228610096
saving predictions to csv file
hourspatient0_1_net13_10-11-01-48-04.csv
Accuracy validation for the hours:  0.883720930233
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [1]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 0.999993344
saving predictions to csv file
patient0_1_net13_10-11-01-50-09.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config5.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_2']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config5.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_2'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-11 01:50:10.296995
Hostname: kat
gpu0
Configuration 'config5.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net13
evaluation:
    online_training: False
    model: net13

end Configuration
['patient0_2']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [2]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.748634112
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 72.0125099182 40.3037857056
20 276.55925293 272.411431885
30 416.599380493 415.294677734
40 555.997583008 556.773425293
50 715.97946167 718.930877686
60 923.099047852 927.542578125
70 1228.42805176 1233.38067627
80 1756.11213379 1761.63308105
90 3001.92504883 3026.81286621
100 72650.4921875 53126.640625
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net13
Model name for the evaluation phase:  net13
Training model...
# Neural Network with 95970 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x131x66
  2          32x133x5
  3          32x133x5
  4          32x67x3
  5          32x67x3
  6          32x67x3
  7          32x34x2
  8          2x34x2
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m0.75735[0m     [32m0.94820[0m    0.79872      0.49592  14.78s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.54023[0m     1.61660    0.33418      0.48745  15.63s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.39400[0m     1.99766    0.19723      0.50949  15.58s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.20468[0m     4.06564    0.05034      0.47848  15.79s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.10288[0m     5.00439    0.02056      0.47836  15.92s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.08106[0m     6.38152    0.01270      0.48265  15.74s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     0.74906    10.20932    0.07337      0.50423  16.16s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      8     0.84226     1.28717    0.65435      0.50010  16.05s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      9     0.32088     2.75911    0.11630      0.47520  15.90s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     10     0.11272     4.57213    0.02465      0.48396  15.97s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.07251[0m     5.79588    0.01251      0.47975  15.93s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.948204 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x64x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x1x64).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.799081251794
Error rate (%):  20.0918748206
[[41685  4485]
 [ 6012    63]]
(52245,)
(52245,)
roc_auc: 0.588656724879
log_loss: 1.11341179581
roc_auc for the hours: 0.521052631579
log_loss for the hours: 0.553428663356
saving predictions to csv file
hourspatient0_2_net13_10-11-01-55-40.csv
Accuracy validation for the hours:  0.860465116279
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [2]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.000747008
saving predictions to csv file
patient0_2_net13_10-11-01-57-42.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config5.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_3']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config5.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_3'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-11 01:57:43.665119
Hostname: kat
gpu0
Configuration 'config5.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net13
evaluation:
    online_training: False
    model: net13

end Configuration
['patient0_3']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [3]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.750563328
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 52.0612277985 28.9869352341
20 191.337734985 185.116714478
30 292.577377319 287.197384644
40 400.500439453 396.009564209
50 535.735168457 532.537109375
60 731.05357666 729.604919434
70 1066.69674072 1069.19353027
80 1804.39440918 1808.60009766
90 3908.51987305 3891.41049805
100 124376.210938 175654.078125
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net13
Model name for the evaluation phase:  net13
Training model...
# Neural Network with 95970 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x131x66
  2          32x133x5
  3          32x133x5
  4          32x67x3
  5          32x67x3
  6          32x67x3
  7          32x34x2
  8          2x34x2
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m0.80905[0m     [32m0.70546[0m    1.14684      0.50522  14.77s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.54973[0m     0.75547    0.72767      0.51595  14.86s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.42716[0m     1.29231    0.33054      0.54179  14.71s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.28781[0m     1.48833    0.19338      0.55755  15.20s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.17713[0m     2.67435    0.06623      0.50077  14.82s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.13419[0m     2.86088    0.04691      0.48866  15.49s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.09124[0m     3.55250    0.02568      0.50010  15.27s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.08338[0m     3.92126    0.02126      0.49452  14.84s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.07630[0m     2.95126    0.02585      0.52067  14.79s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.06266[0m     5.54808    0.01129      0.48871  14.95s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     11     3.91103     0.71776    5.44895      0.57982  14.89s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     12     0.56383     [32m0.69394[0m    0.81250      0.55921  15.21s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     13     0.42396     1.23049    0.34454      0.49716  14.91s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     14     0.26678     1.53835    0.17342      0.49247  15.68s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     15     0.15148     2.81295    0.05385      0.49644  15.86s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     16     0.10629     2.99820    0.03545      0.49907  16.18s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     17     0.07678     3.35092    0.02291      0.50098  16.27s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     18     0.06326     2.49919    0.02531      0.52089  15.82s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     19     [36m0.05830[0m     2.97420    0.01960      0.51586  15.90s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     20     [36m0.05518[0m     2.99765    0.01841      0.53299  15.20s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     21     [36m0.05088[0m     3.96016    0.01285      0.49736  14.90s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     22     0.05170     4.99874    0.01034      0.49170  14.97s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.693943 at epoch 12.
Loaded parameters to layer 'conv2d1' (shape 32x1x64x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x1x64).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.748971193416
Error rate (%):  25.1028806584
[[37875  8295]
 [ 4820  1255]]
(52245,)
(52245,)
roc_auc: 0.621814020648
log_loss: inf
roc_auc for the hours: 0.605263157895
log_loss for the hours: 0.454891480147
saving predictions to csv file
hourspatient0_3_net13_10-11-02-06-08.csv
Accuracy validation for the hours:  0.813953488372
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [3]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.00276224
saving predictions to csv file
patient0_3_net13_10-11-02-08-36.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config5.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_4']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config5.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_4'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-11 02:08:37.915347
Hostname: kat
gpu0
Configuration 'config5.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net13
evaluation:
    online_training: False
    model: net13

end Configuration
['patient0_4']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [4]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.74840064
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 60.27771492 33.2891647339
20 230.724859619 226.139196777
30 348.998257446 345.771307373
40 468.468225098 465.978533936
50 608.787628174 607.555786133
60 801.863439941 803.590454102
70 1127.33896484 1136.01357422
80 1802.12897949 1820.19179688
90 3236.02592773 3251.78005371
100 159526.84375 66619.4296875
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net13
Model name for the evaluation phase:  net13
Training model...
# Neural Network with 95970 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x131x66
  2          32x133x5
  3          32x133x5
  4          32x67x3
  5          32x67x3
  6          32x67x3
  7          32x34x2
  8          2x34x2
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m0.75452[0m     [32m0.84174[0m    0.89638      0.46636  14.67s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.45815[0m     1.38523    0.33074      0.47672  14.84s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.23200[0m     2.47875    0.09359      0.44666  14.77s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.14597[0m     2.90689    0.05021      0.45718  14.99s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.09447[0m     3.46213    0.02729      0.45833  15.05s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.08666[0m     4.99806    0.01734      0.44484  14.86s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.07170[0m     6.24549    0.01148      0.46046  15.20s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.07103[0m     6.49784    0.01093      0.45222  15.93s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.06125[0m     3.80202    0.01611      0.45318  16.11s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     10     0.06800     5.26953    0.01290      0.45664  16.44s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     11     0.06284     8.74271    0.00719      0.45644  16.42s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.841737 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x64x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x1x64).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.83171595368
Error rate (%):  16.828404632
[[43432  2738]
 [ 6054    21]]
(52245,)
(52245,)
roc_auc: 0.617554362969
log_loss: 1.15292510551
roc_auc for the hours: 0.494736842105
log_loss for the hours: 0.504724574527
saving predictions to csv file
hourspatient0_4_net13_10-11-02-14-01.csv
Accuracy validation for the hours:  0.883720930233
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [4]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 0.999682048
saving predictions to csv file
patient0_4_net13_10-11-02-16-00.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config5.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_5']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config5.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_5'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-11 02:16:02.020147
Hostname: kat
gpu0
Configuration 'config5.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net13
evaluation:
    online_training: False
    model: net13

end Configuration
['patient0_5']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [5]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.749146112
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 44.228635788 24.8328939438
20 167.781503296 163.806289673
30 254.511244202 251.485551453
40 343.928485107 341.169134521
50 452.231292725 450.168884277
60 604.746826172 604.360339355
70 863.724084473 868.017297363
80 1408.11137695 1423.19575195
90 2638.64152832 2674.38774414
100 60107.1914062 35895.5507812
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net13
Model name for the evaluation phase:  net13
Training model...
# Neural Network with 95970 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x131x66
  2          32x133x5
  3          32x133x5
  4          32x67x3
  5          32x67x3
  6          32x67x3
  7          32x34x2
  8          2x34x2
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m0.72408[0m     [32m0.84941[0m    0.85245      0.46460  15.08s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.46219[0m     1.42673    0.32395      0.47414  14.79s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.22443[0m     2.73622    0.08202      0.47689  14.68s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.12465[0m     3.32136    0.03753      0.45985  14.69s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.09625[0m     3.79874    0.02534      0.46545  14.81s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.09336[0m     5.20386    0.01794      0.46400  14.69s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.06713[0m     4.54037    0.01478      0.47460  14.76s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.06152[0m     4.88886    0.01258      0.48656  15.31s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      9     0.06302     4.95612    0.01272      0.47964  15.22s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     10     0.06267     8.43317    0.00743      0.46396  14.98s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     11     0.21884     3.54163    0.06179      0.47312  14.88s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.849407 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x64x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x1x64).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.836060867069
Error rate (%):  16.3939132931
[[43648  2522]
 [ 6043    32]]
(52245,)
(52245,)
roc_auc: 0.579565106945
log_loss: 1.15215659104
roc_auc for the hours: 0.473684210526
log_loss for the hours: 0.506398584128
saving predictions to csv file
hourspatient0_5_net13_10-11-02-21-32.csv
Accuracy validation for the hours:  0.883720930233
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [5]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.000493056
saving predictions to csv file
patient0_5_net13_10-11-02-23-30.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config5.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_6']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config5.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_6'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-11 02:23:31.900091
Hostname: kat
gpu0
Configuration 'config5.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net13
evaluation:
    online_training: False
    model: net13

end Configuration
['patient0_6']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [6]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.749228032
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 52.9203617096 28.9710264206
20 204.033294678 198.010336304
30 310.279055786 304.778164673
40 419.120050049 413.251306152
50 547.291717529 541.047363281
60 717.765319824 711.321618652
70 980.086315918 974.004034424
80 1476.19272461 1468.43618164
90 2691.36994629 2660.87460937
100 459356.3125 258723.5625
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net13
Model name for the evaluation phase:  net13
Training model...
# Neural Network with 95970 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x131x66
  2          32x133x5
  3          32x133x5
  4          32x67x3
  5          32x67x3
  6          32x67x3
  7          32x34x2
  8          2x34x2
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m0.76198[0m     [32m0.81984[0m    0.92943      0.53695  14.79s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.54589[0m     1.28411    0.42511      0.49530  15.15s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.31607[0m     2.55055    0.12392      0.46554  14.90s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.18073[0m     3.06358    0.05899      0.45913  14.80s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.11714[0m     2.66432    0.04397      0.46990  15.00s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.08809[0m     4.58758    0.01920      0.46255  14.83s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.07951[0m     5.42747    0.01465      0.47987  14.91s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.06987[0m     5.61034    0.01245      0.46370  14.92s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      9     0.07271     6.34971    0.01145      0.46093  14.96s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.06513[0m     5.60083    0.01163      0.47138  14.95s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     11     0.07201     3.90299    0.01845      0.48959  14.91s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.819840 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x64x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x1x64).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.768666858073
Error rate (%):  23.1333141927
[[38918  7252]
 [ 4834  1241]]
(52245,)
(52245,)
roc_auc: 0.585296512887
log_loss: 0.952862496196
roc_auc for the hours: 0.652631578947
log_loss for the hours: 0.409488451486
saving predictions to csv file
hourspatient0_6_net13_10-11-02-29-04.csv
Accuracy validation for the hours:  0.837209302326
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [6]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 0.999804928
saving predictions to csv file
patient0_6_net13_10-11-02-31-08.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config5.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_7']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config5.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_7'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-11 02:31:09.507170
Hostname: kat
gpu0
Configuration 'config5.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net13
evaluation:
    online_training: False
    model: net13

end Configuration
['patient0_7']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [7]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.747835392
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 42.2832771301 23.406820488
20 162.516268921 157.987145996
30 247.963627625 243.623634338
40 336.95199585 332.831341553
50 445.399627686 441.292938232
60 597.128845215 593.310778809
70 844.070202637 839.791943359
80 1309.5418457 1299.71809082
90 2364.6079834 2327.02700195
100 202022.625 78149.3203125
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net13
Model name for the evaluation phase:  net13
Training model...
# Neural Network with 95970 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x131x66
  2          32x133x5
  3          32x133x5
  4          32x67x3
  5          32x67x3
  6          32x67x3
  7          32x34x2
  8          2x34x2
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m0.72863[0m     [32m0.72305[0m    1.00771      0.57602  15.44s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.48209[0m     1.51172    0.31890      0.45545  15.05s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.30042[0m     2.51948    0.11924      0.44222  14.74s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     0.56585     0.72897    0.77623      0.49835  14.71s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.26254[0m     4.15312    0.06321      0.44501  14.95s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.12493[0m     4.46368    0.02799      0.44038  14.80s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.08398[0m     5.45523    0.01540      0.46665  15.20s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.07794[0m     6.10381    0.01277      0.45770  15.70s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.07632[0m     4.07062    0.01875      0.45556  15.07s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     10     0.08301     7.62167    0.01089      0.45798  15.41s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.06806[0m     6.98661    0.00974      0.44307  15.26s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.723051 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x64x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x1x64).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.714498995119
Error rate (%):  28.5501004881
[[35808 10362]
 [ 4554  1521]]
(52245,)
(52245,)
roc_auc: 0.618588644043
log_loss: 1.00805828612
roc_auc for the hours: 0.647368421053
log_loss for the hours: 0.497428389654
saving predictions to csv file
hourspatient0_7_net13_10-11-02-36-48.csv
Accuracy validation for the hours:  0.720930232558
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [7]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 0.998567936
saving predictions to csv file
patient0_7_net13_10-11-02-38-44.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config5.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_8']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config5.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_8'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-11 02:38:45.935125
Hostname: kat
gpu0
Configuration 'config5.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net13
evaluation:
    online_training: False
    model: net13

end Configuration
['patient0_8']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [8]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.749191168
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 54.1830825806 29.6300670624
20 210.284432983 202.797094727
30 322.79552002 315.015945435
40 440.955853271 432.186102295
50 584.439239502 573.883850098
60 779.399060059 765.642810059
70 1072.5894043 1055.17028809
80 1571.89633789 1552.87558594
90 2680.80834961 2671.50136719
100 68448.984375 353074.21875
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net13
Model name for the evaluation phase:  net13
Training model...
# Neural Network with 95970 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x131x66
  2          32x133x5
  3          32x133x5
  4          32x67x3
  5          32x67x3
  6          32x67x3
  7          32x34x2
  8          2x34x2
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m0.71185[0m     [32m0.73040[0m    0.97461      0.55886  15.87s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.40876[0m     1.85912    0.21987      0.45669  16.09s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.18375[0m     2.93953    0.06251      0.49598  15.65s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.10374[0m     4.10190    0.02529      0.47406  15.63s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.08925[0m     3.09655    0.02882      0.48043  15.78s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.06734[0m     7.46785    0.00902      0.47177  15.85s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.06198[0m     3.52284    0.01759      0.47574  15.39s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      8     0.06714     6.13363    0.01095      0.47332  15.42s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.05673[0m     7.08640    0.00801      0.48398  15.86s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     10     0.06341     3.47477    0.01825      0.46901  15.13s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.05272[0m     5.02652    0.01049      0.47540  14.97s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.730400 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x64x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x1x64).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.815867547134
Error rate (%):  18.4132452866
[[41898  4272]
 [ 5348   727]]
(52245,)
(52245,)
roc_auc: 0.655208412995
log_loss: inf
roc_auc for the hours: 0.673684210526
log_loss for the hours: 0.436381596013
saving predictions to csv file
hourspatient0_8_net13_10-11-02-44-14.csv
Accuracy validation for the hours:  0.883720930233
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [8]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.000419328
saving predictions to csv file
patient0_8_net13_10-11-02-46-15.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config5.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_9']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config5.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_9'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-11 02:46:16.623313
Hostname: kat
gpu0
Configuration 'config5.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net13
evaluation:
    online_training: False
    model: net13

end Configuration
['patient0_9']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [9]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.74868736
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 66.6869514465 35.6989082336
20 256.319952393 245.103649902
30 392.878082275 380.05057373
40 536.743615723 521.363696289
50 716.260894775 697.441894531
60 975.356860352 953.108215332
70 1387.67550049 1363.3236084
80 2106.65888672 2072.82099609
90 3733.63100586 3669.75898437
100 262006.171875 86094.46875
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net13
Model name for the evaluation phase:  net13
Training model...
# Neural Network with 95970 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x131x66
  2          32x133x5
  3          32x133x5
  4          32x67x3
  5          32x67x3
  6          32x67x3
  7          32x34x2
  8          2x34x2
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m0.78357[0m     [32m0.93794[0m    0.83542      0.48486  15.40s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.49227[0m     1.17961    0.41731      0.48735  15.25s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.32784[0m     2.94150    0.11145      0.46843  14.89s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.20032[0m     3.36941    0.05945      0.47169  14.98s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.14529[0m     3.77526    0.03849      0.47537  14.87s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.10455[0m     4.18073    0.02501      0.49518  15.74s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.08151[0m     3.50748    0.02324      0.55007  15.01s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      8     0.08253     4.27325    0.01931      0.50228  15.96s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.07352[0m     5.46562    0.01345      0.48770  15.72s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.07235[0m     4.90605    0.01475      0.48685  15.87s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.06631[0m     3.75163    0.01768      0.49539  15.90s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.937938 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x64x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x1x64).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.846320222031
Error rate (%):  15.3679777969
[[44072  2098]
 [ 5931   144]]
(52245,)
(52245,)
roc_auc: 0.604147957406
log_loss: 1.33355124539
roc_auc for the hours: 0.531578947368
log_loss for the hours: 0.676333884262
saving predictions to csv file
hourspatient0_9_net13_10-11-02-51-52.csv
Accuracy validation for the hours:  0.883720930233
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [9]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 0.999948288
saving predictions to csv file
patient0_9_net13_10-11-02-54-05.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config5.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_10']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config5.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_10'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-11 02:54:06.722893
Hostname: kat
gpu0
Configuration 'config5.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net13
evaluation:
    online_training: False
    model: net13

end Configuration
['patient0_10']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [10]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.748126208
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 49.5935062408 26.4832733154
20 190.337982178 178.602871704
30 296.224377441 280.857037354
40 415.984814453 394.469250488
50 577.838653564 548.425720215
60 818.775402832 780.941381836
70 1187.2631958 1144.36071777
80 1820.75270996 1769.78515625
90 3363.41669922 3314.3128418
100 50863.234375 51923.34375
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net13
Model name for the evaluation phase:  net13
Training model...
# Neural Network with 95970 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x131x66
  2          32x133x5
  3          32x133x5
  4          32x67x3
  5          32x67x3
  6          32x67x3
  7          32x34x2
  8          2x34x2
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m0.75133[0m     [32m0.77263[0m    0.97243      0.53984  15.01s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.45812[0m     1.45435    0.31500      0.46784  15.02s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.24479[0m     3.45798    0.07079      0.45749  15.19s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.14814[0m     5.11697    0.02895      0.46716  15.11s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.11958[0m     3.81563    0.03134      0.46287  14.96s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.07954[0m     3.77746    0.02106      0.46193  14.96s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     0.07974     7.14538    0.01116      0.48327  15.08s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.06959[0m     4.30740    0.01616      0.48376  14.98s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.06663[0m     6.53871    0.01019      0.47468  15.29s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     10     0.06672     3.63052    0.01838      0.49789  15.08s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.05770[0m     8.32909    0.00693      0.47011  15.08s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.772629 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x64x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x1x64).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.841573356302
Error rate (%):  15.8426643698
[[43600  2570]
 [ 5707   368]]
(52245,)
(52245,)
roc_auc: 0.64570951333
log_loss: 0.996607508135
roc_auc for the hours: 0.584210526316
log_loss for the hours: 0.546755795172
saving predictions to csv file
hourspatient0_10_net13_10-11-02-59-27.csv
Accuracy validation for the hours:  0.883720930233
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [10]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 0.999907328
saving predictions to csv file
patient0_10_net13_10-11-03-01-26.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config5.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_11']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config5.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_11'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-11 03:01:27.117160
Hostname: kat
gpu0
Configuration 'config5.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net13
evaluation:
    online_training: False
    model: net13

end Configuration
['patient0_11']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [11]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.749031424
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 37.4027713776 20.3596906662
20 138.625271606 132.382019043
30 211.681109619 204.980381775
40 289.691271973 281.780712891
50 389.566116333 380.066696167
60 543.70489502 531.805041504
70 834.583398437 818.790313721
80 1463.92446289 1432.4847168
90 3328.68920898 3260.95727539
100 410646.09375 69810.453125
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net13
Model name for the evaluation phase:  net13
Training model...
# Neural Network with 95970 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x131x66
  2          32x133x5
  3          32x133x5
  4          32x67x3
  5          32x67x3
  6          32x67x3
  7          32x34x2
  8          2x34x2
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m0.81953[0m     [32m0.79090[0m    1.03620      0.62667  15.80s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.50380[0m     1.22722    0.41052      0.52081  14.66s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.31505[0m     2.53306    0.12437      0.49887  15.02s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.19197[0m     3.51794    0.05457      0.48415  14.63s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.11868[0m     2.28836    0.05186      0.46236  14.67s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     0.12893     5.25708    0.02453      0.47136  14.68s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.09083[0m     3.84549    0.02362      0.46861  14.69s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      8     2.72957     [32m0.70358[0m    3.87954      0.61986  14.71s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      9     0.42058     1.54067    0.27299      0.49297  15.12s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     10     0.20907     4.05320    0.05158      0.46674  14.71s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     11     0.12135     3.85172    0.03150      0.48192  14.84s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     12     [36m0.08703[0m     5.61399    0.01550      0.47885  14.80s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     13     [36m0.06944[0m     6.13834    0.01131      0.49571  14.87s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     14     [36m0.06213[0m     6.74066    0.00922      0.48917  15.19s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     15     [36m0.05343[0m     6.22930    0.00858      0.49562  14.82s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     16     0.05542     9.60140    0.00577      0.49907  14.86s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     17     0.05413     4.78667    0.01131      0.47495  14.79s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     18     0.05556     4.12650    0.01346      0.49108  15.02s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.703580 at epoch 8.
Loaded parameters to layer 'conv2d1' (shape 32x1x64x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x1x64).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.604861709254
Error rate (%):  39.5138290746
[[27501 18669]
 [ 1975  4100]]
(52245,)
(52245,)
roc_auc: 0.665320148922
log_loss: 1.42802563059
roc_auc for the hours: 0.668421052632
log_loss for the hours: 0.820080003047
saving predictions to csv file
hourspatient0_11_net13_10-11-03-08-31.csv
Accuracy validation for the hours:  0.651162790698
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [11]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.000845312
saving predictions to csv file
patient0_11_net13_10-11-03-10-44.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config5.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_12']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config5.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_12'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-11 03:10:45.216766
Hostname: kat
gpu0
Configuration 'config5.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net13
evaluation:
    online_training: False
    model: net13

end Configuration
['patient0_12']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [12]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.749621248
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 65.1829460144 35.0811794281
20 246.685302734 233.028952026
30 381.222595215 364.982098389
40 530.423962402 509.868566895
50 730.584533691 703.699279785
60 1040.28303223 1008.42225342
70 1558.99154053 1521.31486816
80 2527.43164063 2455.40673828
90 5046.20957031 4843.92373047
100 126710.1875 64910.4453125
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net13
Model name for the evaluation phase:  net13
Training model...
# Neural Network with 95970 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x131x66
  2          32x133x5
  3          32x133x5
  4          32x67x3
  5          32x67x3
  6          32x67x3
  7          32x34x2
  8          2x34x2
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m0.86043[0m     [32m0.76279[0m    1.12801      0.51638  15.16s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.53021[0m     0.91341    0.58047      0.49231  14.67s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.40555[0m     1.03947    0.39015      0.55489  14.71s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.27381[0m     2.31715    0.11817      0.48126  14.95s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.16202[0m     2.72253    0.05951      0.45843  15.65s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.11490[0m     4.29951    0.02672      0.46027  15.70s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.09599[0m     3.71555    0.02584      0.46655  15.80s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.09109[0m     4.76484    0.01912      0.45057  15.58s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.08029[0m     4.73462    0.01696      0.45928  15.78s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.06104[0m     7.03942    0.00867      0.45622  15.36s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     11     0.07806     4.43003    0.01762      0.45685  15.58s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.762786 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x64x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x1x64).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.833381184802
Error rate (%):  16.6618815198
[[43370  2800]
 [ 5905   170]]
(52245,)
(52245,)
roc_auc: 0.634736382184
log_loss: 0.933072448959
roc_auc for the hours: 0.584210526316
log_loss for the hours: 0.443550002623
saving predictions to csv file
hourspatient0_12_net13_10-11-03-16-15.csv
Accuracy validation for the hours:  0.883720930233
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [12]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.000525824
saving predictions to csv file
patient0_12_net13_10-11-03-18-21.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config5.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_13']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config5.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_13'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-11 03:18:22.317993
Hostname: kat
gpu0
Configuration 'config5.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net13
evaluation:
    online_training: False
    model: net13

end Configuration
['patient0_13']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [13]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.750686208
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 69.0897041321 37.7125782013
20 266.439715576 253.817520142
30 414.331445313 399.039959717
40 579.853991699 560.493823242
50 802.805938721 779.214904785
60 1136.38771973 1110.1892334
70 1641.78244629 1620.17226562
80 2489.06611328 2463.09140625
90 4471.61362305 4441.97880859
100 100082.695312 85056.0390625
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net13
Model name for the evaluation phase:  net13
Training model...
# Neural Network with 95970 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x131x66
  2          32x133x5
  3          32x133x5
  4          32x67x3
  5          32x67x3
  6          32x67x3
  7          32x34x2
  8          2x34x2
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m0.88025[0m     [32m0.80339[0m    1.09568      0.50553  14.94s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.52889[0m     1.19239    0.44356      0.45503  15.13s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.34224[0m     1.83388    0.18662      0.45213  16.04s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.21679[0m     2.58176    0.08397      0.45090  15.89s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.14025[0m     3.01757    0.04648      0.45337  15.79s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.10311[0m     4.47402    0.02305      0.45747  15.85s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.09796[0m     4.25008    0.02305      0.45395  15.83s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.07784[0m     5.24136    0.01485      0.46515  14.84s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      9     0.07947     4.86489    0.01634      0.46455  15.17s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.06686[0m     8.35926    0.00800      0.46035  14.76s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.06408[0m     8.98009    0.00714      0.45633  14.72s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.803387 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x64x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x1x64).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.849880371327
Error rate (%):  15.0119628673
[[44369  1801]
 [ 6042    33]]
(52245,)
(52245,)
roc_auc: 0.627789309681
log_loss: 1.01064518935
roc_auc for the hours: 0.531578947368
log_loss for the hours: 0.641713613066
saving predictions to csv file
hourspatient0_13_net13_10-11-03-23-44.csv
Accuracy validation for the hours:  0.883720930233
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [13]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 1.001644032
saving predictions to csv file
patient0_13_net13_10-11-03-25-47.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config5.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_14']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config5.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_14'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-11 03:25:48.141711
Hostname: kat
gpu0
Configuration 'config5.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net13
evaluation:
    online_training: False
    model: net13

end Configuration
['patient0_14']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [14]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.747995136
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 51.4431194305 28.1161405563
20 195.642379761 187.486203003
30 299.57428894 291.18163147
40 410.908746338 402.061425781
50 555.348205566 546.590423584
60 781.114685059 775.59395752
70 1179.35510254 1183.46280518
80 1939.34797363 1949.83596191
90 3877.67912598 3944.7189209
100 65181.1953125 57682.203125
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net13
Model name for the evaluation phase:  net13
Training model...
# Neural Network with 95970 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x131x66
  2          32x133x5
  3          32x133x5
  4          32x67x3
  5          32x67x3
  6          32x67x3
  7          32x34x2
  8          2x34x2
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m0.82133[0m     [32m0.73200[0m    1.12203      0.56786  15.32s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.49071[0m     1.73889    0.28220      0.46071  14.98s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.27531[0m     1.91566    0.14372      0.45058  15.13s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.18024[0m     3.20594    0.05622      0.46057  15.54s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.11640[0m     3.61172    0.03223      0.43850  15.48s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     0.13351     4.62334    0.02888      0.46265  14.83s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.07507[0m     5.55809    0.01351      0.45788  16.06s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.06822[0m     5.19945    0.01312      0.47280  15.94s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      9     0.07486     4.29987    0.01741      0.47003  15.92s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     10     0.07075     6.28710    0.01125      0.46994  15.89s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.05670[0m     4.30349    0.01318      0.45654  15.93s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.732000 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x64x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x1x64).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.80625897215
Error rate (%):  19.374102785
[[41513  4657]
 [ 5465   610]]
(52245,)
(52245,)
roc_auc: 0.613002913726
log_loss: 0.890259716051
roc_auc for the hours: 0.589473684211
log_loss for the hours: 0.565465701812
saving predictions to csv file
hourspatient0_14_net13_10-11-03-31-29.csv
Accuracy validation for the hours:  0.883720930233
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [14]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 0.946622464
saving predictions to csv file
patient0_14_net13_10-11-03-33-31.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config5.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_15']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config5.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_15'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-11 03:33:32.298161
Hostname: kat
gpu0
Configuration 'config5.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net13
evaluation:
    online_training: False
    model: net13

end Configuration
['patient0_15']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [15]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.748834816
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 34.6773342133 19.007179451
20 129.966018677 125.497892761
30 197.840336609 193.760687256
40 269.3421875 264.920050049
50 359.024520874 354.514923096
60 493.65269165 489.852355957
70 739.064575195 735.682330322
80 1252.53088379 1250.05979004
90 2505.61677246 2502.26618652
100 37134.734375 63323.234375
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net13
Model name for the evaluation phase:  net13
Training model...
# Neural Network with 95970 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x131x66
  2          32x133x5
  3          32x133x5
  4          32x67x3
  5          32x67x3
  6          32x67x3
  7          32x34x2
  8          2x34x2
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m0.71927[0m     [32m0.70095[0m    1.02613      0.60382  14.83s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.46114[0m     1.35445    0.34046      0.51100  14.75s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.23736[0m     3.02802    0.07839      0.48143  14.94s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.14540[0m     3.82582    0.03801      0.49475  14.91s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.09385[0m     5.00700    0.01874      0.49499  14.96s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.08367[0m     4.11872    0.02031      0.47788  14.72s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.07000[0m     5.88086    0.01190      0.48875  14.90s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.06647[0m     5.92190    0.01123      0.48149  14.81s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.06556[0m     5.48698    0.01195      0.48605  15.06s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.05853[0m     4.27460    0.01369      0.48458  15.01s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.05475[0m     7.38677    0.00741      0.47136  15.26s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.700949 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x64x1).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x1x64).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.748760646952
Error rate (%):  25.1239353048
[[37046  9124]
 [ 4002  2073]]
(52245,)
(52245,)
roc_auc: 0.641640813918
log_loss: 0.875380052894
roc_auc for the hours: 0.657894736842
log_loss for the hours: 0.442771800767
saving predictions to csv file
hourspatient0_15_net13_10-11-03-38-49.csv
Accuracy validation for the hours:  0.837209302326
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [15]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 0.99930112
saving predictions to csv file
patient0_15_net13_10-11-03-40-57.csv
