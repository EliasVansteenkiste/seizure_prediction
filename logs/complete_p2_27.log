['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu1', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_0']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_0'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu1')
Git reference:  Timestamp: 2016-10-17 18:51:05.205676
Hostname: kat
gpu1
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net26
evaluation:
    online_training: False
    model: net26

end Configuration
['patient2_0']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [0]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.77099008
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 367.479559326 395.117904663
20 582.979382324 615.201062012
30 795.170080566 830.338665771
40 1032.00554199 1067.2041748
50 1317.6385498 1346.52661133
60 1685.20253906 1697.71447754
70 2197.84929199 2175.63908691
80 3011.64487305 2914.53989258
90 4710.7300293 4431.95449219
100 63321.7421875 58944.8007812
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net26
Model name for the evaluation phase:  net26
Training model...
Elemwise{clip,no_inplace}.0
Elemwise{log,no_inplace}.0
max
Elemwise{sub,no_inplace}.0
Elemwise{clip,no_inplace}.0
Elemwise{log,no_inplace}.0
max
Elemwise{sub,no_inplace}.0
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m3.51006[0m     [32m3.45545[0m    1.01580      0.49985  40.33s
BI_test_bal_complete called with len(X) = 1530
      2     [36m3.45046[0m     3.45616    0.99835      0.49974  40.60s
BI_test_bal_complete called with len(X) = 1530
      3     3.45224     3.46613    0.99599      0.49830  42.40s
BI_test_bal_complete called with len(X) = 1530
      4     3.45644     3.45724    0.99977      0.49959  43.88s
BI_test_bal_complete called with len(X) = 1530
      5     3.45064     3.46153    0.99685      0.49896  44.05s
BI_test_bal_complete called with len(X) = 1530
      6     3.45688     3.45723    0.99990      0.49959  44.11s
BI_test_bal_complete called with len(X) = 1530
      7     3.45546     [32m3.45261[0m    1.00083      0.50026  43.80s
BI_test_bal_complete called with len(X) = 1530
      8     3.45135     3.45510    0.99891      0.49990  44.07s
BI_test_bal_complete called with len(X) = 1530
      9     3.45546     3.45866    0.99907      0.49938  43.95s
BI_test_bal_complete called with len(X) = 1530
     10     3.45081     [32m3.45081[0m    1.00000      0.50052  44.52s
BI_test_bal_complete called with len(X) = 1530
     11     3.45572     [32m3.44902[0m    1.00194      0.50078  45.01s
BI_test_bal_complete called with len(X) = 1530
     12     3.45421     3.45296    1.00036      0.50021  44.18s
BI_test_bal_complete called with len(X) = 1530
     13     3.45715     3.46082    0.99894      0.49907  44.48s
BI_test_bal_complete called with len(X) = 1530
     14     3.45920     [32m3.44799[0m    1.00325      0.50093  43.99s
BI_test_bal_complete called with len(X) = 1530
     15     3.45724     3.45689    1.00010      0.49964  44.36s
BI_test_bal_complete called with len(X) = 1530
     16     3.45581     [32m3.44438[0m    1.00332      0.50145  44.74s
BI_test_bal_complete called with len(X) = 1530
     17     3.45349     3.45582    0.99933      0.49979  44.42s
BI_test_bal_complete called with len(X) = 1530
     18     3.45099     3.45546    0.99871      0.49984  45.14s
BI_test_bal_complete called with len(X) = 1530
     19     3.45456     3.45189    1.00077      0.50036  44.71s
BI_test_bal_complete called with len(X) = 1530
     20     3.45911     3.44975    1.00271      0.50067  45.05s
BI_test_bal_complete called with len(X) = 1530
     21     [36m3.44966[0m     3.44440    1.00153      0.50145  44.72s
BI_test_bal_complete called with len(X) = 1530
     22     3.45171     3.46581    0.99593      0.49835  43.68s
BI_test_bal_complete called with len(X) = 1530
     23     3.45492     3.44479    1.00294      0.50139  44.15s
BI_test_bal_complete called with len(X) = 1530
     24     [36m3.44922[0m     3.45082    0.99954      0.50052  44.23s
BI_test_bal_complete called with len(X) = 1530
     25     3.45581     3.45082    1.00145      0.50052  43.78s
BI_test_bal_complete called with len(X) = 1530
     26     3.44957     3.45118    0.99953      0.50046  44.52s
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 3.444377 at epoch 16.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.116279069767
Error rate (%):  88.3720930233
[[    0 46170]
 [    0  6075]]
(52245,)
(52245,)
roc_auc: 0.5
log_loss: nan
roc_auc for the hours: 0.5
log_loss for the hours: nan
saving predictions to csv file
hourspatient2_0_net26_10-17-19-41-37.csv
Accuracy validation for the hours:  0.116279069767
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [0]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.069993984
saving predictions to csv file
patient2_0_net26_10-17-19-45-16.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu1', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_1']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_1'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu1')
Git reference:  Timestamp: 2016-10-17 19:45:17.864913
Hostname: kat
gpu1
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net26
evaluation:
    online_training: False
    model: net26

end Configuration
['patient2_1']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [1]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.770752512
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 263.661355591 284.954690552
20 416.892218018 440.678961182
30 568.269549561 590.942108154
40 738.6140625 756.022766113
50 948.0390625 954.364257812
60 1230.36213379 1214.27253418
70 1653.89840088 1589.50096436
80 2395.20083008 2220.65932617
90 4170.49838867 3672.37075195
100 56617.8046875 55581.1640625
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net26
Model name for the evaluation phase:  net26
Training model...
Elemwise{clip,no_inplace}.0
Elemwise{log,no_inplace}.0
max
Elemwise{sub,no_inplace}.0
Elemwise{clip,no_inplace}.0
Elemwise{log,no_inplace}.0
max
Elemwise{sub,no_inplace}.0
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m3.51099[0m     [32m3.45545[0m    1.01607      0.49985  40.24s
BI_test_bal_complete called with len(X) = 1530
      2     [36m3.45046[0m     3.45616    0.99835      0.49974  40.52s
BI_test_bal_complete called with len(X) = 1530
      3     3.45224     3.46613    0.99599      0.49830  43.26s
BI_test_bal_complete called with len(X) = 1530
      4     3.45644     3.45724    0.99977      0.49959  43.79s
BI_test_bal_complete called with len(X) = 1530
      5     3.45064     3.46153    0.99685      0.49896  44.66s
BI_test_bal_complete called with len(X) = 1530
      6     3.45688     3.45723    0.99990      0.49959  44.24s
BI_test_bal_complete called with len(X) = 1530
      7     3.45546     [32m3.45261[0m    1.00083      0.50026  44.20s
BI_test_bal_complete called with len(X) = 1530
      8     3.45135     3.45510    0.99891      0.49990  44.58s
BI_test_bal_complete called with len(X) = 1530
      9     3.45546     3.45866    0.99907      0.49938  44.66s
BI_test_bal_complete called with len(X) = 1530
     10     3.45081     [32m3.45081[0m    1.00000      0.50052  44.43s
BI_test_bal_complete called with len(X) = 1530
     11     3.45572     [32m3.44902[0m    1.00194      0.50078  44.59s
BI_test_bal_complete called with len(X) = 1530
     12     3.45421     3.45296    1.00036      0.50021  43.29s
BI_test_bal_complete called with len(X) = 1530
     13     3.45715     3.46082    0.99894      0.49907  44.43s
BI_test_bal_complete called with len(X) = 1530
     14     3.45920     [32m3.44799[0m    1.00325      0.50093  43.88s
BI_test_bal_complete called with len(X) = 1530
     15     3.45724     3.45689    1.00010      0.49964  44.41s
BI_test_bal_complete called with len(X) = 1530
     16     3.45581     [32m3.44438[0m    1.00332      0.50145  45.04s
BI_test_bal_complete called with len(X) = 1530
     17     3.45349     3.45582    0.99933      0.49979  44.55s
BI_test_bal_complete called with len(X) = 1530
     18     3.45099     3.45546    0.99871      0.49984  44.14s
BI_test_bal_complete called with len(X) = 1530
     19     3.45456     3.45189    1.00077      0.50036  44.56s
BI_test_bal_complete called with len(X) = 1530
     20     3.45911     3.44975    1.00271      0.50067  44.02s
BI_test_bal_complete called with len(X) = 1530
     21     [36m3.44966[0m     3.44440    1.00153      0.50145  44.07s
BI_test_bal_complete called with len(X) = 1530
     22     3.45171     3.46581    0.99593      0.49835  44.15s
BI_test_bal_complete called with len(X) = 1530
     23     3.45492     3.44479    1.00294      0.50139  44.05s
BI_test_bal_complete called with len(X) = 1530
     24     [36m3.44922[0m     3.45082    0.99954      0.50052  45.08s
BI_test_bal_complete called with len(X) = 1530
     25     3.45581     3.45082    1.00145      0.50052  44.64s
BI_test_bal_complete called with len(X) = 1530
     26     3.44957     3.45118    0.99953      0.50046  44.90s
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 3.444377 at epoch 16.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.116279069767
Error rate (%):  88.3720930233
[[    0 46170]
 [    0  6075]]
(52245,)
(52245,)
roc_auc: 0.5
log_loss: nan
roc_auc for the hours: 0.5
log_loss for the hours: nan
saving predictions to csv file
hourspatient2_1_net26_10-17-20-14-28.csv
Accuracy validation for the hours:  0.116279069767
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2286
test_magnitude.shape (234, 64)
(2286, 1, 234, 64)
Read in dataset from test_3 ...
read data and preprocess (fft and slicing)
read in channels [1]
/home/eavsteen/seizure_detection/data/test_3/3_
Done reading in 2286 test snippets of 10min.
Memory usage (GB): 1.074712576
saving predictions to csv file
patient2_1_net26_10-17-20-18-35.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu1', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_2']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_2'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu1')
Git reference:  Timestamp: 2016-10-17 20:18:36.393116
Hostname: kat
gpu1
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net26
evaluation:
    online_training: False
    model: net26

end Configuration
['patient2_2']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [2]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.770715648
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 209.986540222 225.906962585
20 329.095306396 346.162701416
30 444.230593872 460.11050415
40 570.524414062 582.58815918
50 722.16116333 726.961212158
60 921.348901367 911.623071289
70 1211.68074951 1175.55042725
80 1700.91003418 1611.25981445
90 2771.39865723 2552.46484375
100 58473.7617188 75930.625
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net26
Model name for the evaluation phase:  net26
Training model...
Elemwise{clip,no_inplace}.0
Elemwise{log,no_inplace}.0
max
Elemwise{sub,no_inplace}.0
Elemwise{clip,no_inplace}.0
Elemwise{log,no_inplace}.0
max
Elemwise{sub,no_inplace}.0
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m3.50770[0m     [32m3.45545[0m    1.01512      0.49985  40.29s
BI_test_bal_complete called with len(X) = 1530
      2     [36m3.45046[0m     3.45616    0.99835      0.49974  41.91s
BI_test_bal_complete called with len(X) = 1530
      3     3.45224     3.46613    0.99599      0.49830  43.09s
BI_test_bal_complete called with len(X) = 1530
      4     3.45644     3.45724    0.99977      0.49959  44.05s
BI_test_bal_complete called with len(X) = 1530
      5     3.45064     3.46153    0.99685      0.49896  43.70s
BI_test_bal_complete called with len(X) = 1530
      6     3.45688     3.45723    0.99990      0.49959  43.61s
BI_test_bal_complete called with len(X) = 1530
      7     3.45546     [32m3.45261[0m    1.00083      0.50026  43.63s
BI_test_bal_complete called with len(X) = 1530
      8     3.45135     3.45510    0.99891      0.49990  44.33s
BI_test_bal_complete called with len(X) = 1530
      9     3.45546     3.45866    0.99907      0.49938  44.07s
BI_test_bal_complete called with len(X) = 1530
     10     3.45081     [32m3.45081[0m    1.00000      0.50052  44.70s
BI_test_bal_complete called with len(X) = 1530
     11     3.45572     [32m3.44902[0m    1.00194      0.50078  44.28s
BI_test_bal_complete called with len(X) = 1530
     12     3.45421     3.45296    1.00036      0.50021  44.73s
BI_test_bal_complete called with len(X) = 1530
     13     3.45715     3.46082    0.99894      0.49907  44.90s
BI_test_bal_complete called with len(X) = 1530
     14     3.45920     [32m3.44799[0m    1.00325      0.50093  44.43s
BI_test_bal_complete called with len(X) = 1530
     15     3.45724     3.45689    1.00010      0.49964  44.32s
BI_test_bal_complete called with len(X) = 1530
     16     3.45581     [32m3.44438[0m    1.00332      0.50145  44.81s
BI_test_bal_complete called with len(X) = 1530
     17     3.45349     3.45582    0.99933      0.49979  44.44s
BI_test_bal_complete called with len(X) = 1530
     18     3.45099     3.45546    0.99871      0.49984  44.29s
BI_test_bal_complete called with len(X) = 1530
     19     3.45456     3.45189    1.00077      0.50036  44.73s
BI_test_bal_complete called with len(X) = 1530
     20     3.45911     3.44975    1.00271      0.50067  44.80s
BI_test_bal_complete called with len(X) = 1530
     21     [36m3.44966[0m     3.44440    1.00153      0.50145  44.07s
BI_test_bal_complete called with len(X) = 1530
     22     3.45171     3.46581    0.99593      0.49835  43.71s
BI_test_bal_complete called with len(X) = 1530
     23     3.45492     3.44479    1.00294      0.50139  44.18s
BI_test_bal_complete called with len(X) = 1530
     24     [36m3.44922[0m     3.45082    0.99954      0.50052  44.28s
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu1', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2_0']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient2_0'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu1')
Git reference:  Timestamp: 2016-10-17 22:28:01.482331
Hostname: kat
gpu1
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net26
evaluation:
    online_training: False
    model: net26

end Configuration
['patient2_0']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [0]
/home/eavsteen/seizure_detection/data/train_3/3_
normal i 0
normal i 1
normal i 2
