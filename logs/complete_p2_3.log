['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run3.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2', '--channels=0']
Command line arguments: Namespace(channels=[0], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run3.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient2'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-09-28 11:57:45.351115
Hostname: kat
gpu2
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net5
evaluation:
    online_training: False
    model: net5

end Configuration
Loading and preprocessing data...
test_magnitude.shape (1406, 64)
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_3/3_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.725549056
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 370.383615112 382.042739868
20 585.952758789 603.113830566
30 798.876318359 815.979187012
40 1037.00437012 1049.37390137
50 1324.60302734 1323.22802734
60 1695.00808105 1667.13757324
70 2212.20117188 2132.72290039
80 3034.4668457 2848.29077148
90 4751.07553711 4309.59814453
100 63321.7421875 54863.8242188
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net5
Model name for the evaluation phase:  net5
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          64x192x64
  2          64x192x64
  3          64x192x64
  4          64x96x32
  5          64x96x32
  6          64x96x32
  7          64x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m1.39317[0m     [32m0.66781[0m    2.08619      0.60140  62.60s
      2     [36m0.52516[0m     0.71359    0.73595      0.68685  64.78s
      3     [36m0.50677[0m     0.79033    0.64121      0.74723  66.07s
      4     [36m0.49970[0m     0.88901    0.56208      0.64941  66.07s
      5     [36m0.49384[0m     0.81742    0.60414      0.71549  65.84s
Early stopping.
Best valid loss was 0.667805 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d4' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d4' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d7' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d7' (shape 64).
Loaded parameters to layer 'conv2d8' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 0 0 1 1 0 1 1 1 1 0 0 1 1 1 1 0 0 1 1 1 0 1 0 1 1 1 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.603125
Error rate (%):  39.6875
yVal [0 0 1 ..., 0 1 1]
[[1556 2264]
 [ 784 3076]]
roc_auc: 0.741381602148
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (39, 1, 1406, 64)
[ 0.09696515  0.90303469]
[ 0.77974194  0.22025777]
[ 0.2742098   0.72578996]
[ 0.44830549  0.55169439]
[ 0.18095429  0.81904542]
[ 0.984375    0.01562498]
[  1.00000000e+00   1.30724898e-16]
[ 0.45120215  0.54879779]
[ 0.20891324  0.79108697]
[  1.00000000e+00   5.56544602e-11]
[  1.00000000e+00   2.95045375e-08]
[ 0.88897157  0.11102817]
[ 0.19055928  0.80944085]
[ 0.09684352  0.90315706]
[ 0.06973772  0.93026316]
[ 0.69094026  0.30905965]
[ 0.73001415  0.26998618]
[ 0.18677337  0.81322652]
[ 0.98609948  0.01390095]
[ 0.31087193  0.6891278 ]
[  1.00000000e+00   5.43708654e-11]
[ 0.09648581  0.90351433]
[ 0.02817076  0.97182888]
[  9.99991357e-01   1.07757551e-05]
[ 0.0230295   0.97697002]
[ 0.00695444  0.99304581]
[ 0.07073945  0.92926073]
[ 0.76200914  0.23799172]
[ 0.98975593  0.01024532]
[ 0.88000709  0.11999406]
[ 0.04426782  0.95573217]
[ 0.26738393  0.73261607]
[  2.54447641e-05   9.99977708e-01]
[ 0.96232963  0.03767224]
[  1.23499907e-04   9.99878943e-01]
[  5.26445376e-07   1.00000000e+00]
[  9.99907851e-01   9.23811021e-05]
[  4.65180405e-04   9.99533534e-01]
[ 0.4668003   0.53319925]
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[ 0.99845219  0.00154904]
[ 0.02114145  0.97885853]
[ 0.01342212  0.98657799]
[  2.17428109e-07   9.99999881e-01]
[  1.73659937e-05   9.99984324e-01]
roc_auc for the hours: 0.769230769231
Accuracy validation for the hours:  0.454545454545
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run3.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2', '--channels=1']
Command line arguments: Namespace(channels=[1], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run3.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient2'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-09-28 12:07:22.573001
Hostname: kat
gpu2
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net5
evaluation:
    online_training: False
    model: net5

end Configuration
Loading and preprocessing data...
test_magnitude.shape (1406, 64)
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_3/3_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.726818816
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 265.569192505 275.922683716
20 418.741949463 432.515045166
30 570.463165283 582.129150391
40 741.529833984 745.226196289
50 952.19519043 940.145874023
60 1236.58071289 1194.78979492
70 1663.88118896 1561.48345947
80 2413.32441406 2174.828125
90 4212.56235352 3563.96838379
100 56617.8046875 55581.1640625
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net5
Model name for the evaluation phase:  net5
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          64x192x64
  2          64x192x64
  3          64x192x64
  4          64x96x32
  5          64x96x32
  6          64x96x32
  7          64x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m1.13276[0m     [32m0.79605[0m    1.42298      0.54557  63.15s
      2     [36m0.53399[0m     0.84485    0.63205      0.54736  65.95s
      3     [36m0.51177[0m     0.99891    0.51233      0.50260  65.87s
      4     [36m0.49674[0m     0.88065    0.56406      0.61410  65.83s
      5     [36m0.47517[0m     0.87581    0.54255      0.62223  66.13s
Early stopping.
Best valid loss was 0.796047 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d4' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d4' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d7' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d7' (shape 64).
Loaded parameters to layer 'conv2d8' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 1 1 1 1 0 0 1 0 1 0 0 0 1 0 0 0 0 0 1 1 0 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.538802083333
Error rate (%):  46.1197916667
yVal [0 0 1 ..., 0 1 1]
[[3064  756]
 [2786 1074]]
roc_auc: 0.601600792122
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (39, 1, 1406, 64)
[ 0.98138595  0.01861443]
[ 0.98127413  0.01872613]
[ 0.94114643  0.05885383]
[ 0.99418455  0.00581527]
[ 0.97195178  0.02804885]
[  9.99208987e-01   7.91557599e-04]
[  1.00000000e+00   1.99483574e-19]
[ 0.87218839  0.12781253]
[ 0.98260581  0.01739314]
[  1.00000000e+00   9.58653990e-12]
[  1.00000000e+00   5.27823900e-08]
[ 0.99471009  0.00529029]
[ 0.46423465  0.53576517]
[ 0.69717729  0.30282289]
[ 0.11608938  0.88391083]
[ 0.88976038  0.11024044]
[ 0.83945405  0.16054602]
[ 0.95956248  0.04043803]
[  9.99942720e-01   5.72796816e-05]
[ 0.92215067  0.07784972]
[  1.00000000e+00   2.65063250e-07]
[ 0.98441941  0.01558091]
[ 0.88437128  0.11562791]
[  1.00000000e+00   3.82242327e-08]
[ 0.93028873  0.06971066]
[ 0.88647443  0.11352557]
[ 0.76995152  0.23004846]
[ 0.9916327   0.00836737]
[  9.99993145e-01   7.02125180e-06]
[ 0.9981209   0.00187916]
[ 0.8932519   0.10674838]
[ 0.82855284  0.17144699]
[ 0.45282394  0.54717618]
[ 0.91766924  0.08233171]
[ 0.50267172  0.49732831]
[ 0.01708494  0.98291618]
[  1.00000000e+00   1.37270284e-09]
[ 0.10430163  0.89569861]
[ 0.68516076  0.31483841]
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[  9.99998391e-01   1.93618666e-06]
[ 0.74875611  0.25124371]
[ 0.83319116  0.16680788]
[ 0.37107012  0.6289292 ]
[ 0.96246958  0.03753148]
roc_auc for the hours: 0.615384615385
Accuracy validation for the hours:  0.795454545455
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run3.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2', '--channels=2']
Command line arguments: Namespace(channels=[2], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run3.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient2'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-09-28 12:16:52.691190
Hostname: kat
gpu2
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net5
evaluation:
    online_training: False
    model: net5

end Configuration
Loading and preprocessing data...
test_magnitude.shape (1406, 64)
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_3/3_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.724652032
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 211.564569092 218.920532227
20 330.673291016 339.741790771
30 446.107928467 453.246795654
40 572.932189941 574.249145508
50 725.553161621 715.946166992
60 926.149853516 896.588439941
70 1218.91170654 1154.75012207
80 1712.55070801 1579.12597656
90 2791.07785645 2495.08483887
100 58473.7617188 75930.625
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net5
Model name for the evaluation phase:  net5
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          64x192x64
  2          64x192x64
  3          64x192x64
  4          64x96x32
  5          64x96x32
  6          64x96x32
  7          64x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m1.01980[0m     [32m0.89221[0m    1.14300      0.51562  63.46s
      2     [36m0.50227[0m     1.26831    0.39602      0.53174  65.81s
      3     [36m0.47419[0m     1.39039    0.34105      0.64827  65.59s
      4     [36m0.46184[0m     1.56024    0.29600      0.64242  65.34s
      5     [36m0.44456[0m     1.72558    0.25763      0.63704  65.75s
Early stopping.
Best valid loss was 0.892215 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d4' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d4' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d7' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d7' (shape 64).
Loaded parameters to layer 'conv2d8' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 0 0 1 1 0 1 1 1 1 0 1 1 1 1 1 1 0 1 1 1 0 1 1 1 1 1 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.514713541667
Error rate (%):  48.5286458333
yVal [0 0 1 ..., 0 1 1]
[[ 885 2935]
 [ 792 3068]]
roc_auc: 0.575962991346
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (39, 1, 1406, 64)
[ 0.04967084  0.95032883]
[ 0.53679657  0.46320349]
[  4.90836450e-04   9.99509811e-01]
[ 0.09221508  0.90778506]
[ 0.00759225  0.99240792]
[ 0.00416924  0.99583125]
[  1.00000000e+00   7.09646031e-07]
[ 0.15626504  0.84373474]
[  3.02768429e-04   9.99698102e-01]
[ 0.99572635  0.00427519]
[ 0.99569285  0.0043083 ]
[ 0.10460063  0.8954004 ]
[ 0.0013868   0.99861282]
[  5.55503902e-06   9.99999225e-01]
[  3.03883189e-06   9.99997795e-01]
[ 0.52516741  0.47483298]
[ 0.02233339  0.97766566]
[ 0.00208693  0.99791223]
[ 0.90763307  0.09236725]
[  1.26336643e-04   9.99878049e-01]
[ 0.23549016  0.76450986]
[  7.44049088e-04   9.99257624e-01]
[  1.77976763e-05   9.99984622e-01]
[ 0.94586629  0.05413323]
[ 0.70819545  0.29180464]
[ 0.13213776  0.86786222]
[ 0.09410631  0.90589511]
[ 0.64408576  0.35591385]
[ 0.13582988  0.86416948]
[ 0.36675128  0.63324881]
[ 0.85116333  0.1488369 ]
[ 0.55594158  0.44405839]
[  3.39313465e-06   9.99997377e-01]
[  9.06270725e-05   9.99913812e-01]
[  4.75739836e-10   1.00000000e+00]
[  3.49945572e-06   9.99997973e-01]
[ 0.02110624  0.97889602]
[  8.30867066e-07   9.99999821e-01]
[  9.38530548e-07   9.99999821e-01]
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[  9.99969542e-01   3.26351947e-05]
[  7.56998998e-05   9.99929547e-01]
[ 0.23742922  0.76257062]
[  1.60794389e-05   9.99986053e-01]
[  1.88039365e-07   1.00000000e+00]
roc_auc for the hours: 0.587179487179
Accuracy validation for the hours:  0.340909090909
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run3.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2', '--channels=3']
Command line arguments: Namespace(channels=[3], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run3.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient2'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-09-28 12:26:24.151639
Hostname: kat
gpu2
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net5
evaluation:
    online_training: False
    model: net5

end Configuration
Loading and preprocessing data...
test_magnitude.shape (1406, 64)
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_3/3_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.725458944
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 234.08664093 239.721954346
20 364.584063721 371.962585449
30 490.508004761 496.504821777
40 630.362109375 631.961303711
50 803.842010498 795.534606934
60 1044.95795898 1019.23065186
70 1429.24927979 1370.09783936
80 2121.47871094 1998.69506836
90 3590.03435059 3337.28955078
100 147926.25 114985.820312
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net5
Model name for the evaluation phase:  net5
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          64x192x64
  2          64x192x64
  3          64x192x64
  4          64x96x32
  5          64x96x32
  6          64x96x32
  7          64x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m1.21970[0m     [32m1.00200[0m    1.21727      0.53548  63.95s
      2     [36m0.50543[0m     1.07536    0.47001      0.61100  65.49s
      3     [36m0.48067[0m     1.04306    0.46082      0.65495  65.66s
      4     [36m0.46914[0m     [32m0.99956[0m    0.46935      0.65267  65.88s
      5     [36m0.45844[0m     1.12511    0.40747      0.64372  66.31s
      6     [36m0.43505[0m     1.17157    0.37134      0.64225  66.05s
      7     [36m0.42240[0m     1.71258    0.24665      0.63688  65.82s
      8     [36m0.40220[0m     1.16369    0.34563      0.64990  65.49s
Early stopping.
Best valid loss was 0.999555 at epoch 4.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d4' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d4' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d7' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d7' (shape 64).
Loaded parameters to layer 'conv2d8' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[1 0 0 0 0 0 1 0 1 1 0 0 0 0 1 1 1 0 0 0 1 0 1 0 1 0 1 1 0 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.658072916667
Error rate (%):  34.1927083333
yVal [0 0 1 ..., 0 1 1]
[[2327 1493]
 [1133 2727]]
roc_auc: 0.672838618669
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (39, 1, 1406, 64)
[  9.99977767e-01   2.46398813e-05]
[ 0.36846989  0.63153034]
[ 0.32877985  0.67121977]
[ 0.07564598  0.92435426]
[ 0.11018819  0.88981241]
[  9.99846399e-01   1.53658417e-04]
[  1.00000000e+00   1.01779724e-22]
[ 0.4493655   0.55063456]
[ 0.67562121  0.32437876]
[  1.00000000e+00   3.38669692e-09]
[  1.00000000e+00   4.92039874e-07]
[  9.99998808e-01   1.85627630e-06]
[  9.99011099e-01   9.89431050e-04]
[ 0.99866235  0.00134023]
[ 0.05500338  0.94499695]
[ 0.77048892  0.22951101]
[ 0.89145619  0.1085448 ]
[ 0.04394617  0.95605421]
[ 0.96055591  0.03944438]
[ 0.99494225  0.0050589 ]
[  9.99994993e-01   6.41442466e-06]
[ 0.19576946  0.80423063]
[ 0.51611954  0.48388028]
[  1.00000000e+00   2.46318188e-10]
[ 0.72143304  0.27856711]
[  9.99901414e-01   1.00933350e-04]
[ 0.91710353  0.08289789]
[ 0.78651518  0.21348478]
[ 0.98025191  0.01974898]
[  9.99893129e-01   1.08154614e-04]
[ 0.54740775  0.45259255]
[ 0.89393717  0.10606388]
[ 0.94838095  0.0516184 ]
[  9.99720395e-01   2.79813394e-04]
[ 0.79782581  0.20217477]
[ 0.53969216  0.46030706]
[  1.00000000e+00   5.15399146e-09]
[ 0.00360071  0.99640048]
[ 0.4795379   0.52046216]
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[  1.00000000e+00   2.02467773e-12]
[ 0.25897774  0.74102134]
[ 0.72751713  0.27248305]
[  5.53850714e-06   9.99996006e-01]
[ 0.2159086   0.78409165]
roc_auc for the hours: 0.671794871795
Accuracy validation for the hours:  0.727272727273
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run3.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2', '--channels=4']
Command line arguments: Namespace(channels=[4], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run3.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient2'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-09-28 12:39:10.005854
Hostname: kat
gpu2
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net5
evaluation:
    online_training: False
    model: net5

end Configuration
Loading and preprocessing data...
test_magnitude.shape (1406, 64)
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_3/3_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.726208512
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 166.741564941 169.260734558
20 261.176831055 264.865814209
30 354.425119019 357.479827881
40 461.596020508 461.342407227
50 599.61050415 592.545623779
60 798.440466309 775.908874512
70 1114.19197998 1058.04302979
80 1661.69353027 1535.50854492
90 2826.51435547 2533.14819336
100 44210.6640625 39898.75
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net5
Model name for the evaluation phase:  net5
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          64x192x64
  2          64x192x64
  3          64x192x64
  4          64x96x32
  5          64x96x32
  6          64x96x32
  7          64x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m0.94425[0m     [32m0.70954[0m    1.33079      0.62939  64.49s
      2     [36m0.49146[0m     [32m0.70836[0m    0.69380      0.63721  66.60s
      3     [36m0.47700[0m     [32m0.68612[0m    0.69522      0.65283  66.46s
      4     [36m0.46644[0m     [32m0.66557[0m    0.70081      0.66309  66.08s
      5     [36m0.45636[0m     [32m0.66436[0m    0.68691      0.68896  65.32s
      6     [36m0.43343[0m     0.71030    0.61021      0.67806  64.92s
      7     [36m0.40553[0m     0.69954    0.57971      0.62581  65.99s
      8     [36m0.37689[0m     0.78210    0.48190      0.62598  66.02s
      9     [36m0.33943[0m     0.99828    0.34001      0.69368  66.37s
Early stopping.
Best valid loss was 0.664363 at epoch 5.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d4' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d4' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d7' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d7' (shape 64).
Loaded parameters to layer 'conv2d8' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[1 0 0 0 0 1 1 0 1 1 1 0 0 0 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.6890625
Error rate (%):  31.09375
yVal [0 0 1 ..., 0 1 1]
[[2774 1046]
 [1342 2518]]
roc_auc: 0.745977504544
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (39, 1, 1406, 64)
[ 0.99661517  0.00338532]
[ 0.99494439  0.00505646]
[ 0.99390882  0.00609291]
[  9.99675572e-01   3.25632718e-04]
[ 0.98173678  0.01826371]
[  9.99957681e-01   4.26409315e-05]
[  1.00000000e+00   2.07395473e-35]
[  9.99995351e-01   6.06989943e-06]
[ 0.95996445  0.04003562]
[  1.00000000e+00   7.44071910e-16]
[  9.99996960e-01   3.08620133e-06]
[  9.99976993e-01   2.35615535e-05]
[ 0.97027153  0.02972951]
[ 0.95184624  0.0481547 ]
[ 0.35804656  0.64195365]
[ 0.99696302  0.00303726]
[ 0.92292172  0.07707907]
[ 0.9767924   0.02320905]
[  1.00000000e+00   4.18469241e-08]
[ 0.96863836  0.03136257]
[  9.99972045e-01   2.85541701e-05]
[ 0.67967904  0.32032079]
[ 0.43118721  0.56881291]
[  1.00000000e+00   7.42590434e-11]
[  9.99999881e-01   2.09650921e-07]
[ 0.91611159  0.08388886]
[ 0.67777514  0.32222497]
[ 0.97060645  0.0293934 ]
[  1.00000000e+00   8.98526309e-10]
[ 0.97751814  0.02248196]
[ 0.98966944  0.01033045]
[ 0.94571006  0.05429006]
[ 0.96131134  0.03868956]
[  1.00000000e+00   3.95213349e-13]
[ 0.79641765  0.20358211]
[ 0.96563065  0.03436906]
[ 0.91635841  0.08364174]
[ 0.00314786  0.99685192]
[ 0.02466551  0.97533518]
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[  9.99958515e-01   4.15842842e-05]
[ 0.09936454  0.90063506]
[ 0.98174554  0.01825584]
[ 0.11979569  0.88020462]
[ 0.04538968  0.95461196]
roc_auc for the hours: 0.717948717949
Accuracy validation for the hours:  0.863636363636
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run3.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2', '--channels=5']
Command line arguments: Namespace(channels=[5], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run3.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient2'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-09-28 12:53:03.581429
Hostname: kat
gpu2
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net5
evaluation:
    online_training: False
    model: net5

end Configuration
Loading and preprocessing data...
test_magnitude.shape (1406, 64)
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_3/3_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.724914176
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 186.851734924 190.438827515
20 296.48951416 301.152984619
30 409.39744873 412.204345703
40 545.394494629 542.710998535
50 730.416595459 715.384063721
60 1010.47353516 968.890319824
70 1466.35765381 1367.28033447
80 2271.5902832 2048.15332031
90 4106.57885742 3558.15698242
100 67580.4921875 68869.3984375
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net5
Model name for the evaluation phase:  net5
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          64x192x64
  2          64x192x64
  3          64x192x64
  4          64x96x32
  5          64x96x32
  6          64x96x32
  7          64x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m1.06395[0m     [32m0.70429[0m    1.51067      0.56982  64.95s
      2     [36m0.53576[0m     0.77225    0.69377      0.57943  66.31s
      3     [36m0.50626[0m     0.80841    0.62624      0.58415  66.05s
      4     [36m0.48413[0m     0.75405    0.64204      0.62337  65.21s
      5     [36m0.45263[0m     0.87888    0.51501      0.60531  64.98s
Early stopping.
Best valid loss was 0.704293 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d4' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d4' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d7' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d7' (shape 64).
Loaded parameters to layer 'conv2d8' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[1 1 1 0 0 1 1 0 1 1 1 1 0 0 1 1 1 0 0 0 1 1 1 0 1 0 1 1 1 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.576432291667
Error rate (%):  42.3567708333
yVal [0 0 1 ..., 0 1 1]
[[1917 1903]
 [1350 2510]]
roc_auc: 0.620248385915
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (39, 1, 1406, 64)
[ 0.51694632  0.48305354]
[ 0.31890705  0.68109369]
[ 0.09985154  0.90014899]
[ 0.70620155  0.29379785]
[ 0.13589266  0.86410773]
[ 0.95051831  0.04948195]
[  1.00000000e+00   8.83232696e-14]
[ 0.08824159  0.91175932]
[ 0.87479657  0.12520297]
[  9.99987364e-01   1.28373995e-05]
[  9.99979198e-01   2.10988565e-05]
[ 0.96746963  0.03253068]
[ 0.06415179  0.93584889]
[ 0.86243105  0.13756864]
[ 0.04428291  0.95571733]
[ 0.97740674  0.02259486]
[ 0.96110016  0.03890038]
[ 0.59323257  0.40676728]
[ 0.99857295  0.00142851]
[ 0.92171574  0.07828382]
[  9.99909282e-01   9.42238548e-05]
[ 0.53412062  0.46587914]
[ 0.45949748  0.54050255]
[  9.99986112e-01   1.90224018e-05]
[ 0.76972091  0.23027842]
[ 0.27140632  0.72859317]
[ 0.2449055   0.75509429]
[ 0.85919648  0.14080407]
[ 0.97421765  0.02578208]
[ 0.99122941  0.0087718 ]
[ 0.02171879  0.97828054]
[ 0.87015629  0.12984495]
[ 0.00790125  0.99209797]
[ 0.97291857  0.02708114]
[ 0.56145221  0.43854734]
[  7.81121664e-04   9.99220550e-01]
[ 0.99424785  0.00575293]
[  9.33091796e-05   9.99910891e-01]
[ 0.11403954  0.8859604 ]
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[  9.99841571e-01   1.61345262e-04]
[ 0.13744734  0.86255306]
[ 0.03089474  0.96910465]
[ 0.01353528  0.98646474]
[ 0.87312341  0.12687653]
roc_auc for the hours: 0.620512820513
Accuracy validation for the hours:  0.636363636364
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run3.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2', '--channels=6']
Command line arguments: Namespace(channels=[6], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run3.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient2'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-09-28 13:02:35.209695
Hostname: kat
gpu2
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net5
evaluation:
    online_training: False
    model: net5

end Configuration
Loading and preprocessing data...
test_magnitude.shape (1406, 64)
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_3/3_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.726032384
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 164.47532959 169.942024231
20 259.860992432 268.591369629
30 357.403549194 366.823059082
40 473.373016357 480.896636963
50 629.507781982 631.192077637
60 865.92487793 853.120605469
70 1261.51429443 1216.43780518
80 1970.32902832 1859.09008789
90 3448.32658691 3177.92431641
100 47858.3515625 52179.953125
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net5
Model name for the evaluation phase:  net5
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          64x192x64
  2          64x192x64
  3          64x192x64
  4          64x96x32
  5          64x96x32
  6          64x96x32
  7          64x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m1.06077[0m     [32m0.68794[0m    1.54196      0.68213  64.13s
      2     [36m0.52375[0m     0.75420    0.69445      0.72803  65.80s
      3     [36m0.50751[0m     0.79686    0.63689      0.69010  65.68s
      4     [36m0.49256[0m     0.85080    0.57894      0.63574  65.12s
      5     [36m0.46755[0m     0.79302    0.58958      0.73796  64.73s
Early stopping.
Best valid loss was 0.687936 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d4' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d4' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d7' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d7' (shape 64).
Loaded parameters to layer 'conv2d8' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[1 1 0 0 0 1 1 0 1 1 1 1 0 0 1 1 1 1 0 0 1 1 1 0 1 0 1 1 1 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.680598958333
Error rate (%):  31.9401041667
yVal [0 0 1 ..., 0 1 1]
[[2151 1669]
 [ 784 3076]]
roc_auc: 0.700478121694
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (39, 1, 1406, 64)
[ 0.95376891  0.04623167]
[ 0.64528114  0.3547186 ]
[ 0.56263351  0.43736649]
[ 0.99213427  0.00786591]
[ 0.6287449   0.37125519]
[ 0.99846071  0.00154066]
[  1.00000000e+00   1.44764906e-23]
[ 0.95422363  0.04577687]
[ 0.44072542  0.55927449]
[  1.00000000e+00   1.55827337e-10]
[  9.99999404e-01   7.55253154e-07]
[ 0.93477976  0.06521997]
[ 0.39549068  0.60450923]
[ 0.46389306  0.53610629]
[ 0.19541325  0.80458683]
[ 0.87794656  0.12205375]
[ 0.62553877  0.37446192]
[ 0.78352541  0.21647429]
[  9.99865592e-01   1.34443748e-04]
[ 0.16402678  0.83597302]
[ 0.78678602  0.21321374]
[ 0.12864378  0.87135547]
[ 0.03849262  0.96150744]
[  1.00000000e+00   7.73311939e-08]
[ 0.43095684  0.5690428 ]
[ 0.00385679  0.99614257]
[ 0.00421069  0.99579334]
[ 0.80895716  0.19104269]
[ 0.94932306  0.05067851]
[ 0.89487809  0.10512307]
[ 0.03188305  0.96811765]
[ 0.8744002   0.12560029]
[ 0.46447745  0.53552228]
[  9.99977589e-01   2.46853506e-05]
[ 0.1210862  0.8789137]
[ 0.93569022  0.06430901]
[  9.99996066e-01   5.65673417e-06]
[ 0.05062955  0.94937068]
[ 0.15253295  0.84746706]
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[  9.99909997e-01   9.01388485e-05]
[ 0.16528544  0.83471519]
[ 0.04249058  0.95751071]
[ 0.14604081  0.85395908]
[ 0.00133587  0.99866468]
roc_auc for the hours: 0.728205128205
Accuracy validation for the hours:  0.636363636364
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run3.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2', '--channels=7']
Command line arguments: Namespace(channels=[7], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run3.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient2'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-09-28 13:12:01.941326
Hostname: kat
gpu2
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net5
evaluation:
    online_training: False
    model: net5

end Configuration
Loading and preprocessing data...
test_magnitude.shape (1406, 64)
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_3/3_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.72480768
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 178.786965942 193.060745239
20 287.408544922 309.894989014
30 401.81534729 431.074569702
40 541.658898926 576.180419922
50 727.914031982 766.537658691
60 991.201574707 1031.5402832
70 1382.93083496 1416.6105957
80 2000.69443359 2018.96716309
90 3129.06638184 3105.98327637
100 66354.203125 92128.8515625
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net5
Model name for the evaluation phase:  net5
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          64x192x64
  2          64x192x64
  3          64x192x64
  4          64x96x32
  5          64x96x32
  6          64x96x32
  7          64x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m1.19036[0m     [32m0.77139[0m    1.54314      0.66374  63.81s
      2     [36m0.49646[0m     0.92223    0.53832      0.66895  65.32s
      3     [36m0.46708[0m     0.87385    0.53451      0.63883  66.08s
      4     [36m0.45120[0m     0.95563    0.47215      0.65837  65.77s
      5     [36m0.42382[0m     1.15654    0.36645      0.67806  65.60s
Early stopping.
Best valid loss was 0.771390 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d4' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d4' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d7' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d7' (shape 64).
Loaded parameters to layer 'conv2d8' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[1 1 0 0 0 1 1 0 1 1 1 1 0 0 1 0 1 1 0 0 1 1 1 0 1 1 1 1 1 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.659635416667
Error rate (%):  34.0364583333
yVal [0 0 1 ..., 0 1 1]
[[2012 1808]
 [ 806 3054]]
roc_auc: 0.643525045439
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (39, 1, 1406, 64)
[ 0.93274426  0.06725569]
[ 0.99121296  0.00878675]
[ 0.68906844  0.31093186]
[ 0.67549288  0.32450742]
[ 0.48845798  0.5115422 ]
[ 0.97131741  0.02868391]
[  1.00000000e+00   1.40188221e-17]
[ 0.94100726  0.05899274]
[ 0.29247826  0.70752192]
[  1.00000000e+00   8.93067564e-11]
[  1.00000000e+00   5.85214543e-09]
[ 0.99817938  0.00182049]
[ 0.64666343  0.35333756]
[ 0.0881757   0.91182393]
[ 0.07430253  0.92569703]
[  9.99844372e-01   1.56516471e-04]
[ 0.61896783  0.38103166]
[ 0.01175758  0.98824179]
[  9.99994993e-01   5.62821606e-06]
[ 0.37207997  0.62792033]
[ 0.26845405  0.73154551]
[ 0.00140648  0.99859446]
[ 0.00153427  0.998465  ]
[  1.00000000e+00   7.88706558e-08]
[ 0.04634181  0.95365757]
[ 0.00545837  0.99454182]
[ 0.11174643  0.88825375]
[ 0.85585535  0.1441455 ]
[  9.99986947e-01   1.34538923e-05]
[ 0.85439473  0.1456057 ]
[  9.49320558e-04   9.99049962e-01]
[ 0.74326485  0.25673568]
[ 0.02073749  0.97926211]
[ 0.99163413  0.00836492]
[ 0.00151572  0.99848461]
[ 0.34202641  0.65797323]
[  9.99355376e-01   6.45888154e-04]
[ 0.00139577  0.99860328]
[ 0.00429261  0.99570662]
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[  1.00000000e+00   4.93636634e-08]
[ 0.09502333  0.90497643]
[ 0.03520269  0.96479821]
[ 0.02066103  0.97933888]
[  8.61163717e-04   9.99138296e-01]
roc_auc for the hours: 0.666666666667
Accuracy validation for the hours:  0.568181818182
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run3.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2', '--channels=8']
Command line arguments: Namespace(channels=[8], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run3.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient2'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-09-28 13:21:35.286362
Hostname: kat
gpu2
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net5
evaluation:
    online_training: False
    model: net5

end Configuration
Loading and preprocessing data...
test_magnitude.shape (1406, 64)
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_3/3_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.725700608
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 306.942971802 320.542236328
20 486.768151855 508.520324707
30 668.526159668 694.702026367
40 878.795983887 904.719787598
50 1142.65332031 1162.67785645
60 1494.46323242 1501.35644531
70 1994.49293213 1974.20349121
80 2770.04125977 2703.4284668
90 4225.57075195 4081.31066895
100 105201.65625 71258.6328125
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net5
Model name for the evaluation phase:  net5
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          64x192x64
  2          64x192x64
  3          64x192x64
  4          64x96x32
  5          64x96x32
  6          64x96x32
  7          64x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m1.42476[0m     [32m0.94117[0m    1.51382      0.63118  64.29s
      2     [36m0.46946[0m     1.24308    0.37766      0.58789  65.98s
      3     [36m0.45488[0m     1.35531    0.33563      0.63086  66.22s
      4     [36m0.43709[0m     1.31879    0.33143      0.60628  66.37s
      5     [36m0.42759[0m     1.30027    0.32885      0.61963  66.24s
Early stopping.
Best valid loss was 0.941171 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d4' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d4' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d7' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d7' (shape 64).
Loaded parameters to layer 'conv2d8' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 1 0 1 1 1 1 0 0 1 0 1 0 0 0 1 0 0 0 0 0 0 0 0 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.623567708333
Error rate (%):  37.6432291667
yVal [0 0 1 ..., 0 1 1]
[[3084  736]
 [2155 1705]]
roc_auc: 0.604904782573
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (39, 1, 1406, 64)
[ 0.99401617  0.00598498]
[  9.99994755e-01   8.00653379e-06]
[ 0.99767542  0.00232363]
[  9.99586761e-01   4.15327260e-04]
[ 0.99589765  0.00410681]
[  9.99939919e-01   6.18916019e-05]
[  1.00000000e+00   5.04104829e-26]
[  9.99999821e-01   2.00754243e-06]
[ 0.99852079  0.00147993]
[  1.00000000e+00   3.04329485e-14]
[  1.00000000e+00   2.66824646e-10]
[  9.99966025e-01   3.47507121e-05]
[ 0.99816251  0.00183882]
[ 0.99201488  0.00798882]
[ 0.66762853  0.33237171]
[  1.00000000e+00   7.92987976e-07]
[ 0.99410075  0.00589911]
[ 0.97548729  0.02451399]
[  1.00000000e+00   3.51703164e-08]
[ 0.98885864  0.01114234]
[  9.99996364e-01   3.83635279e-06]
[ 0.62365925  0.37634072]
[ 0.57626802  0.42373219]
[  1.00000000e+00   3.10589332e-10]
[  9.99995708e-01   6.38625806e-06]
[ 0.99543858  0.00456323]
[ 0.82818002  0.17182045]
[  9.99968469e-01   3.21918124e-05]
[  9.99884367e-01   1.17746364e-04]
[ 0.84684062  0.15315945]
[ 0.47253424  0.5274657 ]
[ 0.63405389  0.36594602]
[ 0.53245544  0.46754438]
[ 0.92899364  0.07100639]
[ 0.07278326  0.92721653]
[ 0.08612607  0.91387331]
[  9.99926686e-01   7.59323448e-05]
[  8.70033575e-04   9.99130428e-01]
[ 0.00398801  0.99601495]
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[  1.00000000e+00   2.12677587e-09]
[ 0.44591573  0.55408418]
[  9.99494970e-01   5.05411881e-04]
[ 0.04250079  0.95749944]
[ 0.42431515  0.57568502]
roc_auc for the hours: 0.641025641026
Accuracy validation for the hours:  0.840909090909
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run3.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2', '--channels=9']
Command line arguments: Namespace(channels=[9], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run3.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient2'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-09-28 13:31:17.584691
Hostname: kat
gpu2
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net5
evaluation:
    online_training: False
    model: net5

end Configuration
Loading and preprocessing data...
test_magnitude.shape (1406, 64)
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_3/3_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.726102016
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 285.502749634 296.192626953
20 450.084130859 467.958953857
30 614.532775879 635.983337402
40 803.39387207 825.053771973
50 1040.5769043 1057.9163208
60 1362.47683105 1366.25817871
70 1832.86739502 1809.89105225
80 2600.76484375 2522.00878906
90 4211.33994141 4013.83605957
100 48435.8945312 81443.234375
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net5
Model name for the evaluation phase:  net5
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          64x192x64
  2          64x192x64
  3          64x192x64
  4          64x96x32
  5          64x96x32
  6          64x96x32
  7          64x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m1.32837[0m     [32m0.86503[0m    1.53563      0.60026  63.89s
      2     [36m0.49997[0m     0.96265    0.51937      0.58447  65.37s
      3     [36m0.48364[0m     1.13584    0.42580      0.62728  65.58s
      4     [36m0.46554[0m     1.14850    0.40534      0.63167  66.18s
      5     [36m0.45548[0m     1.14979    0.39614      0.62646  66.44s
Early stopping.
Best valid loss was 0.865032 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d4' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d4' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d7' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d7' (shape 64).
Loaded parameters to layer 'conv2d8' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 1 0 1 1 0 1 0 0 1 0 1 0 0 0 0 0 0 0 0 0 0 1 0 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.5984375
Error rate (%):  40.15625
yVal [0 0 1 ..., 0 1 1]
[[3091  729]
 [2355 1505]]
roc_auc: 0.570129160676
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (39, 1, 1406, 64)
[ 0.28801349  0.71198648]
[ 0.99184591  0.00815442]
[ 0.53048414  0.46951553]
[ 0.87594151  0.12405809]
[ 0.74230492  0.25769562]
[  9.99911368e-01   9.03674954e-05]
[  1.00000000e+00   1.51147454e-17]
[  9.99042332e-01   9.59102414e-04]
[ 0.98504615  0.01495336]
[  1.00000000e+00   3.29255997e-11]
[  9.99978125e-01   2.29328034e-05]
[  9.99927580e-01   7.32123517e-05]
[ 0.89125246  0.10874767]
[ 0.94735205  0.05264875]
[ 0.07839628  0.92160344]
[  9.99813318e-01   1.88240243e-04]
[ 0.919608    0.08039214]
[ 0.92681879  0.073181  ]
[ 0.99821728  0.00178323]
[ 0.88362449  0.11637618]
[  9.99923348e-01   7.84339209e-05]
[ 0.03351133  0.96648866]
[ 0.12744115  0.87255901]
[  9.99971867e-01   2.82610235e-05]
[  9.99997973e-01   3.75039735e-06]
[ 0.87997031  0.12003013]
[ 0.59026414  0.40973622]
[ 0.99514753  0.00485314]
[  9.99885678e-01   1.15146839e-04]
[ 0.755826    0.24417455]
[ 0.94100767  0.05899295]
[ 0.87998015  0.12001999]
[  9.99994397e-01   6.52218978e-06]
[  9.99996901e-01   3.83493170e-06]
[ 0.84787548  0.15212506]
[ 0.983567    0.01643478]
[  1.00000000e+00   1.71943276e-11]
[ 0.60849351  0.39150658]
[ 0.92738867  0.07261167]
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[  9.99991357e-01   8.77996808e-06]
[ 0.10461654  0.89538455]
[  9.99954760e-01   4.55689842e-05]
[ 0.1009292   0.89907074]
[  9.99323428e-01   6.78124547e-04]
roc_auc for the hours: 0.517948717949
Accuracy validation for the hours:  0.840909090909
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run3.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2', '--channels=10']
Command line arguments: Namespace(channels=[10], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run3.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient2'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-09-28 13:40:46.953425
Hostname: kat
gpu2
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net5
evaluation:
    online_training: False
    model: net5

end Configuration
Loading and preprocessing data...
test_magnitude.shape (1406, 64)
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_3/3_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.72388608
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 236.922592163 251.930305481
20 374.708331299 398.486328125
30 513.062701416 542.605255127
40 672.122216797 702.880554199
50 870.568389893 898.108978271
60 1134.3536377 1151.20678711
70 1508.80095215 1504.14630127
80 2091.72822266 2048.65869141
90 3209.14863281 3084.92993164
100 33467.8828125 31567.0722656
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net5
Model name for the evaluation phase:  net5
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          64x192x64
  2          64x192x64
  3          64x192x64
  4          64x96x32
  5          64x96x32
  6          64x96x32
  7          64x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m1.25856[0m     [32m0.77297[0m    1.62821      0.62109  64.53s
      2     [36m0.52234[0m     0.81625    0.63992      0.63037  65.63s
      3     [36m0.51584[0m     0.84192    0.61270      0.64030  65.20s
      4     [36m0.51258[0m     0.85521    0.59936      0.66243  65.18s
      5     [36m0.49614[0m     0.93861    0.52860      0.60824  65.93s
Early stopping.
Best valid loss was 0.772973 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d4' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d4' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d7' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d7' (shape 64).
Loaded parameters to layer 'conv2d8' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[1 0 1 0 0 1 1 0 1 1 0 1 0 0 1 0 1 1 1 0 1 1 1 0 0 1 1 1 1 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.623697916667
Error rate (%):  37.6302083333
yVal [0 0 1 ..., 0 1 1]
[[1897 1923]
 [ 967 2893]]
roc_auc: 0.69963215148
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (39, 1, 1406, 64)
[ 0.47205073  0.52794945]
[ 0.85812283  0.14187634]
[ 0.60041767  0.39958256]
[ 0.55161703  0.44838309]
[ 0.40289915  0.59710097]
[ 0.97303843  0.02696148]
[  1.00000000e+00   6.31751903e-19]
[ 0.88292825  0.11707187]
[ 0.36919871  0.6308015 ]
[  1.00000000e+00   1.75311232e-08]
[  1.00000000e+00   9.01975383e-09]
[ 0.7370699   0.26292992]
[ 0.02915663  0.97084337]
[ 0.08460831  0.9153918 ]
[ 0.00202511  0.99797404]
[ 0.70907152  0.29092842]
[ 0.1819645   0.81803566]
[ 0.20948577  0.79051411]
[ 0.99444145  0.005559  ]
[ 0.18374558  0.81625414]
[ 0.55238593  0.44761404]
[  6.78706041e-04   9.99324024e-01]
[  7.77402020e-04   9.99220133e-01]
[  9.99999523e-01   5.46882234e-07]
[ 0.80507481  0.19492464]
[ 0.08862951  0.91137141]
[ 0.17363323  0.82636666]
[ 0.83854967  0.16145144]
[ 0.92335027  0.07665155]
[ 0.42095003  0.57905024]
[ 0.55072981  0.44927055]
[ 0.68742955  0.31257012]
[ 0.92644316  0.07355676]
[  9.99983728e-01   1.81167561e-05]
[ 0.35265514  0.64734566]
[ 0.00441694  0.99558228]
[  9.99961019e-01   3.95181814e-05]
[ 0.0054356   0.99456382]
[ 0.07144026  0.92856061]
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[  9.99991655e-01   8.62379147e-06]
[  4.92898165e-04   9.99508023e-01]
[ 0.28317267  0.7168268 ]
[  3.02180095e-04   9.99698281e-01]
[ 0.05212797  0.94787288]
roc_auc for the hours: 0.723076923077
Accuracy validation for the hours:  0.568181818182
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run3.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2', '--channels=11']
Command line arguments: Namespace(channels=[11], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run3.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient2'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-09-28 13:50:15.991131
Hostname: kat
gpu2
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net5
evaluation:
    online_training: False
    model: net5

end Configuration
Loading and preprocessing data...
test_magnitude.shape (1406, 64)
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_3/3_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.724451328
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 186.644313049 201.672454834
20 301.005688477 324.787322998
30 422.356951904 452.098190308
40 569.603845215 603.014648438
50 763.689239502 798.601593018
60 1034.57580566 1064.75915527
70 1430.09019775 1450.37493896
80 2050.14526367 2051.67700195
90 3226.79782715 3207.58679199
100 56520.15625 104914.585938
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net5
Model name for the evaluation phase:  net5
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          64x192x64
  2          64x192x64
  3          64x192x64
  4          64x96x32
  5          64x96x32
  6          64x96x32
  7          64x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m1.21684[0m     [32m0.73622[0m    1.65283      0.67497  64.20s
      2     [36m0.48533[0m     0.94341    0.51444      0.72721  65.49s
      3     [36m0.45538[0m     1.25108    0.36399      0.66960  65.03s
      4     [36m0.43074[0m     1.42156    0.30300      0.61117  65.47s
      5     [36m0.40052[0m     1.75244    0.22855      0.57227  65.29s
Early stopping.
Best valid loss was 0.736216 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d4' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d4' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d7' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d7' (shape 64).
Loaded parameters to layer 'conv2d8' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[1 1 0 0 0 1 1 0 1 1 1 1 0 0 1 0 1 1 0 0 0 1 1 0 1 0 1 1 1 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.66796875
Error rate (%):  33.203125
yVal [0 0 1 ..., 0 1 1]
[[2054 1766]
 [ 784 3076]]
roc_auc: 0.709525337059
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (39, 1, 1406, 64)
[ 0.42505541  0.57494462]
[ 0.87622392  0.12377631]
[ 0.5038296   0.49617052]
[ 0.57864565  0.42135376]
[ 0.13568349  0.8643164 ]
[ 0.89998573  0.10001358]
[  1.00000000e+00   2.23487526e-17]
[ 0.48941162  0.51058841]
[ 0.55642337  0.44357699]
[  1.00000000e+00   4.81509765e-09]
[  1.00000000e+00   5.73563810e-08]
[  9.99999821e-01   6.74932892e-07]
[ 0.98872393  0.01127691]
[ 0.93408918  0.06591148]
[ 0.01102472  0.98897487]
[ 0.99454653  0.00545412]
[ 0.77814007  0.2218603 ]
[ 0.96295053  0.03704949]
[  9.99647737e-01   3.52762989e-04]
[ 0.82752281  0.17247701]
[  9.99970973e-01   2.98658179e-05]
[ 0.27244157  0.72755831]
[ 0.01199254  0.98801249]
[  1.00000000e+00   1.80740645e-09]
[ 0.39130417  0.60869598]
[ 0.07983635  0.9201653 ]
[ 0.03699378  0.96300775]
[ 0.78600901  0.21399146]
[ 0.81784904  0.18215092]
[ 0.25186768  0.74813223]
[  5.33385173e-05   9.99950886e-01]
[ 0.30583662  0.6941632 ]
[ 0.00274337  0.99725688]
[ 0.48686785  0.51313233]
[ 0.44572654  0.55427325]
[  6.12368924e-04   9.99390125e-01]
[ 0.99487656  0.00512525]
[  7.56675900e-06   9.99997079e-01]
[  3.85177787e-04   9.99615610e-01]
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[  9.99880672e-01   1.19487006e-04]
[ 0.01394877  0.98605132]
[ 0.01953691  0.98046762]
[  5.67485928e-04   9.99432862e-01]
[  4.71305801e-04   9.99530196e-01]
roc_auc for the hours: 0.728205128205
Accuracy validation for the hours:  0.568181818182
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run3.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2', '--channels=12']
Command line arguments: Namespace(channels=[12], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run3.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient2'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-09-28 13:59:45.758460
Hostname: kat
gpu2
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net5
evaluation:
    online_training: False
    model: net5

end Configuration
Loading and preprocessing data...
test_magnitude.shape (1406, 64)
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_3/3_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.725540864
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 248.17615509 252.292892456
20 390.046142578 397.643157959
30 530.814239502 540.408538818
40 692.21217041 701.233337402
50 895.86038208 900.681671143
60 1176.14956055 1169.04772949
70 1593.55310059 1562.03234863
80 2265.55048828 2189.94775391
90 3531.49135742 3371.82397461
100 68512.453125 61788.859375
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net5
Model name for the evaluation phase:  net5
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          64x192x64
  2          64x192x64
  3          64x192x64
  4          64x96x32
  5          64x96x32
  6          64x96x32
  7          64x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m1.20191[0m     [32m0.79899[0m    1.50428      0.62028  64.44s
      2     [36m0.51470[0m     0.98017    0.52511      0.67529  65.78s
      3     [36m0.49021[0m     0.96810    0.50637      0.68831  65.84s
      4     [36m0.46625[0m     1.06307    0.43859      0.67074  65.10s
      5     [36m0.44444[0m     1.20955    0.36745      0.65348  65.28s
Early stopping.
Best valid loss was 0.798994 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d4' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d4' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d7' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d7' (shape 64).
Loaded parameters to layer 'conv2d8' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[1 1 0 0 0 0 1 0 1 1 1 1 0 0 1 0 1 0 0 0 1 0 0 0 0 0 0 1 0 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.618359375
Error rate (%):  38.1640625
yVal [0 0 1 ..., 0 1 1]
[[2368 1452]
 [1479 2381]]
roc_auc: 0.64024814855
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (39, 1, 1406, 64)
[ 0.5591597   0.44084024]
[ 0.99275261  0.00724735]
[ 0.96616763  0.03383274]
[ 0.9721806  0.0278196]
[ 0.94365156  0.05634832]
[  9.99382496e-01   6.18988124e-04]
[  1.00000000e+00   1.23938858e-21]
[ 0.99058825  0.00941156]
[ 0.51241875  0.48758101]
[  1.00000000e+00   6.15834361e-09]
[  1.00000000e+00   9.80587487e-08]
[ 0.96033722  0.03966255]
[ 0.87199247  0.12800778]
[ 0.34980896  0.65019125]
[ 0.11852776  0.88147223]
[ 0.99500978  0.00499126]
[ 0.78692627  0.21307336]
[ 0.84093589  0.15906399]
[  9.99945939e-01   5.41647569e-05]
[ 0.49941689  0.5005827 ]
[ 0.9769696   0.02303085]
[ 0.2520687   0.74793166]
[ 0.42045051  0.57954961]
[  9.99999225e-01   8.00502448e-07]
[ 0.99876642  0.0012372 ]
[ 0.25331941  0.74668014]
[ 0.66170245  0.33829778]
[ 0.92914265  0.07085834]
[ 0.99616951  0.00383147]
[ 0.90241265  0.09758721]
[ 0.95123816  0.04876289]
[ 0.20789327  0.79210764]
[ 0.02072076  0.97927886]
[ 0.27449614  0.72550416]
[  1.36300485e-04   9.99863863e-01]
[  3.50381335e-04   9.99650657e-01]
[ 0.8302238  0.1697771]
[ 0.00160785  0.99839318]
[ 0.00410749  0.99589521]
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[  9.99999106e-01   1.06687878e-06]
[ 0.06236165  0.93763834]
[ 0.93737251  0.06262757]
[  8.24658258e-04   9.99175072e-01]
[ 0.00175915  0.99824268]
roc_auc for the hours: 0.65641025641
Accuracy validation for the hours:  0.659090909091
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run3.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2', '--channels=13']
Command line arguments: Namespace(channels=[13], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run3.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient2'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-09-28 14:09:21.635957
Hostname: kat
gpu2
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net5
evaluation:
    online_training: False
    model: net5

end Configuration
Loading and preprocessing data...
test_magnitude.shape (1406, 64)
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_3/3_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.725356544
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 313.265170288 326.406982422
20 498.231085205 521.788146973
30 685.862628174 717.073608398
40 902.230651855 938.709350586
50 1171.92333984 1206.95782471
60 1527.57519531 1552.16845703
70 2029.24715576 2029.27972412
80 2804.71967773 2764.22265625
90 4254.45888672 4141.17211914
100 35079.8945312 31263.9492188
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net5
Model name for the evaluation phase:  net5
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          64x192x64
  2          64x192x64
  3          64x192x64
  4          64x96x32
  5          64x96x32
  6          64x96x32
  7          64x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m1.47321[0m     [32m0.87442[0m    1.68478      0.61117  64.27s
      2     [36m0.49842[0m     0.97651    0.51041      0.60205  65.64s
      3     [36m0.48374[0m     1.10711    0.43694      0.56510  65.59s
      4     [36m0.47508[0m     0.95512    0.49741      0.64339  65.53s
      5     [36m0.46977[0m     1.10336    0.42576      0.59017  66.00s
Early stopping.
Best valid loss was 0.874422 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d4' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d4' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d7' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d7' (shape 64).
Loaded parameters to layer 'conv2d8' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[1 0 0 0 1 1 1 0 1 1 0 1 0 0 1 1 1 0 1 0 0 0 0 0 0 0 0 1 0 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.613020833333
Error rate (%):  38.6979166667
yVal [0 0 1 ..., 0 1 1]
[[2478 1342]
 [1630 2230]]
roc_auc: 0.596740905515
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (39, 1, 1406, 64)
[  2.43331102e-04   9.99757648e-01]
[ 0.29333082  0.70666873]
[ 0.07082237  0.92917895]
[ 0.19256052  0.80743974]
[ 0.07834741  0.92165256]
[  9.99678075e-01   3.23180197e-04]
[  1.00000000e+00   1.59781234e-26]
[ 0.78371054  0.21629041]
[ 0.90831035  0.09168995]
[  1.00000000e+00   5.30552446e-09]
[  1.00000000e+00   8.07933986e-09]
[  1.00000000e+00   2.96792653e-08]
[ 0.9753595  0.024642 ]
[ 0.98938489  0.01061558]
[  3.75487361e-05   9.99966145e-01]
[ 0.933514    0.06648671]
[ 0.78485715  0.21514302]
[ 0.86364293  0.13635752]
[ 0.9138931   0.08610681]
[ 0.13223164  0.8677696 ]
[ 0.81310523  0.18689451]
[ 0.17575544  0.8242448 ]
[ 0.00189365  0.99810886]
[ 0.96987629  0.03012396]
[  9.99983907e-01   1.62757678e-05]
[ 0.78487486  0.21512519]
[ 0.80134112  0.19865867]
[ 0.79529047  0.2047103 ]
[ 0.91155678  0.08844325]
[ 0.82278866  0.1772114 ]
[  9.99971151e-01   3.00734864e-05]
[ 0.87138313  0.1286169 ]
[ 0.93329215  0.0667079 ]
[  9.99998212e-01   2.95479913e-06]
[ 0.80627298  0.19372651]
[  3.09454277e-04   9.99692738e-01]
[  1.00000000e+00   2.23626113e-08]
[  5.99724532e-04   9.99400020e-01]
[ 0.03481544  0.96518421]
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[ 0.73209983  0.26790035]
[ 0.01254188  0.98745829]
[  9.99351084e-01   6.49972702e-04]
[ 0.19232546  0.80767488]
[ 0.41401348  0.58598709]
roc_auc for the hours: 0.646153846154
Accuracy validation for the hours:  0.681818181818
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run3.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2', '--channels=14']
Command line arguments: Namespace(channels=[14], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run3.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient2'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-09-28 14:18:50.098669
Hostname: kat
gpu2
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net5
evaluation:
    online_training: False
    model: net5

end Configuration
Loading and preprocessing data...
test_magnitude.shape (1406, 64)
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_3/3_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.725307392
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 268.114727783 273.846969604
20 419.789349365 430.405151367
30 568.496173096 582.308776855
40 736.171875 750.966308594
50 942.937286377 954.910858154
60 1216.87109375 1218.35766602
70 1611.33862305 1587.65899658
80 2251.2371582 2171.8034668
90 3539.77995605 3341.80603027
100 38412.0351562 39300.5585938
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net5
Model name for the evaluation phase:  net5
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          64x192x64
  2          64x192x64
  3          64x192x64
  4          64x96x32
  5          64x96x32
  6          64x96x32
  7          64x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m1.25395[0m     [32m0.97957[0m    1.28010      0.52311  63.59s
      2     [36m0.52397[0m     1.07889    0.48566      0.54948  65.91s
      3     [36m0.51200[0m     1.30351    0.39279      0.58919  66.03s
      4     [36m0.50228[0m     1.27395    0.39427      0.58952  65.42s
      5     [36m0.49755[0m     1.43023    0.34788      0.63298  65.39s
Early stopping.
Best valid loss was 0.979572 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d4' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d4' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d7' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d7' (shape 64).
Loaded parameters to layer 'conv2d8' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[0 0 1 0 0 1 1 0 1 1 0 1 0 0 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.527473958333
Error rate (%):  47.2526041667
yVal [0 0 1 ..., 0 1 1]
[[2486 1334]
 [2295 1565]]
roc_auc: 0.540440685782
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (39, 1, 1406, 64)
[ 0.00518658  0.99481308]
[ 0.98099333  0.01900578]
[ 0.17010242  0.829898  ]
[ 0.82680005  0.17319985]
[ 0.5321725   0.46782705]
[  9.99863863e-01   1.37445153e-04]
[  1.00000000e+00   1.06880696e-27]
[ 0.8864491   0.11355179]
[ 0.03270569  0.96729469]
[  9.99807775e-01   1.92183419e-04]
[  9.99341249e-01   6.59851008e-04]
[  9.99955475e-01   4.55491281e-05]
[ 0.32674623  0.67325372]
[ 0.8865127   0.11348912]
[  3.04341200e-04   9.99695897e-01]
[ 0.80210471  0.19789609]
[ 0.55298948  0.44701019]
[ 0.93871546  0.06128569]
[ 0.54828215  0.45171762]
[ 0.27830952  0.72169042]
[ 0.99813628  0.00186653]
[ 0.44740403  0.55259603]
[ 0.35821676  0.64178258]
[ 0.97289699  0.02710312]
[  9.99060392e-01   9.41822829e-04]
[ 0.99232632  0.00767475]
[ 0.79683089  0.20316866]
[ 0.86194813  0.13805236]
[ 0.98817724  0.01182383]
[ 0.98960382  0.01039658]
[ 0.99813044  0.00187142]
[ 0.86733931  0.13266091]
[ 0.45388627  0.54611367]
[ 0.99883586  0.0011652 ]
[ 0.58715379  0.412846  ]
[ 0.17702028  0.82298112]
[  9.99794424e-01   2.05919729e-04]
[ 0.00562678  0.99437308]
[ 0.01807762  0.98192292]
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[  1.00000000e+00   1.35817103e-07]
[  2.69927637e-06   1.00000000e+00]
[ 0.99342096  0.00658064]
[ 0.00914842  0.99085099]
[ 0.9903667   0.00963504]
roc_auc for the hours: 0.497435897436
Accuracy validation for the hours:  0.659090909091
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run3.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu2', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient2', '--channels=15']
Command line arguments: Namespace(channels=[15], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run3.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient2'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu2')
Git reference:  Timestamp: 2016-09-28 14:28:21.087865
Hostname: kat
gpu2
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net5
evaluation:
    online_training: False
    model: net5

end Configuration
Loading and preprocessing data...
test_magnitude.shape (1406, 64)
Read in dataset from train_3 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_3/3_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.72460288
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 209.032162476 220.332107544
20 332.380444336 351.279418945
30 459.308435059 484.765441895
40 610.22890625 640.295166016
50 804.460357666 836.352508545
60 1069.28730469 1096.11523438
70 1449.42525635 1460.753479
80 2038.72851562 2017.47363281
90 3126.08322754 3036.31750488
100 28167.1855469 26524.03125
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net5
Model name for the evaluation phase:  net5
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          64x192x64
  2          64x192x64
  3          64x192x64
  4          64x96x32
  5          64x96x32
  6          64x96x32
  7          64x48x16
  8          2x48x16
  9          2
 10          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m1.19349[0m     [32m0.72147[0m    1.65424      0.64746  64.50s
      2     [36m0.50563[0m     0.78580    0.64346      0.69238  65.82s
      3     [36m0.48718[0m     0.81695    0.59634      0.70524  66.19s
      4     [36m0.47555[0m     0.84419    0.56333      0.71696  65.91s
      5     [36m0.46690[0m     0.89494    0.52171      0.71452  65.92s
Early stopping.
Best valid loss was 0.721472 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d4' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d4' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d7' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d7' (shape 64).
Loaded parameters to layer 'conv2d8' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[1 1 0 0 0 1 1 0 1 1 0 1 0 0 1 0 1 1 1 0 1 1 1 0 0 1 1 1 1 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.64296875
Error rate (%):  35.703125
yVal [0 0 1 ..., 0 1 1]
[[2331 1489]
 [1253 2607]]
roc_auc: 0.67902795486
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (39, 1, 1406, 64)
[ 0.70805585  0.29194385]
[ 0.9868558   0.01314363]
[ 0.76311016  0.23689   ]
[ 0.92743117  0.07256905]
[ 0.83451092  0.16548958]
[ 0.99870527  0.00129494]
[  1.00000000e+00   7.16035199e-17]
[ 0.99825436  0.00174523]
[ 0.6399132   0.36008722]
[  9.99999583e-01   6.10949485e-07]
[  9.99999821e-01   8.24256517e-07]
[ 0.99346387  0.00653764]
[ 0.55938852  0.44061139]
[ 0.36242747  0.63757241]
[ 0.00314651  0.99685341]
[ 0.98356229  0.01643945]
[ 0.62276113  0.3772383 ]
[ 0.82838297  0.17161749]
[ 0.99618077  0.00382043]
[ 0.38736057  0.61263973]
[ 0.7117092   0.28829035]
[ 0.03652914  0.96347225]
[ 0.04198082  0.95801914]
[  9.99996901e-01   3.29694944e-06]
[ 0.98948097  0.01051927]
[ 0.08200833  0.91799408]
[ 0.23268546  0.76731586]
[ 0.77105635  0.22894363]
[ 0.93166262  0.06833807]
[ 0.46646848  0.53353119]
[ 0.48322245  0.51677728]
[ 0.46887866  0.53112113]
[ 0.44317362  0.55682665]
[ 0.99826992  0.00173049]
[ 0.00925682  0.99074626]
[ 0.00159217  0.99840939]
[  9.99998212e-01   3.27885573e-06]
[  7.85506487e-08   1.00000000e+00]
[ 0.05141469  0.94858587]
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[  9.99920428e-01   7.97243774e-05]
[ 0.00226735  0.99773252]
[ 0.63119197  0.36880752]
[  4.45494989e-05   9.99957025e-01]
[ 0.01554592  0.98445505]
roc_auc for the hours: 0.702564102564
Accuracy validation for the hours:  0.613636363636
