['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run1.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0', '--channels=0']
Command line arguments: Namespace(channels=[0], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run1.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient0'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-09-27 11:45:00.715232
Hostname: kat
gpu0
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 512
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net3
evaluation:
    online_training: False
    model: net3

end Configuration
Loading and preprocessing data...
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_1/1_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.72484864
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 70.7466438293 63.842420578
20 304.508380127 300.779174805
30 460.82131958 457.620559692
40 614.12779541 611.13269043
50 784.973907471 782.218841553
60 994.49576416 989.865478516
70 1274.92553711 1264.19610596
80 1700.02680664 1675.02429199
90 2542.60905762 2483.04052734
100 45472.875 51963.8164062
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net3
Model name for the evaluation phase:  net3
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x512x64
  1          64x512x64
  2          64x512x64
  3          64x256x32
  4          64x256x32
  5          64x256x32
  6          64x256x32
  7          64x128x16
  8          64x128x16
  9          64x128x16
 10          2x128x16
 11          2
 12          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m1.25975[0m     [32m1.04547[0m    1.20496      0.56006  539.83s
      2     [36m0.66012[0m     [32m0.74165[0m    0.89006      0.55924  541.97s
      3     [36m0.64318[0m     [32m0.60381[0m    1.06521      0.56348  538.75s
      4     [36m0.63624[0m     0.61906    1.02775      0.57438  545.31s
      5     [36m0.60570[0m     [32m0.59854[0m    1.01195      0.58545  530.87s
      6     [36m0.60203[0m     0.61766    0.97470      0.59440  535.07s
      7     [36m0.59118[0m     0.63015    0.93816      0.58545  546.56s
      8     [36m0.58683[0m     0.62554    0.93811      0.60140  532.41s
      9     [36m0.58398[0m     0.62150    0.93962      0.59098  535.45s
Early stopping.
Best valid loss was 0.598545 at epoch 5.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d6' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d6' (shape 64).
Loaded parameters to layer 'conv2d9' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d9' (shape 64).
Loaded parameters to layer 'conv2d10' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d10' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[1 0 0 0 0 0 0 1 1 1 0 1 1 0 1 1 1 1 0 1 0 1 0 0 1 0 1 0 1 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.57265625
Error rate (%):  42.734375
yVal [0 0 1 ..., 0 1 1]
[[2272 1548]
 [1734 2126]]
roc_auc: 0.699531644196
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run1.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0', '--channels=1']
Command line arguments: Namespace(channels=[1], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run1.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient0'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-09-27 13:27:22.937178
Hostname: kat
gpu0
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 512
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net3
evaluation:
    online_training: False
    model: net3

end Configuration
Loading and preprocessing data...
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_1/1_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.724226048
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 73.2094459534 65.3325195312
20 304.830169678 299.064300537
30 453.218609619 447.091934204
40 592.686523438 585.265686035
50 741.791564941 732.578125
60 919.896789551 906.589538574
70 1164.1838501 1144.06207275
80 1584.97133789 1549.58764648
90 2631.43066406 2554.1439209
100 212492.21875 103666.890625
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net3
Model name for the evaluation phase:  net3
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x512x64
  1          64x512x64
  2          64x512x64
  3          64x256x32
  4          64x256x32
  5          64x256x32
  6          64x256x32
  7          64x128x16
  8          64x128x16
  9          64x128x16
 10          2x128x16
 11          2
 12          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m1.19549[0m     [32m0.61267[0m    1.95128      0.57324  536.03s
      2     [36m0.63359[0m     [32m0.60327[0m    1.05027      0.60449  536.46s
      3     0.63914     0.63143    1.01221      0.68050  527.99s
      4     [36m0.60930[0m     0.65026    0.93701      0.65625  537.37s
      5     [36m0.60363[0m     0.62935    0.95912      0.70980  535.10s
      6     [36m0.58439[0m     0.64784    0.90205      0.70312  532.05s
Early stopping.
Best valid loss was 0.603270 at epoch 2.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d6' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d6' (shape 64).
Loaded parameters to layer 'conv2d9' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d9' (shape 64).
Loaded parameters to layer 'conv2d10' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d10' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[1 0 0 0 0 0 1 1 1 1 0 1 1 0 1 1 1 1 0 1 0 1 0 0 1 1 1 0 1 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.5921875
Error rate (%):  40.78125
yVal [0 0 1 ..., 0 1 1]
[[2316 1504]
 [1628 2232]]
roc_auc: 0.665764825163
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run1.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0', '--channels=2']
Command line arguments: Namespace(channels=[2], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run1.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient0'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-09-27 14:35:18.220960
Hostname: kat
gpu0
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 512
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net3
evaluation:
    online_training: False
    model: net3

end Configuration
Loading and preprocessing data...
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_1/1_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.723841024
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 66.0938278198 59.3271923065
20 275.823791504 272.096435547
30 416.650689697 412.592544556
40 556.646313477 551.753051758
50 717.273956299 710.977752686
60 925.331677246 914.809448242
70 1232.3055542 1212.10852051
80 1764.00136719 1717.79833984
90 3024.64064941 2907.14428711
100 72650.4921875 58577.3359375
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net3
Model name for the evaluation phase:  net3
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x512x64
  1          64x512x64
  2          64x512x64
  3          64x256x32
  4          64x256x32
  5          64x256x32
  6          64x256x32
  7          64x128x16
  8          64x128x16
  9          64x128x16
 10          2x128x16
 11          2
 12          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m1.22268[0m     [32m0.63831[0m    1.91549      0.63770  523.05s
      2     [36m0.63150[0m     0.99098    0.63725      0.51107  535.47s
      3     [36m0.62920[0m     1.23137    0.51098      0.50472  524.84s
      4     [36m0.58269[0m     1.18874    0.49017      0.50342  526.77s
      5     [36m0.57099[0m     0.85268    0.66964      0.49333  535.37s
Early stopping.
Best valid loss was 0.638310 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d6' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d6' (shape 64).
Loaded parameters to layer 'conv2d9' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d9' (shape 64).
Loaded parameters to layer 'conv2d10' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d10' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[1 0 1 1 1 1 1 1 1 1 0 1 1 0 1 1 1 0 0 1 0 1 1 1 1 1 1 1 1 1]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.645963541667
Error rate (%):  35.4036458333
yVal [0 0 1 ..., 0 1 1]
[[1135 2685]
 [  34 3826]]
roc_auc: 0.639864464368
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run1.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0', '--channels=3']
Command line arguments: Namespace(channels=[3], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run1.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient0'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-09-27 15:34:12.672791
Hostname: kat
gpu0
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 512
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net3
evaluation:
    online_training: False
    model: net3

end Configuration
Loading and preprocessing data...
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_1/1_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.724230144
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 47.6684310913 43.0745182037
20 190.535946655 186.172027588
30 292.377093506 286.294784546
40 400.819000244 392.791015625
50 536.772857666 525.470214844
60 733.36652832 715.44934082
70 1071.4920166 1038.94641113
80 1814.90427246 1741.25292969
90 3935.36066895 3727.35095215
100 175654.078125 94563.71875
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net3
Model name for the evaluation phase:  net3
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x512x64
  1          64x512x64
  2          64x512x64
  3          64x256x32
  4          64x256x32
  5          64x256x32
  6          64x256x32
  7          64x128x16
  8          64x128x16
  9          64x128x16
 10          2x128x16
 11          2
 12          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m1.83696[0m     [32m0.65002[0m    2.82600      0.55290  559.21s
      2     [36m0.65224[0m     [32m0.64735[0m    1.00756      0.59749  552.31s
      3     [36m0.64050[0m     [32m0.63054[0m    1.01579      0.63656  521.38s
      4     [36m0.60871[0m     0.66497    0.91539      0.53613  528.94s
      5     [36m0.59444[0m     0.77810    0.76397      0.54134  544.99s
      6     [36m0.57198[0m     0.88845    0.64380      0.55534  543.24s
      7     [36m0.55312[0m     1.02722    0.53846      0.55273  545.63s
Early stopping.
Best valid loss was 0.630540 at epoch 3.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d6' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d6' (shape 64).
Loaded parameters to layer 'conv2d9' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d9' (shape 64).
Loaded parameters to layer 'conv2d10' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d10' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[1 0 0 0 0 0 0 0 0 0 0 1 0 0 0 1 0 0 0 0 0 1 1 0 1 0 1 1 1 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.637239583333
Error rate (%):  36.2760416667
yVal [0 0 1 ..., 0 1 1]
[[2336 1484]
 [1302 2558]]
roc_auc: 0.69993781027
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run1.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0', '--channels=4']
Command line arguments: Namespace(channels=[4], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run1.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient0'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-09-27 16:52:11.405943
Hostname: kat
gpu0
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 512
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net3
evaluation:
    online_training: False
    model: net3

end Configuration
Loading and preprocessing data...
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_1/1_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.724652032
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 54.9849830627 50.1900939941
20 229.307006836 228.20741272
30 348.048464966 346.217544556
40 467.856695557 464.409698486
50 608.873718262 602.048614502
60 803.540222168 789.24432373
70 1133.24448242 1100.21539307
80 1815.55136719 1742.62597656
90 3260.82875977 3121.5411377
100 159526.84375 66619.4296875
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net3
Model name for the evaluation phase:  net3
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x512x64
  1          64x512x64
  2          64x512x64
  3          64x256x32
  4          64x256x32
  5          64x256x32
  6          64x256x32
  7          64x128x16
  8          64x128x16
  9          64x128x16
 10          2x128x16
 11          2
 12          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m1.31040[0m     [32m0.60901[0m    2.15167      0.69157  538.37s
      2     [36m0.65282[0m     [32m0.60236[0m    1.08377      0.68799  558.83s
      3     0.65365     0.80398    0.81302      0.52799  552.56s
      4     [36m0.61096[0m     0.72928    0.83776      0.57178  561.13s
      5     [36m0.60599[0m     0.65126    0.93049      0.63363  530.14s
      6     [36m0.58707[0m     0.65936    0.89036      0.63607  545.38s
      7     [36m0.56448[0m     [32m0.59697[0m    0.94557      0.66520  546.83s
      8     0.56620     0.61102    0.92665      0.65804  539.82s
      9     [36m0.55496[0m     [32m0.56887[0m    0.97555      0.69824  504.62s
     10     [36m0.53558[0m     0.57095    0.93805      0.70133  505.87s
     11     [36m0.52644[0m     0.56943    0.92451      0.71387  547.67s
     12     [36m0.51667[0m     [32m0.55796[0m    0.92599      0.74333  594.06s
     13     [36m0.50798[0m     0.56855    0.89345      0.73551  505.87s
     14     [36m0.49803[0m     0.57844    0.86100      0.72477  504.45s
     15     [36m0.47719[0m     0.57583    0.82871      0.73893  512.32s
     16     [36m0.46221[0m     0.57417    0.80500      0.74284  505.74s
Early stopping.
Best valid loss was 0.557960 at epoch 12.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d6' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d6' (shape 64).
Loaded parameters to layer 'conv2d9' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d9' (shape 64).
Loaded parameters to layer 'conv2d10' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d10' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[1 0 0 1 1 0 1 1 1 1 0 1 1 0 1 1 1 1 0 1 0 1 1 0 1 1 1 1 1 1]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.751432291667
Error rate (%):  24.8567708333
yVal [0 0 1 ..., 0 1 1]
[[1947 1873]
 [  36 3824]]
roc_auc: 0.758886044272
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run1.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0', '--channels=5']
Command line arguments: Namespace(channels=[5], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run1.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient0'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-09-27 19:28:22.638862
Hostname: kat
gpu0
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 512
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net3
evaluation:
    online_training: False
    model: net3

end Configuration
Loading and preprocessing data...
test_magnitude.shape (1406, 64)
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_1/1_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.72513536
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 40.4209140778 36.9957923889
20 166.929934692 164.751541138
30 253.996229553 251.12739563
40 343.703009033 339.247955322
50 452.435745239 445.635696411
60 605.83416748 594.33026123
70 867.009185791 845.254577637
80 1415.50119629 1374.06323242
90 2654.56486816 2579.15917969
100 60107.1914062 35847.8867188
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net3
Model name for the evaluation phase:  net3
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x512x64
  1          64x512x64
  2          64x512x64
  3          64x256x32
  4          64x256x32
  5          64x256x32
  6          64x256x32
  7          64x128x16
  8          64x128x16
  9          64x128x16
 10          2x128x16
 11          2
 12          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m1.04084[0m     [32m1.91061[0m    0.54477      0.49821  153.30s
      2     [36m0.62528[0m     [32m1.48066[0m    0.42229      0.49626  155.54s
      3     [36m0.60078[0m     [32m1.13574[0m    0.52898      0.49447  156.53s
      4     [36m0.59372[0m     [32m1.07398[0m    0.55282      0.48942  157.26s
      5     [36m0.57499[0m     [32m0.92718[0m    0.62015      0.47673  156.66s
      6     [36m0.56308[0m     [32m0.80943[0m    0.69565      0.45996  156.53s
      7     [36m0.55750[0m     0.81084    0.68756      0.46484  156.86s
      8     [36m0.54505[0m     0.84613    0.64417      0.45687  156.83s
      9     [36m0.54205[0m     0.84675    0.64016      0.45866  156.19s
     10     [36m0.53422[0m     0.84053    0.63557      0.46403  156.80s
Early stopping.
Best valid loss was 0.809432 at epoch 6.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d6' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d6' (shape 64).
Loaded parameters to layer 'conv2d9' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d9' (shape 64).
Loaded parameters to layer 'conv2d10' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d10' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 1 0 0 0 0 0 0 1 0 0 0 0 0 0 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.464973958333
Error rate (%):  53.5026041667
yVal [0 0 1 ..., 0 1 1]
[[3342  478]
 [3631  229]]
roc_auc: 0.565143538236
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (39, 1, 1406, 64)
[  1.00000000e+00   4.97314643e-16]
[ 0.77119368  0.22880672]
[ 0.89330137  0.10669826]
[ 0.88491946  0.11508024]
[ 0.96096194  0.03903747]
[ 0.90700233  0.09299731]
[ 0.98202205  0.01797846]
[  1.00000000e+00   9.50853776e-15]
[ 0.96918529  0.03081485]
[ 0.83556795  0.16443217]
[ 0.98616302  0.01383738]
[  9.99957860e-01   4.23820129e-05]
[  1.00000000e+00   9.93054954e-08]
[ 0.90530074  0.09469975]
[ 0.82777423  0.17222618]
[ 0.95951998  0.04047961]
[  9.99956429e-01   4.47721541e-05]
[ 0.99365342  0.00634698]
[  9.99885678e-01   1.13663991e-04]
[  1.00000000e+00   4.41643354e-11]
[ 0.96552336  0.03447547]
[ 0.9782781   0.02172173]
[ 0.92727393  0.07272625]
[ 0.98094934  0.01905126]
[ 0.92815864  0.07184114]
[  1.00000000e+00   3.92747751e-10]
[ 0.95527059  0.04472922]
[  1.00000000e+00   2.09693859e-11]
[  1.00000000e+00   8.82167821e-16]
[  9.99942482e-01   5.86700698e-05]
[  1.00000000e+00   9.64115059e-14]
[ 0.82349139  0.1765085 ]
[  1.00000000e+00   2.01192570e-11]
[ 0.85545236  0.14454708]
[  1.00000000e+00   1.51372831e-07]
[ 0.98329329  0.01670672]
[ 0.9181065   0.08189357]
[ 0.99782133  0.00217807]
[ 0.6011678   0.39883238]
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[  9.99228358e-01   7.74761604e-04]
[ 0.94728768  0.0527127 ]
[ 0.87967813  0.12032223]
[ 0.97037083  0.02962937]
[  1.00000000e+00   3.52927323e-08]
roc_auc for the hours: 0.523076923077
Accuracy validation for the hours:  0.886363636364
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run1.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0', '--channels=6']
Command line arguments: Namespace(channels=[6], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run1.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient0'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-09-27 20:00:29.780993
Hostname: kat
gpu0
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 512
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net3
evaluation:
    online_training: False
    model: net3

end Configuration
Loading and preprocessing data...
test_magnitude.shape (1406, 64)
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_1/1_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.7257088
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 48.3308135986 43.7012329102
20 203.010769653 198.697387695
30 309.622598267 303.911743164
40 418.704449463 410.685119629
50 547.045196533 536.160308838
60 717.938061523 702.114440918
70 981.146099854 956.138244629
80 1479.44748535 1432.06201172
90 2699.1140625 2590.68603516
100 459356.3125 258723.5625
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net3
Model name for the evaluation phase:  net3
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x512x64
  1          64x512x64
  2          64x512x64
  3          64x256x32
  4          64x256x32
  5          64x256x32
  6          64x256x32
  7          64x128x16
  8          64x128x16
  9          64x128x16
 10          2x128x16
 11          2
 12          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m1.06363[0m     [32m2.72735[0m    0.38999      0.49837  153.14s
      2     [36m0.61856[0m     [32m2.12520[0m    0.29106      0.49707  156.27s
      3     [36m0.59430[0m     [32m1.71590[0m    0.34635      0.49544  157.02s
      4     [36m0.57790[0m     [32m1.42880[0m    0.40446      0.49300  157.11s
      5     [36m0.55712[0m     [32m1.36014[0m    0.40960      0.49170  156.97s
      6     [36m0.54602[0m     [32m1.11443[0m    0.48995      0.48470  156.86s
      7     [36m0.54037[0m     1.17971    0.45805      0.48519  156.63s
      8     [36m0.52584[0m     1.13935    0.46152      0.47803  156.63s
      9     [36m0.51854[0m     1.18471    0.43770      0.47705  156.46s
     10     [36m0.51144[0m     [32m1.03198[0m    0.49559      0.47428  157.25s
     11     [36m0.50211[0m     [32m0.87375[0m    0.57466      0.49137  156.88s
     12     [36m0.49464[0m     0.95181    0.51968      0.49447  156.61s
     13     [36m0.48761[0m     0.88360    0.55185      0.49430  156.70s
     14     [36m0.46765[0m     0.91044    0.51365      0.50000  156.57s
     15     [36m0.46484[0m     [32m0.78747[0m    0.59030      0.50586  156.57s
     16     [36m0.44534[0m     [32m0.78067[0m    0.57046      0.52474  157.05s
     17     [36m0.44232[0m     [32m0.67005[0m    0.66012      0.54574  156.40s
     18     [36m0.42207[0m     0.74385    0.56741      0.55127  156.75s
     19     [36m0.40042[0m     0.70099    0.57123      0.58398  156.64s
     20     [36m0.38969[0m     0.76810    0.50735      0.55680  156.43s
     21     [36m0.37851[0m     0.77308    0.48962      0.58154  156.92s
Early stopping.
Best valid loss was 0.670052 at epoch 17.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d6' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d6' (shape 64).
Loaded parameters to layer 'conv2d9' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d9' (shape 64).
Loaded parameters to layer 'conv2d10' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d10' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 1 1 1 1 1 1 1 0 1 1 0 1 1 0 1 0 0 0 0 1 0 1 1 1 1 1 1]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.549348958333
Error rate (%):  45.0651041667
yVal [0 0 1 ..., 0 1 1]
[[2002 1818]
 [1643 2217]]
roc_auc: 0.641767320891
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (39, 1, 1406, 64)
[  1.00000000e+00   2.35342976e-18]
[ 0.20829344  0.7917062 ]
[ 0.52454239  0.47545773]
[ 0.06999405  0.93000573]
[ 0.66478384  0.33521578]
[ 0.52231622  0.47768381]
[ 0.84449154  0.15550855]
[  1.00000000e+00   3.97064256e-11]
[ 0.52631009  0.47368968]
[ 0.18037625  0.81962371]
[ 0.74726743  0.25273207]
[ 0.99805248  0.00194767]
[  9.99886811e-01   1.14277871e-04]
[ 0.77094841  0.22905129]
[ 0.51392609  0.48607409]
[  9.99776185e-01   2.23811818e-04]
[ 0.9974944   0.00250663]
[ 0.64336634  0.35663342]
[  1.00000000e+00   6.41655618e-08]
[  1.00000000e+00   5.10257716e-24]
[ 0.12488643  0.87511384]
[ 0.81472892  0.18527083]
[ 0.7339192   0.26608089]
[ 0.77971554  0.22028394]
[ 0.46957904  0.53042138]
[ 0.82274586  0.17725454]
[  3.36366240e-04   9.99664903e-01]
[  1.00000000e+00   3.91442967e-08]
[  1.00000000e+00   3.60029216e-12]
[ 0.87721193  0.12278872]
[  1.00000000e+00   2.07383835e-08]
[  3.61677259e-04   9.99638498e-01]
[  1.00000000e+00   5.07276710e-09]
[ 0.16724901  0.83275139]
[  9.99646544e-01   3.54770484e-04]
[ 0.77134371  0.22865614]
[ 0.91333658  0.08666353]
[  6.50034224e-07   9.99999940e-01]
[ 0.1153859   0.88461465]
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[ 0.52137589  0.47862461]
[ 0.59832424  0.40167588]
[  3.77511780e-04   9.99623775e-01]
[ 0.73593646  0.26406401]
[ 0.89819491  0.10180578]
roc_auc for the hours: 0.641025641026
Accuracy validation for the hours:  0.681818181818
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run1.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0', '--channels=7']
Command line arguments: Namespace(channels=[7], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run1.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient0'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-09-27 21:01:21.652512
Hostname: kat
gpu0
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 512
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net3
evaluation:
    online_training: False
    model: net3

end Configuration
Loading and preprocessing data...
test_magnitude.shape (1406, 64)
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_1/1_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.725118976
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 38.6423419952 35.0991477966
20 161.713800049 158.613922119
30 247.503570557 242.854927063
40 336.667449951 330.682769775
50 445.338150024 436.794891357
60 597.433325195 584.704162598
70 844.703747559 824.881347656
80 1311.05961914 1273.43701172
90 2369.42944336 2276.2890625
100 202022.625 78149.3203125
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net3
Model name for the evaluation phase:  net3
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x512x64
  1          64x512x64
  2          64x512x64
  3          64x256x32
  4          64x256x32
  5          64x256x32
  6          64x256x32
  7          64x128x16
  8          64x128x16
  9          64x128x16
 10          2x128x16
 11          2
 12          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m1.05863[0m     [32m2.04395[0m    0.51793      0.49837  154.09s
      2     [36m0.60752[0m     [32m1.95973[0m    0.31000      0.49658  156.29s
      3     [36m0.58030[0m     [32m1.76953[0m    0.32794      0.49740  156.87s
      4     [36m0.56537[0m     [32m1.45131[0m    0.38956      0.49300  156.68s
      5     [36m0.54432[0m     [32m1.18293[0m    0.46014      0.49007  156.45s
      6     [36m0.53433[0m     [32m0.98397[0m    0.54304      0.55290  156.62s
      7     [36m0.52695[0m     1.08670    0.48491      0.53581  156.70s
      8     [36m0.51116[0m     1.10902    0.46091      0.55241  156.08s
      9     [36m0.50605[0m     1.11190    0.45513      0.53939  156.65s
     10     [36m0.50108[0m     1.04306    0.48039      0.53678  156.56s
Early stopping.
Best valid loss was 0.983967 at epoch 6.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d6' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d6' (shape 64).
Loaded parameters to layer 'conv2d9' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d9' (shape 64).
Loaded parameters to layer 'conv2d10' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d10' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 1 0 0 0 1 0 1 0 1 0 0 1 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.548697916667
Error rate (%):  45.1302083333
yVal [0 0 1 ..., 0 1 1]
[[3606  214]
 [3252  608]]
roc_auc: 0.636115752923
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (39, 1, 1406, 64)
[  1.00000000e+00   1.15192655e-21]
[ 0.9985739   0.00142613]
[  9.99099195e-01   9.00396844e-04]
[  9.99632835e-01   3.66908906e-04]
[ 0.99795634  0.00204391]
[ 0.9983505   0.00164919]
[  9.99692380e-01   3.08025978e-04]
[  1.00000000e+00   1.34085295e-18]
[  1.00000000e+00   3.43189822e-06]
[ 0.98771816  0.01228122]
[  9.99990344e-01   1.34409147e-05]
[  1.00000000e+00   1.24183375e-08]
[  1.00000000e+00   3.21237947e-09]
[ 0.92701608  0.07298431]
[ 0.99897081  0.00103003]
[ 0.99780738  0.00219276]
[  1.00000000e+00   2.23831065e-10]
[  9.99999940e-01   3.60326595e-07]
[  1.00000000e+00   6.84121640e-12]
[  1.00000000e+00   1.35531666e-17]
[  9.99985754e-01   1.81033465e-05]
[ 0.95956963  0.04043001]
[ 0.96493256  0.03506756]
[ 0.71252441  0.28747532]
[ 0.98566222  0.01433808]
[  1.00000000e+00   5.47897841e-14]
[  1.00000000e+00   1.61852356e-07]
[  1.00000000e+00   2.23651691e-16]
[  1.00000000e+00   2.62541007e-21]
[  1.00000000e+00   7.64513236e-13]
[  1.00000000e+00   1.29485254e-20]
[ 0.99843186  0.00156849]
[  1.00000000e+00   1.22608705e-14]
[  1.00000000e+00   3.05721315e-09]
[  1.00000000e+00   4.85789912e-16]
[  9.99999821e-01   3.01301867e-07]
[ 0.91553944  0.08446069]
[  9.99367356e-01   6.32923213e-04]
[ 0.85543227  0.14456755]
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[  9.99999940e-01   2.42525545e-07]
[  9.99420047e-01   5.80309541e-04]
[  9.99995232e-01   8.09036555e-06]
[ 0.82592529  0.1740751 ]
[  1.00000000e+00   1.48822898e-11]
roc_auc for the hours: 0.530769230769
Accuracy validation for the hours:  0.886363636364
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run1.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0', '--channels=8']
Command line arguments: Namespace(channels=[8], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run1.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient0'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-09-27 21:33:27.401030
Hostname: kat
gpu0
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 512
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net3
evaluation:
    online_training: False
    model: net3

end Configuration
Loading and preprocessing data...
test_magnitude.shape (1406, 64)
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_1/1_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.725184512
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 49.4141464233 44.965970993
20 208.958178711 205.577194214
30 321.900491333 316.595809937
40 440.470233154 432.077514648
50 584.674072266 570.474365234
60 780.80411377 755.815979004
70 1076.43822021 1032.71588135
80 1580.6878418 1504.79504395
90 2701.39460449 2561.01733398
100 353074.21875 68448.984375
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net3
Model name for the evaluation phase:  net3
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x512x64
  1          64x512x64
  2          64x512x64
  3          64x256x32
  4          64x256x32
  5          64x256x32
  6          64x256x32
  7          64x128x16
  8          64x128x16
  9          64x128x16
 10          2x128x16
 11          2
 12          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m1.09076[0m     [32m2.82794[0m    0.38571      0.49837  153.16s
      2     [36m0.59824[0m     [32m2.16409[0m    0.27644      0.49658  155.99s
      3     [36m0.57528[0m     [32m1.70073[0m    0.33826      0.49544  157.07s
      4     [36m0.56314[0m     [32m1.51927[0m    0.37067      0.49316  156.73s
      5     [36m0.54862[0m     [32m1.30892[0m    0.41914      0.49040  157.02s
      6     [36m0.54078[0m     [32m1.13458[0m    0.47664      0.48828  156.14s
      7     [36m0.53476[0m     [32m1.09749[0m    0.48726      0.48503  156.36s
      8     [36m0.52149[0m     1.15392    0.45193      0.48128  156.77s
      9     [36m0.52131[0m     [32m1.00773[0m    0.51731      0.47347  156.12s
     10     [36m0.51360[0m     1.04927    0.48948      0.47835  157.24s
     11     [36m0.51127[0m     [32m0.93724[0m    0.54550      0.47249  156.36s
     12     [36m0.50697[0m     [32m0.86908[0m    0.58335      0.52181  156.07s
     13     [36m0.50165[0m     0.95611    0.52467      0.47119  156.58s
     14     [36m0.49227[0m     0.87111    0.56511      0.48047  156.66s
     15     [36m0.49126[0m     [32m0.86172[0m    0.57010      0.48486  156.64s
     16     [36m0.48476[0m     0.87001    0.55719      0.51725  157.26s
     17     [36m0.47787[0m     [32m0.75664[0m    0.63157      0.59668  156.47s
     18     [36m0.46787[0m     [32m0.72272[0m    0.64737      0.61279  156.38s
     19     [36m0.44881[0m     0.75013    0.59830      0.55599  156.24s
     20     0.44961     0.81264    0.55328      0.53630  156.94s
     21     [36m0.42928[0m     0.76837    0.55869      0.60726  156.64s
     22     [36m0.41709[0m     0.79977    0.52151      0.53369  156.92s
Early stopping.
Best valid loss was 0.722724 at epoch 18.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d6' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d6' (shape 64).
Loaded parameters to layer 'conv2d9' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d9' (shape 64).
Loaded parameters to layer 'conv2d10' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d10' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 1 0 1 1 1 0 1 1 0 1 1 1 0 0 1 0 0 1 0 0 0 1 1 0 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.615494791667
Error rate (%):  38.4505208333
yVal [0 0 1 ..., 0 1 1]
[[3020  800]
 [2153 1707]]
roc_auc: 0.690503282424
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (39, 1, 1406, 64)
[  1.00000000e+00   1.53259620e-20]
[ 0.70562714  0.2943733 ]
[ 0.99827862  0.00172147]
[  9.99055624e-01   9.44414409e-04]
[ 0.96417421  0.03582533]
[ 0.841214    0.15878545]
[ 0.99639785  0.00360236]
[  1.00000000e+00   6.42972081e-18]
[  9.99780774e-01   2.19690701e-04]
[ 0.75510174  0.2448986 ]
[ 0.98993361  0.01006703]
[  9.99997795e-01   2.18199216e-06]
[  9.99990582e-01   1.08080330e-05]
[ 0.94393408  0.05606631]
[ 0.75926679  0.24073273]
[ 0.99788564  0.00211456]
[  9.99995887e-01   6.18538297e-06]
[ 0.99812788  0.00187235]
[  1.00000000e+00   6.43605214e-09]
[  1.00000000e+00   3.44858030e-16]
[  9.99722779e-01   2.78700958e-04]
[ 0.89102477  0.10897517]
[ 0.97736073  0.02263881]
[ 0.4738892   0.52611071]
[ 0.98211044  0.0178896 ]
[  1.00000000e+00   1.80869653e-12]
[ 0.35198525  0.64801461]
[  1.00000000e+00   1.52136706e-20]
[  1.00000000e+00   2.55399814e-22]
[  1.00000000e+00   3.28760019e-10]
[  1.00000000e+00   1.41523918e-13]
[ 0.81425685  0.18574378]
[  1.00000000e+00   2.44538806e-10]
[ 0.87258989  0.12741061]
[  1.00000000e+00   6.09367667e-10]
[ 0.99315798  0.00684372]
[ 0.90300882  0.09699123]
[ 0.62754995  0.37245023]
[ 0.84648472  0.15351611]
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[ 0.99891192  0.00108827]
[ 0.80296665  0.19703323]
[ 0.8042239   0.19577667]
[ 0.49600035  0.50399959]
[  1.00000000e+00   1.78326811e-08]
roc_auc for the hours: 0.671794871795
Accuracy validation for the hours:  0.863636363636
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run1.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0', '--channels=9']
Command line arguments: Namespace(channels=[9], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run1.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient0'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-09-27 22:36:52.806862
Hostname: kat
gpu0
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 512
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net3
evaluation:
    online_training: False
    model: net3

end Configuration
Loading and preprocessing data...
test_magnitude.shape (1406, 64)
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_1/1_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.724897792
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 60.8246585846 54.0624084473
20 254.689199829 246.874298096
30 391.764382935 379.099685669
40 536.115319824 516.814331055
50 716.320129395 687.126220703
60 976.413891602 932.889160156
70 1390.45943604 1328.53936768
80 2113.4605957 2010.52490234
90 3753.54802246 3538.35632324
100 262006.171875 86094.46875
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net3
Model name for the evaluation phase:  net3
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x512x64
  1          64x512x64
  2          64x512x64
  3          64x256x32
  4          64x256x32
  5          64x256x32
  6          64x256x32
  7          64x128x16
  8          64x128x16
  9          64x128x16
 10          2x128x16
 11          2
 12          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m1.24362[0m     [32m3.50749[0m    0.35456      0.49837  153.92s
      2     [36m0.58123[0m     [32m2.98020[0m    0.19503      0.49691  156.35s
      3     [36m0.57322[0m     [32m2.29839[0m    0.24940      0.49577  157.13s
      4     [36m0.54450[0m     [32m1.98414[0m    0.27443      0.49333  156.94s
      5     [36m0.52575[0m     [32m1.70700[0m    0.30800      0.49137  157.11s
      6     [36m0.52574[0m     [32m1.52131[0m    0.34559      0.49007  156.54s
      7     [36m0.52273[0m     [32m1.47497[0m    0.35440      0.48926  156.72s
      8     [36m0.50306[0m     [32m1.43486[0m    0.35060      0.48486  156.63s
      9     [36m0.50103[0m     1.50281    0.33340      0.48210  157.03s
     10     [36m0.49410[0m     [32m1.35797[0m    0.36385      0.47900  156.91s
     11     [36m0.49222[0m     [32m1.25791[0m    0.39130      0.49772  157.02s
     12     [36m0.48686[0m     1.26492    0.38489      0.50195  157.32s
     13     [36m0.48452[0m     1.28803    0.37617      0.55192  157.49s
     14     [36m0.47052[0m     1.34373    0.35016      0.50879  157.58s
     15     0.47115     [32m1.17954[0m    0.39944      0.54883  157.47s
     16     [36m0.46335[0m     1.18139    0.39221      0.54574  157.57s
     17     [36m0.45695[0m     [32m1.02945[0m    0.44387      0.55176  157.80s
     18     [36m0.44538[0m     1.05360    0.42272      0.51953  157.64s
     19     [36m0.42510[0m     [32m0.93762[0m    0.45338      0.49447  157.49s
     20     0.43114     1.09180    0.39488      0.52913  157.51s
     21     [36m0.41314[0m     0.94978    0.43499      0.53353  157.60s
     22     [36m0.40104[0m     [32m0.87162[0m    0.46011      0.54801  157.62s
     23     [36m0.35841[0m     0.93121    0.38489      0.54785  157.51s
     24     [36m0.34932[0m     1.06567    0.32779      0.56771  157.54s
     25     [36m0.34320[0m     1.19236    0.28784      0.52230  157.47s
     26     [36m0.32963[0m     1.14018    0.28910      0.56608  157.44s
Early stopping.
Best valid loss was 0.871616 at epoch 22.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d6' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d6' (shape 64).
Loaded parameters to layer 'conv2d9' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d9' (shape 64).
Loaded parameters to layer 'conv2d10' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d10' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[0 0 1 0 0 0 1 1 0 0 0 1 0 0 1 1 1 0 0 1 0 0 1 0 1 0 1 0 1 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.568489583333
Error rate (%):  43.1510416667
yVal [0 0 1 ..., 0 1 1]
[[2404 1416]
 [1898 1962]]
roc_auc: 0.613371537856
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (39, 1, 1406, 64)
[  1.00000000e+00   8.18235482e-24]
[ 0.11935756  0.88064265]
[ 0.12758461  0.87241572]
[ 0.23541461  0.76458496]
[ 0.80680448  0.19319548]
[ 0.31344974  0.68654984]
[ 0.77562344  0.22437657]
[  1.00000000e+00   5.74364135e-23]
[  9.99976218e-01   2.51191686e-05]
[ 0.09502835  0.90497118]
[ 0.99263573  0.0073649 ]
[ 0.99089873  0.00910124]
[ 0.66807067  0.33192948]
[ 0.85936403  0.14063604]
[ 0.73780233  0.2621983 ]
[ 0.98240882  0.0175922 ]
[  9.99839067e-01   1.62375378e-04]
[ 0.68927115  0.31072888]
[  1.00000000e+00   1.74393323e-13]
[  1.00000000e+00   5.26714223e-35]
[ 0.76965296  0.23034701]
[ 0.91789609  0.08210455]
[ 0.91695964  0.08304017]
[ 0.91429853  0.08570193]
[ 0.06590077  0.93409985]
[  1.00000000e+00   2.56447685e-09]
[ 0.57930911  0.42069012]
[  1.00000000e+00   3.31523137e-16]
[  1.00000000e+00   1.64645110e-12]
[ 0.99683422  0.00316666]
[  1.00000000e+00   3.09048407e-14]
[ 0.07060025  0.92940068]
[  1.00000000e+00   4.83178342e-09]
[ 0.00323643  0.996764  ]
[  1.00000000e+00   1.87011150e-16]
[  9.99941885e-01   5.83801811e-05]
[ 0.87924987  0.12075024]
[ 0.2952306   0.70476866]
[ 0.47714323  0.52285701]
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[  9.99697864e-01   3.03962501e-04]
[ 0.00171683  0.99828249]
[ 0.42733353  0.57266623]
[ 0.87658191  0.12341788]
[  1.00000000e+00   1.56611701e-08]
roc_auc for the hours: 0.579487179487
Accuracy validation for the hours:  0.704545454545
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run1.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0', '--channels=10']
Command line arguments: Namespace(channels=[10], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run1.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient0'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-09-27 23:51:03.241270
Hostname: kat
gpu0
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 512
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net3
evaluation:
    online_training: False
    model: net3

end Configuration
Loading and preprocessing data...
test_magnitude.shape (1406, 64)
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_1/1_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.725549056
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 45.3170951843 39.5809764862
20 189.624957275 178.504226685
30 296.130010986 277.927627563
40 416.461804199 387.818572998
50 579.042205811 535.606506348
60 821.163928223 759.156677246
70 1192.01209717 1108.3949585
80 1831.40200195 1702.2791748
90 3394.49926758 3141.58947754
100 51527.984375 51923.34375
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net3
Model name for the evaluation phase:  net3
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x512x64
  1          64x512x64
  2          64x512x64
  3          64x256x32
  4          64x256x32
  5          64x256x32
  6          64x256x32
  7          64x128x16
  8          64x128x16
  9          64x128x16
 10          2x128x16
 11          2
 12          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m1.20647[0m     [32m2.47130[0m    0.48819      0.49821  154.36s
      2     [36m0.59558[0m     [32m1.74924[0m    0.34048      0.49430  156.74s
      3     [36m0.58513[0m     [32m1.42927[0m    0.40939      0.49447  156.89s
      4     [36m0.56006[0m     [32m1.28588[0m    0.43554      0.49089  156.68s
      5     [36m0.53955[0m     [32m1.10178[0m    0.48971      0.52604  156.91s
      6     [36m0.53864[0m     [32m0.99771[0m    0.53987      0.58105  156.74s
      7     [36m0.53345[0m     1.07388    0.49675      0.51693  156.44s
      8     [36m0.51337[0m     1.14279    0.44922      0.51921  156.60s
      9     [36m0.51199[0m     1.13333    0.45176      0.49740  156.96s
     10     [36m0.50045[0m     1.08357    0.46185      0.49919  156.26s
Early stopping.
Best valid loss was 0.997713 at epoch 6.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d6' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d6' (shape 64).
Loaded parameters to layer 'conv2d9' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d9' (shape 64).
Loaded parameters to layer 'conv2d10' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d10' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 1 1 1 1 0 1 0 0 0 1 1 0 0 1 0 0 0 0 1 0 0 0 0 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.596223958333
Error rate (%):  40.3776041667
yVal [0 0 1 ..., 0 1 1]
[[2958  862]
 [2239 1621]]
roc_auc: 0.611486009006
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (39, 1, 1406, 64)
[  1.00000000e+00   1.59429592e-14]
[ 0.79049546  0.20950493]
[ 0.87539876  0.12460086]
[ 0.96367896  0.0363215 ]
[ 0.98608482  0.01391753]
[ 0.69729924  0.30270058]
[ 0.98954225  0.01045914]
[  1.00000000e+00   7.44700092e-13]
[ 0.99203295  0.00796773]
[ 0.75484371  0.24515618]
[ 0.98895717  0.01104299]
[  9.99975204e-01   2.49775239e-05]
[  1.00000000e+00   1.05404108e-09]
[ 0.90896809  0.09103222]
[ 0.90669715  0.09330224]
[ 0.98498809  0.01501309]
[  9.99999821e-01   2.97472207e-06]
[ 0.99784666  0.00215392]
[  1.00000000e+00   1.09898490e-09]
[  1.00000000e+00   8.54159948e-20]
[  9.99285042e-01   7.14957539e-04]
[ 0.55349702  0.44650292]
[ 0.71638238  0.28361782]
[ 0.67363471  0.32636532]
[ 0.71029937  0.28970069]
[  1.00000000e+00   1.16484183e-14]
[ 0.99428701  0.00571436]
[  1.00000000e+00   2.84758924e-13]
[  1.00000000e+00   1.84053375e-13]
[  1.00000000e+00   2.27352714e-09]
[  1.00000000e+00   4.44285977e-21]
[ 0.90809143  0.09190894]
[  1.00000000e+00   4.57496194e-12]
[ 0.99827647  0.001723  ]
[  1.00000000e+00   3.59009480e-13]
[  9.99996185e-01   5.45833655e-06]
[ 0.91490221  0.08509786]
[ 0.99885386  0.00114529]
[ 0.55546498  0.44453499]
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[  9.99992847e-01   8.53235088e-06]
[ 0.78048867  0.21951121]
[ 0.83414131  0.16585854]
[ 0.64587033  0.35412967]
[  1.00000000e+00   2.37235446e-14]
roc_auc for the hours: 0.615384615385
Accuracy validation for the hours:  0.886363636364
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run1.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0', '--channels=11']
Command line arguments: Namespace(channels=[11], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run1.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient0'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-09-28 00:23:11.630341
Hostname: kat
gpu0
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 512
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net3
evaluation:
    online_training: False
    model: net3

end Configuration
Loading and preprocessing data...
test_magnitude.shape (1406, 64)
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_1/1_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.724566016
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 34.3634315491 30.060459137
20 138.222512817 132.134262085
30 211.831253052 202.679618835
40 290.449456787 276.802490234
50 391.356781006 370.085968018
60 547.523474121 512.188842773
70 842.824353027 778.507873535
80 1484.78508301 1340.56811523
90 3403.51403809 2935.4519043
100 410646.09375 69810.453125
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net3
Model name for the evaluation phase:  net3
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x512x64
  1          64x512x64
  2          64x512x64
  3          64x256x32
  4          64x256x32
  5          64x256x32
  6          64x256x32
  7          64x128x16
  8          64x128x16
  9          64x128x16
 10          2x128x16
 11          2
 12          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m1.51096[0m     [32m1.45707[0m    1.03698      0.49837  153.86s
      2     [36m0.62399[0m     [32m0.93861[0m    0.66480      0.64583  156.56s
      3     [36m0.58734[0m     [32m0.80341[0m    0.73106      0.59880  156.95s
      4     [36m0.57375[0m     0.84063    0.68253      0.61654  156.54s
      5     [36m0.55484[0m     [32m0.73961[0m    0.75018      0.58561  157.07s
      6     [36m0.54773[0m     [32m0.70834[0m    0.77326      0.56104  156.92s
      7     [36m0.53586[0m     0.81558    0.65702      0.61377  156.74s
      8     [36m0.51307[0m     0.88164    0.58195      0.59880  156.77s
      9     [36m0.51265[0m     0.95679    0.53580      0.58903  156.47s
     10     [36m0.50353[0m     0.89326    0.56370      0.57048  156.53s
Early stopping.
Best valid loss was 0.708341 at epoch 6.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d6' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d6' (shape 64).
Loaded parameters to layer 'conv2d9' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d9' (shape 64).
Loaded parameters to layer 'conv2d10' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d10' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 1 1 1 1 1 0 1 1 0 1 1 1 1 0 1 0 0 1 0 1 1 1 0 1 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.570703125
Error rate (%):  42.9296875
yVal [0 0 1 ..., 0 1 1]
[[2051 1769]
 [1528 2332]]
roc_auc: 0.648635115156
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (39, 1, 1406, 64)
[  1.00000000e+00   4.61513538e-09]
[ 0.04823764  0.95176202]
[ 0.09484317  0.90515709]
[ 0.05262235  0.94737732]
[ 0.67272961  0.32727   ]
[ 0.04860318  0.95139742]
[ 0.88909668  0.11090368]
[  1.00000000e+00   1.29571544e-11]
[ 0.54835182  0.45164803]
[ 0.21212991  0.78786987]
[ 0.15465517  0.84534544]
[ 0.91686827  0.08313357]
[  9.99999523e-01   8.73015381e-07]
[ 0.91632682  0.08367305]
[ 0.80313045  0.19687054]
[ 0.98096299  0.01903722]
[  9.99999702e-01   4.35355332e-07]
[ 0.88040376  0.11959645]
[  9.99890149e-01   1.11020490e-04]
[  1.00000000e+00   1.08078372e-14]
[ 0.22169131  0.77830791]
[ 0.04686666  0.95313299]
[ 0.03437689  0.9656235 ]
[ 0.1147457   0.88525385]
[ 0.04125379  0.9587459 ]
[  9.99999940e-01   4.71073378e-07]
[ 0.57571304  0.42428717]
[  1.00000000e+00   9.34257793e-12]
[  1.00000000e+00   2.08526807e-10]
[ 0.99013364  0.00986707]
[  1.00000000e+00   2.19989744e-07]
[ 0.471973    0.52802688]
[  9.99999702e-01   1.48691799e-06]
[ 0.88508087  0.1149202 ]
[  1.00000000e+00   2.49971066e-07]
[ 0.85632956  0.14367053]
[ 0.91998875  0.08001154]
[ 0.38960749  0.61039221]
[ 0.08813843  0.91186202]
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[ 0.99564058  0.00436034]
[ 0.0711307   0.92886907]
[ 0.0236775   0.97632295]
[ 0.11571637  0.88428307]
[  9.99817967e-01   1.82610936e-04]
roc_auc for the hours: 0.646153846154
Accuracy validation for the hours:  0.636363636364
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run1.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0', '--channels=12']
Command line arguments: Namespace(channels=[12], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run1.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient0'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-09-28 00:55:20.467746
Hostname: kat
gpu0
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 512
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net3
evaluation:
    online_training: False
    model: net3

end Configuration
Loading and preprocessing data...
test_magnitude.shape (1406, 64)
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_1/1_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.725622784
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 59.5394416809 52.4879989624
20 245.482409668 233.52784729
30 380.90708313 361.512054443
40 531.113098145 500.606658936
50 732.89251709 684.365264893
60 1045.06953125 970.801757812
70 1567.62325439 1455.69378662
80 2545.51733398 2337.99316406
90 5088.38081055 4587.39916992
100 126710.1875 64910.4453125
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net3
Model name for the evaluation phase:  net3
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x512x64
  1          64x512x64
  2          64x512x64
  3          64x256x32
  4          64x256x32
  5          64x256x32
  6          64x256x32
  7          64x128x16
  8          64x128x16
  9          64x128x16
 10          2x128x16
 11          2
 12          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m1.61764[0m     [32m3.33728[0m    0.48472      0.49837  153.50s
      2     [36m0.61934[0m     [32m2.13680[0m    0.28984      0.49707  156.51s
      3     [36m0.59486[0m     [32m1.50977[0m    0.39401      0.49479  156.94s
      4     [36m0.55231[0m     [32m1.24877[0m    0.44229      0.48942  157.31s
      5     [36m0.52488[0m     [32m1.03619[0m    0.50655      0.47380  157.62s
      6     [36m0.52193[0m     [32m0.98199[0m    0.53151      0.47721  158.06s
      7     [36m0.51822[0m     1.05257    0.49233      0.47282  158.19s
      8     [36m0.49482[0m     1.05247    0.47015      0.46794  157.22s
      9     0.49550     1.01936    0.48609      0.45817  157.42s
     10     [36m0.48671[0m     [32m0.89429[0m    0.54425      0.53320  157.50s
     11     [36m0.48090[0m     0.89891    0.53498      0.46533  157.90s
     12     [36m0.47688[0m     [32m0.80481[0m    0.59254      0.53304  157.52s
     13     [36m0.46938[0m     0.85646    0.54805      0.52881  157.34s
     14     [36m0.45418[0m     0.82722    0.54904      0.55192  157.53s
     15     0.45549     [32m0.80185[0m    0.56804      0.56445  156.75s
     16     [36m0.44096[0m     0.83867    0.52578      0.53727  156.88s
     17     0.44348     [32m0.76833[0m    0.57720      0.56478  156.93s
     18     [36m0.42224[0m     [32m0.76741[0m    0.55022      0.54883  156.77s
     19     [36m0.40374[0m     0.78425    0.51482      0.62207  157.63s
     20     0.40627     0.78292    0.51892      0.62126  156.82s
     21     [36m0.38803[0m     0.88770    0.43712      0.52686  156.95s
     22     [36m0.38090[0m     0.82793    0.46007      0.59261  156.73s
Early stopping.
Best valid loss was 0.767412 at epoch 18.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d6' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d6' (shape 64).
Loaded parameters to layer 'conv2d9' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d9' (shape 64).
Loaded parameters to layer 'conv2d10' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d10' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 1 1 1 1 1 0 1 1 0 1 1 1 1 0 1 0 0 1 0 1 1 1 1 1 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.558072916667
Error rate (%):  44.1927083333
yVal [0 0 1 ..., 0 1 1]
[[1815 2005]
 [1389 2471]]
roc_auc: 0.518663870276
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (39, 1, 1406, 64)
[  1.00000000e+00   1.21947863e-16]
[ 0.07701139  0.92298925]
[ 0.03905769  0.96094215]
[ 0.01729306  0.9827072 ]
[ 0.15094128  0.84905964]
[ 0.07253613  0.92746377]
[ 0.50437903  0.49562106]
[  1.00000000e+00   4.55806826e-14]
[ 0.64847767  0.35152206]
[ 0.00591331  0.99408638]
[ 0.26560187  0.73439753]
[  9.99643266e-01   3.56844888e-04]
[  1.00000000e+00   1.77196569e-09]
[ 0.89808923  0.10191213]
[ 0.29410741  0.70589244]
[ 0.98542595  0.01457519]
[ 0.90743864  0.09256075]
[ 0.99852139  0.0014789 ]
[  1.00000000e+00   1.52495627e-10]
[  1.00000000e+00   4.97280179e-16]
[ 0.46318808  0.53681159]
[ 0.26781741  0.73218244]
[ 0.11717849  0.88282186]
[ 0.34740889  0.65259075]
[ 0.03346247  0.96653742]
[ 0.9977687   0.00223158]
[  1.57184422e-05   9.99985397e-01]
[  1.00000000e+00   1.40054999e-11]
[  1.00000000e+00   1.15726708e-11]
[ 0.56430292  0.43569687]
[  9.99990880e-01   9.16766294e-06]
[ 0.07907622  0.92092454]
[  9.99996185e-01   5.58638476e-06]
[ 0.81711447  0.18288584]
[  1.00000000e+00   1.08556651e-06]
[ 0.65228951  0.34771165]
[ 0.9044773   0.09552286]
[  9.74481984e-04   9.99028444e-01]
[ 0.06492967  0.9350698 ]
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[ 0.95472223  0.04527808]
[ 0.69393015  0.30606994]
[ 0.07122826  0.92877215]
[ 0.39812267  0.60187697]
[  9.99141634e-01   8.58858752e-04]
roc_auc for the hours: 0.502564102564
Accuracy validation for the hours:  0.545454545455
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run1.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0', '--channels=13']
Command line arguments: Namespace(channels=[13], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run1.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient0'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-09-28 01:59:01.056568
Hostname: kat
gpu0
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 512
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net3
evaluation:
    online_training: False
    model: net3

end Configuration
Loading and preprocessing data...
test_magnitude.shape (1406, 64)
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_1/1_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.725180416
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 63.0294364929 56.5815162659
20 264.939825439 254.637069702
30 413.522460938 396.065826416
40 579.621655273 552.57043457
50 803.26651001 762.77243042
60 1137.32678223 1083.71508789
70 1643.4175293 1582.21246338
80 2494.01391602 2400.1328125
90 4490.2112793 4296.84179688
100 100082.695312 85056.0390625
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net3
Model name for the evaluation phase:  net3
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x512x64
  1          64x512x64
  2          64x512x64
  3          64x256x32
  4          64x256x32
  5          64x256x32
  6          64x256x32
  7          64x128x16
  8          64x128x16
  9          64x128x16
 10          2x128x16
 11          2
 12          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m1.41574[0m     [32m4.06977[0m    0.34787      0.49837  154.07s
      2     [36m0.62764[0m     [32m2.30774[0m    0.27197      0.49674  156.42s
      3     [36m0.59418[0m     [32m1.82495[0m    0.32559      0.49740  157.28s
      4     [36m0.56425[0m     [32m1.51933[0m    0.37138      0.49235  157.09s
      5     [36m0.53190[0m     [32m1.11963[0m    0.47506      0.47917  157.06s
      6     [36m0.52981[0m     [32m1.04147[0m    0.50872      0.49349  156.48s
      7     [36m0.52156[0m     1.10718    0.47107      0.48877  156.75s
      8     [36m0.49503[0m     1.07676    0.45974      0.51758  156.99s
      9     [36m0.49340[0m     1.09329    0.45130      0.50651  157.10s
     10     [36m0.48241[0m     [32m0.91790[0m    0.52556      0.56445  156.40s
     11     [36m0.47386[0m     [32m0.90882[0m    0.52141      0.55306  157.29s
     12     [36m0.46743[0m     [32m0.85933[0m    0.54395      0.50667  156.30s
     13     [36m0.46122[0m     [32m0.83752[0m    0.55069      0.50765  156.74s
     14     [36m0.44169[0m     0.84267    0.52415      0.49609  157.01s
     15     0.44319     0.86913    0.50993      0.49398  157.29s
     16     [36m0.42153[0m     [32m0.82882[0m    0.50859      0.51416  156.37s
     17     [36m0.41315[0m     0.83178    0.49670      0.60579  156.56s
     18     [36m0.41091[0m     [32m0.77467[0m    0.53043      0.57796  156.80s
     19     [36m0.37792[0m     0.88431    0.42736      0.64779  156.76s
     20     0.38046     0.80793    0.47091      0.61523  156.72s
     21     [36m0.36327[0m     0.93293    0.38939      0.61458  156.90s
     22     [36m0.35279[0m     1.03899    0.33955      0.60612  156.67s
Early stopping.
Best valid loss was 0.774667 at epoch 18.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d6' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d6' (shape 64).
Loaded parameters to layer 'conv2d9' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d9' (shape 64).
Loaded parameters to layer 'conv2d10' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d10' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 1 1 1 1 1 0 1 1 0 1 1 1 1 0 1 0 0 1 0 1 0 1 1 1 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.578645833333
Error rate (%):  42.1354166667
yVal [0 0 1 ..., 0 1 1]
[[1783 2037]
 [1199 2661]]
roc_auc: 0.594676776171
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (39, 1, 1406, 64)
[  1.00000000e+00   7.03497136e-08]
[ 0.05044728  0.94955283]
[ 0.04669119  0.95330948]
[ 0.13285376  0.86714619]
[ 0.77887911  0.22112142]
[ 0.02557342  0.9744271 ]
[ 0.57218623  0.42781377]
[  1.00000000e+00   1.69193124e-13]
[ 0.65805626  0.34194362]
[ 0.00810296  0.99189836]
[ 0.61567593  0.38432449]
[  9.99575794e-01   4.24276164e-04]
[  1.00000000e+00   2.62166200e-08]
[ 0.91875589  0.08124457]
[ 0.16986075  0.83013952]
[ 0.94708556  0.05291476]
[ 0.40371737  0.5962829 ]
[ 0.79293215  0.20706788]
[  1.00000000e+00   1.62158827e-07]
[  1.00000000e+00   3.50956811e-19]
[ 0.62632751  0.3736729 ]
[ 0.07796135  0.92203838]
[ 0.02822008  0.97177941]
[ 0.28203186  0.71796829]
[ 0.11628398  0.88371634]
[  1.00000000e+00   1.02307965e-07]
[  9.25103638e-09   1.00000000e+00]
[  1.00000000e+00   9.81580160e-17]
[  1.00000000e+00   4.84577809e-19]
[ 0.78571838  0.21428177]
[  9.99999166e-01   1.33696483e-06]
[  1.68842462e-07   1.00000000e+00]
[  1.00000000e+00   1.04145581e-08]
[  2.78497173e-04   9.99721646e-01]
[  1.00000000e+00   4.57176570e-17]
[ 0.57194376  0.4280563 ]
[ 0.67864221  0.32135758]
[  6.18807026e-05   9.99938428e-01]
[ 0.10426088  0.89573884]
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[ 0.97887611  0.02112358]
[ 0.29405096  0.70594853]
[  6.40429382e-04   9.99360800e-01]
[ 0.41936904  0.5806309 ]
[ 0.97094226  0.02905835]
roc_auc for the hours: 0.54358974359
Accuracy validation for the hours:  0.590909090909
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run1.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0', '--channels=14']
Command line arguments: Namespace(channels=[14], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run1.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient0'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-09-28 03:02:31.412297
Hostname: kat
gpu0
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 512
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net3
evaluation:
    online_training: False
    model: net3

end Configuration
Loading and preprocessing data...
test_magnitude.shape (1406, 64)
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_1/1_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.72523776
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 47.1018074036 41.9034309387
20 194.863269043 187.404129028
30 299.46585083 288.103988647
40 411.538861084 394.770477295
50 557.168609619 531.75213623
60 785.241699219 745.654541016
70 1187.45931396 1128.42919922
80 1955.85324707 1847.97949219
90 3920.83825684 3699.4642334
100 65181.1953125 57682.203125
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net3
Model name for the evaluation phase:  net3
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x512x64
  1          64x512x64
  2          64x512x64
  3          64x256x32
  4          64x256x32
  5          64x256x32
  6          64x256x32
  7          64x128x16
  8          64x128x16
  9          64x128x16
 10          2x128x16
 11          2
 12          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m1.34225[0m     [32m2.35387[0m    0.57023      0.49870  153.49s
      2     [36m0.63252[0m     [32m1.58522[0m    0.39901      0.49691  156.68s
      3     [36m0.61653[0m     [32m1.22075[0m    0.50504      0.48600  156.99s
      4     [36m0.58493[0m     1.24323    0.47049      0.48568  156.84s
      5     [36m0.55361[0m     [32m1.00193[0m    0.55254      0.50700  156.99s
      6     [36m0.54439[0m     [32m0.86922[0m    0.62630      0.58643  156.71s
      7     [36m0.53673[0m     1.00549    0.53380      0.53548  156.84s
      8     [36m0.51569[0m     0.94388    0.54635      0.56510  156.45s
      9     [36m0.51516[0m     0.94180    0.54699      0.56055  157.82s
     10     [36m0.50832[0m     [32m0.80190[0m    0.63390      0.58968  156.78s
     11     [36m0.49536[0m     [32m0.77451[0m    0.63958      0.57926  157.30s
     12     [36m0.49251[0m     0.77797    0.63307      0.58024  156.48s
     13     [36m0.48106[0m     0.79917    0.60195      0.58040  156.75s
     14     [36m0.46583[0m     0.81855    0.56910      0.56738  156.82s
     15     [36m0.46200[0m     [32m0.74268[0m    0.62207      0.60335  156.80s
     16     [36m0.44035[0m     0.76652    0.57448      0.59229  156.72s
     17     [36m0.43345[0m     [32m0.71297[0m    0.60796      0.60807  157.17s
     18     [36m0.42168[0m     0.74160    0.56861      0.62712  157.11s
     19     [36m0.39503[0m     0.74747    0.52849      0.61133  156.71s
     20     [36m0.38689[0m     0.83653    0.46249      0.60612  156.97s
     21     [36m0.38486[0m     0.90025    0.42750      0.55355  156.75s
Early stopping.
Best valid loss was 0.712967 at epoch 17.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d6' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d6' (shape 64).
Loaded parameters to layer 'conv2d9' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d9' (shape 64).
Loaded parameters to layer 'conv2d10' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d10' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 1 1 1 1 1 0 1 1 0 1 1 1 1 0 1 0 0 1 0 1 1 1 0 1 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.611588541667
Error rate (%):  38.8411458333
yVal [0 0 1 ..., 0 1 1]
[[1897 1923]
 [1060 2800]]
roc_auc: 0.638799643274
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (39, 1, 1406, 64)
[  1.00000000e+00   2.24396524e-09]
[ 0.02475943  0.97524059]
[ 0.04090108  0.95909941]
[ 0.03806745  0.96193254]
[ 0.39173675  0.60826361]
[ 0.02255604  0.97744387]
[ 0.97445571  0.02554453]
[  1.00000000e+00   8.19033833e-14]
[ 0.93732381  0.06267612]
[ 0.01877275  0.9812277 ]
[ 0.24764061  0.75235957]
[ 0.76065791  0.23934218]
[ 0.99777275  0.00222786]
[ 0.99524307  0.0047567 ]
[ 0.83362448  0.16637501]
[ 0.98998821  0.01001242]
[ 0.9442243   0.05577653]
[ 0.85966593  0.14033431]
[  1.00000000e+00   1.23616024e-08]
[  1.00000000e+00   3.87566840e-17]
[ 0.13127019  0.86873049]
[ 0.01982226  0.98017782]
[ 0.01483067  0.98516929]
[ 0.00467298  0.99532884]
[ 0.03248416  0.96751547]
[ 0.99456495  0.00543661]
[ 0.11521431  0.88478583]
[  1.00000000e+00   1.28278410e-12]
[  9.99999821e-01   2.13716632e-07]
[ 0.9946475   0.00535275]
[  9.99953687e-01   4.77447174e-05]
[ 0.37913185  0.62086821]
[ 0.99431056  0.00569084]
[ 0.7304396   0.26955983]
[  1.00000000e+00   9.34285804e-09]
[ 0.91957378  0.08042712]
[ 0.75938225  0.24061786]
[ 0.00250362  0.99749738]
[ 0.00868489  0.99131536]
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[  9.99988616e-01   1.23947766e-05]
[ 0.09631486  0.90368605]
[ 0.12575638  0.87424392]
[ 0.00409684  0.995906  ]
[ 0.46878105  0.53121942]
roc_auc for the hours: 0.630769230769
Accuracy validation for the hours:  0.613636363636
['python', 'train_batch.py', '--debug-sub-ratio=1', '--model-filename=run1.pickle', '--config-filename=config.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0', '--channels=15']
Command line arguments: Namespace(channels=[15], chosen_validation_ratio=0.2, config_filename='config.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_filename='run1.pickle', no_channels=1, no_preprocessing=False, no_save_model=False, no_save_preprocessed=False, no_training=False, patients=['patient0'], plot_prob_dist=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-09-28 04:03:27.335345
Hostname: kat
gpu0
Configuration 'config.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 512
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net3
evaluation:
    online_training: False
    model: net3

end Configuration
Loading and preprocessing data...
test_magnitude.shape (1406, 64)
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels
/home/eavsteen/seizure_detection/data/train_1/1_
[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191]
153
[110  74 163  97 126  71  18 157 145   7   5 139 158 170 160 167  37  66
 138 122  56 187 136 182 191 152  63  60 161  33   4  55  96  44  45  26
 178 180 113   8 101  89  90 118 175 111  24  30 112  61 177 123  19 146
  83  54 156  16  51  86 143  40 176  22 131 130 137  80 108  14  27  92
 109  46 188  98  62   2  59 106 107  43  10  93  73 185 171 124 189 134
 154 184  50   0  94 153  95  64 135  41  69  49  48  85  13 144  23 179
 129  20  15  78 104  52 100  76   3 116 190 125   6  68  75  84 141 121
  12 168 164 149  91 173  11 119 102  35  57  65   1 120 155  42 105 132
 166  17  38 133  53 150 128  34  28]
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
20
[ 5  2 19 16 11 22 17 24 23 14  1 10 13  8  6 18  4  9  7 20]
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 192 no seizure hours and 25 seizure hours
Memory usage (GB): 0.7251968
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 39
percentiles:
0 0.0 0.0
10 31.7646816254 28.4185752869
20 129.457452393 125.507354736
30 197.740777588 192.144943237
40 269.609753418 261.310760498
50 359.916183472 347.308181763
60 495.644329834 475.592895508
70 743.125952148 708.52130127
80 1261.15825195 1195.06652832
90 2526.72180176 2381.0592041
100 37134.734375 63323.234375
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
size 38400
no_normal 192
no_seizure 25
no_samples_normal_ph 100
no_samples_seizure_ph 768
Histogram:
[19200 19200]
magnitudes.shape (38400,)
labels.shape (38400,)
Ratio validation: 0.2
xVal.shape (7680,)
yVal.shape (7680,)
xTrain.shape (30720,)
yTrain.shape (30720,)
xVal.shape (7680, 2)
yVal.shape (7680,)
Saving preprocessed data...
Building models ...
Model name for the training phase:  net3
Model name for the evaluation phase:  net3
Training model...
# Neural Network with 149506 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x512x64
  1          64x512x64
  2          64x512x64
  3          64x256x32
  4          64x256x32
  5          64x256x32
  6          64x256x32
  7          64x128x16
  8          64x128x16
  9          64x128x16
 10          2x128x16
 11          2
 12          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -------
      1     [36m1.05057[0m     [32m1.79858[0m    0.58411      0.49837  153.41s
      2     [36m0.62452[0m     [32m1.52751[0m    0.40885      0.49674  156.46s
      3     [36m0.58317[0m     [32m1.30131[0m    0.44814      0.49447  156.72s
      4     [36m0.57367[0m     1.37766    0.41641      0.49154  156.71s
      5     [36m0.55418[0m     [32m1.23369[0m    0.44921      0.48747  156.84s
      6     [36m0.54676[0m     [32m1.03157[0m    0.53002      0.47721  156.90s
      7     [36m0.54115[0m     1.16908    0.46289      0.48031  157.11s
      8     [36m0.52294[0m     1.16182    0.45011      0.47477  156.89s
      9     [36m0.51713[0m     1.21981    0.42395      0.47217  157.33s
     10     [36m0.51110[0m     1.07474    0.47556      0.47070  156.64s
     11     [36m0.50245[0m     [32m0.98244[0m    0.51143      0.47721  157.04s
     12     [36m0.49361[0m     [32m0.97857[0m    0.50442      0.50570  156.93s
     13     [36m0.48702[0m     [32m0.93974[0m    0.51825      0.49609  157.48s
     14     [36m0.47137[0m     1.01310    0.46528      0.50667  156.94s
     15     [36m0.47001[0m     [32m0.88453[0m    0.53137      0.49935  157.26s
     16     [36m0.45982[0m     0.91578    0.50211      0.51074  156.95s
     17     [36m0.44784[0m     [32m0.81926[0m    0.54664      0.48096  157.40s
     18     [36m0.43344[0m     0.90841    0.47714      0.48828  157.04s
     19     [36m0.41392[0m     0.85872    0.48202      0.49023  156.86s
     20     [36m0.40771[0m     1.08183    0.37687      0.48682  157.01s
     21     [36m0.40578[0m     1.09147    0.37177      0.48161  156.94s
Early stopping.
Best valid loss was 0.819262 at epoch 17.
Loaded parameters to layer 'conv2d1' (shape 64x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 64).
Loaded parameters to layer 'conv2d2' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d2' (shape 64).
Loaded parameters to layer 'conv2d5' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d5' (shape 64).
Loaded parameters to layer 'conv2d6' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d6' (shape 64).
Loaded parameters to layer 'conv2d9' (shape 64x64x3x3).
Loaded parameters to layer 'conv2d9' (shape 64).
Loaded parameters to layer 'conv2d10' (shape 2x64x3x3).
Loaded parameters to layer 'conv2d10' (shape 2).
Saving model...
Validating...
probabilities.shape (7680, 2)
Showing last 30 test samples..
Predictions:
[0 0 1 0 0 1 0 0 0 1 0 0 0 0 1 0 0 0 0 0 0 0 1 0 1 1 1 0 1 0]
Ground Truth:
[1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1 1]
Performance on relevant data
Accuracy validation:  0.491276041667
Error rate (%):  50.8723958333
yVal [0 0 1 ..., 0 1 1]
[[2445 1375]
 [2532 1328]]
roc_auc: 0.610291654233
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (39, 1, 1406, 64)
[  1.00000000e+00   6.86868069e-23]
[ 0.95309347  0.04690714]
[ 0.98276448  0.01723567]
[ 0.73735332  0.26264715]
[ 0.9777841   0.02221607]
[ 0.71152413  0.28847584]
[  9.99987423e-01   1.25834813e-05]
[  1.00000000e+00   2.17729916e-29]
[ 0.99047256  0.00952922]
[ 0.84618688  0.15381236]
[ 0.96065778  0.03934207]
[ 0.95806319  0.04193686]
[ 0.88548446  0.11451595]
[ 0.9974544   0.00254612]
[ 0.90269417  0.09730589]
[ 0.99370229  0.00629786]
[  9.99561727e-01   4.39107622e-04]
[ 0.88986123  0.11013876]
[  1.00000000e+00   5.18765792e-17]
[  1.00000000e+00   1.63298867e-25]
[ 0.92556846  0.07443114]
[ 0.85452735  0.14547265]
[ 0.83847386  0.16152564]
[ 0.96128112  0.03871889]
[ 0.90314782  0.09685193]
[  1.00000000e+00   3.11615205e-15]
[ 0.09758156  0.90241909]
[  1.00000000e+00   1.17601835e-26]
[  1.00000000e+00   8.71256758e-22]
[  1.00000000e+00   1.01387158e-07]
[  1.00000000e+00   9.17032089e-15]
[ 0.38450611  0.61549324]
[  1.00000000e+00   2.78819034e-11]
[ 0.71449184  0.28550881]
[  1.00000000e+00   7.07516736e-19]
[  9.99965787e-01   3.43612483e-05]
[ 0.8810184   0.11898153]
[ 0.24826851  0.75173134]
[ 0.382007    0.61799294]
magnitudes_seizure_val.shape (5, 1, 1406, 64)
[ 0.99695069  0.00304957]
[ 0.9885301   0.01146996]
[ 0.36822432  0.63177538]
[ 0.92657787  0.07342163]
[  1.00000000e+00   3.41720892e-08]
roc_auc for the hours: 0.523076923077
Accuracy validation for the hours:  0.818181818182
