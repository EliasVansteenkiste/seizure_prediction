['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_0']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_0'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-10 00:22:41.107429
Hostname: kat
gpu3
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net11
evaluation:
    online_training: False
    model: net11

end Configuration
['patient0_0']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [0]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.677527552
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 77.4825836182 42.2078788757
20 305.512463379 300.472479248
30 461.135577393 459.25463562
40 614.021606445 614.238354492
50 784.364746094 787.311828613
60 993.193286133 998.551342773
70 1272.31512451 1279.6506958
80 1694.84467773 1704.01054688
90 2529.98266602 2551.26169434
100 45472.875 51963.8164062
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net11
Model name for the evaluation phase:  net11
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m1.20446[0m     [32m0.69839[0m    1.72464      0.47526  52.80s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.64095[0m     1.02228    0.62698      0.47533  58.80s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.62410[0m     1.04869    0.59512      0.47512  58.90s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.61368[0m     1.05736    0.58039      0.47047  59.01s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.60788[0m     1.04163    0.58358      0.47112  58.92s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.60304[0m     1.00549    0.59975      0.47032  59.30s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.60002[0m     1.02328    0.58637      0.46978  58.64s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.59705[0m     1.01661    0.58730      0.47128  58.54s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.59494[0m     0.99613    0.59726      0.46943  58.63s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.59259[0m     0.97764    0.60614      0.46884  58.68s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.59173[0m     0.98845    0.59865      0.47003  58.82s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.698386 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.854608096469
Error rate (%):  14.5391903531
[[44649  1521]
 [ 6075     0]]
(52245,)
(52245,)
roc_auc: 0.623011306399
log_loss: 0.555432066471
roc_auc for the hours: 0.526315789474
log_loss for the hours: 0.438363868308
saving predictions to csv file
hourspatient0_0_net11_10-10-00-42-40.csv
Accuracy validation for the hours:  0.883720930233
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [0]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 0.983748608
saving predictions to csv file
patient0_0_net11_10-10-00-53-23.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_1']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_1'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-10 00:53:24.694398
Hostname: kat
gpu3
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net11
evaluation:
    online_training: False
    model: net11

end Configuration
['patient0_1']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [1]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.677892096
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 79.8583602905 43.7949028015
20 305.763250732 299.520977783
30 453.40585022 450.005862427
40 592.349865723 590.177758789
50 740.968597412 740.054229736
60 918.324951172 917.797363281
70 1161.24418945 1163.53183594
80 1578.52695313 1588.20612793
90 2613.2675293 2653.38178711
100 212492.21875 103666.890625
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net11
Model name for the evaluation phase:  net11
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m1.34692[0m     [32m0.66786[0m    2.01678      0.61006  54.10s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.65789[0m     0.73014    0.90104      0.45998  59.07s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.63420[0m     0.92047    0.68900      0.47522  58.99s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.62457[0m     0.92391    0.67601      0.47026  59.00s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.60694[0m     0.93711    0.64766      0.47008  59.11s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.60080[0m     0.92463    0.64977      0.46846  59.27s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.59457[0m     0.97659    0.60882      0.46597  58.99s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.59150[0m     0.96123    0.61536      0.46673  59.02s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.58960[0m     0.95209    0.61927      0.45911  59.01s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.58504[0m     0.96376    0.60704      0.45683  59.55s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.58403[0m     0.96029    0.60818      0.45439  59.03s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.667857 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.699684180304
Error rate (%):  30.0315819696
[[33569 12601]
 [ 3089  2986]]
(52245,)
(52245,)
roc_auc: 0.656730005678
log_loss: 0.767239426296
roc_auc for the hours: 0.7
log_loss for the hours: 0.548673825769
saving predictions to csv file
hourspatient0_1_net11_10-10-01-07-49.csv
Accuracy validation for the hours:  0.720930232558
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [1]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 0.984457216
saving predictions to csv file
patient0_1_net11_10-10-01-10-26.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_2']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_2'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-10 01:10:27.677160
Hostname: kat
gpu3
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net11
evaluation:
    online_training: False
    model: net11

end Configuration
['patient0_2']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [2]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.677761024
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 72.0125099182 40.3037857056
20 276.55925293 272.411431885
30 416.599380493 415.294677734
40 555.997583008 556.773425293
50 715.97946167 718.930877686
60 923.099047852 927.542578125
70 1228.42805176 1233.38067627
80 1756.11213379 1761.63308105
90 3001.92504883 3026.81286621
100 72650.4921875 53126.640625
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net11
Model name for the evaluation phase:  net11
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m1.45417[0m     [32m0.68384[0m    2.12648      0.59281  54.85s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.65256[0m     0.77624    0.84067      0.50613  58.90s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.62677[0m     0.91281    0.68663      0.47306  59.01s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.60884[0m     0.95288    0.63895      0.46024  58.81s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.59958[0m     0.97749    0.61339      0.43706  58.86s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.58739[0m     1.03506    0.56749      0.44444  58.84s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.58129[0m     1.10477    0.52616      0.44991  58.70s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.57633[0m     1.15486    0.49905      0.45526  58.67s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.57257[0m     1.17976    0.48533      0.46210  59.01s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.56818[0m     1.23036    0.46180      0.45797  59.24s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.56566[0m     1.23458    0.45819      0.46019  59.06s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.683840 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.742004019523
Error rate (%):  25.7995980477
[[36163 10007]
 [ 3472  2603]]
(52245,)
(52245,)
roc_auc: 0.65699814338
log_loss: 0.761251205776
roc_auc for the hours: 0.663157894737
log_loss for the hours: 0.578343701842
saving predictions to csv file
hourspatient0_2_net11_10-10-01-25-10.csv
Accuracy validation for the hours:  0.790697674419
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [2]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 0.983629824
saving predictions to csv file
patient0_2_net11_10-10-01-27-18.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_3']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_3'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-10 01:27:19.947005
Hostname: kat
gpu3
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net11
evaluation:
    online_training: False
    model: net11

end Configuration
['patient0_3']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [3]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.676859904
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 52.0612277985 28.9869352341
20 191.337734985 185.116714478
30 292.577377319 287.197384644
40 400.500439453 396.009564209
50 535.735168457 532.537109375
60 731.05357666 729.604919434
70 1066.69674072 1069.19353027
80 1804.39440918 1808.60009766
90 3908.51987305 3891.41049805
100 124376.210938 175654.078125
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net11
Model name for the evaluation phase:  net11
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m1.66036[0m     [32m0.66518[0m    2.49609      0.61068  54.43s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.66174[0m     0.86630    0.76388      0.47615  59.01s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.63803[0m     1.10628    0.57673      0.47831  58.96s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.62703[0m     1.13272    0.55356      0.47522  58.91s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.62147[0m     1.11332    0.55821      0.47371  58.98s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.61319[0m     1.05799    0.57958      0.47052  58.99s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.61026[0m     1.09702    0.55628      0.46958  58.99s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.60551[0m     0.99343    0.60952      0.46993  58.84s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.60103[0m     1.00788    0.59633      0.46995  58.88s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.59940[0m     1.00889    0.59412      0.46988  58.87s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.59240[0m     0.97205    0.60944      0.46951  58.98s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.665184 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.651086228347
Error rate (%):  34.8913771653
[[30567 15603]
 [ 2626  3449]]
(52245,)
(52245,)
roc_auc: 0.661331597041
log_loss: 0.7255054107
roc_auc for the hours: 0.647368421053
log_loss for the hours: 0.57665146485
saving predictions to csv file
hourspatient0_3_net11_10-10-01-41-41.csv
Accuracy validation for the hours:  0.674418604651
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [3]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 0.982618112
saving predictions to csv file
patient0_3_net11_10-10-01-43-51.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_4']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_4'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-10 01:43:52.867369
Hostname: kat
gpu3
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net11
evaluation:
    online_training: False
    model: net11

end Configuration
['patient0_4']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [4]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.677425152
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 60.27771492 33.2891647339
20 230.724859619 226.139196777
30 348.998257446 345.771307373
40 468.468225098 465.978533936
50 608.787628174 607.555786133
60 801.863439941 803.590454102
70 1127.33896484 1136.01357422
80 1802.12897949 1820.19179688
90 3236.02592773 3251.78005371
100 159526.84375 66619.4296875
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net11
Model name for the evaluation phase:  net11
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m1.31450[0m     [32m0.66432[0m    1.97871      0.64549  54.83s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.66785[0m     0.68723    0.97180      0.47409  59.39s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.63749[0m     0.71701    0.88909      0.48490  58.74s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.62237[0m     0.77699    0.80100      0.48503  58.68s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.60444[0m     0.82034    0.73681      0.48416  58.75s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.59717[0m     0.86344    0.69162      0.46867  58.70s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.58852[0m     0.92543    0.63594      0.46639  58.63s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.58358[0m     0.90768    0.64293      0.46787  58.62s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.57763[0m     0.95110    0.60733      0.46592  58.66s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.57143[0m     0.95433    0.59878      0.46356  58.63s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.56563[0m     0.94676    0.59743      0.46061  58.76s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.664324 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.650531151306
Error rate (%):  34.9468848694
[[30314 15856]
 [ 2402  3673]]
(52245,)
(52245,)
roc_auc: 0.684850628069
log_loss: 0.571876243716
roc_auc for the hours: 0.778947368421
log_loss for the hours: 0.500377717146
saving predictions to csv file
hourspatient0_4_net11_10-10-01-58-13.csv
Accuracy validation for the hours:  0.720930232558
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [4]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 0.985104384
saving predictions to csv file
patient0_4_net11_10-10-02-00-19.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_5']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_5'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-10 02:00:20.932380
Hostname: kat
gpu3
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net11
evaluation:
    online_training: False
    model: net11

end Configuration
['patient0_5']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [5]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.677040128
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 44.228635788 24.8328939438
20 167.781503296 163.806289673
30 254.511244202 251.485551453
40 343.928485107 341.169134521
50 452.231292725 450.168884277
60 604.746826172 604.360339355
70 863.724084473 868.017297363
80 1408.11137695 1423.19575195
90 2638.64152832 2674.38774414
100 60107.1914062 35895.5507812
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net11
Model name for the evaluation phase:  net11
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m1.24258[0m     [32m0.66056[0m    1.88112      0.56038  53.86s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.64569[0m     0.72995    0.88458      0.53106  58.49s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.62624[0m     0.84493    0.74118      0.47522  58.45s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.61392[0m     0.95746    0.64120      0.47191  58.43s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.60731[0m     0.97486    0.62297      0.47070  58.50s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.60038[0m     0.96592    0.62156      0.46588  58.46s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.59534[0m     0.97665    0.60957      0.46834  58.39s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.59060[0m     0.97044    0.60859      0.47117  58.36s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.58810[0m     0.95474    0.61598      0.47553  58.40s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.58399[0m     0.93330    0.62573      0.47681  58.38s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.58099[0m     0.95458    0.60863      0.47759  58.52s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.660555 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.76820748397
Error rate (%):  23.179251603
[[38457  7713]
 [ 4397  1678]]
(52245,)
(52245,)
roc_auc: 0.659501233142
log_loss: 0.593324608257
roc_auc for the hours: 0.631578947368
log_loss for the hours: 0.471255742267
saving predictions to csv file
hourspatient0_5_net11_10-10-02-14-24.csv
Accuracy validation for the hours:  0.790697674419
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [5]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 0.984072192
saving predictions to csv file
patient0_5_net11_10-10-02-16-29.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_6']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_6'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-10 02:16:31.182755
Hostname: kat
gpu3
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net11
evaluation:
    online_training: False
    model: net11

end Configuration
['patient0_6']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [6]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.677019648
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 52.9203617096 28.9710264206
20 204.033294678 198.010336304
30 310.279055786 304.778164673
40 419.120050049 413.251306152
50 547.291717529 541.047363281
60 717.765319824 711.321618652
70 980.086315918 974.004034424
80 1476.19272461 1468.43618164
90 2691.36994629 2660.87460937
100 459356.3125 258723.5625
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net11
Model name for the evaluation phase:  net11
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m1.23606[0m     [32m0.74078[0m    1.66859      0.52557  53.98s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.62855[0m     0.90688    0.69309      0.47965  58.75s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.61467[0m     1.00784    0.60989      0.47615  58.70s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.60335[0m     1.03641    0.58216      0.47191  58.64s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.59624[0m     0.98657    0.60436      0.47464  58.55s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.58896[0m     0.98234    0.59954      0.47320  58.67s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.58748[0m     0.98369    0.59722      0.47040  58.43s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.58257[0m     0.93415    0.62364      0.48657  58.42s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.58048[0m     0.91997    0.63098      0.49050  58.55s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.57462[0m     0.90255    0.63666      0.49058  58.44s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     11     0.57561     0.89583    0.64254      0.49746  58.58s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.740783 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.856828404632
Error rate (%):  14.3171595368
[[44290  1880]
 [ 5600   475]]
(52245,)
(52245,)
roc_auc: 0.631598670506
log_loss: 0.726197883656
roc_auc for the hours: 0.657894736842
log_loss for the hours: 0.465452513208
saving predictions to csv file
hourspatient0_6_net11_10-10-02-30-37.csv
Accuracy validation for the hours:  0.883720930233
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [6]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 0.982945792
saving predictions to csv file
patient0_6_net11_10-10-02-32-42.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_7']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_7'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-10 02:32:44.176487
Hostname: kat
gpu3
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net11
evaluation:
    online_training: False
    model: net11

end Configuration
['patient0_7']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [7]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.677937152
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 42.2832771301 23.406820488
20 162.516268921 157.987145996
30 247.963627625 243.623634338
40 336.95199585 332.831341553
50 445.399627686 441.292938232
60 597.128845215 593.310778809
70 844.070202637 839.791943359
80 1309.5418457 1299.71809082
90 2364.6079834 2327.02700195
100 202022.625 78149.3203125
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net11
Model name for the evaluation phase:  net11
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m1.11182[0m     [32m0.71255[0m    1.56034      0.47722  53.72s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.62735[0m     0.86155    0.72816      0.47388  58.49s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.60586[0m     0.91914    0.65916      0.47769  58.44s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.59657[0m     0.91885    0.64926      0.49370  58.42s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.59136[0m     0.89921    0.65765      0.49752  58.49s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.58763[0m     0.87190    0.67396      0.50041  58.43s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.58594[0m     0.85229    0.68749      0.49892  58.37s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.58398[0m     0.84244    0.69320      0.49700  58.35s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.58126[0m     0.82136    0.70769      0.49308  58.39s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.57963[0m     0.81131    0.71443      0.49234  58.36s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.57731[0m     0.80339    0.71859      0.49705  58.50s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.712546 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.85692410757
Error rate (%):  14.307589243
[[44770  1400]
 [ 6075     0]]
(52245,)
(52245,)
roc_auc: 0.573671828303
log_loss: 0.601007145172
roc_auc for the hours: 0.457894736842
log_loss for the hours: 0.467948408831
saving predictions to csv file
hourspatient0_7_net11_10-10-02-46-47.csv
Accuracy validation for the hours:  0.883720930233
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [7]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 0.983752704
saving predictions to csv file
patient0_7_net11_10-10-02-48-53.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_8']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_8'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-10 02:48:54.651340
Hostname: kat
gpu3
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net11
evaluation:
    online_training: False
    model: net11

end Configuration
['patient0_8']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [8]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.67825664
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 54.1830825806 29.6300670624
20 210.284432983 202.797094727
30 322.79552002 315.015945435
40 440.955853271 432.186102295
50 584.439239502 573.883850098
60 779.399060059 765.642810059
70 1072.5894043 1055.17028809
80 1571.89633789 1552.87558594
90 2680.80834961 2671.50136719
100 68448.984375 353074.21875
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net11
Model name for the evaluation phase:  net11
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m1.23184[0m     [32m0.67707[0m    1.81936      0.63537  53.79s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.61566[0m     0.82441    0.74679      0.59205  58.47s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.59996[0m     0.88613    0.67706      0.51880  58.41s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.59311[0m     0.90513    0.65528      0.51900  58.40s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.58685[0m     0.89742    0.65394      0.52246  58.47s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.58045[0m     0.87533    0.66311      0.55040  58.41s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.57836[0m     0.84018    0.68838      0.58231  58.35s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.57646[0m     0.82948    0.69497      0.59155  58.33s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.57405[0m     0.80815    0.71033      0.60213  58.37s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.57135[0m     0.79028    0.72297      0.60228  58.35s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.57055[0m     0.79262    0.71982      0.59582  58.48s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.677070 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.78177816059
Error rate (%):  21.822183941
[[38167  8003]
 [ 3398  2677]]
(52245,)
(52245,)
roc_auc: 0.699069885759
log_loss: 0.637140703654
roc_auc for the hours: 0.731578947368
log_loss for the hours: 0.432740788651
saving predictions to csv file
hourspatient0_8_net11_10-10-03-02-57.csv
Accuracy validation for the hours:  0.860465116279
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [8]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 0.98512896
saving predictions to csv file
patient0_8_net11_10-10-03-05-02.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_9']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_9'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-10 03:05:04.319615
Hostname: kat
gpu3
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net11
evaluation:
    online_training: False
    model: net11

end Configuration
['patient0_9']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [9]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.677060608
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 66.6869514465 35.6989082336
20 256.319952393 245.103649902
30 392.878082275 380.05057373
40 536.743615723 521.363696289
50 716.260894775 697.441894531
60 975.356860352 953.108215332
70 1387.67550049 1363.3236084
80 2106.65888672 2072.82099609
90 3733.63100586 3669.75898437
100 262006.171875 86094.46875
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net11
Model name for the evaluation phase:  net11
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m1.40963[0m     [32m0.88759[0m    1.58816      0.53786  53.95s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.61653[0m     1.35242    0.45587      0.47574  58.67s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.59527[0m     1.38850    0.42872      0.47512  58.63s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.58884[0m     1.38471    0.42524      0.47171  58.61s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.57856[0m     1.33960    0.43189      0.47039  58.69s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.57305[0m     1.28061    0.44748      0.46691  58.64s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.56854[0m     1.29717    0.43829      0.46669  58.58s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.56415[0m     1.24594    0.45279      0.46797  58.55s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.56242[0m     1.20029    0.46857      0.49122  58.59s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.55806[0m     1.15555    0.48294      0.50476  58.56s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.55606[0m     1.17447    0.47346      0.51030  58.70s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.887588 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.8391042205
Error rate (%):  16.08957795
[[42851  3319]
 [ 5087   988]]
(52245,)
(52245,)
roc_auc: 0.638613709756
log_loss: 1.11276600555
roc_auc for the hours: 0.584210526316
log_loss for the hours: 0.603776330744
saving predictions to csv file
hourspatient0_9_net11_10-10-03-19-09.csv
Accuracy validation for the hours:  0.883720930233
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [9]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 0.983638016
saving predictions to csv file
patient0_9_net11_10-10-03-21-15.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_10']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_10'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-10 03:21:16.735873
Hostname: kat
gpu3
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net11
evaluation:
    online_training: False
    model: net11

end Configuration
['patient0_10']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [10]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.677994496
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 49.5935062408 26.4832733154
20 190.337982178 178.602871704
30 296.224377441 280.857037354
40 415.984814453 394.469250488
50 577.838653564 548.425720215
60 818.775402832 780.941381836
70 1187.2631958 1144.36071777
80 1820.75270996 1769.78515625
90 3363.41669922 3314.3128418
100 50863.234375 51923.34375
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net11
Model name for the evaluation phase:  net11
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m1.37922[0m     [32m0.69230[0m    1.99224      0.53806  53.94s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.63048[0m     0.93563    0.67386      0.49768  58.70s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.60761[0m     1.08503    0.55999      0.47924  58.67s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.59664[0m     1.11811    0.53361      0.47377  58.65s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.58912[0m     1.08436    0.54329      0.47288  58.71s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.58284[0m     1.03382    0.56377      0.48114  58.67s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.57759[0m     1.02523    0.56337      0.47977  58.60s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.57216[0m     0.99280    0.57631      0.49163  58.58s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.56972[0m     0.94160    0.60506      0.51817  58.61s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.56359[0m     0.94033    0.59935      0.52360  58.59s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.56126[0m     0.90767    0.61835      0.53494  58.74s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.692299 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.851660445976
Error rate (%):  14.8339554024
[[43992  2178]
 [ 5572   503]]
(52245,)
(52245,)
roc_auc: 0.64986952317
log_loss: 0.568612785625
roc_auc for the hours: 0.689473684211
log_loss for the hours: 0.37138586733
saving predictions to csv file
hourspatient0_10_net11_10-10-03-35-22.csv
Accuracy validation for the hours:  0.883720930233
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [10]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 0.985378816
saving predictions to csv file
patient0_10_net11_10-10-03-37-28.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_11']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_11'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-10 03:37:29.861237
Hostname: kat
gpu3
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net11
evaluation:
    online_training: False
    model: net11

end Configuration
['patient0_11']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [11]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.677031936
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 37.4027713776 20.3596906662
20 138.625271606 132.382019043
30 211.681109619 204.980381775
40 289.691271973 281.780712891
50 389.566116333 380.066696167
60 543.70489502 531.805041504
70 834.583398437 818.790313721
80 1463.92446289 1432.4847168
90 3328.68920898 3260.95727539
100 410646.09375 69810.453125
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net11
Model name for the evaluation phase:  net11
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m1.36986[0m     [32m0.69723[0m    1.96473      0.57752  54.09s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.62664[0m     [32m0.68822[0m    0.91052      0.58762  58.72s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.61172[0m     0.69090    0.88539      0.58444  58.68s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.60256[0m     0.71826    0.83892      0.57858  58.65s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.59531[0m     0.70493    0.84450      0.58126  58.73s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.58809[0m     0.71589    0.82149      0.57885  58.67s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.58548[0m     0.74367    0.78729      0.58149  58.61s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.58103[0m     0.74050    0.78464      0.58225  58.59s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.57947[0m     0.74829    0.77439      0.58178  58.64s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.57450[0m     0.75700    0.75893      0.57950  58.61s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.57244[0m     0.76977    0.74366      0.58153  58.73s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     12     [36m0.56751[0m     0.72970    0.77773      0.58685  58.69s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.688222 at epoch 2.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.597722270074
Error rate (%):  40.2277729926
[[27728 18442]
 [ 2575  3500]]
(52245,)
(52245,)
roc_auc: 0.630917042135
log_loss: 1.00937172471
roc_auc for the hours: 0.642105263158
log_loss for the hours: 0.709271577066
saving predictions to csv file
hourspatient0_11_net11_10-10-03-52-35.csv
Accuracy validation for the hours:  0.627906976744
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [11]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 0.983166976
saving predictions to csv file
patient0_11_net11_10-10-03-54-40.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_12']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_12'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-10 03:54:41.943760
Hostname: kat
gpu3
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net11
evaluation:
    online_training: False
    model: net11

end Configuration
['patient0_12']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [12]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.677650432
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 65.1829460144 35.0811794281
20 246.685302734 233.028952026
30 381.222595215 364.982098389
40 530.423962402 509.868566895
50 730.584533691 703.699279785
60 1040.28303223 1008.42225342
70 1558.99154053 1521.31486816
80 2527.43164063 2455.40673828
90 5046.20957031 4843.92373047
100 126710.1875 64910.4453125
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net11
Model name for the evaluation phase:  net11
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m1.79014[0m     [32m0.91013[0m    1.96689      0.47857  53.97s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.61484[0m     0.98607    0.62353      0.47471  58.67s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.59752[0m     1.00655    0.59363      0.47481  58.63s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.58786[0m     1.01014    0.58195      0.47119  58.62s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.58215[0m     1.02214    0.56954      0.47029  58.69s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.57100[0m     1.02027    0.55966      0.46619  58.64s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.56662[0m     0.99751    0.56804      0.46474  58.57s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.56214[0m     0.96974    0.57968      0.46735  58.54s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.55908[0m     0.93388    0.59867      0.46850  58.59s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.55646[0m     [32m0.89066[0m    0.62477      0.45921  58.57s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.55309[0m     [32m0.88808[0m    0.62280      0.45895  58.70s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     12     [36m0.54971[0m     [32m0.85020[0m    0.64657      0.46250  58.65s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     13     [36m0.54586[0m     [32m0.83362[0m    0.65481      0.47321  58.68s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     14     [36m0.54404[0m     [32m0.83158[0m    0.65422      0.47571  58.75s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     15     [36m0.54137[0m     [32m0.81115[0m    0.66741      0.50036  58.54s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     16     [36m0.54034[0m     [32m0.78504[0m    0.68829      0.51594  58.66s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     17     [36m0.53425[0m     [32m0.77789[0m    0.68680      0.50872  58.55s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     18     [36m0.53336[0m     [32m0.73586[0m    0.72481      0.52737  58.58s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     19     [36m0.52972[0m     0.73895    0.71686      0.51818  58.69s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     20     [36m0.52653[0m     [32m0.72157[0m    0.72970      0.54362  58.68s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     21     [36m0.52328[0m     [32m0.71832[0m    0.72848      0.57116  58.67s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     22     [36m0.52164[0m     0.73486    0.70984      0.54064  58.68s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     23     [36m0.51565[0m     0.71953    0.71664      0.57537  58.53s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     24     [36m0.51267[0m     [32m0.69729[0m    0.73523      0.61064  58.74s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     25     [36m0.50715[0m     0.74167    0.68380      0.55847  58.55s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     26     [36m0.50347[0m     0.70700    0.71212      0.59829  58.70s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     27     [36m0.49678[0m     0.76171    0.65219      0.54631  58.60s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     28     [36m0.49230[0m     0.73108    0.67338      0.57042  58.70s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     29     [36m0.49223[0m     0.76120    0.64665      0.56309  58.66s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     30     [36m0.47538[0m     0.73639    0.64556      0.58445  58.75s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     31     [36m0.47525[0m     0.72496    0.65556      0.60458  58.48s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     32     [36m0.46549[0m     0.79345    0.58667      0.54699  58.65s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     33     0.46551     0.72809    0.63936      0.59825  58.62s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     34     [36m0.46070[0m     0.72648    0.63415      0.59766  58.62s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.697293 at epoch 24.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.737429419083
Error rate (%):  26.2570580917
[[37990  8180]
 [ 5538   537]]
(52245,)
(52245,)
roc_auc: 0.560912207613
log_loss: 1.04385646511
roc_auc for the hours: 0.484210526316
log_loss for the hours: 0.495899106471
saving predictions to csv file
hourspatient0_12_net11_10-10-04-31-16.csv
Accuracy validation for the hours:  0.813953488372
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [12]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 0.983281664
saving predictions to csv file
patient0_12_net11_10-10-04-33-23.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_13']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_13'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-10 04:33:25.082967
Hostname: kat
gpu3
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net11
evaluation:
    online_training: False
    model: net11

end Configuration
['patient0_13']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [13]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.67708928
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 69.0897041321 37.7125782013
20 266.439715576 253.817520142
30 414.331445313 399.039959717
40 579.853991699 560.493823242
50 802.805938721 779.214904785
60 1136.38771973 1110.1892334
70 1641.78244629 1620.17226562
80 2489.06611328 2463.09140625
90 4471.61362305 4441.97880859
100 100082.695312 85056.0390625
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net11
Model name for the evaluation phase:  net11
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m1.48849[0m     [32m1.16345[0m    1.27938      0.47795  53.82s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.62350[0m     1.29582    0.48116      0.47492  58.48s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.61265[0m     [32m1.13901[0m    0.53788      0.47398  58.42s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.59927[0m     1.19406    0.50187      0.47109  58.40s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.58818[0m     [32m1.13848[0m    0.51664      0.46925  58.47s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.57929[0m     [32m1.09214[0m    0.53042      0.46825  58.41s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.57718[0m     1.09225    0.52843      0.46566  58.35s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.57000[0m     [32m1.03553[0m    0.55044      0.48998  58.33s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.56797[0m     [32m0.96004[0m    0.59161      0.50816  58.38s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.56111[0m     [32m0.95612[0m    0.58686      0.50124  58.34s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.55841[0m     [32m0.92236[0m    0.60541      0.52169  58.48s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     12     [36m0.55283[0m     [32m0.88961[0m    0.62143      0.52720  58.45s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     13     [36m0.55164[0m     [32m0.79697[0m    0.69217      0.56414  58.47s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     14     [36m0.54490[0m     0.79838    0.68250      0.54982  58.53s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     15     [36m0.53844[0m     [32m0.79371[0m    0.67838      0.55398  58.32s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     16     [36m0.53351[0m     [32m0.73037[0m    0.73046      0.55392  58.43s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     17     [36m0.52782[0m     [32m0.70650[0m    0.74709      0.55509  58.33s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     18     [36m0.52385[0m     [32m0.68170[0m    0.76844      0.56928  58.37s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     19     [36m0.51922[0m     [32m0.66797[0m    0.77731      0.63088  58.47s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     20     [36m0.51533[0m     0.68322    0.75426      0.61714  58.46s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     21     [36m0.50635[0m     0.75362    0.67189      0.54576  58.45s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     22     0.50950     0.71710    0.71049      0.59245  58.46s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     23     [36m0.50300[0m     [32m0.66189[0m    0.75994      0.61930  58.31s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     24     [36m0.49892[0m     0.74969    0.66550      0.55651  58.51s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     25     [36m0.48742[0m     0.74190    0.65700      0.57696  58.33s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     26     [36m0.47909[0m     0.75712    0.63278      0.58281  58.48s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     27     0.47933     0.83251    0.57576      0.52578  58.38s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     28     [36m0.47387[0m     0.78777    0.60154      0.52799  58.47s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     29     0.48076     0.82492    0.58280      0.51665  58.45s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     30     [36m0.46057[0m     0.85052    0.54151      0.51908  58.52s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     31     [36m0.45634[0m     0.86958    0.52479      0.53258  58.26s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     32     0.46473     0.87951    0.52840      0.50861  58.44s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     33     [36m0.44228[0m     0.88162    0.50166      0.53821  58.41s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.661891 at epoch 23.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.809665996746
Error rate (%):  19.0334003254
[[41477  4693]
 [ 5251   824]]
(52245,)
(52245,)
roc_auc: 0.625252321221
log_loss: nan
roc_auc for the hours: 0.552631578947
log_loss for the hours: 0.458605550303
saving predictions to csv file
hourspatient0_13_net11_10-10-05-08-53.csv
Accuracy validation for the hours:  0.860465116279
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [13]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 0.98304
saving predictions to csv file
patient0_13_net11_10-10-05-10-59.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_14']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_14'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-10 05:11:00.846265
Hostname: kat
gpu3
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net11
evaluation:
    online_training: False
    model: net11

end Configuration
['patient0_14']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [14]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.67690496
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 51.4431194305 28.1161405563
20 195.642379761 187.486203003
30 299.57428894 291.18163147
40 410.908746338 402.061425781
50 555.348205566 546.590423584
60 781.114685059 775.59395752
70 1179.35510254 1183.46280518
80 1939.34797363 1949.83596191
90 3877.67912598 3944.7189209
100 65181.1953125 57682.203125
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net11
Model name for the evaluation phase:  net11
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m1.51009[0m     [32m0.71716[0m    2.10565      0.49478  53.99s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.63982[0m     0.82725    0.77343      0.49469  58.68s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.62114[0m     0.85504    0.72645      0.47913  58.63s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.61225[0m     0.88539    0.69150      0.47429  58.61s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.60502[0m     0.92361    0.65506      0.47930  58.69s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.59128[0m     0.95199    0.62109      0.47908  58.63s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.58546[0m     0.91700    0.63845      0.50180  58.56s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.58076[0m     0.88481    0.65637      0.52315  58.54s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.57857[0m     0.82106    0.70466      0.55721  58.59s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.57013[0m     0.79354    0.71846      0.57246  58.55s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     11     [36m0.56701[0m     0.75624    0.74978      0.59012  58.69s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     12     [36m0.56314[0m     [32m0.70967[0m    0.79353      0.59170  58.61s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     13     [36m0.56009[0m     [32m0.67226[0m    0.83315      0.58545  58.47s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     14     [36m0.55593[0m     [32m0.65736[0m    0.84570      0.59203  58.64s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     15     [36m0.55100[0m     [32m0.64351[0m    0.85624      0.59331  58.53s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     16     [36m0.54486[0m     [32m0.63778[0m    0.85430      0.60609  58.64s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     17     [36m0.54078[0m     0.65382    0.82711      0.60355  58.53s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     18     [36m0.53418[0m     0.64659    0.82616      0.60799  58.58s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     19     [36m0.52993[0m     0.66057    0.80223      0.60359  58.69s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     20     [36m0.52178[0m     0.68763    0.75881      0.59793  58.67s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     21     [36m0.51567[0m     0.73552    0.70110      0.57395  58.66s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     22     0.51829     0.68985    0.75131      0.60186  58.67s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     23     [36m0.50621[0m     0.72076    0.70233      0.58638  58.52s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     24     [36m0.49651[0m     0.72985    0.68030      0.58471  58.73s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     25     [36m0.49558[0m     0.69894    0.70905      0.60310  58.55s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     26     [36m0.49196[0m     0.70436    0.69846      0.59478  58.70s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.637779 at epoch 16.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.603062494019
Error rate (%):  39.6937505981
[[28119 18051]
 [ 2687  3388]]
(52245,)
(52245,)
roc_auc: 0.672623803068
log_loss: inf
roc_auc for the hours: 0.647368421053
log_loss for the hours: 0.808084058404
saving predictions to csv file
hourspatient0_14_net11_10-10-05-39-45.csv
Accuracy validation for the hours:  0.674418604651
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [14]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 0.982929408
saving predictions to csv file
patient0_14_net11_10-10-05-41-51.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config3.yml', '--no-channels=1', '--target-gpu=gpu3', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient0_15']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config3.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient0_15'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu3')
Git reference:  Timestamp: 2016-10-10 05:41:52.988263
Hostname: kat
gpu3
Configuration 'config3.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net11
evaluation:
    online_training: False
    model: net11

end Configuration
['patient0_15']
<type 'list'>
Loading and preprocessing data...
total
191
25
train
153
20
validation
38
5
test_magnitude.shape (1406, 64)
20
5
153
38
Read in dataset from train_1 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [15]
/home/eavsteen/seizure_detection/data/train_1/1_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 191 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
Memory usage (GB): 0.677117952
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 153 val_counter_normal 38
percentiles:
0 0.0 0.0
10 34.6773342133 19.007179451
20 129.966018677 125.497892761
30 197.840336609 193.760687256
40 269.3421875 264.920050049
50 359.024520874 354.514923096
60 493.65269165 489.852355957
70 739.064575195 735.682330322
80 1252.53088379 1250.05979004
90 2505.61677246 2502.26618652
100 37134.734375 63323.234375
Histogram:
[3822 3822]
yTrain.shape (7644,)
xTrain.shape (7644,)
Histogram:
[570 570]
yTrain.shape (7644,)
xTrain.shape (1140,)
xVal.shape (1140,)
yVal.shape (1140,)
Ratio validation: 0.2
xTrain.shape (7644,)
yTrain.shape (7644,)
xVal.shape (1140, 2)
yVal.shape (1140,)
Building models ...
Model name for the training phase:  net11
Model name for the evaluation phase:  net11
Training model...
# Neural Network with 37890 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x192x64
  4          32x96x32
  5          32x96x32
  6          32x96x32
  7          32x48x16
  8          2x48x16
  9          2
 10          2

BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  ------
      1     [36m1.19098[0m     [32m0.68298[0m    1.74381      0.47753  54.02s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      2     [36m0.63897[0m     0.74713    0.85523      0.47131  58.65s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      3     [36m0.62179[0m     0.76997    0.80755      0.46832  58.60s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      4     [36m0.61241[0m     0.78319    0.78194      0.46551  58.58s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      5     [36m0.60594[0m     0.83991    0.72143      0.46418  58.66s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      6     [36m0.59982[0m     0.83359    0.71957      0.45918  58.57s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      7     [36m0.59424[0m     0.85097    0.69831      0.46124  58.32s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      8     [36m0.58911[0m     0.85270    0.69087      0.46497  58.34s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
      9     [36m0.58743[0m     0.80867    0.72642      0.47243  58.56s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     10     [36m0.58210[0m     0.77414    0.75193      0.48499  58.53s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
     11     0.58263     0.79303    0.73469      0.48038  58.66s
BI_train_bal_complete called with len(X) = 6114
BI_test_bal_complete called with len(X) = 1530
Early stopping.
Best valid loss was 0.682976 at epoch 1.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d2' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d2' (shape 32).
Loaded parameters to layer 'conv2d4' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d4' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d8' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d8' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (38, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (46170, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.841094841612
Error rate (%):  15.8905158388
[[43848  2322]
 [ 5980    95]]
(52245,)
(52245,)
roc_auc: 0.640198604014
log_loss: 0.513780971176
roc_auc for the hours: 0.636842105263
log_loss for the hours: 0.39333298983
saving predictions to csv file
hourspatient0_15_net11_10-10-05-55-58.csv
Accuracy validation for the hours:  0.883720930233
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 1584
test_magnitude.shape (234, 64)
(1584, 1, 234, 64)
Read in dataset from test_1 ...
read data and preprocess (fft and slicing)
read in channels [15]
/home/eavsteen/seizure_detection/data/test_1/1_
Done reading in 1584 test snippets of 10min.
Memory usage (GB): 0.984670208
saving predictions to csv file
patient0_15_net11_10-10-05-58-04.csv
