['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config4.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_0']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config4.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_0'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-22 12:27:37.321428
Hostname: kat
gpu0
Configuration 'config4.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net33
evaluation:
    online_training: False
    model: net33

end Configuration
['patient1_0']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [0]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.848515072
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 199.036781311 184.038919067
20 483.221002197 465.519171143
30 718.880554199 694.377087402
40 969.482617188 933.868884277
50 1265.8637085 1213.74743652
60 1644.84228516 1568.92561035
70 2171.59033203 2061.92285156
80 2997.35341797 2842.94628906
90 4640.41015625 4440.24106445
100 101397.328125 96893.890625
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net33
Model name for the evaluation phase:  net33
Training model...
# Neural Network with 47138 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x96x32
  4          32x96x32
  5          32x48x16
  6          32x48x16
  7          32x24x8
  8          32x24x8
  9          32x12x4
 10          32x12x4
 11          32x6x4
 12          2x6x4
 13          2
 14          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -----
      1    [36m48.72533[0m     [32m2.28984[0m   21.27896      0.52261  7.89s
      2    [36m10.03315[0m     [32m1.15838[0m    8.66140      0.49635  7.83s
      3     [36m5.89861[0m     [32m0.97841[0m    6.02877      0.50997  7.72s
      4     [36m4.14338[0m     1.04451    3.96683      0.51724  7.66s
      5     [36m3.12294[0m     1.00389    3.11084      0.53581  7.61s
      6     [36m2.45227[0m     [32m0.85469[0m    2.86920      0.39395  7.71s
      7     [36m2.03979[0m     [32m0.77086[0m    2.64612      0.51129  7.77s
      8     [36m1.76049[0m     [32m0.75653[0m    2.32706      0.47488  7.87s
      9     [36m1.52699[0m     0.82155    1.85867      0.41565  7.80s
     10     [36m1.34817[0m     [32m0.75094[0m    1.79530      0.46435  7.83s
     11     [36m1.25488[0m     0.79017    1.58811      0.41331  7.65s
     12     [36m1.16905[0m     [32m0.72159[0m    1.62011      0.50958  7.54s
     13     [36m1.10363[0m     0.77994    1.41501      0.41153  7.74s
     14     [36m1.01996[0m     [32m0.70905[0m    1.43849      0.56480  7.64s
     15     [36m1.00016[0m     0.71230    1.40412      0.56039  7.54s
     16     [36m0.94865[0m     0.80817    1.17383      0.42030  7.80s
     17     [36m0.91303[0m     0.71595    1.27526      0.55899  7.97s
     18     [36m0.88439[0m     0.75503    1.17133      0.41669  7.73s
     19     [36m0.85539[0m     0.72762    1.17560      0.42286  7.80s
     20     [36m0.81690[0m     0.71275    1.14612      0.47522  7.61s
     21     [36m0.80298[0m     [32m0.70858[0m    1.13322      0.52547  7.74s
     22     [36m0.78092[0m     0.70989    1.10006      0.45291  7.69s
     23     [36m0.77941[0m     0.71196    1.09474      0.55586  7.51s
     24     [36m0.77228[0m     0.74305    1.03933      0.42179  7.66s
     25     [36m0.75774[0m     0.71018    1.06696      0.49501  7.55s
     26     [36m0.75728[0m     0.72123    1.04999      0.43895  7.57s
     27     [36m0.72541[0m     0.71541    1.01398      0.56144  7.64s
     28     [36m0.70915[0m     0.77654    0.91322      0.39566  7.58s
     29     [36m0.69595[0m     0.72108    0.96515      0.53438  7.77s
     30     [36m0.69552[0m     0.78178    0.88966      0.37765  7.70s
     31     [36m0.68425[0m     0.75226    0.90959      0.38233  7.76s
Early stopping.
Best valid loss was 0.708580 at epoch 21.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d3' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d3' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d9' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d9' (shape 32).
Loaded parameters to layer 'conv2d11' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d11' (shape 32).
Loaded parameters to layer 'conv2d12' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d12' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[ 0.75030595  0.64103538  0.63775903  0.5488171   0.65394878  0.80955523
  0.8556205   0.75972569  0.68508309  0.74054104  0.68475831  0.68805432
  0.78357053  0.77403677  0.67565304  0.85504615  0.7279588   0.58507246
  0.52987546  0.64758235  0.65711993  0.60680884  0.7409597   0.49980164
  0.79643261  0.80445004  0.73872393  0.69014972  0.78687179  0.68181282]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.414857022264
Error rate (%):  58.5142977736
[[36235 52460]
 [ 2994  3081]]
(94770,)
(94770,)
roc_auc: 0.432230913866
log_loss: 1.57390282001
roc_auc for the hours: 0.427397260274
log_loss for the hours: 1.2642895103
saving predictions to csv file
hourspatient1_0_net33_10-22-12-43-34.csv
Accuracy validation for the hours:  0.461538461538
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [0]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.10032896
saving predictions to csv file
patient1_0_net33_10-22-12-46-38.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config4.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_1']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config4.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_1'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-22 12:46:39.283217
Hostname: kat
gpu0
Configuration 'config4.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net33
evaluation:
    online_training: False
    model: net33

end Configuration
['patient1_1']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [1]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.848871424
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 203.761627197 188.411010742
20 496.77197876 482.61751709
30 732.597296143 714.697686768
40 973.972167969 949.532727051
50 1245.81005859 1212.85552979
60 1576.76357422 1532.16108398
70 2013.54516602 1951.80438232
80 2668.75805664 2577.9690918
90 3942.10078125 3797.89812012
100 71591.0625 60304.03125
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net33
Model name for the evaluation phase:  net33
Training model...
# Neural Network with 47138 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x96x32
  4          32x96x32
  5          32x48x16
  6          32x48x16
  7          32x24x8
  8          32x24x8
  9          32x12x4
 10          32x12x4
 11          32x6x4
 12          2x6x4
 13          2
 14          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -----
      1    [36m43.33869[0m     [32m2.26070[0m   19.17048      0.52640  7.57s
      2     [36m8.32910[0m     [32m1.65405[0m    5.03559      0.52093  7.77s
      3     [36m5.02811[0m     [32m1.63692[0m    3.07169      0.50889  7.40s
      4     [36m3.53443[0m     [32m1.42147[0m    2.48646      0.50095  7.46s
      5     [36m2.72125[0m     [32m1.29198[0m    2.10627      0.50461  7.58s
      6     [36m2.17506[0m     [32m0.97563[0m    2.22938      0.50824  7.52s
      7     [36m1.79170[0m     [32m0.96924[0m    1.84857      0.51210  7.35s
      8     [36m1.57500[0m     [32m0.90363[0m    1.74298      0.50231  7.36s
      9     [36m1.39913[0m     [32m0.69405[0m    2.01588      0.56296  7.39s
     10     [36m1.27232[0m     0.71639    1.77601      0.54676  7.36s
     11     [36m1.16010[0m     [32m0.68389[0m    1.69633      0.56397  7.37s
     12     [36m1.07868[0m     0.76150    1.41652      0.52443  7.36s
     13     [36m1.04093[0m     0.70282    1.48108      0.53761  7.38s
     14     [36m0.99384[0m     0.76287    1.30277      0.53308  7.37s
     15     [36m0.95946[0m     0.73400    1.30717      0.53634  7.36s
     16     [36m0.92884[0m     0.69932    1.32819      0.54452  7.36s
     17     [36m0.88466[0m     [32m0.66403[0m    1.33225      0.58530  7.39s
     18     [36m0.86937[0m     0.66944    1.29867      0.53970  7.40s
     19     [36m0.83395[0m     0.67263    1.23985      0.57687  7.40s
     20     [36m0.81996[0m     0.72988    1.12342      0.53595  7.40s
     21     [36m0.80821[0m     0.73458    1.10024      0.53225  7.44s
     22     [36m0.78268[0m     0.66499    1.17698      0.59473  7.41s
     23     0.78597     0.66703    1.17832      0.58114  7.40s
     24     [36m0.76454[0m     0.66824    1.14411      0.59088  7.40s
     25     [36m0.75996[0m     [32m0.66315[0m    1.14599      0.57382  7.40s
     26     [36m0.74773[0m     0.67255    1.11179      0.49163  7.40s
     27     [36m0.74112[0m     0.70280    1.05452      0.54611  7.41s
     28     [36m0.72705[0m     0.69395    1.04770      0.55550  7.39s
     29     0.73311     0.66316    1.10548      0.56714  7.39s
     30     [36m0.71485[0m     0.71772    0.99600      0.53934  7.39s
     31     [36m0.70943[0m     0.70810    1.00188      0.54715  7.42s
     32     [36m0.70195[0m     0.68687    1.02196      0.55985  7.39s
     33     [36m0.69947[0m     0.66578    1.05061      0.57825  7.38s
     34     0.70657     0.66751    1.05852      0.58291  7.37s
     35     [36m0.68661[0m     [32m0.66058[0m    1.03940      0.60483  7.37s
     36     [36m0.67892[0m     0.69046    0.98328      0.56073  7.39s
     37     [36m0.67471[0m     [32m0.65805[0m    1.02532      0.61616  7.40s
     38     [36m0.66530[0m     0.66718    0.99718      0.49865  7.40s
     39     [36m0.65272[0m     0.66826    0.97674      0.59142  7.40s
     40     [36m0.64882[0m     0.66481    0.97594      0.48552  7.40s
     41     [36m0.64406[0m     [32m0.65650[0m    0.98105      0.59420  7.41s
     42     [36m0.64259[0m     0.65974    0.97401      0.60323  7.39s
     43     [36m0.63629[0m     0.67421    0.94376      0.58444  7.41s
     44     [36m0.63526[0m     0.67143    0.94612      0.60297  7.40s
     45     [36m0.63486[0m     [32m0.64157[0m    0.98954      0.62006  7.41s
     46     [36m0.62994[0m     0.65891    0.95603      0.60501  7.39s
     47     [36m0.62486[0m     0.64932    0.96232      0.61974  7.40s
     48     0.62803     [32m0.64074[0m    0.98016      0.61635  7.41s
     49     0.62645     0.65812    0.95187      0.60396  7.41s
     50     [36m0.61637[0m     0.72209    0.85359      0.56744  7.41s
     51     [36m0.61086[0m     [32m0.63803[0m    0.95742      0.62780  7.42s
     52     0.61598     0.65093    0.94630      0.61727  7.39s
     53     [36m0.60895[0m     0.68713    0.88623      0.59402  7.42s
     54     [36m0.60431[0m     0.64144    0.94212      0.61915  7.38s
     55     [36m0.59953[0m     0.63866    0.93873      0.61559  7.39s
     56     [36m0.59593[0m     [32m0.63159[0m    0.94354      0.62944  7.40s
     57     0.59841     0.64360    0.92978      0.61746  7.41s
     58     0.59727     0.64671    0.92354      0.61326  7.40s
     59     [36m0.59157[0m     0.64666    0.91481      0.59319  7.39s
     60     [36m0.58400[0m     0.65214    0.89551      0.62090  7.41s
     61     0.59423     0.63335    0.93823      0.62118  7.39s
     62     [36m0.57319[0m     0.64522    0.88836      0.62122  7.41s
     63     0.57928     0.63173    0.91697      0.62806  7.42s
     64     [36m0.57046[0m     0.65680    0.86854      0.62710  7.38s
     65     0.57544     0.64549    0.89147      0.62093  7.39s
     66     [36m0.55415[0m     0.64262    0.86233      0.61947  7.40s
Early stopping.
Best valid loss was 0.631586 at epoch 56.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d3' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d3' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d9' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d9' (shape 32).
Loaded parameters to layer 'conv2d11' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d11' (shape 32).
Loaded parameters to layer 'conv2d12' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d12' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[ 0.63394964  0.60576218  0.62493575  0.70621216  0.69597721  0.59379166
  0.55228609  0.70270228  0.7125982   0.5773319   0.60184932  0.64057434
  0.44984126  0.3637237   0.38976723  0.56699067  0.52247876  0.62795413
  0.52943152  0.64162886  0.46500543  0.60108924  0.54004467  0.70196134
  0.62140924  0.72085267  0.74693447  0.75299299  0.76077378  0.70764267]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.451081565896
Error rate (%):  54.8918434104
[[38040 50655]
 [ 1366  4709]]
(94770,)
(94770,)
roc_auc: 0.607560751148
log_loss: 1.69982676476
roc_auc for the hours: 0.602739726027
log_loss for the hours: 1.24719101674
saving predictions to csv file
hourspatient1_1_net33_10-22-13-00-38.csv
Accuracy validation for the hours:  0.448717948718
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [1]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.100378112
saving predictions to csv file
patient1_1_net33_10-22-13-03-30.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config4.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_2']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config4.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_2'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-22 13:03:31.634248
Hostname: kat
gpu0
Configuration 'config4.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net33
evaluation:
    online_training: False
    model: net33

end Configuration
['patient1_2']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [2]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.848351232
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 210.389639282 196.646928406
20 506.963934326 496.903918457
30 739.698999023 728.238903809
40 971.565100098 956.919091797
50 1226.64501953 1206.60388184
60 1529.57705078 1501.93178711
70 1919.78259277 1881.66341553
80 2487.38320313 2434.10976563
90 3554.0130127 3481.28129883
100 119907.929688 146484.890625
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net33
Model name for the evaluation phase:  net33
Training model...
# Neural Network with 47138 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x96x32
  4          32x96x32
  5          32x48x16
  6          32x48x16
  7          32x24x8
  8          32x24x8
  9          32x12x4
 10          32x12x4
 11          32x6x4
 12          2x6x4
 13          2
 14          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -----
      1    [36m39.97212[0m     [32m2.38276[0m   16.77558      0.53777  7.33s
      2     [36m8.17798[0m     [32m1.27213[0m    6.42858      0.53659  7.32s
      3     [36m4.69592[0m     [32m1.22297[0m    3.83977      0.52507  7.34s
      4     [36m3.30946[0m     [32m1.18746[0m    2.78700      0.51969  7.32s
      5     [36m2.53584[0m     [32m0.75450[0m    3.36094      0.56050  7.34s
      6     [36m2.03107[0m     0.81833    2.48197      0.54310  7.35s
      7     [36m1.70484[0m     [32m0.72138[0m    2.36331      0.56242  7.34s
      8     [36m1.49747[0m     0.75266    1.98956      0.54982  7.36s
      9     [36m1.32333[0m     [32m0.69324[0m    1.90892      0.45979  7.36s
     10     [36m1.19093[0m     [32m0.69302[0m    1.71846      0.54757  7.34s
     11     [36m1.13343[0m     [32m0.69177[0m    1.63844      0.45794  7.36s
     12     [36m1.03530[0m     0.71609    1.44576      0.56815  7.38s
     13     [36m1.01321[0m     0.69487    1.45814      0.56926  7.37s
     14     [36m0.96824[0m     0.71114    1.36153      0.55613  7.36s
     15     [36m0.91801[0m     0.71287    1.28776      0.56309  7.36s
     16     [36m0.88614[0m     0.70826    1.25115      0.56157  7.39s
     17     [36m0.86710[0m     0.69786    1.24252      0.56225  7.38s
     18     [36m0.83101[0m     0.69829    1.19006      0.56097  7.37s
     19     [36m0.80962[0m     0.70445    1.14931      0.56039  7.39s
     20     [36m0.80426[0m     0.69883    1.15086      0.56481  7.38s
     21     [36m0.78455[0m     [32m0.68018[0m    1.15344      0.58537  7.40s
     22     [36m0.76961[0m     0.71761    1.07247      0.55840  7.41s
     23     [36m0.76642[0m     [32m0.66924[0m    1.14521      0.60288  7.38s
     24     [36m0.75159[0m     0.73514    1.02237      0.55744  7.39s
     25     [36m0.74629[0m     0.71390    1.04537      0.55628  7.39s
     26     [36m0.72991[0m     [32m0.66603[0m    1.09590      0.59238  7.38s
     27     [36m0.70994[0m     0.67136    1.05748      0.59183  7.40s
     28     [36m0.70092[0m     0.68153    1.02845      0.58507  7.37s
     29     [36m0.69310[0m     0.76562    0.90528      0.56714  7.37s
     30     0.69642     0.69680    0.99947      0.58844  7.39s
     31     [36m0.68133[0m     [32m0.66354[0m    1.02682      0.61011  7.39s
     32     [36m0.66767[0m     [32m0.65632[0m    1.01729      0.62145  7.38s
     33     [36m0.66726[0m     0.66494    1.00349      0.48759  7.37s
     34     0.67188     0.76500    0.87827      0.57239  7.36s
     35     [36m0.65232[0m     [32m0.64910[0m    1.00496      0.55194  7.36s
     36     [36m0.64356[0m     [32m0.64821[0m    0.99283      0.56396  7.37s
     37     0.64929     0.69447    0.93495      0.60477  7.37s
     38     [36m0.63429[0m     0.64854    0.97802      0.62966  7.38s
     39     [36m0.63353[0m     0.67006    0.94549      0.61839  7.38s
     40     0.63584     [32m0.63805[0m    0.99654      0.62436  7.39s
     41     [36m0.62497[0m     0.64286    0.97217      0.58634  7.39s
     42     0.62971     0.69061    0.91181      0.47968  7.37s
     43     0.62984     0.65614    0.95991      0.61073  7.38s
     44     0.62659     0.64462    0.97203      0.54027  7.38s
     45     [36m0.61117[0m     0.64210    0.95182      0.65279  7.39s
     46     [36m0.60901[0m     0.67039    0.90844      0.46805  7.37s
     47     0.63071     0.64861    0.97241      0.62190  7.38s
     48     [36m0.60820[0m     0.64304    0.94582      0.63888  7.38s
     49     [36m0.60252[0m     0.63914    0.94270      0.57248  7.37s
     50     0.60509     0.64325    0.94068      0.65373  7.37s
Early stopping.
Best valid loss was 0.638054 at epoch 40.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d3' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d3' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d9' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d9' (shape 32).
Loaded parameters to layer 'conv2d11' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d11' (shape 32).
Loaded parameters to layer 'conv2d12' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d12' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[ 0.26429215  0.24890849  0.2946524   0.28702563  0.23706336  0.24422443
  0.27937824  0.19272585  0.20048197  0.1394023   0.17691775  0.24324952
  0.1987868   0.24613419  0.30939648  0.24833956  0.26415089  0.2051402
  0.19285519  0.20242226  0.13631725  0.159455    0.13633628  0.12925003
  0.11756065  0.13681047  0.13907759  0.19159178  0.14464229  0.17858627]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.418318033133
Error rate (%):  58.1681966867
[[34550 54145]
 [  981  5094]]
(94770,)
(94770,)
roc_auc: 0.607854841707
log_loss: 1.86047797289
roc_auc for the hours: 0.635616438356
log_loss for the hours: 1.3020403517
saving predictions to csv file
hourspatient1_2_net33_10-22-13-19-24.csv
Accuracy validation for the hours:  0.397435897436
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [2]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.100070912
saving predictions to csv file
patient1_2_net33_10-22-13-22-16.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config4.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_3']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config4.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_3'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-22 13:22:17.469428
Hostname: kat
gpu0
Configuration 'config4.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net33
evaluation:
    online_training: False
    model: net33

end Configuration
['patient1_3']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [3]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.848809984
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 19.1249866486 16.0321680069
20 110.960594177 117.977423096
30 462.367929077 465.247445679
40 726.516931152 722.714147949
50 983.638244629 972.796356201
60 1269.06445312 1248.00100098
70 1619.77319336 1586.1126709
80 2106.37036133 2054.18427734
90 2963.09577637 2880.79763184
100 141686.875 89649.6484375
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net33
Model name for the evaluation phase:  net33
Training model...
# Neural Network with 47138 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x96x32
  4          32x96x32
  5          32x48x16
  6          32x48x16
  7          32x24x8
  8          32x24x8
  9          32x12x4
 10          32x12x4
 11          32x6x4
 12          2x6x4
 13          2
 14          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -----
      1    [36m29.55038[0m     [32m2.28493[0m   12.93275      0.46439  7.41s
      2     [36m6.18900[0m     [32m0.92528[0m    6.68883      0.49014  7.35s
      3     [36m3.77127[0m     [32m0.73255[0m    5.14811      0.53127  7.34s
      4     [36m2.68008[0m     0.87582    3.06007      0.44176  7.34s
      5     [36m2.06943[0m     0.84607    2.44593      0.45903  7.34s
      6     [36m1.65883[0m     0.87975    1.88557      0.42502  7.39s
      7     [36m1.40393[0m     [32m0.72468[0m    1.93732      0.48871  7.35s
      8     [36m1.28501[0m     0.77728    1.65321      0.42031  7.38s
      9     [36m1.12985[0m     0.74698    1.51256      0.41267  7.37s
     10     [36m1.05032[0m     [32m0.71719[0m    1.46449      0.47899  7.35s
     11     [36m0.97192[0m     0.74040    1.31271      0.42359  7.37s
     12     [36m0.91757[0m     [32m0.68337[0m    1.34271      0.51093  7.36s
     13     [36m0.88385[0m     0.68738    1.28581      0.50568  7.38s
     14     [36m0.84263[0m     0.71720    1.17490      0.54257  7.37s
     15     [36m0.82835[0m     0.70227    1.17954      0.53850  7.37s
     16     [36m0.80769[0m     0.69410    1.16364      0.55291  7.37s
     17     [36m0.79283[0m     0.68370    1.15961      0.51044  7.37s
     18     [36m0.74711[0m     [32m0.68335[0m    1.09331      0.48694  7.40s
     19     [36m0.73186[0m     0.68927    1.06179      0.52013  7.40s
     20     [36m0.71943[0m     0.71932    1.00015      0.55556  7.40s
     21     0.72745     [32m0.68033[0m    1.06926      0.51409  7.40s
     22     [36m0.69134[0m     0.70199    0.98482      0.56997  7.41s
     23     0.70027     0.68477    1.02264      0.54281  7.40s
     24     0.69532     0.69354    1.00256      0.56446  7.40s
     25     [36m0.67247[0m     0.75071    0.89577      0.55870  7.41s
     26     [36m0.66856[0m     [32m0.67677[0m    0.98788      0.51567  7.40s
     27     [36m0.64692[0m     0.68130    0.94955      0.54047  7.41s
     28     [36m0.64333[0m     0.70280    0.91538      0.56554  7.40s
     29     [36m0.63716[0m     0.79768    0.79876      0.55739  7.39s
     30     0.64536     0.69118    0.93371      0.56701  7.38s
     31     0.64135     0.67875    0.94489      0.53634  7.41s
     32     [36m0.61968[0m     [32m0.67470[0m    0.91846      0.55796  7.40s
     33     [36m0.61173[0m     0.68743    0.88988      0.53238  7.38s
     34     0.61588     0.70114    0.87840      0.50553  7.38s
     35     [36m0.60611[0m     0.69416    0.87316      0.57743  7.37s
     36     [36m0.59212[0m     0.68786    0.86081      0.54565  7.41s
     37     [36m0.59058[0m     0.71843    0.82205      0.58417  7.43s
     38     0.59577     0.67501    0.88261      0.56456  7.40s
     39     0.59552     [32m0.67400[0m    0.88357      0.54989  7.42s
     40     [36m0.58141[0m     0.72355    0.80355      0.55426  7.42s
     41     [36m0.57954[0m     0.73115    0.79265      0.55787  7.41s
     42     [36m0.57883[0m     0.76851    0.75318      0.58843  7.39s
     43     [36m0.57258[0m     0.69801    0.82031      0.55110  7.41s
     44     [36m0.57151[0m     0.68699    0.83190      0.58459  7.39s
     45     [36m0.56255[0m     0.76998    0.73060      0.58734  7.41s
     46     [36m0.56181[0m     0.71693    0.78364      0.59153  7.39s
     47     [36m0.54797[0m     [32m0.67291[0m    0.81433      0.56526  7.40s
     48     0.55249     0.69976    0.78954      0.55553  7.41s
     49     [36m0.54541[0m     0.75205    0.72524      0.56786  7.38s
     50     0.54605     0.70544    0.77406      0.56092  7.39s
     51     [36m0.54414[0m     0.74113    0.73421      0.55304  7.41s
     52     [36m0.54403[0m     0.87690    0.62040      0.54251  7.39s
     53     0.55302     0.69596    0.79462      0.56223  7.42s
     54     [36m0.52754[0m     0.92404    0.57091      0.54558  7.38s
     55     0.53742     0.71099    0.75588      0.56543  7.39s
     56     [36m0.52046[0m     0.69403    0.74991      0.56709  7.40s
     57     [36m0.51464[0m     0.73065    0.70437      0.55610  7.41s
Early stopping.
Best valid loss was 0.672912 at epoch 47.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d3' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d3' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d9' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d9' (shape 32).
Loaded parameters to layer 'conv2d11' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d11' (shape 32).
Loaded parameters to layer 'conv2d12' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d12' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[  1.62632114e-06   1.04846447e-06   1.06958214e-06   9.75931584e-07
   1.55892667e-06   8.23535117e-07   1.29197201e-06   1.37249822e-06
   5.55805229e-07   3.21875547e-07   2.73110260e-07   6.47124352e-07
   6.71236421e-07   8.54186851e-07   4.95490383e-07   7.39121617e-07
   7.34327841e-07   3.61160346e-07   2.72360921e-07   2.40019574e-07
   9.43753605e-07   1.01652347e-06   9.51493064e-07   2.57997249e-06
   2.79474352e-06   1.95425378e-06   9.37716663e-07   2.59649551e-06
   2.79939582e-06   3.71079386e-06]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.614403292181
Error rate (%):  38.5596707819
[[55153 33542]
 [ 3001  3074]]
(94770,)
(94770,)
roc_auc: 0.616791120075
log_loss: inf
roc_auc for the hours: 0.621917808219
log_loss for the hours: 0.681467643229
saving predictions to csv file
hourspatient1_3_net33_10-22-13-33-44.csv
Accuracy validation for the hours:  0.705128205128
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [3]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.10102528
saving predictions to csv file
patient1_3_net33_10-22-13-36-34.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config4.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_4']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config4.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_4'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-22 13:36:35.915649
Hostname: kat
gpu0
Configuration 'config4.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net33
evaluation:
    online_training: False
    model: net33

end Configuration
['patient1_4']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [4]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.847613952
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 235.407817078 219.809516907
20 571.790344238 556.848303223
30 840.501837158 821.775939941
40 1116.47878418 1091.31035156
50 1434.89074707 1400.26373291
60 1840.24331055 1790.55202637
70 2408.61494141 2333.43139648
80 3297.89345703 3176.70976563
90 4956.27602539 4739.19238281
100 52009.53125 38008.9335938
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net33
Model name for the evaluation phase:  net33
Training model...
# Neural Network with 47138 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x96x32
  4          32x96x32
  5          32x48x16
  6          32x48x16
  7          32x24x8
  8          32x24x8
  9          32x12x4
 10          32x12x4
 11          32x6x4
 12          2x6x4
 13          2
 14          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -----
      1    [36m47.93488[0m     [32m3.23655[0m   14.81049      0.51015  7.35s
      2     [36m9.60463[0m     [32m2.52965[0m    3.79682      0.50122  7.40s
      3     [36m5.74965[0m     [32m2.00999[0m    2.86054      0.50431  7.34s
      4     [36m3.97614[0m     [32m1.05752[0m    3.75986      0.50529  7.34s
      5     [36m3.10145[0m     1.06124    2.92247      0.50624  7.35s
      6     [36m2.47150[0m     [32m0.90669[0m    2.72584      0.50608  7.37s
      7     [36m1.99681[0m     [32m0.75498[0m    2.64484      0.53386  7.36s
      8     [36m1.75981[0m     0.78787    2.23363      0.50475  7.37s
      9     [36m1.51829[0m     [32m0.69117[0m    2.19669      0.56052  7.37s
     10     [36m1.38121[0m     0.69312    1.99275      0.56113  7.36s
     11     [36m1.28904[0m     0.69573    1.85280      0.55288  7.37s
     12     [36m1.16343[0m     0.76809    1.51471      0.52901  7.39s
     13     [36m1.11117[0m     0.70730    1.57101      0.52624  7.40s
     14     [36m1.05637[0m     0.71644    1.47447      0.53742  7.37s
     15     [36m1.02047[0m     0.74449    1.37069      0.50662  7.37s
     16     [36m0.96793[0m     0.69291    1.39690      0.54587  7.37s
     17     [36m0.93419[0m     [32m0.67083[0m    1.39259      0.60564  7.37s
     18     [36m0.89774[0m     0.71014    1.26416      0.54455  7.40s
     19     [36m0.86946[0m     0.77965    1.11519      0.50770  7.41s
     20     [36m0.86845[0m     0.67465    1.28727      0.58769  7.40s
     21     [36m0.84327[0m     0.68295    1.23476      0.55556  7.41s
     22     [36m0.81808[0m     0.74377    1.09992      0.50269  7.42s
     23     [36m0.80994[0m     0.73092    1.10812      0.52297  7.43s
     24     [36m0.77873[0m     0.71297    1.09225      0.53749  7.41s
     25     0.78669     0.72174    1.08999      0.52740  7.42s
     26     [36m0.77118[0m     0.68829    1.12043      0.55402  7.40s
     27     [36m0.76323[0m     0.69273    1.10176      0.55257  7.41s
Early stopping.
Best valid loss was 0.670829 at epoch 17.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d3' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d3' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d9' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d9' (shape 32).
Loaded parameters to layer 'conv2d11' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d11' (shape 32).
Loaded parameters to layer 'conv2d12' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d12' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[ 0.47076702  0.57769829  0.57399279  0.5820958   0.63470429  0.49224532
  0.550327    0.39339775  0.53520185  0.34030446  0.35237324  0.35834685
  0.25199053  0.21277657  0.36883363  0.14732116  0.19042923  0.28608352
  0.2330948   0.30881646  0.19384092  0.23657413  0.33016533  0.36918095
  0.65443677  0.50417084  0.70984584  0.46635714  0.52457929  0.29634312]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.592898596602
Error rate (%):  40.7101403398
[[53690 35005]
 [ 3576  2499]]
(94770,)
(94770,)
roc_auc: 0.568268070841
log_loss: 0.685355498011
roc_auc for the hours: 0.6
log_loss for the hours: 0.582995213383
saving predictions to csv file
hourspatient1_4_net33_10-22-13-44-07.csv
Accuracy validation for the hours:  0.615384615385
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [4]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.099833344
saving predictions to csv file
patient1_4_net33_10-22-13-46-59.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config4.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_5']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config4.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_5'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-22 13:47:00.224351
Hostname: kat
gpu0
Configuration 'config4.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net33
evaluation:
    online_training: False
    model: net33

end Configuration
['patient1_5']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [5]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.848420864
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 231.335012817 211.108001709
20 564.578271484 538.999780273
30 830.936474609 795.66987915
40 1104.11230469 1055.32932129
50 1420.78125 1352.56451416
60 1826.70258789 1730.86726074
70 2401.11716309 2262.68579102
80 3287.26503906 3085.56469727
90 4899.46132813 4571.94418945
100 55591.203125 52662.2460938
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net33
Model name for the evaluation phase:  net33
Training model...
# Neural Network with 47138 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x96x32
  4          32x96x32
  5          32x48x16
  6          32x48x16
  7          32x24x8
  8          32x24x8
  9          32x12x4
 10          32x12x4
 11          32x6x4
 12          2x6x4
 13          2
 14          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -----
      1    [36m48.28158[0m     [32m3.76744[0m   12.81550      0.50799  7.61s
      2     [36m9.84526[0m     [32m2.34912[0m    4.19104      0.50176  7.41s
      3     [36m5.66658[0m     [32m2.08776[0m    2.71419      0.50270  7.34s
      4     [36m3.99850[0m     [32m1.44350[0m    2.77001      0.49796  7.34s
      5     [36m3.12759[0m     [32m1.17083[0m    2.67127      0.50353  7.35s
      6     [36m2.49229[0m     1.25674    1.98313      0.50149  7.36s
      7     [36m2.03690[0m     1.21924    1.67063      0.49905  7.36s
      8     [36m1.77406[0m     [32m0.89397[0m    1.98447      0.49932  7.37s
      9     [36m1.55170[0m     [32m0.69437[0m    2.23468      0.54833  7.39s
     10     [36m1.39849[0m     0.77006    1.81609      0.50718  7.37s
     11     [36m1.28399[0m     0.76097    1.68731      0.50419  7.39s
     12     [36m1.18867[0m     0.95684    1.24228      0.50337  7.39s
     13     [36m1.11329[0m     1.02067    1.09075      0.49973  7.38s
     14     [36m1.06933[0m     0.78085    1.36945      0.50244  7.74s
     15     [36m1.01065[0m     0.88020    1.14820      0.50041  7.53s
     16     [36m0.98291[0m     0.82276    1.19464      0.49986  7.37s
     17     [36m0.94708[0m     0.81158    1.16695      0.49986  7.37s
     18     [36m0.90216[0m     0.80052    1.12697      0.50148  7.38s
     19     [36m0.86973[0m     0.74981    1.15993      0.50041  7.40s
Early stopping.
Best valid loss was 0.694374 at epoch 9.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d3' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d3' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d9' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d9' (shape 32).
Loaded parameters to layer 'conv2d11' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d11' (shape 32).
Loaded parameters to layer 'conv2d12' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d12' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[ 0.96860403  0.61289632  0.82770139  0.92457867  0.88835758  0.80002397
  0.79027629  0.90428197  0.6259706   0.74865967  0.7757296   0.64668685
  0.43963644  0.85823518  0.81893992  0.4830749   0.56121671  0.87066513
  0.57593465  0.83371526  0.92963058  0.84102148  0.74066412  0.61978775
  0.89233732  0.94278038  0.86685222  0.61809635  0.90559727  0.71707153]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.434726179171
Error rate (%):  56.5273820829
[[37032 51663]
 [ 1908  4167]]
(94770,)
(94770,)
roc_auc: 0.561702167482
log_loss: 1.10521355706
roc_auc for the hours: 0.671232876712
log_loss for the hours: 0.776733131172
saving predictions to csv file
hourspatient1_5_net33_10-22-13-53-38.csv
Accuracy validation for the hours:  0.333333333333
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [5]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.099825152
saving predictions to csv file
patient1_5_net33_10-22-13-56-44.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config4.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_6']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config4.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_6'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-22 13:56:45.974617
Hostname: kat
gpu0
Configuration 'config4.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net33
evaluation:
    online_training: False
    model: net33

end Configuration
['patient1_6']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [6]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.848285696
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 199.270783997 178.304678345
20 484.265484619 454.425598145
30 715.207281494 673.034472656
40 957.550097656 897.335144043
50 1246.79968262 1160.86651611
60 1628.27236328 1502.71569824
70 2172.52145996 1989.60817871
80 3015.20869141 2745.85849609
90 4633.05883789 4178.59511719
100 66751.359375 59361.5703125
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net33
Model name for the evaluation phase:  net33
Training model...
# Neural Network with 47138 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x96x32
  4          32x96x32
  5          32x48x16
  6          32x48x16
  7          32x24x8
  8          32x24x8
  9          32x12x4
 10          32x12x4
 11          32x6x4
 12          2x6x4
 13          2
 14          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -----
      1    [36m46.55901[0m     [32m2.85085[0m   16.33163      0.51719  7.36s
      2     [36m9.19531[0m     [32m1.61481[0m    5.69435      0.50797  7.39s
      3     [36m5.61311[0m     2.59215    2.16543      0.50162  7.34s
      4     [36m3.81444[0m     [32m1.15294[0m    3.30844      0.50204  7.36s
      5     [36m2.95735[0m     1.19068    2.48374      0.50461  7.35s
      6     [36m2.38613[0m     [32m1.06863[0m    2.23289      0.50257  7.38s
      7     [36m1.97184[0m     [32m1.06846[0m    1.84550      0.50041  7.35s
      8     [36m1.73731[0m     [32m0.85157[0m    2.04014      0.50041  7.36s
      9     [36m1.49724[0m     [32m0.74743[0m    2.00319      0.52992  7.37s
     10     [36m1.35021[0m     0.77923    1.73274      0.52968  7.35s
     11     [36m1.23498[0m     0.79355    1.55626      0.50527  7.36s
     12     [36m1.16629[0m     0.83771    1.39224      0.50796  7.37s
     13     [36m1.09630[0m     0.90287    1.21424      0.50000  7.38s
     14     [36m1.05538[0m     0.80286    1.31452      0.50922  7.37s
     15     [36m1.01647[0m     0.81298    1.25030      0.50230  7.37s
     16     [36m0.95884[0m     0.74964    1.27906      0.52422  7.37s
     17     [36m0.92102[0m     0.75474    1.22031      0.51831  7.37s
     18     [36m0.87463[0m     [32m0.71751[0m    1.21898      0.54213  7.38s
     19     [36m0.86151[0m     0.76417    1.12737      0.51581  7.40s
     20     [36m0.85226[0m     [32m0.69301[0m    1.22979      0.55719  7.40s
     21     [36m0.82222[0m     0.72015    1.14172      0.52981  7.42s
     22     [36m0.80054[0m     0.81667    0.98026      0.49892  7.42s
     23     [36m0.79183[0m     0.75701    1.04599      0.51264  7.40s
     24     [36m0.78437[0m     0.73022    1.07416      0.53371  7.40s
     25     [36m0.76630[0m     0.72765    1.05313      0.53792  7.40s
     26     [36m0.76304[0m     0.73453    1.03881      0.52377  7.40s
     27     [36m0.74832[0m     0.75992    0.98474      0.50793  7.42s
     28     [36m0.73497[0m     0.75416    0.97456      0.51723  7.40s
     29     0.73604     0.73971    0.99505      0.52815  7.39s
     30     [36m0.72914[0m     [32m0.69222[0m    1.05333      0.55941  7.39s
     31     [36m0.72058[0m     0.77566    0.92899      0.50689  7.41s
     32     [36m0.71934[0m     0.70125    1.02580      0.54066  7.40s
     33     [36m0.71095[0m     0.78411    0.90670      0.50594  7.39s
     34     0.71170     0.79213    0.89846      0.50067  7.37s
     35     [36m0.70391[0m     0.73029    0.96387      0.53404  7.40s
     36     [36m0.69643[0m     0.84341    0.82574      0.49933  7.41s
     37     [36m0.69511[0m     0.79137    0.87836      0.50068  7.40s
     38     0.69655     0.82937    0.83986      0.49892  7.40s
     39     0.69540     [32m0.66438[0m    1.04669      0.59520  7.40s
     40     [36m0.68954[0m     0.82545    0.83535      0.50095  7.41s
     41     [36m0.68644[0m     0.70157    0.97844      0.54784  7.41s
     42     0.68982     0.66562    1.03636      0.62961  7.39s
     43     [36m0.67960[0m     0.77335    0.87878      0.50664  7.41s
     44     [36m0.67348[0m     0.88469    0.76127      0.50027  7.40s
     45     0.67878     0.75435    0.89982      0.52001  7.42s
     46     [36m0.67221[0m     0.67464    0.99640      0.58668  7.39s
     47     [36m0.66591[0m     0.75681    0.87989      0.54342  7.41s
     48     [36m0.65708[0m     0.68239    0.96291      0.56557  7.43s
     49     0.65881     0.70808    0.93041      0.55266  7.39s
Early stopping.
Best valid loss was 0.664375 at epoch 39.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d3' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d3' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d9' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d9' (shape 32).
Loaded parameters to layer 'conv2d11' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d11' (shape 32).
Loaded parameters to layer 'conv2d12' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d12' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[ 0.00645704  0.0064788   0.0056156   0.00672717  0.00587179  0.00540229
  0.00514926  0.00514377  0.00545034  0.00626173  0.00827013  0.00793712
  0.00800094  0.00816662  0.01171033  0.00964334  0.01031763  0.00886031
  0.01077453  0.00814251  0.01036968  0.01064946  0.01174818  0.01242086
  0.01359053  0.0136557   0.01546916  0.0095618   0.01066695  0.01187711]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.900559248707
Error rate (%):  9.94407512926
[[85346  3349]
 [ 6075     0]]
(94770,)
(94770,)
roc_auc: 0.58556801746
log_loss: 0.304677537098
roc_auc for the hours: 0.482191780822
log_loss for the hours: 0.276426264916
saving predictions to csv file
hourspatient1_6_net33_10-22-14-07-00.csv
Accuracy validation for the hours:  0.935897435897
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [6]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.099374592
saving predictions to csv file
patient1_6_net33_10-22-14-09-53.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config4.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_7']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config4.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_7'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-22 14:09:54.626430
Hostname: kat
gpu0
Configuration 'config4.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net33
evaluation:
    online_training: False
    model: net33

end Configuration
['patient1_7']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [7]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.847265792
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 182.900706482 163.150218201
20 446.00692749 416.755505371
30 662.357696533 620.480499268
40 892.956396484 834.12010498
50 1172.0982666 1087.89544678
60 1542.81384277 1420.86425781
70 2076.69821777 1899.79864502
80 2929.02983398 2668.57714844
90 4619.13442383 4199.77285156
100 65353.1796875 57503.8945312
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net33
Model name for the evaluation phase:  net33
Training model...
# Neural Network with 47138 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x96x32
  4          32x96x32
  5          32x48x16
  6          32x48x16
  7          32x24x8
  8          32x24x8
  9          32x12x4
 10          32x12x4
 11          32x6x4
 12          2x6x4
 13          2
 14          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -----
      1    [36m45.70652[0m     [32m2.59939[0m   17.58353      0.52424  7.35s
      2     [36m9.35630[0m     [32m1.79552[0m    5.21092      0.50554  7.37s
      3     [36m5.57457[0m     [32m1.49796[0m    3.72145      0.50431  7.34s
      4     [36m3.74975[0m     [32m1.17731[0m    3.18502      0.50176  7.34s
      5     [36m2.88309[0m     [32m1.02370[0m    2.81635      0.50950  7.35s
      6     [36m2.35170[0m     [32m0.95640[0m    2.45892      0.50824  7.38s
      7     [36m1.95299[0m     [32m0.95374[0m    2.04772      0.51020  7.35s
      8     [36m1.73852[0m     [32m0.87702[0m    1.98230      0.50421  7.36s
      9     [36m1.49103[0m     [32m0.73239[0m    2.03584      0.54211  7.37s
     10     [36m1.33934[0m     0.84023    1.59402      0.51992  7.34s
     11     [36m1.24265[0m     0.79137    1.57027      0.50771  7.37s
     12     [36m1.15914[0m     0.90930    1.27476      0.50553  7.37s
     13     [36m1.10255[0m     0.85588    1.28821      0.50054  7.38s
     14     [36m1.03278[0m     0.89025    1.16011      0.50163  7.41s
     15     [36m1.00972[0m     0.81059    1.24566      0.50392  7.41s
     16     [36m0.96950[0m     [32m0.66911[0m    1.44894      0.62815  7.36s
     17     [36m0.91719[0m     0.86504    1.06028      0.50014  7.36s
     18     [36m0.87707[0m     0.77075    1.13794      0.53647  7.39s
     19     [36m0.86800[0m     0.81815    1.06093      0.50230  7.41s
     20     [36m0.84109[0m     0.81283    1.03477      0.50463  7.40s
     21     [36m0.82804[0m     0.76739    1.07904      0.52087  7.40s
     22     [36m0.80640[0m     0.71286    1.13122      0.53983  7.41s
     23     [36m0.78565[0m     0.77140    1.01847      0.53656  7.42s
     24     [36m0.78131[0m     0.70147    1.11382      0.54612  7.41s
     25     [36m0.76754[0m     0.84943    0.90359      0.50175  7.41s
     26     [36m0.75903[0m     0.68093    1.11469      0.58212  7.40s
Early stopping.
Best valid loss was 0.669114 at epoch 16.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d3' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d3' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d9' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d9' (shape 32).
Loaded parameters to layer 'conv2d11' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d11' (shape 32).
Loaded parameters to layer 'conv2d12' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d12' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[ 0.02223338  0.02364681  0.02109516  0.02772726  0.01823325  0.04168144
  0.04464929  0.05995751  0.0911284   0.06474675  0.04472094  0.03741197
  0.08207328  0.05422279  0.04612092  0.02348556  0.01432986  0.02899523
  0.03136466  0.01877345  0.05342869  0.05996848  0.08635145  0.09013756
  0.23162322  0.06359869  0.07325984  0.03922589  0.01967125  0.01340404]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.872923921072
Error rate (%):  12.7076078928
[[82693  6002]
 [ 6041    34]]
(94770,)
(94770,)
roc_auc: 0.564027701164
log_loss: 0.332745075105
roc_auc for the hours: 0.457534246575
log_loss for the hours: 0.285818739908
saving predictions to csv file
hourspatient1_7_net33_10-22-14-17-19.csv
Accuracy validation for the hours:  0.935897435897
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [7]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.098371072
saving predictions to csv file
patient1_7_net33_10-22-14-20-50.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config4.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_8']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config4.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_8'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-22 14:20:52.205032
Hostname: kat
gpu0
Configuration 'config4.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net33
evaluation:
    online_training: False
    model: net33

end Configuration
['patient1_8']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [8]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.848678912
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 179.447947693 164.423493958
20 434.278393555 418.093994141
30 634.319030762 613.24385376
40 834.442565918 807.11171875
50 1056.00579834 1020.13357544
60 1321.37426758 1274.3189209
70 1666.15869141 1603.34324951
80 2169.84814453 2082.13676758
90 3113.30068359 2981.24484863
100 59862.1054688 57871.4179688
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net33
Model name for the evaluation phase:  net33
Training model...
# Neural Network with 47138 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x96x32
  4          32x96x32
  5          32x48x16
  6          32x48x16
  7          32x24x8
  8          32x24x8
  9          32x12x4
 10          32x12x4
 11          32x6x4
 12          2x6x4
 13          2
 14          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -----
      1    [36m33.87545[0m     [32m1.94179[0m   17.44552      0.53750  7.54s
      2     [36m6.59228[0m     [32m1.48307[0m    4.44503      0.51094  7.65s
      3     [36m4.04652[0m     [32m1.43067[0m    2.82840      0.50620  7.64s
      4     [36m2.87058[0m     [32m1.10148[0m    2.60610      0.50122  7.77s
      5     [36m2.18440[0m     [32m0.83407[0m    2.61896      0.51194  7.79s
      6     [36m1.78306[0m     [32m0.78809[0m    2.26251      0.51202  7.80s
      7     [36m1.53617[0m     [32m0.75839[0m    2.02558      0.50748  7.79s
      8     [36m1.34013[0m     [32m0.69600[0m    1.92548      0.53489  7.80s
      9     [36m1.18062[0m     [32m0.68705[0m    1.71837      0.54806  7.80s
     10     [36m1.10710[0m     0.68994    1.60464      0.55164  7.79s
     11     [36m1.01381[0m     0.69033    1.46859      0.54233  7.81s
     12     [36m0.96094[0m     0.70996    1.35352      0.53387  7.80s
     13     [36m0.92016[0m     0.68712    1.33917      0.54113  7.46s
     14     [36m0.88862[0m     0.69100    1.28599      0.54691  7.37s
     15     [36m0.86274[0m     0.69034    1.24972      0.54337  7.37s
     16     [36m0.83924[0m     [32m0.68027[0m    1.23368      0.55968  7.37s
     17     [36m0.81642[0m     0.68396    1.19367      0.55275  7.37s
     18     [36m0.78672[0m     [32m0.67662[0m    1.16272      0.55236  7.38s
     19     [36m0.77658[0m     0.67838    1.14475      0.55904  7.39s
     20     0.77674     [32m0.67508[0m    1.15059      0.55664  7.40s
     21     [36m0.76612[0m     [32m0.67497[0m    1.13504      0.55664  7.40s
     22     [36m0.74367[0m     [32m0.66864[0m    1.11222      0.56728  7.41s
     23     [36m0.74137[0m     0.67540    1.09768      0.54662  7.40s
     24     [36m0.72501[0m     0.68274    1.06192      0.55178  7.41s
     25     0.72877     0.67958    1.07238      0.55709  7.45s
     26     [36m0.71954[0m     0.67342    1.06849      0.55646  7.40s
     27     [36m0.71519[0m     0.67893    1.05341      0.55929  7.41s
     28     [36m0.70224[0m     0.67327    1.04303      0.55115  7.39s
     29     [36m0.69794[0m     0.67601    1.03245      0.55333  7.39s
     30     0.69862     0.68358    1.02201      0.55209  7.39s
     31     [36m0.69330[0m     0.68468    1.01259      0.56255  7.42s
     32     [36m0.68864[0m     0.72171    0.95417      0.55823  7.40s
Early stopping.
Best valid loss was 0.668638 at epoch 22.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d3' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d3' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d9' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d9' (shape 32).
Loaded parameters to layer 'conv2d11' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d11' (shape 32).
Loaded parameters to layer 'conv2d12' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d12' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[ 0.91225201  0.9347254   0.90904146  0.90698755  0.92839092  0.90343344
  0.92663264  0.93058336  0.89974898  0.95052773  0.93802905  0.91264457
  0.90143293  0.91250288  0.93793327  0.89964396  0.91063052  0.92519766
  0.92379963  0.87760222  0.91628784  0.88996822  0.91247427  0.88059825
  0.89280647  0.89294493  0.93190843  0.87432015  0.91880161  0.89698863]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.260377756674
Error rate (%):  73.9622243326
[[19128 69567]
 [  527  5548]]
(94770,)
(94770,)
roc_auc: 0.605228550145
log_loss: 1.63206333583
roc_auc for the hours: 0.641095890411
log_loss for the hours: 1.44318517288
saving predictions to csv file
hourspatient1_8_net33_10-22-14-29-07.csv
Accuracy validation for the hours:  0.269230769231
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [8]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.100537856
saving predictions to csv file
patient1_8_net33_10-22-14-31-59.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config4.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_9']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config4.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_9'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-22 14:32:00.936480
Hostname: kat
gpu0
Configuration 'config4.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net33
evaluation:
    online_training: False
    model: net33

end Configuration
['patient1_9']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [9]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.847511552
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 3.68383948803 3.51945617199
20 8.91916770935 8.73870506287
30 13.5332503319 13.2244482994
40 19.6162849426 18.9431503296
50 42.7269630432 33.8711013794
60 446.623547363 383.009014893
70 778.942749023 709.81932373
80 1201.11340332 1105.85910645
90 1927.03088379 1777.32213135
100 43853.8789062 40357.3945312
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net33
Model name for the evaluation phase:  net33
Training model...
# Neural Network with 47138 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x96x32
  4          32x96x32
  5          32x48x16
  6          32x48x16
  7          32x24x8
  8          32x24x8
  9          32x12x4
 10          32x12x4
 11          32x6x4
 12          2x6x4
 13          2
 14          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -----
      1    [36m21.18071[0m     [32m1.01828[0m   20.80049      0.50961  7.35s
      2     [36m4.28522[0m     [32m0.76684[0m    5.58813      0.48555  7.35s
      3     [36m2.86786[0m     0.83286    3.44338      0.50728  7.37s
      4     [36m2.15468[0m     0.85765    2.51230      0.50014  7.34s
      5     [36m1.73243[0m     0.78417    2.20926      0.50624  7.35s
      6     [36m1.46571[0m     [32m0.70957[0m    2.06564      0.51040  7.40s
      7     [36m1.29203[0m     0.73138    1.76655      0.50204  7.35s
      8     [36m1.19113[0m     [32m0.70846[0m    1.68128      0.50638  7.36s
      9     [36m1.03988[0m     [32m0.69805[0m    1.48970      0.49228  7.37s
     10     [36m0.98280[0m     0.72882    1.34849      0.50149  7.35s
     11     [36m0.95206[0m     0.70139    1.35739      0.50798  7.37s
     12     [36m0.90011[0m     0.70962    1.26844      0.50715  7.43s
     13     [36m0.87658[0m     0.70829    1.23761      0.50189  7.40s
     14     [36m0.85841[0m     0.70686    1.21439      0.50271  7.42s
     15     [36m0.84853[0m     0.70311    1.20681      0.50500  7.37s
     16     [36m0.81873[0m     0.70705    1.15796      0.50203  7.37s
     17     0.82926     0.70161    1.18193      0.51180  7.37s
     18     [36m0.80983[0m     0.71024    1.14023      0.50902  7.43s
     19     [36m0.79171[0m     0.70530    1.12251      0.45285  7.43s
Early stopping.
Best valid loss was 0.698050 at epoch 9.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d3' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d3' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d9' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d9' (shape 32).
Loaded parameters to layer 'conv2d11' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d11' (shape 32).
Loaded parameters to layer 'conv2d12' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d12' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[ 0.29277775  0.40471601  0.57113135  0.04321302  0.61790448  0.09740012
  0.04656109  0.13024695  0.22802219  0.18282071  0.30213764  0.42692721
  0.09553719  0.20249617  0.46238008  0.19082002  0.14312266  0.24846937
  0.20929286  0.07177956  0.37847346  0.67397255  0.26369417  0.17343473
  0.02980672  0.07068954  0.54875946  0.165591    0.10119843  0.37995699]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.23147620555
Error rate (%):  76.852379445
[[17710 70985]
 [ 1848  4227]]
(94770,)
(94770,)
roc_auc: 0.475372133243
log_loss: 0.934795062881
roc_auc for the hours: 0.558904109589
log_loss for the hours: 0.806147317665
saving predictions to csv file
hourspatient1_9_net33_10-22-14-38-31.csv
Accuracy validation for the hours:  0.217948717949
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [9]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.099649024
saving predictions to csv file
patient1_9_net33_10-22-14-41-51.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config4.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_10']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config4.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_10'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-22 14:41:52.506571
Hostname: kat
gpu0
Configuration 'config4.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net33
evaluation:
    online_training: False
    model: net33

end Configuration
['patient1_10']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [10]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.847450112
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 181.207902527 167.670619202
20 438.332196045 424.686590576
30 639.719543457 622.390942383
40 839.969042969 817.731738281
50 1060.19781494 1030.7331543
60 1320.43032227 1280.04846191
70 1650.03087158 1595.78609619
80 2111.48989258 2038.48054199
90 2911.55273438 2807.46408691
100 41643.4882812 36225.46875
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net33
Model name for the evaluation phase:  net33
Training model...
# Neural Network with 47138 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x96x32
  4          32x96x32
  5          32x48x16
  6          32x48x16
  7          32x24x8
  8          32x24x8
  9          32x12x4
 10          32x12x4
 11          32x6x4
 12          2x6x4
 13          2
 14          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -----
      1    [36m29.28026[0m     [32m1.06519[0m   27.48830      0.54861  7.34s
      2     [36m5.83211[0m     1.26099    4.62503      0.54253  7.62s
      3     [36m3.41781[0m     [32m0.76772[0m    4.45191      0.55930  7.36s
      4     [36m2.47825[0m     0.93728    2.64410      0.50339  7.35s
      5     [36m1.92781[0m     0.84645    2.27753      0.52360  7.63s
      6     [36m1.64165[0m     0.76992    2.13224      0.51013  7.36s
      7     [36m1.35972[0m     0.77916    1.74511      0.50612  7.37s
      8     [36m1.22664[0m     [32m0.72495[0m    1.69203      0.51860  7.36s
      9     [36m1.08990[0m     [32m0.69765[0m    1.56225      0.53994  7.37s
     10     [36m1.00500[0m     [32m0.69145[0m    1.45346      0.55001  7.35s
     11     [36m0.95656[0m     [32m0.68930[0m    1.38773      0.54828  7.39s
     12     [36m0.89334[0m     0.74911    1.19253      0.51093  7.37s
     13     [36m0.87963[0m     0.73384    1.19866      0.52192  7.38s
     14     [36m0.84171[0m     0.76143    1.10543      0.53145  7.39s
     15     [36m0.82538[0m     0.73599    1.12145      0.53607  7.37s
     16     [36m0.80323[0m     0.78072    1.02883      0.53829  7.37s
     17     [36m0.78111[0m     0.71008    1.10003      0.54462  7.37s
     18     [36m0.76098[0m     0.69134    1.10073      0.55559  7.38s
     19     [36m0.74835[0m     0.71186    1.05126      0.54769  7.38s
     20     [36m0.73908[0m     0.71608    1.03211      0.54793  7.40s
     21     [36m0.72222[0m     [32m0.66341[0m    1.08864      0.55664  7.41s
     22     [36m0.71337[0m     0.68686    1.03859      0.55893  7.41s
     23     [36m0.70836[0m     0.69411    1.02052      0.55776  7.40s
     24     [36m0.69566[0m     0.68842    1.01052      0.56257  7.40s
     25     [36m0.69491[0m     [32m0.65750[0m    1.05690      0.59973  7.41s
     26     [36m0.68897[0m     [32m0.65467[0m    1.05240      0.57266  7.40s
     27     [36m0.66863[0m     0.66924    0.99909      0.57838  7.41s
     28     [36m0.66149[0m     [32m0.65154[0m    1.01526      0.55875  7.39s
     29     0.66430     0.71278    0.93198      0.55658  7.39s
     30     [36m0.65602[0m     0.70772    0.92695      0.55806  7.39s
     31     [36m0.64859[0m     0.68987    0.94016      0.57201  7.41s
     32     [36m0.64403[0m     0.65636    0.98122      0.60524  7.40s
     33     0.64427     0.65705    0.98055      0.54830  7.39s
     34     [36m0.63989[0m     0.65185    0.98166      0.61445  7.38s
     35     [36m0.62638[0m     0.65562    0.95541      0.60808  7.37s
     36     0.62978     [32m0.64847[0m    0.97119      0.61325  7.39s
     37     [36m0.62598[0m     [32m0.64178[0m    0.97538      0.60586  7.40s
     38     [36m0.61771[0m     [32m0.63005[0m    0.98041      0.60319  7.40s
     39     [36m0.60844[0m     0.63801    0.95365      0.61219  7.40s
     40     0.60847     0.65617    0.92730      0.60298  7.41s
     41     0.60919     0.63062    0.96602      0.61616  7.41s
     42     0.61466     0.66918    0.91853      0.45599  7.39s
     43     [36m0.60276[0m     0.72348    0.83314      0.57631  7.41s
     44     [36m0.59680[0m     0.70520    0.84628      0.57432  7.40s
     45     [36m0.59500[0m     0.67365    0.88325      0.59438  7.41s
     46     [36m0.59225[0m     0.67583    0.87632      0.49852  7.41s
     47     [36m0.58674[0m     0.66907    0.87695      0.47546  7.44s
     48     [36m0.57951[0m     0.65975    0.87838      0.53706  7.45s
Early stopping.
Best valid loss was 0.630051 at epoch 38.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d3' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d3' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d9' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d9' (shape 32).
Loaded parameters to layer 'conv2d11' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d11' (shape 32).
Loaded parameters to layer 'conv2d12' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d12' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[ 0.0362307   0.0427569   0.04272216  0.04274099  0.02080902  0.0289547
  0.0169604   0.01986486  0.01772199  0.03777755  0.01989253  0.04125945
  0.02892124  0.04926062  0.04212787  0.06197174  0.04327189  0.05952927
  0.04600401  0.04495609  0.04801906  0.03002861  0.04302816  0.03076922
  0.02979846  0.06038978  0.03334336  0.04185314  0.03567491  0.04485815]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.550269072491
Error rate (%):  44.9730927509
[[48517 40178]
 [ 2443  3632]]
(94770,)
(94770,)
roc_auc: 0.611148613283
log_loss: 1.13063858011
roc_auc for the hours: 0.605479452055
log_loss for the hours: 0.820929012535
saving predictions to csv file
hourspatient1_10_net33_10-22-14-52-24.csv
Accuracy validation for the hours:  0.538461538462
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [10]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.099268096
saving predictions to csv file
patient1_10_net33_10-22-14-55-27.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config4.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_11']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config4.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_11'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-22 14:55:28.174838
Hostname: kat
gpu0
Configuration 'config4.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net33
evaluation:
    online_training: False
    model: net33

end Configuration
['patient1_11']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [11]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.848150528
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 172.641601563 159.5427948
20 417.636303711 403.23772583
30 608.427856445 589.179815674
40 796.191516113 769.670605469
50 999.883514404 964.325683594
60 1236.0432373 1189.17692871
70 1532.10228271 1470.09255371
80 1945.44143066 1860.52646484
90 2669.32939453 2545.69404297
100 34311.5273438 30092.4199219
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net33
Model name for the evaluation phase:  net33
Training model...
# Neural Network with 47138 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x96x32
  4          32x96x32
  5          32x48x16
  6          32x48x16
  7          32x24x8
  8          32x24x8
  9          32x12x4
 10          32x12x4
 11          32x6x4
 12          2x6x4
 13          2
 14          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -----
      1    [36m26.97647[0m     [32m1.33599[0m   20.19212      0.58760  7.46s
      2     [36m5.21089[0m     [32m0.74641[0m    6.98130      0.59384  7.44s
      3     [36m3.18174[0m     0.86347    3.68483      0.56927  7.46s
      4     [36m2.31585[0m     1.04639    2.21319      0.50502  7.45s
      5     [36m1.78203[0m     1.13782    1.56618      0.50787  7.46s
      6     [36m1.51934[0m     0.87800    1.73046      0.50689  7.48s
      7     [36m1.26566[0m     0.95272    1.32847      0.50340  7.46s
      8     [36m1.12653[0m     0.82985    1.35750      0.50828  7.47s
      9     [36m1.00962[0m     [32m0.72180[0m    1.39876      0.54292  7.47s
     10     [36m0.94005[0m     0.75923    1.23816      0.53510  7.46s
     11     [36m0.86984[0m     0.72453    1.20055      0.55126  7.47s
     12     [36m0.82631[0m     0.78945    1.04669      0.51849  7.48s
     13     [36m0.82138[0m     0.77576    1.05880      0.50541  7.50s
     14     [36m0.77994[0m     0.76071    1.02528      0.52088  7.49s
     15     [36m0.75277[0m     0.72409    1.03961      0.57012  7.49s
     16     [36m0.74319[0m     [32m0.66647[0m    1.11511      0.62084  7.48s
     17     [36m0.71478[0m     [32m0.66054[0m    1.08210      0.62517  7.46s
     18     [36m0.68632[0m     0.67346    1.01909      0.60942  7.48s
     19     [36m0.68064[0m     [32m0.65413[0m    1.04052      0.63577  7.48s
     20     [36m0.66405[0m     0.70575    0.94092      0.59831  7.48s
     21     [36m0.66084[0m     0.66769    0.98974      0.62575  7.52s
     22     [36m0.64082[0m     0.66547    0.96296      0.63294  7.43s
     23     [36m0.63953[0m     0.71328    0.89661      0.56890  7.40s
     24     [36m0.63271[0m     0.67114    0.94275      0.62028  7.40s
     25     0.63337     0.68198    0.92873      0.60000  7.41s
     26     [36m0.62587[0m     0.65826    0.95079      0.64209  7.40s
     27     [36m0.60967[0m     0.67147    0.90797      0.61603  7.41s
     28     [36m0.60290[0m     0.67614    0.89169      0.60923  7.39s
     29     [36m0.59995[0m     0.66171    0.90666      0.63942  7.39s
Early stopping.
Best valid loss was 0.654133 at epoch 19.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d3' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d3' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d9' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d9' (shape 32).
Loaded parameters to layer 'conv2d11' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d11' (shape 32).
Loaded parameters to layer 'conv2d12' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d12' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[ 0.39087492  0.487418    0.48171499  0.46262005  0.33499491  0.46702507
  0.37621886  0.33224502  0.39378995  0.51288366  0.4104313   0.56779248
  0.45860371  0.66571623  0.52723759  0.54896444  0.52265996  0.57006538
  0.53389919  0.44776729  0.53700298  0.67478842  0.73052537  0.6032359
  0.65877092  0.63101852  0.63737869  0.54081684  0.58346432  0.53872162]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.473694207028
Error rate (%):  52.6305792972
[[40395 48300]
 [ 1578  4497]]
(94770,)
(94770,)
roc_auc: 0.567118972704
log_loss: 1.13918312154
roc_auc for the hours: 0.58904109589
log_loss for the hours: 0.961932985446
saving predictions to csv file
hourspatient1_11_net33_10-22-15-04-05.csv
Accuracy validation for the hours:  0.525641025641
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [11]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.09953024
saving predictions to csv file
patient1_11_net33_10-22-15-06-57.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config4.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_12']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config4.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_12'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-22 15:06:58.609431
Hostname: kat
gpu0
Configuration 'config4.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net33
evaluation:
    online_training: False
    model: net33

end Configuration
['patient1_12']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [12]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.84731904
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 194.413856506 178.851933289
20 463.675524902 446.537554932
30 666.165478516 644.010736084
40 859.942541504 831.373522949
50 1065.9508667 1029.34899902
60 1304.29125977 1256.71569824
70 1606.91943359 1543.18864746
80 2047.88012695 1958.46350098
90 2871.70686035 2742.33198242
100 68176.640625 59867.6914062
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net33
Model name for the evaluation phase:  net33
Training model...
# Neural Network with 47138 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x96x32
  4          32x96x32
  5          32x48x16
  6          32x48x16
  7          32x24x8
  8          32x24x8
  9          32x12x4
 10          32x12x4
 11          32x6x4
 12          2x6x4
 13          2
 14          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -----
      1    [36m27.91560[0m     [32m2.69120[0m   10.37293      0.53100  7.64s
      2     [36m5.68346[0m     [32m1.92305[0m    2.95544      0.50284  7.34s
      3     [36m3.47409[0m     [32m1.81095[0m    1.91838      0.50270  7.35s
      4     [36m2.46527[0m     [32m1.51238[0m    1.63006      0.49742  7.34s
      5     [36m1.86927[0m     1.66066    1.12562      0.50271  7.36s
      6     [36m1.57471[0m     [32m1.46276[0m    1.07653      0.50149  7.36s
      7     [36m1.32196[0m     [32m1.26518[0m    1.04488      0.49905  7.38s
      8     [36m1.18590[0m     [32m1.04893[0m    1.13058      0.49769  7.39s
      9     [36m1.04313[0m     1.06800    0.97671      0.50014  7.37s
     10     [36m0.99332[0m     [32m1.03463[0m    0.96007      0.50068  7.35s
     11     [36m0.94004[0m     [32m0.94727[0m    0.99237      0.50149  7.37s
     12     [36m0.88305[0m     [32m0.93732[0m    0.94210      0.50310  7.37s
     13     [36m0.85106[0m     [32m0.93283[0m    0.91234      0.49973  7.38s
     14     [36m0.81798[0m     1.00145    0.81680      0.50054  7.38s
     15     [36m0.80025[0m     0.93493    0.85595      0.50041  7.37s
     16     [36m0.78971[0m     [32m0.86560[0m    0.91233      0.50095  7.39s
     17     [36m0.75649[0m     [32m0.85734[0m    0.88237      0.50068  7.37s
     18     [36m0.73903[0m     [32m0.84311[0m    0.87656      0.50229  7.41s
     19     [36m0.73341[0m     0.85027    0.86256      0.49959  7.39s
     20     [36m0.71480[0m     0.87064    0.82100      0.50191  7.40s
     21     [36m0.71208[0m     0.88182    0.80752      0.50515  7.41s
     22     [36m0.69452[0m     0.89508    0.77593      0.49973  7.42s
     23     [36m0.69345[0m     0.85173    0.81417      0.50177  7.41s
     24     [36m0.67980[0m     0.86911    0.78218      0.50405  7.41s
     25     0.67989     [32m0.80685[0m    0.84265      0.50634  7.41s
     26     [36m0.67437[0m     [32m0.77410[0m    0.87117      0.52620  7.41s
     27     [36m0.66203[0m     0.82088    0.80649      0.50955  7.42s
     28     [36m0.65719[0m     [32m0.72913[0m    0.90132      0.54735  7.40s
     29     [36m0.64881[0m     0.84508    0.76774      0.51597  7.40s
     30     [36m0.64662[0m     0.89207    0.72485      0.50136  7.39s
     31     [36m0.63615[0m     0.80950    0.78586      0.53364  7.42s
     32     [36m0.63032[0m     [32m0.72648[0m    0.86763      0.55526  7.41s
     33     [36m0.62916[0m     0.76726    0.82000      0.53427  7.40s
     34     0.63465     0.76924    0.82503      0.52251  7.40s
     35     [36m0.62361[0m     0.73271    0.85110      0.55980  7.40s
     36     [36m0.61873[0m     0.72834    0.84950      0.56962  7.40s
     37     [36m0.61249[0m     0.75494    0.81132      0.56113  7.40s
     38     [36m0.61005[0m     0.73195    0.83346      0.56942  7.40s
     39     [36m0.60819[0m     [32m0.70418[0m    0.86368      0.57470  7.41s
     40     [36m0.60623[0m     [32m0.69434[0m    0.87311      0.57645  7.41s
     41     0.60631     [32m0.69383[0m    0.87386      0.56872  7.47s
     42     [36m0.60030[0m     0.72208    0.83135      0.57497  7.40s
     43     [36m0.59737[0m     0.72092    0.82862      0.58227  7.45s
     44     [36m0.58961[0m     [32m0.66294[0m    0.88938      0.59486  7.40s
     45     [36m0.58819[0m     [32m0.64013[0m    0.91887      0.60573  7.42s
     46     0.58921     0.65508    0.89946      0.59504  7.40s
     47     [36m0.58465[0m     0.68557    0.85279      0.58306  7.41s
     48     [36m0.57654[0m     0.65049    0.88633      0.60005  7.44s
     49     [36m0.57150[0m     0.67026    0.85265      0.60803  7.40s
     50     0.57592     [32m0.63274[0m    0.91019      0.61113  7.40s
     51     [36m0.56973[0m     0.67960    0.83833      0.61889  7.42s
     52     0.57306     0.70910    0.80815      0.59082  7.40s
     53     [36m0.56480[0m     0.64377    0.87733      0.59860  7.42s
     54     0.56546     0.63320    0.89302      0.60887  7.39s
     55     [36m0.56247[0m     0.64787    0.86818      0.60305  7.40s
     56     [36m0.55199[0m     0.64118    0.86090      0.61128  7.41s
     57     0.55225     0.67149    0.82242      0.60719  7.41s
     58     [36m0.55082[0m     0.63446    0.86816      0.61949  7.41s
     59     [36m0.54276[0m     0.63916    0.84918      0.61831  7.39s
     60     0.54449     0.64966    0.83811      0.60195  7.41s
Early stopping.
Best valid loss was 0.632743 at epoch 50.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d3' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d3' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d9' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d9' (shape 32).
Loaded parameters to layer 'conv2d11' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d11' (shape 32).
Loaded parameters to layer 'conv2d12' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d12' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[ 0.15860927  0.16702819  0.18188883  0.12553935  0.20853837  0.15641117
  0.1635042   0.13896197  0.20749395  0.14613383  0.1123882   0.12138025
  0.12460964  0.09700841  0.16582352  0.08695052  0.15789106  0.12995915
  0.09571985  0.10447848  0.15531054  0.15504225  0.15450563  0.140002
  0.23908265  0.20681074  0.19052418  0.2407826   0.21995704  0.16256647]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.729777355703
Error rate (%):  27.0222644297
[[66742 21953]
 [ 3656  2419]]
(94770,)
(94770,)
roc_auc: 0.652840012834
log_loss: 0.639021509828
roc_auc for the hours: 0.723287671233
log_loss for the hours: 0.396970274517
saving predictions to csv file
hourspatient1_12_net33_10-22-15-19-37.csv
Accuracy validation for the hours:  0.858974358974
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [12]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.098395648
saving predictions to csv file
patient1_12_net33_10-22-15-22-30.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config4.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_13']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config4.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_13'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-22 15:22:32.025748
Hostname: kat
gpu0
Configuration 'config4.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net33
evaluation:
    online_training: False
    model: net33

end Configuration
['patient1_13']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [13]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.848248832
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 197.41583252 182.761578369
20 473.741113281 459.648413086
30 683.193365479 665.443499756
40 884.565112305 862.165649414
50 1098.331604 1068.85339355
60 1343.71057129 1304.4578125
70 1651.5090332 1598.25623779
80 2090.38417969 2016.00366211
90 2902.72646484 2791.59272461
100 37327.25 36955.34375
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net33
Model name for the evaluation phase:  net33
Training model...
# Neural Network with 47138 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x96x32
  4          32x96x32
  5          32x48x16
  6          32x48x16
  7          32x24x8
  8          32x24x8
  9          32x12x4
 10          32x12x4
 11          32x6x4
 12          2x6x4
 13          2
 14          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -----
      1    [36m28.32854[0m     [32m2.03205[0m   13.94087      0.55348  7.49s
      2     [36m5.64966[0m     [32m0.90443[0m    6.24664      0.57872  7.35s
      3     [36m3.32992[0m     1.32385    2.51534      0.50916  7.35s
      4     [36m2.39287[0m     [32m0.84304[0m    2.83839      0.53380  7.35s
      5     [36m1.84752[0m     0.95176    1.94115      0.50895  7.36s
      6     [36m1.56157[0m     [32m0.80962[0m    1.92879      0.52634  7.37s
      7     [36m1.30996[0m     0.88479    1.48053      0.51101  7.37s
      8     [36m1.17395[0m     [32m0.68253[0m    1.71999      0.58295  7.38s
      9     [36m1.04624[0m     0.72160    1.44989      0.55267  7.37s
     10     [36m0.98164[0m     0.70565    1.39111      0.57902  7.36s
     11     [36m0.92808[0m     0.70199    1.32208      0.56072  7.38s
     12     [36m0.87142[0m     0.74292    1.17297      0.55762  7.37s
     13     [36m0.83926[0m     0.72400    1.15920      0.53626  7.39s
     14     [36m0.80925[0m     0.81793    0.98939      0.50922  7.38s
     15     [36m0.78698[0m     0.71670    1.09806      0.57984  7.78s
     16     [36m0.77567[0m     0.71420    1.08608      0.57240  7.64s
     17     [36m0.74325[0m     0.70468    1.05473      0.57689  7.37s
     18     [36m0.72406[0m     0.69301    1.04481      0.58197  7.39s
     19     [36m0.71719[0m     [32m0.67599[0m    1.06094      0.59578  7.40s
     20     [36m0.70207[0m     0.70372    0.99766      0.58578  7.41s
     21     [36m0.70169[0m     [32m0.66884[0m    1.04911      0.60352  7.65s
     22     [36m0.69142[0m     [32m0.64335[0m    1.07472      0.61572  7.87s
     23     [36m0.67415[0m     0.66531    1.01329      0.60207  7.86s
     24     [36m0.66645[0m     0.66008    1.00965      0.60437  7.47s
     25     [36m0.66356[0m     0.64713    1.02540      0.61188  7.42s
     26     [36m0.65673[0m     [32m0.62907[0m    1.04397      0.62480  7.41s
     27     [36m0.64765[0m     0.64085    1.01061      0.62033  7.42s
     28     [36m0.63902[0m     [32m0.61189[0m    1.04434      0.64993  7.40s
     29     [36m0.63355[0m     0.64562    0.98131      0.61451  7.40s
     30     [36m0.62897[0m     0.61973    1.01491      0.63755  7.39s
     31     [36m0.62444[0m     0.66559    0.93818      0.60902  7.42s
     32     [36m0.61857[0m     0.65661    0.94207      0.60875  7.41s
     33     [36m0.61547[0m     0.64305    0.95711      0.61414  7.40s
     34     0.61607     [32m0.61171[0m    1.00712      0.66433  7.39s
     35     [36m0.60442[0m     0.62040    0.97424      0.63656  7.41s
     36     0.60966     0.61663    0.98870      0.62214  7.42s
     37     [36m0.59644[0m     0.65993    0.90380      0.60667  7.41s
     38     0.59736     0.61904    0.96497      0.62237  7.41s
     39     [36m0.59447[0m     0.61922    0.96003      0.61543  7.41s
     40     [36m0.59025[0m     0.63670    0.92706      0.62030  7.42s
     41     0.59335     0.61622    0.96289      0.61968  7.42s
     42     [36m0.58225[0m     0.62847    0.92647      0.60969  7.40s
     43     0.58286     0.63665    0.91550      0.62320  7.42s
     44     [36m0.57196[0m     0.62987    0.90805      0.63405  7.41s
Early stopping.
Best valid loss was 0.611715 at epoch 34.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d3' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d3' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d9' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d9' (shape 32).
Loaded parameters to layer 'conv2d11' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d11' (shape 32).
Loaded parameters to layer 'conv2d12' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d12' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[ 0.30220109  0.35332769  0.23685212  0.20922668  0.23555253  0.31262282
  0.23622188  0.22577231  0.21920495  0.27478507  0.200689    0.22866605
  0.25970411  0.27165154  0.24472031  0.25415015  0.24006796  0.28754321
  0.22356473  0.22148001  0.25449207  0.2916348   0.28803021  0.32190087
  0.31664395  0.29999855  0.21648224  0.26728949  0.28785446  0.30664787]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.66909359502
Error rate (%):  33.090640498
[[60149 28546]
 [ 2814  3261]]
(94770,)
(94770,)
roc_auc: 0.693369447292
log_loss: 0.767489394253
roc_auc for the hours: 0.767123287671
log_loss for the hours: 0.537998391274
saving predictions to csv file
hourspatient1_13_net33_10-22-15-32-11.csv
Accuracy validation for the hours:  0.794871794872
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [13]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.099321344
saving predictions to csv file
patient1_13_net33_10-22-15-35-08.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config4.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_14']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config4.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_14'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-22 15:35:09.415687
Hostname: kat
gpu0
Configuration 'config4.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net33
evaluation:
    online_training: False
    model: net33

end Configuration
['patient1_14']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [14]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.848265216
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 189.141261292 174.980825806
20 452.630731201 438.836401367
30 649.66987915 632.660009766
40 836.557116699 814.948742676
50 1031.56469727 1003.98742676
60 1251.25163574 1216.06953125
70 1519.30529785 1471.67954102
80 1885.33984375 1820.3204834
90 2516.96833496 2415.86462402
100 43412.1367188 33402.015625
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net33
Model name for the evaluation phase:  net33
Training model...
# Neural Network with 47138 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x96x32
  4          32x96x32
  5          32x48x16
  6          32x48x16
  7          32x24x8
  8          32x24x8
  9          32x12x4
 10          32x12x4
 11          32x6x4
 12          2x6x4
 13          2
 14          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -----
      1    [36m24.41236[0m     [32m2.32467[0m   10.50143      0.51963  7.36s
      2     [36m4.89314[0m     [32m1.36721[0m    3.57891      0.50635  7.34s
      3     [36m2.92836[0m     1.49820    1.95458      0.50270  7.34s
      4     [36m2.12445[0m     [32m1.29540[0m    1.64000      0.49742  7.43s
      5     [36m1.65703[0m     [32m1.17179[0m    1.41410      0.50326  7.78s
      6     [36m1.41662[0m     [32m0.86163[0m    1.64412      0.50392  7.79s
      7     [36m1.20344[0m     1.08564    1.10850      0.49905  7.46s
      8     [36m1.09859[0m     0.89031    1.23395      0.49769  7.49s
      9     [36m0.97258[0m     0.87798    1.10774      0.50095  7.37s
     10     [36m0.95283[0m     [32m0.81838[0m    1.16429      0.50230  7.38s
     11     [36m0.88855[0m     [32m0.80159[0m    1.10849      0.50392  7.39s
     12     [36m0.84438[0m     0.87954    0.96002      0.50391  7.36s
     13     [36m0.82101[0m     0.85828    0.95657      0.50027  7.38s
     14     [36m0.78986[0m     0.91713    0.86123      0.50054  7.37s
     15     [36m0.77487[0m     [32m0.76978[0m    1.00660      0.50608  7.37s
     16     [36m0.75983[0m     0.80284    0.94644      0.50311  7.36s
     17     [36m0.73926[0m     [32m0.76154[0m    0.97074      0.51722  7.37s
     18     [36m0.72464[0m     [32m0.74151[0m    0.97725      0.54724  7.66s
     19     [36m0.71579[0m     0.77811    0.91991      0.51310  7.40s
     20     [36m0.70830[0m     0.81375    0.87041      0.50381  7.71s
     21     [36m0.70569[0m     0.78938    0.89399      0.51599  7.83s
     22     [36m0.69206[0m     0.79906    0.86610      0.51857  7.85s
     23     [36m0.68271[0m     0.81118    0.84162      0.51536  7.83s
     24     [36m0.67743[0m     0.74172    0.91332      0.56311  7.83s
     25     [36m0.67111[0m     0.74515    0.90064      0.56599  7.84s
     26     [36m0.67003[0m     [32m0.70732[0m    0.94727      0.57482  7.69s
     27     [36m0.65941[0m     [32m0.64648[0m    1.02002      0.61468  7.79s
     28     [36m0.64746[0m     0.72566    0.89224      0.57829  7.84s
     29     [36m0.64343[0m     0.78035    0.82454      0.56010  7.82s
     30     [36m0.63498[0m     0.70221    0.90427      0.58329  7.82s
     31     [36m0.62545[0m     0.67959    0.92034      0.60281  7.84s
     32     0.62777     0.74700    0.84039      0.57363  7.83s
     33     [36m0.61920[0m     0.66903    0.92552      0.60362  7.82s
     34     [36m0.61746[0m     [32m0.63800[0m    0.96781      0.61445  7.74s
     35     [36m0.60071[0m     0.73552    0.81672      0.58123  7.37s
     36     0.60675     0.69606    0.87169      0.58659  7.39s
     37     [36m0.60060[0m     [32m0.63416[0m    0.94708      0.61616  7.40s
     38     [36m0.59525[0m     [32m0.61633[0m    0.96579      0.65181  7.40s
     39     [36m0.58641[0m     0.65434    0.89619      0.60599  7.40s
     40     [36m0.57943[0m     0.66254    0.87456      0.60785  7.41s
     41     [36m0.57752[0m     0.65255    0.88502      0.61019  7.41s
     42     0.57790     0.62335    0.92708      0.63580  7.39s
     43     [36m0.57048[0m     0.65648    0.86900      0.62483  7.41s
     44     [36m0.56694[0m     0.62046    0.91374      0.64081  7.44s
     45     [36m0.55719[0m     0.66092    0.84306      0.61628  7.41s
     46     0.55896     0.68630    0.81446      0.60151  7.39s
     47     [36m0.55541[0m     0.62928    0.88262      0.62702  7.40s
     48     [36m0.54744[0m     0.74752    0.73235      0.58811  7.41s
Early stopping.
Best valid loss was 0.616329 at epoch 38.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d3' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d3' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d9' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d9' (shape 32).
Loaded parameters to layer 'conv2d11' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d11' (shape 32).
Loaded parameters to layer 'conv2d12' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d12' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[ 0.02653345  0.02034098  0.0200633   0.01671251  0.0134287   0.01869965
  0.01884496  0.02077962  0.01997729  0.01306138  0.0210912   0.01906323
  0.01699871  0.02163422  0.02171487  0.02998418  0.0248754   0.01699566
  0.02101272  0.02162013  0.01464443  0.01719324  0.01599717  0.02734096
  0.01709427  0.01711923  0.0237681   0.01665192  0.01686418  0.0163487 ]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.766307903345
Error rate (%):  23.3692096655
[[70712 17983]
 [ 4164  1911]]
(94770,)
(94770,)
roc_auc: 0.662889585315
log_loss: 0.530522614787
roc_auc for the hours: 0.698630136986
log_loss for the hours: 0.367218953714
saving predictions to csv file
hourspatient1_14_net33_10-22-15-45-23.csv
Accuracy validation for the hours:  0.846153846154
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [14]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.100500992
saving predictions to csv file
patient1_14_net33_10-22-15-48-14.csv
['python', 'train.py', '--debug-sub-ratio=1', '--config-filename=config4.yml', '--no-channels=1', '--target-gpu=gpu0', '--data-path=/home/eavsteen/seizure_detection/data', '--patients=patient1_15']
init done
Command line arguments: Namespace(chosen_validation_ratio=0.2, config_filename='config4.yml', data_path='/home/eavsteen/seizure_detection/data', debug_sub_ratio=1.0, exclude_user=[], fixed_seed=True, include_user=[], mode='None', model_path='/home/eavsteen/seizure_detection/vault', no_channels=1, no_predict_test=False, no_preprocessing=False, no_save_model=False, no_training=False, patients=['patient1_15'], plot_prob_dist=False, save_preprocessed=False, shift=0, shuffle_before_split=True, target_gpu='gpu0')
Git reference:  Timestamp: 2016-10-22 15:48:15.263448
Hostname: kat
gpu0
Configuration 'config4.yml':
Configuration:
preprocess:
    floor: 0
    ceil: 64
    fft_width: 1024
    overlap: 0
    magnitude_window: 192
    augmentation: shift
    normalization: min_max_x255
    include_userdata: false
training:
    model: net33
evaluation:
    online_training: False
    model: net33

end Configuration
['patient1_15']
<type 'list'>
Loading and preprocessing data...
total
365
25
train
292
20
validation
73
5
test_magnitude.shape (1406, 64)
20
5
292
73
Read in dataset from train_2 ...
Processing data ...
read data and preprocess (fft and slicing)
read in channels [15]
/home/eavsteen/seizure_detection/data/train_2/2_
normal i 0
normal i 1
normal i 2
normal i 3
normal i 4
normal i 5
normal i 6
normal i 7
normal i 8
normal i 9
normal i 10
normal i 11
normal i 12
normal i 13
normal i 14
normal i 15
normal i 16
normal i 17
normal i 18
normal i 19
normal i 20
normal i 21
normal i 22
normal i 23
normal i 24
normal i 25
normal i 26
normal i 27
normal i 28
normal i 29
normal i 30
normal i 31
normal i 32
normal i 33
normal i 34
normal i 35
normal i 36
normal i 37
normal i 38
normal i 39
normal i 40
normal i 41
normal i 42
normal i 43
normal i 44
normal i 45
normal i 46
normal i 47
normal i 48
normal i 49
normal i 50
normal i 51
normal i 52
normal i 53
normal i 54
normal i 55
normal i 56
normal i 57
normal i 58
normal i 59
normal i 60
normal i 61
normal i 62
normal i 63
normal i 64
normal i 65
normal i 66
normal i 67
normal i 68
normal i 69
normal i 70
normal i 71
normal i 72
normal i 73
normal i 74
normal i 75
normal i 76
normal i 77
normal i 78
normal i 79
normal i 80
normal i 81
normal i 82
normal i 83
normal i 84
normal i 85
normal i 86
normal i 87
normal i 88
normal i 89
normal i 90
normal i 91
normal i 92
normal i 93
normal i 94
normal i 95
normal i 96
normal i 97
normal i 98
normal i 99
normal i 100
normal i 101
normal i 102
normal i 103
normal i 104
normal i 105
normal i 106
normal i 107
normal i 108
normal i 109
normal i 110
normal i 111
normal i 112
normal i 113
normal i 114
normal i 115
normal i 116
normal i 117
normal i 118
normal i 119
normal i 120
normal i 121
normal i 122
normal i 123
normal i 124
normal i 125
normal i 126
normal i 127
normal i 128
normal i 129
normal i 130
normal i 131
normal i 132
normal i 133
normal i 134
normal i 135
normal i 136
normal i 137
normal i 138
normal i 139
normal i 140
normal i 141
normal i 142
normal i 143
normal i 144
normal i 145
normal i 146
normal i 147
normal i 148
normal i 149
normal i 150
normal i 151
normal i 152
normal i 153
normal i 154
normal i 155
normal i 156
normal i 157
normal i 158
normal i 159
normal i 160
normal i 161
normal i 162
normal i 163
normal i 164
normal i 165
normal i 166
normal i 167
normal i 168
normal i 169
normal i 170
normal i 171
normal i 172
normal i 173
normal i 174
normal i 175
normal i 176
normal i 177
normal i 178
normal i 179
normal i 180
normal i 181
normal i 182
normal i 183
normal i 184
normal i 185
normal i 186
normal i 187
normal i 188
normal i 189
normal i 190
normal i 191
normal i 192
normal i 193
normal i 194
normal i 195
normal i 196
normal i 197
normal i 198
normal i 199
normal i 200
normal i 201
normal i 202
normal i 203
normal i 204
normal i 205
normal i 206
normal i 207
normal i 208
normal i 209
normal i 210
normal i 211
normal i 212
normal i 213
normal i 214
normal i 215
normal i 216
normal i 217
normal i 218
normal i 219
normal i 220
normal i 221
normal i 222
normal i 223
normal i 224
normal i 225
normal i 226
normal i 227
normal i 228
normal i 229
normal i 230
normal i 231
normal i 232
normal i 233
normal i 234
normal i 235
normal i 236
normal i 237
normal i 238
normal i 239
normal i 240
normal i 241
normal i 242
normal i 243
normal i 244
normal i 245
normal i 246
normal i 247
normal i 248
normal i 249
normal i 250
normal i 251
normal i 252
normal i 253
normal i 254
normal i 255
normal i 256
normal i 257
normal i 258
normal i 259
normal i 260
normal i 261
normal i 262
normal i 263
normal i 264
normal i 265
normal i 266
normal i 267
normal i 268
normal i 269
normal i 270
normal i 271
normal i 272
normal i 273
normal i 274
normal i 275
normal i 276
normal i 277
normal i 278
normal i 279
normal i 280
normal i 281
normal i 282
normal i 283
normal i 284
normal i 285
normal i 286
normal i 287
normal i 288
normal i 289
normal i 290
normal i 291
normal i 292
normal i 293
normal i 294
normal i 295
normal i 296
normal i 297
normal i 298
normal i 299
normal i 300
normal i 301
normal i 302
normal i 303
normal i 304
normal i 305
normal i 306
normal i 307
normal i 308
normal i 309
normal i 310
normal i 311
normal i 312
normal i 313
normal i 314
normal i 315
normal i 316
normal i 317
normal i 318
normal i 319
normal i 320
normal i 321
normal i 322
normal i 323
normal i 324
normal i 325
normal i 326
normal i 327
normal i 328
normal i 329
normal i 330
normal i 331
normal i 332
normal i 333
normal i 334
normal i 335
normal i 336
normal i 337
normal i 338
normal i 339
normal i 340
normal i 341
normal i 342
normal i 343
normal i 344
normal i 345
normal i 346
normal i 347
normal i 348
normal i 349
normal i 350
normal i 351
normal i 352
normal i 353
normal i 354
normal i 355
normal i 356
normal i 357
normal i 358
normal i 359
normal i 360
normal i 361
normal i 362
normal i 363
normal i 364
seizure i 0
seizure i 1
seizure i 2
seizure i 3
seizure i 4
seizure i 5
seizure i 6
seizure i 7
seizure i 8
seizure i 9
seizure i 10
seizure i 11
seizure i 12
seizure i 13
seizure i 14
seizure i 15
seizure i 16
seizure i 17
seizure i 18
seizure i 19
seizure i 20
seizure i 21
seizure i 22
seizure i 23
seizure i 24
Done reading in 365 no seizure hours and 25 seizure hours
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
Memory usage (GB): 0.847474688
train_counter_seizure 20 val_counter_seizure 5
train_counter_normal 292 val_counter_normal 73
percentiles:
0 0.0 0.0
10 192.412426758 176.768930054
20 459.689099121 442.431689453
30 658.81307373 637.209912109
40 846.730224609 819.873974609
50 1042.01245117 1009.00811768
60 1261.45869141 1219.99689941
70 1528.8362793 1476.44569092
80 1896.24025879 1829.35996094
90 2539.709375 2448.71398926
100 29197.0292969 29615.0136719
Histogram:
[1460 1460]
yTrain.shape (2920,)
xTrain.shape (2920,)
Histogram:
[1095 1095]
yTrain.shape (2920,)
xTrain.shape (2190,)
xVal.shape (2190,)
yVal.shape (2190,)
Ratio validation: 0.2
xTrain.shape (2920,)
yTrain.shape (2920,)
xVal.shape (2190, 2)
yVal.shape (2190,)
Building models ...
Model name for the training phase:  net33
Model name for the evaluation phase:  net33
Training model...
# Neural Network with 47138 learnable parameters

## Layer information

  #    name  size
---  ------  ---------
  0          1x192x64
  1          32x192x64
  2          32x192x64
  3          32x96x32
  4          32x96x32
  5          32x48x16
  6          32x48x16
  7          32x24x8
  8          32x24x8
  9          32x12x4
 10          32x12x4
 11          32x6x4
 12          2x6x4
 13          2
 14          2

  epoch    trn loss    val loss    trn/val    valid acc  dur
-------  ----------  ----------  ---------  -----------  -----
      1    [36m25.38615[0m     [32m1.89127[0m   13.42283      0.53398  7.33s
      2     [36m5.10778[0m     [32m1.33840[0m    3.81632      0.51121  7.33s
      3     [36m3.09259[0m     [32m1.32667[0m    2.33110      0.50566  7.56s
      4     [36m2.23217[0m     [32m1.18862[0m    1.87796      0.49824  7.85s
      5     [36m1.71328[0m     [32m1.02829[0m    1.66615      0.50434  7.88s
      6     [36m1.43606[0m     [32m0.81560[0m    1.76075      0.50662  7.89s
      7     [36m1.23638[0m     0.92643    1.33456      0.49959  7.89s
      8     [36m1.10718[0m     [32m0.79509[0m    1.39252      0.50014  7.90s
      9     [36m1.00187[0m     [32m0.77266[0m    1.29665      0.50393  7.90s
     10     [36m0.95085[0m     [32m0.77167[0m    1.23219      0.50583  7.88s
     11     [36m0.88694[0m     [32m0.72736[0m    1.21940      0.51231  7.90s
     12     [36m0.85313[0m     0.81086    1.05213      0.50553  7.90s
     13     [36m0.83233[0m     0.78895    1.05499      0.50027  7.91s
     14     [36m0.79775[0m     0.84249    0.94689      0.50054  7.90s
     15     [36m0.78697[0m     0.76690    1.02617      0.51527  7.90s
     16     [36m0.77195[0m     0.74088    1.04193      0.53451  7.90s
     17     [36m0.74596[0m     0.76999    0.96879      0.52048  7.90s
     18     [36m0.71893[0m     [32m0.68084[0m    1.05594      0.57524  7.91s
     19     [36m0.71660[0m     0.73525    0.97464      0.55255  7.77s
     20     [36m0.70809[0m     0.76551    0.92499      0.55256  7.91s
     21     [36m0.68897[0m     0.72330    0.95253      0.57100  7.94s
     22     [36m0.68461[0m     0.73892    0.92650      0.56189  7.95s
     23     [36m0.67334[0m     0.70275    0.95815      0.58032  7.93s
     24     [36m0.66116[0m     0.69811    0.94707      0.57686  7.94s
     25     0.66178     0.75253    0.87942      0.56032  7.94s
     26     0.66278     [32m0.61027[0m    1.08605      0.65046  7.93s
     27     [36m0.64079[0m     0.67797    0.94517      0.59962  7.95s
     28     [36m0.63191[0m     0.66792    0.94608      0.60733  7.93s
     29     0.63248     0.66701    0.94823      0.60666  7.92s
     30     [36m0.62234[0m     0.69904    0.89028      0.59550  7.92s
     31     [36m0.61636[0m     0.73327    0.84056      0.58579  7.88s
     32     0.62015     [32m0.60955[0m    1.01739      0.64712  7.41s
     33     [36m0.60451[0m     0.68522    0.88221      0.61171  7.82s
     34     0.61341     0.66929    0.91652      0.61310  7.81s
     35     [36m0.59601[0m     0.65948    0.90376      0.62625  7.65s
     36     0.59711     0.61353    0.97324      0.64988  7.42s
     37     [36m0.59260[0m     0.68460    0.86562      0.61263  7.42s
     38     [36m0.59089[0m     [32m0.59029[0m    1.00102      0.65532  7.41s
     39     [36m0.58218[0m     0.60775    0.95792      0.64968  7.40s
     40     [36m0.57907[0m     0.59727    0.96953      0.64357  7.41s
     41     [36m0.57306[0m     0.63943    0.89621      0.65140  7.42s
     42     0.58823     0.62067    0.94774      0.61427  7.39s
     43     0.57933     0.65524    0.88415      0.63676  7.41s
     44     [36m0.57236[0m     0.59697    0.95878      0.64243  7.40s
     45     [36m0.57027[0m     0.59918    0.95175      0.63602  7.42s
     46     [36m0.56525[0m     0.60298    0.93743      0.64060  7.40s
     47     [36m0.56032[0m     0.62121    0.90199      0.65696  7.44s
     48     [36m0.55688[0m     0.59624    0.93400      0.63427  7.45s
Early stopping.
Best valid loss was 0.590287 at epoch 38.
Loaded parameters to layer 'conv2d1' (shape 32x1x3x3).
Loaded parameters to layer 'conv2d1' (shape 32).
Loaded parameters to layer 'conv2d3' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d3' (shape 32).
Loaded parameters to layer 'conv2d5' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d5' (shape 32).
Loaded parameters to layer 'conv2d7' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d7' (shape 32).
Loaded parameters to layer 'conv2d9' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d9' (shape 32).
Loaded parameters to layer 'conv2d11' (shape 32x32x3x3).
Loaded parameters to layer 'conv2d11' (shape 32).
Loaded parameters to layer 'conv2d12' (shape 2x32x3x3).
Loaded parameters to layer 'conv2d12' (shape 2).
Saving model...
Validating...
Changing batch iterator test:
Calculating final prediction for the hour long sessions
magnitudes_normal_val.shape (73, 1, 1406, 64)
magnitudes_seizure_val.shape (5, 1, 1406, 64)
probabilities_normal (88695, 2)
probabilities_seizure (6075, 2)
Showing last 30 test samples..
Predictions:
[ 0.0049391   0.00488271  0.00752964  0.01151509  0.00862663  0.00632357
  0.00671571  0.01263727  0.00889695  0.01253346  0.01203698  0.01351364
  0.01238965  0.00617233  0.00973881  0.0088715   0.03105138  0.079609
  0.08948878  0.07764429  0.0787225   0.06936962  0.04951238  0.03931669
  0.0503279   0.04234182  0.06253543  0.06166232  0.06608282  0.04120304]
Ground Truth:
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
Performance on relevant data
Accuracy validation:  0.736910414688
Error rate (%):  26.3089585312
[[67041 21654]
 [ 3279  2796]]
(94770,)
(94770,)
roc_auc: 0.694128868595
log_loss: 0.687893328176
roc_auc for the hours: 0.720547945205
log_loss for the hours: 0.401610347302
saving predictions to csv file
hourspatient1_15_net33_10-22-15-58-38.csv
Accuracy validation for the hours:  0.807692307692
Calculating the predictions for the test files
Loading and preprocessing data...
no_files 2256
test_magnitude.shape (234, 64)
(2256, 1, 234, 64)
Read in dataset from test_2 ...
read data and preprocess (fft and slicing)
read in channels [15]
/home/eavsteen/seizure_detection/data/test_2/2_
Done reading in 2256 test snippets of 10min.
Memory usage (GB): 1.099747328
saving predictions to csv file
patient1_15_net33_10-22-16-01-43.csv
